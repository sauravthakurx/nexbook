<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- NEW: PWA Manifest and Theme Color -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <!-- NEW: Apple-specific PWA meta tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Nexbook - S.S. Jain Subodh P.G. College</title>
    <link rel="apple-touch-icon" href="https://i.postimg.cc/7hbZywt6/Gemini-Generated-Image-z6te44z6te44z6te.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    
    <!-- Confetti Animation Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <!-- Chart.js CDN for Leaderboard -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@^4"></script>
    <!-- Lucide Icons CDN for Hamburger Menu -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- NEW: Google Fonts for Headings and Body -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@700;800;900&display=swap" rel="stylesheet">
    <!-- NEW: Google Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />
    <style>
        /* Page Loader Styles - Optimized for Instant Hide */
        #page-loader {
            position: fixed;
            inset: 0;
            z-index: 100000;
            background-color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Fast fade-out for instant feel - reduced from 0.5s to 0.2s */
            transition: opacity 0.2s ease-out;
            /* Prevent layout shift by using contain */
            contain: layout style paint;
            /* Use will-change for better performance */
            will-change: opacity;
        }
        #page-loader.hidden {
            opacity: 0;
            pointer-events: none;
            /* Immediately remove from layout after fade */
            visibility: hidden;
        }
        /* Optimized SVG Spinner - Minimal animation */
        .premium-spinner {
            animation: rotate 1s linear infinite;
            width: 40px;
            height: 40px;
            /* GPU acceleration */
            transform: translateZ(0);
            will-change: transform;
        }
        .premium-spinner .path {
            stroke: #2563eb;
            stroke-linecap: round;
            /* Simplified animation for better performance */
            animation: dash 1.2s ease-in-out infinite;
        }
        @keyframes rotate {
            100% {
                transform: rotate(360deg) translateZ(0);
            }
        }
        @keyframes dash {
            0% {
                stroke-dasharray: 1, 150;
                stroke-dashoffset: 0;
            }
            50% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -35;
            }
            100% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -124;
            }
        }

        /* Premium Apple-Style Gradient Animation - Right to Left Sliding Effect */
        @keyframes gradientSlideRTL {
            0% {
                background-position: 200% center;
                opacity: 0.7;
            }
            50% {
                opacity: 0.9;
            }
            100% {
                background-position: 0% center;
                opacity: 1;
            }
        }

        /* Enhanced fade and scale animation for tabs */
        @keyframes tabColorFade {
            0% {
                transform: scale(0.98);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-header-gradient {
            background-size: 300% 100%;
            animation: gradientSlideRTL 1s cubic-bezier(0.22, 0.61, 0.36, 1) forwards;
            will-change: background-position;
        }
        
        /* Apply animation to tab transitions */
        .tab-active-animation {
            animation: tabColorFade 0.4s cubic-bezier(0.22, 0.61, 0.36, 1) forwards;
        }

        /* Text Overflow Prevention - Apply to all boxes, cards, and containers */
        button, a, div, span, p, h1, h2, h3, h4, h5, h6 {
            word-wrap: break-word;
            word-break: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }
        
        /* Prevent text from escaping in modal content boxes */
        .modal-content-box, 
        [class*="rounded-"], 
        [class*="bg-white"],
        [class*="p-"] {
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Styles for the component */
        .scroll-float {
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .scroll-float-text { display: inline-block; font-size: clamp(4rem, 15vw, 15rem); font-weight: 700; text-align: center; line-height: 1; }
        .char { display: inline-block; }
        html {
            scroll-behavior: smooth !important; /* FIX: Changed from auto to smooth - prevents page jump */
            /* NEW: Prevent horizontal scrolling */
            overflow-x: hidden;
        }
        body {
            overflow-x: hidden;
            /* FIX: Removed scroll-padding-top to prevent auto-scroll on layout shift */
            scroll-padding-top: 0 !important;
        }
        /* UPDATED: Apply new font styles */
        body, .body-font {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Inter", Roboto, Helvetica, Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            line-height: 1.6;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif;
            font-feature-settings: 'liga' on, 'kern' on; /* Good for serif fonts */
        }

        .font-roboto {
            font-family: 'Roboto', sans-serif;
        }

        /* NEW: Utility class for Playfair Display font */
        .font-playfair {
            font-family: 'Playfair Display', serif;
        }

        /* NEW: Apply Playfair Display to the logo font class */
        .logo-font {
            font-family: 'Playfair Display', serif;
        }

        /* NEW: Utility for slight vertical adjustment */
        .translate-y-0\.5 {
            transform: translateY(2px);
        }


        /* NEW: Grid-based expand/collapse for smoother animations */
        .expandable-grid-wrapper {
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }
        .expandable-grid-wrapper.expanded {
            max-height: 10000px !important; /* A large value to ensure it expands fully */
        }
        /* Initially hide the how-it-works steps */
        #how-it-works-steps-wrapper:not([data-expanded="true"]) {
            max-height: 0;
        }
        /* NEW: Styles for "What You'll Gain" expandable section */
        #what-you-gain-wrapper:not([data-expanded="true"]) {
            max-height: 20rem; /* Approx height for 2 rows on desktop */
        }
        @media (max-width: 767px) {
            #what-you-gain-wrapper:not([data-expanded="true"]) {
                max-height: 33rem; /* Approx height for 3 rows on mobile (2 cards per row) */
            }
        }

        /* --- Apple-Style Expand/Collapse System --- */
        .expandable-content-wrapper {
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.23, 1, 0.32, 1); /* Apple-like easing */
            will-change: max-height;
        }
        #about-us-expandable-wrapper:not([data-expanded="true"]) {
            max-height: 0;
        }
        .rules-collapsible-button[aria-expanded="true"] svg {
            transform: rotate(180deg);
        }

        /* --- NEW: Generic Button Styles --- */
        .view-toggle-btn {
            display: inline-block;
            cursor: pointer;
            background-color: #eff6ff; /* blue-50 */
            color: #1e40af; /* blue-800 */
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px; /* fully rounded */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #dbeafe; /* blue-100 */
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        }
        .view-toggle-btn:hover {
            background-color: #dbeafe; /* blue-100 */
            color: #1c3d9a; /* blue-900 */
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
         .view-toggle-btn:active {
            transform: translateY(-1px);
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        }
        .view-toggle-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* --- "Trading, Simplified" Heading Animation --- */
        .animated-gradient-text {
          background: linear-gradient(90deg, #2563eb, #7c3aed, #db2777, #2563eb);
          background-size: 250% auto;
          color: transparent;
          background-clip: text;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          animation: gradient-flow 6s linear infinite;
        }
        
        /* Rules Panel Animation */
        .rules-panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        .rules-panel.expanded {
            max-height: 500px;
        }
        
        .rules-panel .close-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            padding: 0.5rem;
            border-radius: 9999px;
            transition: all 0.2s;
            background: transparent;
            border: none;
            cursor: pointer;
            color: #666;
        }
        
        .rules-panel .close-button:hover {
            background-color: rgba(0, 0, 0, 0.05);
            color: #000;
        }

        /* --- NEW: Join Us Accordion Styles --- */
        .role-accordion details {
            background-color: #f9fafb; /* gray-50 */
            border: 1px solid #e5e7eb; /* gray-200 */
            border-radius: 1rem; /* rounded-2xl */
            transition: background-color 0.2s;
        }
        .role-accordion details[open] {
            background-color: #ffffff;
        }
        .role-accordion summary {
            padding: 1.5rem;
            font-size: 1.25rem; /* text-xl */
            font-weight: 700; /* font-bold */
            cursor: pointer;
        }
        /* --- NEW: Explosive Title Animation on Scroll --- */
        .explosive-title {
            position: relative;
            display: inline-block;
            transition: transform 0.3s ease-out;
        }
        .explosive-title.is-bursting {
            transform: scale(1.1);
        }
        .explosive-title.is-bursting::before,
        .explosive-title.is-bursting::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 250%; /* Increased size for more impact */
            height: 250%;
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
            animation: burst 0.8s ease-out forwards;
            z-index: -1; /* Place behind the text */
        }
        .explosive-title.is-bursting::before {
            background: radial-gradient(circle, rgba(255, 215, 0, 0.7), transparent 70%); /* UPDATED: Gold color */
            animation-delay: 0.1s; /* Slight delay for the second color */
        }
        .explosive-title.is-bursting::after {
            background: radial-gradient(circle, rgba(255, 105, 180, 0.7), transparent 70%); /* UPDATED: Pink color */
        }
        @keyframes burst {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
        }

        @keyframes gradient-flow {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }
        
        /* --- General UI Enhancements --- */
        .glowing-blue-text {
            color: #60a5fa;
            text-shadow: 0 0 8px rgba(59, 130, 246, 0.7), 0 0 10px rgba(59, 130, 246, 0.5);
            transition: all 0.3s ease;
        }
        .glowing-blue-text:hover {
            text-shadow: 0 0 12px rgba(59, 130, 246, 1), 0 0 15px rgba(59, 130, 246, 0.8);
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .button-animation {
            transition: transform 0.1s ease-in-out;
            will-change: transform;
        }
        .button-animation:active {
            transform: scale(0.95);
        }
        
        @keyframes electric-shine {
            0%, 100% { color: #2563eb; text-shadow: 0 0 5px rgba(59, 130, 246, 0.7), 0 0 8px rgba(59, 130, 246, 0.5); }
            50% { color: #60a5fa; text-shadow: 0 0 10px rgba(96, 165, 250, 1), 0 0 15px rgba(96, 165, 250, 0.8); }
        }
        .academyx-link {
            font-weight: bold;
            animation: electric-shine 4s infinite;
        }
        .mobile-academyx-glow { animation: electric-shine 6s infinite; }
        
        /* Counter Animation Styles */
        .counter-number {
            display: inline-block;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .scroll-reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            transition-delay: 0.2s;
        }
        .scroll-reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* NEW Free Books UI styles */
        .claim-button {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
        }
        .claim-button:hover {
            box-shadow: 0 6px 20px rgba(34, 197, 94, 0.5);
        }
        
        /* NEW Apple-Style AI Course Card */
        .ai-course-card-apple {
            background-color: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1.5rem; /* rounded-3xl */
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        .ai-course-card-apple:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.15);
        }
        .ai-course-card-apple .details-panel {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease-out, padding-top 0.5s ease, padding-bottom 0.5s ease;
            will-change: max-height, opacity;
            padding-top: 0;
            padding-bottom: 0;
        }
        .ai-course-card-apple.expanded .details-panel {
            opacity: 1;
            padding-top: 1rem;
            padding-bottom: 1.5rem;
        }
        /* NEW: Styles for the redesigned AI course card from your request */
        .course-card.expanded .course-details {
            max-height: 600px; /* A large value for expansion */
            padding-top: 0.5rem;
            padding-bottom: 1.25rem;
            opacity: 1;
        }
        .plus-icon {
            transition: transform 0.3s ease-in-out;
        }
        .course-card.expanded .plus-icon {
            transform: rotate(45deg);
        }
        .course-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out, opacity 0.3s ease-out;
            padding-top: 0;
            padding-bottom: 0;
            opacity: 0;
        }
        
        /* --- UNIFIED MODAL SYSTEM (REPLACES ALL PREVIOUS MODAL STYLES) --- */
        body.modal-open {
            overflow: hidden;
        }
        .modal-overlay {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem; /* Padding for smaller screens */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.35s ease-out, visibility 0.35s ease-out;
        }
        .modal-overlay.is-visible {
            opacity: 1;
            visibility: visible;
            transition-timing-function: ease-out;
        }
        .modal-backdrop {
            position: absolute;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5); /* Standard dark overlay */
            opacity: 0;
            transition: opacity 0.35s ease-out;
            will-change: opacity; /* Hardware acceleration hint */
        }
        .modal-content {
            position: relative;
            background-color: white;
            border-radius: 1.25rem;
            box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            width: 100%;
            transform: scale(0.95) translateY(10px);
            opacity: 0;
            transition: transform 0.35s ease-out, opacity 0.3s ease-out;
            will-change: transform, opacity;
        }
        /* NEW: Remove padding from the overlay when it contains a fullscreen modal */
        .modal-overlay:has(.modal-content--fullscreen) {
            padding: 0;
        }

        /* NEW: Modifier for full-screen modals */
        .modal-content--fullscreen {
            width: 100vw;
            height: 100dvh; /* FIX: Use dynamic viewport height to avoid being hidden by mobile browser UI */
            border-radius: 0;
            box-shadow: none;
            transform: translateY(100%); /* Start from bottom for slide-in animation */
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .modal-overlay.is-visible .modal-content--fullscreen {
            transform: translateY(0);
        }
        /* NEW: Ensure fullscreen modal aligns to top on all screen sizes */
        .modal-overlay:has(.modal-content--fullscreen) {
            align-items: flex-start;
            justify-content: flex-start;
        }

        /* --- Animation States --- */
        .modal-overlay.is-visible .modal-content {
            transform: scale(1);
            opacity: 1;
        }
        .modal-overlay.is-visible .modal-backdrop {
            opacity: 1;
        }

        /* NEW Apple-Style Segmented Control */
        .segmented-control {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 0.25rem;
            background-color: #f3f4f6; /* gray-100 */
            border-radius: 0.75rem; /* rounded-xl */
            position: relative;
        }
        .segment {
            flex-grow: 1;
            text-align: center;
            padding: 0.5rem 0.25rem;
            border-radius: 0.5rem; /* rounded-lg */
            cursor: pointer;
            color: #4b5563; /* gray-600 */
            font-weight: 600;
            transition: color 0.3s ease;
            z-index: 10;
        }
        .segment.active {
            color: #1e40af; /* blue-800 */
        }
        
        /* === MODAL SCROLL ISOLATION === */
        /* Dashboard Modal - Scroll only inside */
        #profileDashboardModal {
            isolation: isolate;
        }
        #profileDashboardModal .modal-content {
            overflow: hidden;
        }
        #profileDashboardContent {
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            max-height: 100%;
        }
        
        /* My Backpack Modal - Scroll only inside */
        #myBackpackModal {
            isolation: isolate;
        }
        #myBackpackModal .modal-content {
            overflow: hidden;
        }
        
        /* NEW "Trading, Simplified" Card */
        #trading-simplified-card {
            background-color: rgba(249, 250, 251, 0.8);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.07);
        }
        #trading-simplified-card h2 {
            background: linear-gradient(90deg, #2563eb, #7c3aed, #db2777, #2563eb);
            background-size: 250% auto;
            color: #000;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient-flow 6s linear infinite;
        }
        #trading-simplified-overlay {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.35s ease-out, visibility 0.35s ease-out;
        }
        #trading-simplified-overlay.visible { 
            opacity: 1;
            visibility: visible;
        }
        #trading-simplified-overlay .overlay-backdrop {
             position: absolute;
             inset: 0;
             background-color: rgba(0, 0, 0, 0.6);
             opacity: 0;
             transition: opacity 0.35s ease-out;
             will-change: opacity;
        }
        #trading-simplified-overlay .overlay-content {
            transform: scale(0.95) translateY(10px);
            opacity: 0;
            transition: transform 0.35s ease-out, opacity 0.3s ease-out;
            will-change: transform, opacity;
        }
        #trading-simplified-overlay.visible .overlay-content {
            transform: scale(1);
        }
        #trading-simplified-overlay.visible .overlay-backdrop {
            opacity: 1;
            opacity: 1;
        }
        
        /* NEW Apple-Style Step Boxes */
        .step-box-apple {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        /* --- MOBILE-ONLY STYLES (APPLE-LIKE AESTHETIC) --- */
        @media (max-width: 767px) {
            /* 1. Cutout Box Styling */
             .payment-info-section {
                padding-top: 3rem !important; /* Make space for the curve */
                margin-top: -30px;
                z-index: 10;
                position: relative;
                border-top-left-radius: 30px;
                border-top-right-radius: 30px;
                box-shadow: 0 -10px 20px rgba(0,0,0,0.05);
            }
            #top {
                background-color: #f9fafb; /* bg-gray-50 */
            }
            #top::after {
                content: '';
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                height: 40px;
                background: inherit;
                border-top-left-radius: 100%;
                border-top-right-radius: 100%;
                transform: translateY(50%);
                filter: drop-shadow(0 -10px 8px rgba(0,0,0,0.04));
                z-index: 5;
            }
            
            /* 4. Ensure Full Box Visibility before "View More" */
            #course-selection-container-wrapper:not([data-expanded="true"]) {
                max-height: 70rem; /* 4 items: (4 * 16rem h) + (3 * 2rem gap) */
            }
            #study-material-wrapper:not([data-expanded="true"]) {
                max-height: 46rem; /* 4 items: approx (4 * 9.5rem h) + (3 * 2rem gap) */
            }
             #platforms-wrapper:not([data-expanded="true"]) {
                max-height: 64rem; /* 4 items: approx (4 * 14rem h) + (3 * 2rem gap) */
            }
            #ai-courses-wrapper:not([data-expanded="true"]) {
                max-height: 42rem; /* 4 items: approx (4 * 8.5rem h) + (3 * 2rem gap) */
            }
            #universities-wrapper:not([data-expanded="true"]) {
                max-height: 28rem; /* 2 rows of 2 items. (2 * 13rem h) + (1 * 1.5rem gap) */
            }
            #subjects-wrapper:not([data-expanded="true"]) {
                 max-height: 54rem; /* 4 items: approx (4 * 11.5rem h) + (3 * 2rem gap) */
            }
            .expandable-content-wrapper[data-expanded="true"] {
                max-height: 10000px; /* A large value to ensure it expands fully */
            }
            /* NEW: Ensure grid-based wrappers also show 4 items initially on mobile */
            .expandable-grid-wrapper:not(.expanded) {
                max-height: 64rem; /* Approx height for 4 cards */
            }

            /* Thinkly AI search bar fix */
            #thinkly-ai-hero .AgWCw {
                max-width: 100vw !important;
                width: 95% !important;
                pointer-events: auto !important; /* FIX: Stop click leak that causes page jump */
            }
            
            /* Large container fix */
            #thinkly-ai-hero .LmmD9,
            #thinkly-ai-hero .d4HWzd {
                max-width: 100vw !important;
            }
            
            /* Global safety net */
            * {
                max-width: 100vw !important;
            }
        }

        /* --- NEW FUTURISTIC MOBILE NAVIGATION BAR STYLES --- */
        :root {
            --ease-quart: cubic-bezier(0.76, 0, 0.24, 1);
            --ease-out-quart: cubic-bezier(0.25, 1, 0.5, 1);
        }
 
        .mobile-nav-container {
            position: fixed;
            bottom: 0.2rem;
            left: 50%;
            transform: translate(-50%, 20px) scale(0.98);
            filter: blur(10px);
            opacity: 0;
            width: calc(100% - 0.4rem); /* Made it narrower */
            max-width: 380px; /* Reduced max width */
            z-index: 50;
            animation: cinematic-reveal-mobile 1s var(--ease-out-quart) 0.5s forwards;
            will-change: transform, filter, opacity;
            transition: transform 0.4s var(--ease-quart), opacity 0.4s var(--ease-quart);
        }
 
        .mobile-nav-container.hidden {
            transform: translate(-50%, 150%); /* Slide down to hide */
            opacity: 0;
            pointer-events: none;
        }
 
        .mobile-nav-container.nav-hidden {
            transform: translate(-50%, 150%); /* Slide down to hide */
            opacity: 0;
            pointer-events: none;
        }
        @keyframes cinematic-reveal-mobile {
            100% {
                opacity: 1;
                transform: translate(-50%, 0) scale(1);
                filter: blur(0);
            }
        }
        
        .mobile-nav-bg {
            position: absolute;
            inset: 3px 0; /* Make it vertically thinner */
            border-radius: 3rem; /* Increased radius */
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(24px) saturate(1.8);
            -webkit-backdrop-filter: blur(24px) saturate(1.8);
            border: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow: 0 -4px 32px 0 rgba(0, 0, 0, 0.1);
            pointer-events: auto; /* Make the background block clicks to elements behind it */
        }
 
        .mobile-nav-item {
            transition: transform 0.2s var(--ease-out-quart);
        }
 
        .mobile-nav-item:active {
            transform: scale(0.9);
            /* pointer-events: auto; */ /* No longer needed as parent nav is clickable */
        }

        /* NEW: Prevent raised button from jumping on click */
        .nex-button-raised:active {
            transform: translateY(-13px) scale(0.95);
        }
 
        .mobile-nav-item .icon-wrapper {
            position: relative;
            /* pointer-events: none; */ /* Removed to allow clicks on icons */
        }
 
        .mobile-nav-item.active .icon-glow {
            opacity: 1;
            transform: scale(1);
        }
        
        .mobile-nav-item.active svg {
            color: #2563EB; /* Active icon color: vibrant blue */
        }
 
        .icon-glow {
            position: absolute;
            inset: -8px;
            background: #3B82F6; /* Glow color: vibrant blue */
            border-radius: 50%;
            opacity: 0;
            filter: blur(12px);
            transform: scale(0.5);
            transition: all 0.4s var(--ease-quart);
            z-index: -1;
        }
        
        /* NEW: Style for the raised NeX button */
        .nex-button-raised {
            transform: translateY(-13px);
            transition: transform 0.4s var(--ease-quart);
        }

        /* NEW: Mobile Bottom Nav Safe Area */
        @supports (padding-bottom: env(safe-area-inset-bottom)) {
            .pb-safe {
                padding-bottom: env(safe-area-inset-bottom);
            }
        }
        /* --- Thinkly AI Chat Styles --- */
        #thinkly-ai-hero {
            --nvzc4: #ffffff;
            --nvzc9: #0a0a0a;
            --nvzc12: #56595e;
            --nvzc13: #0a0a0a;
            --nvzc19: #007aff;
            --aYn2S: #f0f2f5;
            --emphasized-curve: cubic-bezier(0.38, 0.72, 0, 1);
        }
        #thinkly-ai-hero .AgWCw {
            display: flex;
            align-items: flex-end;
            pointer-events: auto !important; /* FIX: Enable pointer events to prevent click leak and page jump */
            position: fixed; /* Fixed position so it doesn't scroll */
            bottom: 1rem; /* 16px */
            left: 40%;
            transform: translateX(-50%);
            z-index: 40 !important; /* Below navbar (50) to sit BEHIND the Navbar */
            isolation: isolate; /* Create new stacking context */
            will-change: height, margin, width, border-radius;
            transition: height .5s var(--emphasized-curve), margin .5s var(--emphasized-curve), width .5s var(--emphasized-curve), border-radius .5s var(--emphasized-curve);
            height: 56px;
            border-radius: 28px;
            margin: 0 1rem; /* Add horizontal margin for spacing on smaller screens */
            width: 100%;
            max-width: 720px;
            cursor: pointer;
        }
        #thinkly-ai-hero .AgWCw > * {
            pointer-events: auto !important; /* Re-enable pointer events for direct children */
        }
        #thinkly-ai-hero .UAbVe .AgWCw,
        #thinkly-ai-hero .is-chatting .AgWCw { cursor: default; }
        #thinkly-ai-hero .UAbVe .AgWCw { height: 120px; }
        #thinkly-ai-hero .is-chatting .AgWCw { height: 300px; border-radius: 24px; }
        #thinkly-ai-hero .LmmD9, #thinkly-ai-hero .d4HWzd { position: absolute; contain: paint; border-radius: inherit; inset: 0; transition: border-radius .5s var(--emphasized-curve); }
        
        /* ðŸ”¥ CRITICAL FIX: Make animation layers click-through so search bar is tappable */
        #thinkly-ai-hero .LmmD9,
        #thinkly-ai-hero .d4HWzd,
        #thinkly-ai-hero .LmmD9::before,
        #thinkly-ai-hero .LmmD9::after,
        #thinkly-ai-hero .d4HWzd::before {
            pointer-events: none !important;
        }
        
        /* ðŸ”¥ Ensure interactive elements receive clicks */
        #thinkly-ai-hero .AgWCw,
        #thinkly-ai-hero .esoFne,
        #thinkly-ai-hero #searchBarWrapper,
        #thinkly-ai-hero #searchBar,
        #thinkly-ai-hero #sendBtn,
        #thinkly-ai-hero #clearChatBtn,
        #thinkly-ai-hero #thinklyMenuButton,
        #thinkly-ai-hero #closeButton {
            pointer-events: auto !important;
        }
        
        #thinkly-ai-hero .LmmD9::after { border-radius: inherit; content: ""; position: absolute; inset: 0; background: var(--aYn2S); z-index: -1; pointer-events: none; }
        #thinkly-ai-hero .UAbVe .LmmD9::after { animation: color-pulse-on-expand .5s cubic-bezier(0.4, 0, 0.2, 1); }
        #thinkly-ai-hero .LmmD9::before { content: ""; position: absolute; opacity: 0; background: conic-gradient(rgba(52,168,82,0) 0deg,rgba(52,168,82,1) 38.9738deg,rgba(255,211,20,1) 62.3678deg,rgba(255,70,65,1) 87.0062deg,rgba(49,134,255,1) 107.428deg,rgba(49,134,255,0.5) 204.48deg,rgba(49,134,255,0) 308.88deg,rgba(52,168,82,0) 360deg) border-box; left: 50%; top: 50%; translate: -50% -50%; width: 1200px; height: 1200px; scale: 1 .4; pointer-events: none; transition: opacity .3s; filter: blur(35px); }
        #thinkly-ai-hero .UAbVe .LmmD9::before { animation: gradient-spin-expand 1.6s cubic-bezier(0.2, 0, 0, 1); }
        #thinkly-ai-hero .d4HWzd::before { content: ""; contain: paint; position: absolute; inset: 0; border-radius: inherit; transition: filter .3s, border-radius .5s var(--emphasized-curve); background: var(--nvzc4); border: 1px solid #dcdfe5; }
        #thinkly-ai-hero .UAbVe .d4HWzd::before { animation: plate-background-blur-on-expand .6s var(--emphasized-curve), color-pulse-on-expand .5s var(--emphasized-curve); }
        #thinkly-ai-hero .esoFne { display: flex; flex-direction: column; width: 100%; height: 100%; padding: 16px; z-index: 100; position: relative; transition: padding .5s var(--emphasized-curve); }
        #thinkly-ai-hero .UAbVe .esoFne { padding: 16px; }
        /* UPDATED: Adjust padding and flex for chatting state */
        #thinkly-ai-hero .is-chatting .esoFne {
            padding: 48px 8px 8px 8px;
            justify-content: flex-end; /* Push content to the bottom */
        }
        #thinkly-ai-hero #chatOutput { flex-grow: 1; overflow-y: auto; margin-bottom: 12px; display: flex; flex-direction: column; gap: 12px; scroll-behavior: smooth; scrollbar-width: none; }
        #thinkly-ai-hero #chatOutput::-webkit-scrollbar { display: none; }
        #thinkly-ai-hero .chat-message { padding: 8px 14px; border-radius: 18px; max-width: 80%; word-wrap: break-word; overflow-wrap: break-word; }
        #thinkly-ai-hero .user-message { background-color: var(--nvzc19); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
        #thinkly-ai-hero .ai-message { background-color: #e5e5ea; color: black; align-self: flex-start; border-bottom-left-radius: 4px; }
        #thinkly-ai-hero .input-area { display: flex; align-items: flex-end; gap: 8px; position: relative; opacity: 0; transform: translateY(20px); pointer-events: none; transition: opacity 0.4s var(--emphasized-curve), transform 0.4s var(--emphasized-curve); }
        #thinkly-ai-hero .UAbVe .input-area, #thinkly-ai-hero .is-chatting .input-area { opacity: 1; transform: translateY(0); pointer-events: auto; }
        /* NEW: Styles for AI response pills */
        #thinkly-ai-hero .ai-response-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        #thinkly-ai-hero .ai-pill {
            background-color: rgba(0, 122, 255, 0.1);
            border: 1px solid rgba(0, 122, 255, 0.2);
            color: #007aff;
            padding: 8px 14px;
            border-radius: 16px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #thinkly-ai-hero .ai-pill:hover {
            background-color: rgba(0, 122, 255, 0.2);
        }
        
        /* ðŸ”¥ SUPER BOOST: Force searchBarWrapper to be on top and clickable */
        #thinkly-ai-hero #searchBarWrapper {
            position: relative;
            z-index: 42 !important; /* Below navbar (50) but above AgWCw (40) */
            pointer-events: auto !important;
            cursor: pointer;
            isolation: isolate; /* Create new stacking context */
        }
        
        /* ðŸ”¥ Make sure content area is also high z-index */
        #thinkly-ai-hero .esoFne {
            z-index: 43 !important; /* Below navbar but above searchBarWrapper */
            position: relative;
            pointer-events: auto !important;
        }
        
        #thinkly-ai-hero .textarea-wrapper { position: relative; flex-grow: 1; display: flex; background-color: #f0f2f5; border-radius: 20px; transition: background-color 0.3s; }
        #thinkly-ai-hero .textarea-wrapper:focus-within { background-color: #e9ebf0; }
        #thinkly-ai-hero .ITIRGe { font-family: "Google Sans", Roboto, Arial, sans-serif; width: 100%; font-size: 16px; line-height: 22px; border: none; background: none; outline: none; padding: 12px 16px; resize: none; color: var(--nvzc13); min-height: 48px; max-height: 84px; overflow-y: auto; position: relative; z-index: 2; font-weight: 400 !important; font-style: normal !important; }
        #thinkly-ai-hero .placeholder-text { position: absolute; top: 50%; left: 16px; transform: translateY(-50%); color: var(--nvzc12); pointer-events: none; opacity: 0; transition: opacity 0.4s ease 0.2s, transform 0.4s ease 0.2s; z-index: 1; }
        #thinkly-ai-hero .UAbVe .placeholder-text { opacity: 1; }
        #thinkly-ai-hero .textarea-wrapper.has-content .placeholder-text { opacity: 0; transition-delay: 0s; }
        #thinkly-ai-hero .action-buttons { display: flex; align-items: center; gap: 4px; }
        #thinkly-ai-hero #fileButton { opacity: 0; transform: scale(0.8); pointer-events: none; transition: opacity .4s ease .2s, transform .4s var(--emphasized-curve) .2s; }
        #thinkly-ai-hero .UAbVe #fileButton, #thinkly-ai-hero .is-chatting #fileButton { opacity: 1; transform: scale(1); pointer-events: auto; }
        #thinkly-ai-hero .control-button, #thinkly-ai-hero .OEueve { cursor: pointer; border-radius: 9999px; display: flex; align-items: center; justify-content: center; width: 48px; height: 48px; flex-shrink: 0; transition: transform 0.2s ease, opacity 0.2s ease, background-color 0.2s ease; }
        #thinkly-ai-hero .control-button:hover { background-color: rgba(0,0,0,0.05); }
        #thinkly-ai-hero .OEueve { background: radial-gradient(circle at 28% 24%, #e0f2fe 0%, #bae6fd 45%, #7dd3fc 100%); color: white; padding: 0; overflow: hidden; border: none; box-shadow: 0 4px 12px rgba(125,211,252,0.3); }
        #thinkly-ai-hero .OEueve:not(.disabled):hover { transform: scale(1.05); }
        #thinkly-ai-hero .OEueve.disabled { opacity: .5; pointer-events: none; }
        
        /* EMO Send Button Styles */
        .emo-send-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            padding: 2px;
        }
        .emo-send-face {
            width: 65%;
            height: 45%;
            background: #0f1416;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 0 8%;
        }
        .emo-send-eye-group {
            transform-origin: 50% 50%;
            transition: all 350ms cubic-bezier(.2,.9,.2,1);
        }
        .emo-send-eye-group path {
            transition: d 350ms cubic-bezier(.2,.9,.2,1);
        }
        #thinkly-ai-hero #expandButton { position: absolute; top: 12px; left: 12px; z-index: 100 !important; width: 80px; height: 28px; border-radius: 14px; background-color: rgba(0, 122, 255, 0.1); border: 1px solid rgba(0, 122, 255, 0.2); backdrop-filter: blur(4px); color: var(--nvzc19); font-size: 13px; font-weight: 500; display: flex; align-items: center; justify-content: center; gap: 4px; cursor: pointer; opacity: 0; pointer-events: none; transition: opacity 0.1s ease, background-color .2s ease; }
        #thinkly-ai-hero .is-chatting #expandButton, #thinkly-ai-hero .UAbVe #expandButton { opacity: 1 !important; pointer-events: auto !important; transition-delay: .2s; }
        #thinkly-ai-hero #expandButton:hover { background-color: rgba(0, 122, 255, 0.2); }
        #thinkly-ai-hero #clearChatButton { position: absolute; top: 16px; right: 16px; z-index: 100 !important; width: 32px; height: 32px; border-radius: 50%; background-color: rgba(128, 128, 128, 0.15); color: #666; display: flex; align-items: center; justify-content: center; cursor: pointer; opacity: 0; pointer-events: none; transition: opacity .4s ease .2s, background-color .2s ease; backdrop-filter: blur(4px); }
        #thinkly-ai-hero .is-chatting #clearChatButton, #thinkly-ai-hero .UAbVe #clearChatButton { opacity: 1; pointer-events: auto; }
        #thinkly-ai-hero #clearChatButton:hover { background-color: rgba(200, 200, 200, 0.9); }
        #thinkly-ai-hero .search-bar-title { color: var(--nvzc9); font-size: 1.5rem; font-weight: 500; text-align: left; opacity: 0.8; position: absolute; left: 24px; top: 50%; transform: translateY(-50%); pointer-events: none; transition: opacity .3s ease, transform .5s var(--emphasized-curve); }
        #thinkly-ai-hero .UAbVe .search-bar-title { opacity: 0; transform: translateY(-150%); }
        #thinkly-ai-hero .is-chatting .search-bar-title { opacity: 0; transform: translateY(-50%) translateY(-60px); }
        #thinkly-ai-hero .shine-colorful { background: conic-gradient(from 90deg at 40% -25%, #fff500, #ff8c00, #ff2d2d, #ff00a0, #ff2d2d, #ff8c00, #fff500); background-size: 200% auto; -webkit-background-clip: text; background-clip: text; color: transparent; animation: shine 4s linear infinite; }
        /* NEW: Responsive fix for Thinkly AI on mobile */
        @media (max-width: 767px) {
            #thinkly-ai-hero .AgWCw {
                max-width: 100%; /* Allow it to fill the container on mobile */
                margin: 0 1rem; /* Use horizontal margin for consistent spacing */
            }
            #thinkly-ai-hero .AgWCw { width: 94%; bottom: 85px; }
            /* NEW: Fix for the fullscreen expanded view on mobile */
            #thinkly-ai-hero #expandedView {
                width: 100vw;
                height: 100dvh; /* Use dynamic viewport height to account for address bar */
                max-width: 100vw;
                max-height: 100dvh; /* Use dynamic viewport height */
                border-radius: 0; /* Remove rounded corners for a true fullscreen feel */
            }
        }
        #thinkly-ai-hero .thinking-shine { background: linear-gradient(120deg, #56595e 20%, #0a0a0a 40%, #0a0a0a 60%, #56595e 80%); background-size: 300% auto; color: transparent; -webkit-background-clip: text; background-clip: text; animation: shine 1s linear infinite; }
        #thinkly-ai-hero #middleTitle { position: absolute; top: 12px; left: 50%; transform: translateX(-50%); z-index: 10; font-size: 14px; font-weight: 700; opacity: 0; pointer-events: none; transition: opacity .4s ease; }
        #thinkly-ai-hero .UAbVe:not(.is-chatting) #middleTitle, #thinkly-ai-hero .is-chatting #middleTitle { opacity: 1; }
        #thinkly-ai-hero #expandedView { 
            position: fixed; 
            inset: 0; 
            width: 100vw;
            height: 100dvh; /* Use dynamic viewport height for mobile */
            z-index: 100 !important; /* High z-index for fullscreen mode - above navbar */
            background: #ffffff; 
            display: flex; 
            flex-direction: column; 
            border-radius: 0; /* No rounded corners for fullscreen */
            transform: scale(0.95); 
            opacity: 0; 
            pointer-events: none; 
            transition: transform .4s var(--emphasized-curve), opacity .4s var(--emphasized-curve); 
        }
        #thinkly-ai-hero #expandedView.visible { transform: scale(1); opacity: 1; pointer-events: auto; }
        
        /* ðŸ”¥ FIX: Hide Thinkly AI when other modals are open */
        body.modal-open #thinkly-ai-hero #expandedView,
        #notesNavigationModal.active ~ * #thinkly-ai-hero #expandedView,
        #assignmentsNavigationModal.active ~ * #thinkly-ai-hero #expandedView,
        #practicalsNavigationModal.active ~ * #thinkly-ai-hero #expandedView {
            display: none !important;
            z-index: -1 !important;
        }
        
        #thinkly-ai-hero .expanded-header { padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #e5e5ea; flex-shrink: 0; }
        #thinkly-ai-hero .expanded-title { font-weight: 700; font-size: 1.1rem; }
        #thinkly-ai-hero #closeButton { 
            width: 32px; 
            height: 32px; 
            background: #e5e5ea; 
            color: #888; 
            z-index: 100000 !important; 
            position: relative; 
            pointer-events: auto !important;
            cursor: pointer !important;
        }
        /* NEW: Thinkly AI Sidebar Styles */
        #thinkly-ai-hero #thinklySidebarOverlay {
            position: absolute;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 20;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
        }
        #thinkly-ai-hero #thinklySidebarOverlay.visible {
            opacity: 1;
            pointer-events: auto;
        }
        #thinkly-ai-hero #thinklySidebar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            z-index: 30;
        }
        /* NEW: Fix for the expanded view's input area to make textarea take full width */
        #thinkly-ai-hero .expanded-input-area .input-area {
            width: 100%;
        }
        #thinkly-ai-hero .expanded-input-area .ITIRGe { flex-grow: 1; }
        #thinkly-ai-hero #expandedChatOutput { flex-grow: 1; overflow-y: auto; padding: 16px; display: flex; flex-direction: column; gap: 12px; }
        #thinkly-ai-hero .expanded-input-area { padding: 8px 16px 16px; border-top: 1px solid #e5e5ea; }
        @keyframes takeoff { 0% { transform: translateX(0) scale(1); opacity: 1; } 100% { transform: translateX(40px) scale(0.6); opacity: 0; } }
        #thinkly-ai-hero .animate-takeoff { animation: takeoff 0.5s ease-out forwards; }
        /* Prevent body scroll when Thinkly AI is expanded - Handled by inline styles now */
        body.thinkly-expanded {
            overflow: hidden; /* Backup safety */
        }
        @keyframes shine { to { background-position: 200% center; } }
        @keyframes gradient-spin-expand { 0% { opacity: 0; transform: rotate(90deg); } 10% { opacity: 1; } 80% { opacity: 1; } 100% { opacity: 0; transform: rotate(250deg); } }
        @keyframes plate-background-blur-on-expand { 0% { filter: blur(0); } 11% { filter: blur(7px); } 100% { filter: blur(0); } }
        @keyframes color-pulse-on-expand { 11% { background: var(--nvzc4); } }

        /* ðŸ”¥ CRITICAL: Hide Thinkly AI when any modal is open */
        body.modal-open #thinkly-ai-hero {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }

        /* ðŸ”¥ NEW: Smooth transition for Thinkly AI visibility */
        #thinkly-ai-hero {
            position: relative;
            z-index: 40 !important; /* Below navbar (50) to stay behind it when scrolling */
            transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
        }

        /* Success Modal Styles */
        .success-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .success-modal.show {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        
        .success-modal-content {
            background: white;
            border-radius: 24px;
            padding: 48px 40px;
            text-align: center;
            max-width: 420px;
            width: 90%;
            position: relative;
            transform: scale(0.8) translateY(30px);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .success-modal.show .success-modal-content {
            transform: scale(1) translateY(0);
        }

        /* NEW: My Orders Status Tracker */
        .order-status-tracker {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            margin: 2rem 0;
        }
        .order-status-tracker::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background-color: #e5e7eb; /* gray-200 */
            transform: translateY(-50%);
            z-index: 1;
        }
        .status-step {
            position: relative;
            z-index: 2;
            text-align: center;
        }
        .status-dot {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: #e5e7eb; /* gray-200 */
            border: 4px solid #fff;
            margin: 0 auto 0.5rem;
            transition: background-color 0.3s;
        }
        .status-step.active .status-dot {
            background-color: #2563eb; /* blue-600 */
        }

        
        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 50%;
            margin: 0 auto 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: success-bounce 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        
        @keyframes success-bounce {
            0% { 
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% { 
                transform: scale(1.2) rotate(180deg);
                opacity: 1;
            }
            100% { 
                transform: scale(1) rotate(360deg);
                opacity: 1;
            }
        }
        
        /* Toast Notification Styles */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: white;
            color: black;
            padding: 16px 24px;
            border-radius: 12px;
            font-weight: 500;
            z-index: 10001;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none; /* Prevent blocking clicks when hidden */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(8px);
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
            pointer-events: auto; /* Allow interaction when visible */
        }
        
        /* Loading Button Styles */
        .btn-loading {
            position: relative;
            cursor: wait;
            opacity: 0.7;
        }
        
        .btn-loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* UPDATED: Error toast style as per your request */
        .toast.error {
            background-color: white;
            color: #2563eb; /* blue-600 */
        }

        /* NEW: Apple-Style Connection Alert */
        .connection-alert {
            position: fixed;
            bottom: 6rem; /* Moved up to avoid mobile nav */
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            z-index: 10002; /* Above toast */
            display: flex;
            align-items: center;
            gap: 0.75rem; /* 12px */
            padding: 0.75rem 1.25rem; /* 12px 20px */
            border-radius: 9999px; /* pill shape */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            font-size: 0.9rem; /* 14.4px */
            font-weight: 500;
            color: rgba(0, 0, 0, 0.75);
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(16px) saturate(1.8);
            -webkit-backdrop-filter: blur(16px) saturate(1.8);
            border: 1px solid rgba(0, 0, 0, 0.08);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            opacity: 0;
            visibility: hidden;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), visibility 0.4s;
            will-change: transform, opacity;
        }
        .connection-alert.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
            visibility: visible;
        }

        /* EMO Pet Chatbot Styles */
        .emo-pet-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 40; /* Below modals (100) but above normal content */
            width: 100px;
            height: 100px;
            pointer-events: auto;
        }
        
        @media (max-width: 767px) {
            .emo-pet-container {
                bottom: 100px; /* Above mobile nav */
                right: 15px;
                width: 80px;
                height: 80px;
            }
        }

        .emo-bot {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at 28% 24%, #e0f2fe 0%, #bae6fd 45%, #7dd3fc 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 18px 40px rgba(125,211,252,0.25), inset 0 -6px 18px rgba(0,0,0,0.04);
            position: relative;
            transition: transform 520ms cubic-bezier(0.34, 1.56, 0.64, 1);
            animation: emo-minimal-bounce 3s ease-in-out infinite;
            cursor: pointer;
        }

        /* Minimal Bounce Animation */
        @keyframes emo-minimal-bounce {
            0%, 100% { 
                transform: translateY(0px); 
            }
            50% { 
                transform: translateY(-6px); 
            }
        }

        .emo-screen {
            width: 62%;
            height: 36%;
            background: #0f1416;
            border-radius: 28px;
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 0 6%;
            filter: drop-shadow(0 6px 18px rgba(2,6,10,0.25));
        }

        .emo-eye-group {
            transform-origin: 50% 50%;
            transition: transform 700ms cubic-bezier(.2,.9,.2,1);
        }

        .emo-glow {
            filter: drop-shadow(0 8px 16px rgba(61,238,255,0.12));
        }

        .emo-hint {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: #4b5563;
            opacity: 0;
            transition: opacity 0.3s;
            white-space: nowrap;
            pointer-events: none;
        }

        .emo-pet-container:hover .emo-hint {
            opacity: 0.6;
        }

        /* --- NEW: AcademyX Platform Card Styles --- */
        .card-apple-platform {
            background-color: #f9f9f9;
            border-radius: 24px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .card-apple-platform:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .card-visual {
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background-size: cover;
            background-position: center;
        }
        .card-visual::before { /* Gradient Overlay */
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: 0;
        }
        .card-visual img, .card-visual svg, .card-visual span {
            position: relative;
            z-index: 1;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
        }
        .card-content-platform {
            padding: 24px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
        }
        .card-link-platform {
            font-weight: 600;
            color: #007aff;
            transition: transform 0.2s ease;
            display: inline-block;
        }
        .card-link-platform:hover {
           transform: translateX(4px);
        }

        /* Gradients Overlays - Reduced Opacity for Clearer Images */
        .gradient-google::before { background: linear-gradient(135deg, rgba(66, 133, 244, 0.65), rgba(52, 168, 83, 0.65)); }
        .gradient-ai::before { background: linear-gradient(135deg, rgba(95, 114, 190, 0.65), rgba(153, 33, 232, 0.65)); }
        .gradient-growth::before { background: linear-gradient(135deg, rgba(16, 185, 129, 0.65), rgba(52, 211, 153, 0.65)); }
        .gradient-stanford::before { background: linear-gradient(135deg, rgba(177, 4, 14, 0.65), rgba(140, 21, 21, 0.65)); }
        .gradient-amazon::before { background: linear-gradient(135deg, rgba(255, 153, 0, 0.65), rgba(35, 47, 62, 0.65)); }
        .gradient-business::before { background: linear-gradient(135deg, rgba(245, 208, 32, 0.65), rgba(245, 56, 3, 0.65)); }
        .gradient-design::before { background: linear-gradient(135deg, rgba(142, 45, 226, 0.65), rgba(74, 0, 224, 0.65)); }
        .gradient-cs::before { background: linear-gradient(135deg, rgba(0, 198, 255, 0.65), rgba(0, 114, 255, 0.65)); }
        .gradient-cfi::before { background: linear-gradient(135deg, rgba(0, 45, 98, 0.65), rgba(0, 66, 148, 0.65)); }
        .gradient-dm::before { background: linear-gradient(135deg, rgba(214, 41, 118, 0.65), rgba(250, 126, 30, 0.65)); }
        .gradient-pm::before { background: linear-gradient(135deg, rgba(237, 33, 58, 0.65), rgba(147, 41, 30, 0.65)); }

        /* === BUY BOOKS MODAL STYLES === */
        #buyBooksModal {
            position: fixed;
            inset: 0;
            z-index: 99999;
            background: white;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            display: none;
            isolation: isolate; /* Isolate the modal content */
        }
        #buyBooksModal.active {
            display: block;
            transform: translateY(0);
        }
        #buyBooksContainer {
            width: 100%;
            height: 100%;
            overflow: auto; /* Allow scrolling ONLY inside this container */
            overflow-x: hidden;
            position: relative;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }
        #buyBooksIframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }
        /* Shopping Modal Loader */
        #shoppingLoader {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100000;
            pointer-events: none;
        }
        #shoppingLoader.hidden {
            display: none;
        }
        .shopping-spinner {
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        .shopping-spinner .path {
            stroke: #3b82f6;
            stroke-linecap: round;
            animation: dash 1.5s ease-in-out infinite;
        }
        @keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }
        @keyframes dash {
            0% {
                stroke-dasharray: 1, 150;
                stroke-dashoffset: 0;
            }
            50% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -35;
            }
            100% {
                stroke-dasharray: 90, 150;
                stroke-dashoffset: -124;
            }
        }
        /* Close button for buy books modal */
        #closeBuyBooksBtn {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 100001;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 9999px;
            padding: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.2s;
            cursor: pointer;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        #closeBuyBooksBtn:hover {
            background: rgba(243, 244, 246, 0.95);
            transform: scale(1.05);
            box-shadow: 0 6px 10px -2px rgba(0, 0, 0, 0.12);
        }
        #closeBuyBooksBtn svg {
            display: block;
            color: #374151;
            width: 20px;
            height: 20px;
        }

        /* ===== CRITICAL FIX: Prevent Thinkly AI page jump ===== */
        /* This fixes the issue where clicking Thinkly AI causes page to jump to top */
        html, body {
            scroll-behavior: smooth !important;
        }

        /* Prevent auto-scroll on layout shift when Thinkly AI expands */
        #thinkly-ai-hero {
            scroll-margin-top: 0 !important;
        }

        /* ========================================
           HAMBURGER MENU STYLES (Apple-Style)
           ======================================== */
        
        /* Scrollbar styles for menu */
        #menu-nav::-webkit-scrollbar {
            width: 6px;
        }
        #menu-nav::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        #menu-nav::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 10px;
        }
        #menu-nav::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        /* Apple-like Animated Hamburger Icon */
        .hamburger-icon-apple {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            width: 20px;
            height: 16px;
            position: relative;
            transform: rotate(0deg);
            transition: .2s ease-in-out;
            cursor: pointer;
        }

        .hamburger-icon-apple .line-apple {
            display: block;
            position: absolute;
            height: 2px;
            width: 100%;
            background: currentColor;
            border-radius: 9px;
            opacity: 1;
            left: 0;
            transform: rotate(0deg);
            transition: .25s ease-in-out;
        }

        .hamburger-icon-apple .line-apple.top {
            top: 0px;
        }
        .hamburger-icon-apple .line-apple.middle {
            top: 7px;
        }
        .hamburger-icon-apple .line-apple.bottom {
            top: 14px;
        }
        
        /* Active state (X) */
        #hamburgerBtn.active .hamburger-icon-apple .line-apple.top {
            top: 7px;
            transform: rotate(135deg);
        }
        
        #hamburgerBtn.active .hamburger-icon-apple .line-apple.middle {
            opacity: 0;
            left: -60px;
        }
        
        #hamburgerBtn.active .hamburger-icon-apple .line-apple.bottom {
            top: 7px;
            transform: rotate(-135deg);
        }

        /* Mobile Hamburger */
        .hamburger-icon-apple-mobile {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            width: 20px;
            height: 16px;
            position: relative;
            transform: rotate(0deg);
            transition: .2s ease-in-out;
            cursor: pointer;
        }

        .hamburger-icon-apple-mobile .line-apple {
            display: block;
            position: absolute;
            height: 2px;
            width: 100%;
            background: currentColor;
            border-radius: 9px;
            opacity: 1;
            left: 0;
            transform: rotate(0deg);
            transition: .25s ease-in-out;
        }

        .hamburger-icon-apple-mobile .line-apple.top {
            top: 0px;
        }
        .hamburger-icon-apple-mobile .line-apple.middle {
            top: 7px;
        }
        .hamburger-icon-apple-mobile .line-apple.bottom {
            top: 14px;
        }
        
        #hamburgerBtnMobile.active .hamburger-icon-apple-mobile .line-apple.top {
            top: 7px;
            transform: rotate(135deg);
        }
        
        #hamburgerBtnMobile.active .hamburger-icon-apple-mobile .line-apple.middle {
            opacity: 0;
            left: -60px;
        }
        
        #hamburgerBtnMobile.active .hamburger-icon-apple-mobile .line-apple.bottom {
            top: 7px;
            transform: rotate(-135deg);
        }

        /* ðŸ”¥ CRITICAL FIX: Completely hide Thinkly AI when any modal is open */
        body.modal-open #thinkly-ai-hero,
        body.modal-open .AgWCw,
        body.modal-open #searchBarWrapper {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
            z-index: -1 !important;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://unpkg.com/react@18/umd/react.development.js",
    "react-dom": "https://unpkg.com/react-dom@18/umd/react-dom.development.js"
  }
}
</script>
<!-- GSAP & ScrollTrigger for new animation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script><script src="https://unpkg.com/react@18/umd/react.development.js"></script><script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script><script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<!-- NEW: Libraries for Instant PDF Download -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="body-font text-gray-800 bg-gray-50">

    <!-- ========================================
         HAMBURGER MENU OVERLAY + PANEL
         ======================================== -->
    
    <!-- Menu Overlay (backdrop blur) -->
    <div id="menu-overlay" class="fixed inset-0 z-[9990] bg-black/20 backdrop-blur-sm hidden transition-opacity duration-300 ease-in-out"></div>

    <!-- Sliding Menu Panel (right side) -->
    <div id="mobileMenu"
         class="fixed top-0 right-0 z-[9991] h-full w-[60%] sm:w-[50%] md:max-w-md bg-white shadow-xl transform translate-x-full transition-transform duration-300 ease-in-out">
        <div class="flex flex-col h-full">
            <!-- Menu Header -->
            <div class="flex justify-between items-center h-16 px-6 border-b border-gray-200 flex-shrink-0">
                <h2 class="text-xl font-semibold text-black">Menu</h2>
                <button id="closeMenuBtn" type="button" class="p-2 rounded-md text-gray-600 hover:text-black hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-black">
                    <span class="sr-only">Close menu</span>
                    <i data-lucide="x" class="h-6 w-6"></i>
                </button>
            </div>

            <!-- User Profile Section - Dynamic based on auth state -->
            <div id="mobileProfileSection" class="p-6 border-b border-gray-200">
                <!-- Content will be dynamically updated by Firebase auth -->
            </div>

            <!-- Scrollable Menu Navigation -->
            <nav id="menu-nav" class="flex-1 overflow-y-auto p-6">
                <ul class="space-y-1">
                    <!-- General -->
                    <li>
                        <button id="menuMyOrders" class="menu-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="archive" class="h-5 w-5"></i>
                            <span>My Orders</span>
                        </button>
                    </li>
                    <li>
                        <button id="menuBackpack" class="menu-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="briefcase" class="h-5 w-5"></i>
                            <span>My Backpack</span>
                        </button>
                    </li>
                    
                    <!-- Books Section -->
                    <li><div class="h-px bg-gray-200 my-4"></div></li>
                    <li class="px-4 pt-4 pb-1">
                        <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Books</span>
                    </li>
                    <li>
                        <button id="menuRequestBook" class="menu-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="book-plus" class="h-5 w-5"></i>
                            <span>Request a Book</span>
                        </button>
                    </li>
                    <li>
                        <a href="#browse-courses" class="menu-item flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="shopping-cart" class="h-5 w-5"></i>
                            <span>Buy Books</span>
                        </a>
                    </li>
                    <li>
                        <button id="menuSellBook" class="menu-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="tag" class="h-5 w-5"></i>
                            <span>Sell Books</span>
                        </button>
                    </li>

                    <!-- Academics Section -->
                    <li><div class="h-px bg-gray-200 my-4"></div></li>
                    <li class="px-4 pt-4 pb-1">
                        <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Academics</span>
                    </li>
                    <li>
                        <a href="#academy-x" class="menu-item flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="graduation-cap" class="h-5 w-5"></i>
                            <span>AcademyX</span>
                        </a>
                    </li>
                    <li>
                        <button id="menuCollegeEssentials" class="menu-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="clipboard-list" class="h-5 w-5"></i>
                            <span>College Essentials</span>
                        </button>
                    </li>
                    
                    <!-- Study Material Accordion -->
                    <li>
                        <button id="study-toggle-btn" type="button" class="w-full flex justify-between items-center px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <span class="flex items-center space-x-3">
                                <i data-lucide="book-marked" class="h-5 w-5"></i>
                                <span>Study Material</span>
                            </span>
                            <i data-lucide="chevron-down" id="study-chevron" class="h-5 w-5 transition-transform duration-300"></i>
                        </button>
                    </li>
                    <li class="overflow-hidden">
                        <div id="studyDrop" class="pl-8 pr-4 space-y-1 mt-1 max-h-0 overflow-hidden transition-all duration-500 ease-in-out">
                            <button data-section="pyq" class="menu-item study-material-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <i data-lucide="file-question" class="h-5 w-5"></i>
                                <span>PYQ</span>
                            </button>
                            <button data-section="notes" class="menu-item study-material-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <i data-lucide="file-text" class="h-5 w-5"></i>
                                <span>Notes</span>
                            </button>
                            <button data-section="assignment" class="menu-item study-material-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <i data-lucide="file-pen-line" class="h-5 w-5"></i>
                                <span>Assignment</span>
                            </button>
                            <button data-section="practical" class="menu-item study-material-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <i data-lucide="flask-conical" class="h-5 w-5"></i>
                                <span>Practical</span>
                            </button>
                            <button data-section="syllabus" class="menu-item study-material-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <i data-lucide="book-copy" class="h-5 w-5"></i>
                                <span>Syllabus</span>
                            </button>
                        </div>
                    </li>
                    
                    <!-- Student Corner Accordion -->
                    <li>
                        <button id="student-toggle-btn" type="button" class="w-full flex justify-between items-center px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <span class="flex items-center space-x-3">
                                <i data-lucide="layout-grid" class="h-5 w-5"></i>
                                <span>Student Corner</span>
                            </span>
                            <i data-lucide="chevron-down" id="student-chevron" class="h-5 w-5 transition-transform duration-300"></i>
                        </button>
                    </li>
                    <li class="overflow-hidden">
                        <div id="studentDrop" class="pl-8 pr-4 space-y-1 mt-1 max-h-0 overflow-hidden transition-all duration-500 ease-in-out">
                            <a href="#" class="flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <i data-lucide="calendar-days" class="h-5 w-5"></i>
                                <span>Time Table</span>
                            </a>
                            <a href="#" class="flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <i data-lucide="bell" class="h-5 w-5"></i>
                                <span>Notification</span>
                            </a>
                            <a href="#" class="flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <i data-lucide="award" class="h-5 w-5"></i>
                                <span>Result</span>
                            </a>
                        </div>
                    </li>

                    <!-- Community Section -->
                    <li><div class="h-px bg-gray-200 my-4"></div></li>
                    <li class="px-4 pt-4 pb-1">
                        <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Community</span>
                    </li>
                    <li>
                        <button id="group-toggle-btn" type="button" class="w-full flex justify-between items-center px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <span class="flex items-center space-x-3">
                                <i data-lucide="users" class="h-5 w-5"></i>
                                <span>Join Groups</span>
                            </span>
                            <i data-lucide="chevron-down" id="group-chevron" class="h-5 w-5 transition-transform duration-300"></i>
                        </button>
                    </li>
                    <li class="overflow-hidden">
                        <div id="groupDrop" class="pl-8 pr-4 space-y-1 mt-1 max-h-0 overflow-hidden transition-all duration-500 ease-in-out">
                            <a href="https://t.me/your_telegram_group" target="_blank" rel="noopener noreferrer" class="flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <svg class="w-5 h-5 text-blue-500" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/>
                                </svg>
                                <span>Join Telegram Group</span>
                            </a>
                            <a href="https://chat.whatsapp.com/your_whatsapp_group" target="_blank" rel="noopener noreferrer" class="flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                                <svg class="w-5 h-5 text-green-500" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                                </svg>
                                <span>Join WhatsApp Group</span>
                            </a>
                        </div>
                    </li>

                    <!-- About Section -->
                    <li><div class="h-px bg-gray-200 my-4"></div></li>
                    <li>
                        <a href="#about-us" class="menu-item flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="info" class="h-5 w-5"></i>
                            <span>About Us</span>
                        </a>
                    </li>
                    <li>
                        <button id="menuThinklyAI" class="menu-item w-full flex items-center space-x-3 px-4 py-2.5 rounded-lg text-base font-medium text-gray-800 hover:bg-gray-100 hover:text-black transition-colors duration-150">
                            <i data-lucide="sparkles" class="h-5 w-5"></i>
                            <span>Thinkly AI</span>
                        </button>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
    <!-- End Hamburger Menu -->

    <!-- Page Loader -->
    <!-- UPDATED: Switched to a premium, Apple-like SVG spinner -->
    <div id="page-loader">
        <svg class="premium-spinner" viewBox="0 0 50 50">
            <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="4"></circle>
        </svg>
    </div>

    <!-- NEW: Internet Connection Alert -->
    <div id="connection-alert" class="connection-alert">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="1" y1="1" x2="23" y2="23"></line><path d="M16.72 11.06A10.94 10.94 0 0 1 19 12.55"></path><path d="M5 12.55a10.94 10.94 0 0 1 5.17-2.39"></path><path d="M10.71 5.05A16 16 0 0 1 22.58 9"></path><path d="M1.42 9a15.91 15.91 0 0 1 4.7-2.88"></path><path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path><line x1="12" y1="20" x2="12.01" y2="20"></line></svg>
        <span>No Internet Connection â€” Please check your network.</span>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        Your item has been listed for sale!
    </div>

    <!-- Modals Container -->
    <div id="modalContainer">
        <!-- AI Helper Modal -->
        <div id="aiModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="aiModalTitle">
            <div class="modal-backdrop" data-close-modal></div> 
            <div class="modal-content max-w-lg">
                <button id="closeAiModalBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                <div class="p-8 text-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="0.48" height="0.48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto text-blue-500 mb-4"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                    <h2 id="aiModalTitle" class="text-2xl font-bold mb-2">Thinkly AI</h2>
                    <p class="text-gray-600 mb-6">Upload your syllabus or notes (PDF, DOCX) and get a custom study plan, summary, or key questions.</p>
                    <button class="w-full h-12 bg-blue-600 text-white hover:bg-blue-700 rounded-lg font-semibold flex items-center justify-center button-animation">Select Document</button>
                </div>
            </div>
        </div>

        <!-- Checkout Modal -->
        <div id="checkoutModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div id="checkoutModalContent" class="modal-content modal-content--fullscreen flex flex-col">
                <!-- Modal content will be injected here by JS -->
            </div>
        </div>
        
        <!-- Sell Book Modal -->
        <div id="sellBookModal" class="modal-overlay" role="dialog" aria-modal="true">
             <div class="modal-backdrop" data-close-modal></div>
             <div id="sellBookModalContent" class="modal-content modal-content--fullscreen flex flex-col">
                <!-- Sell modal content will be injected by JS -->
            </div>
        </div>
        
        <!-- Free Book Modal -->
        <div id="freeBookModal" class="modal-overlay" role="dialog" aria-modal="true">
             <div class="modal-backdrop" data-close-modal></div>
             <div id="freeBookModalContent" class="modal-content modal-content--fullscreen flex flex-col">
                <!-- Free Book modal content will be injected by JS -->
            </div>
        </div>

        <!-- Request Book Modal -->
         <div id="requestModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="requestModalTitle">
            <div class="modal-backdrop" data-close-modal></div> 
            <div class="modal-content max-w-lg">
                 <button id="closeRequestModalBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                <div class="p-8">
                    <h2 id="requestModalTitle" class="text-2xl font-bold mb-4">Request a Book</h2>
                    <p class="text-gray-600 mb-6">Post a request and we'll notify sellers who have what you're looking for.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <input class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Book Title" />
                        <input class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Author" />
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <input class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Subject"/>
                        <input class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Semester" />
                    </div>
                    <div class="mb-4">
                        <input type="email" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Your Email Address" />
                    </div>
                    <button id="postRequestBtn" class="w-full h-12 text-lg bg-yellow-400 text-gray-900 hover:bg-yellow-500 rounded-lg font-semibold flex items-center justify-center button-animation">Post Book Request <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-2"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg></button>
                </div>
            </div>
        </div>

        <!-- Syllabus Modal -->
        <div id="syllabusModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen flex flex-col">
                 <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Syllabus Directory</h2>
                    <button id="closeSyllabusModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="syllabusContent" class="p-8 overflow-y-auto">
                    <!-- Syllabus content will be injected here -->
                </div>
            </div>
        </div>

        <!-- PYQ Modal -->
        <div id="pyqModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen flex flex-col">
                 <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">PYQ Directory</h2>
                    <button id="closePyqModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="pyqContent" class="p-8 overflow-y-auto">
                    <!-- PYQ content will be injected here -->
                </div>
            </div>
        </div>

        <!-- Practicals Modal -->
        <div id="practicalsModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen flex flex-col">
                 <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Practicals Directory</h2>
                    <button id="closePracticalsModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="practicalsContent" class="p-8 overflow-y-auto">
                    <!-- Practicals content will be injected here -->
                </div>
            </div>
        </div>

        <!-- Assignments Modal -->
        <div id="assignmentsModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen flex flex-col">
                 <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Assignments Directory</h2>
                    <button id="closeAssignmentsModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="assignmentsContent" class="p-8 overflow-y-auto">
                    <!-- Assignments content will be injected here -->
                </div>
            </div>
        </div>

        <!-- Notes Modal -->
        <div id="notesModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen flex flex-col">
                 <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Notes Directory</h2>
                    <button id="closeNotesModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="notesContent" class="p-8 overflow-y-auto">
                    <!-- Notes content will be injected here -->
                </div>
            </div>
        </div>

        <!-- Time Table Modal -->
        <div id="timeTableModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen flex flex-col">
                 <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Time Table Directory</h2>
                    <button id="closeTimeTableModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="timeTableContent" class="p-8 overflow-y-auto">
                    <div class="mb-8">
                        <h3 class="text-2xl font-bold mb-4 border-b pb-2">Commerce</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/Commerce-UG_Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">B.Com. (UG)</span>
                            </a>
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/Commerce-PG_Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">M.Com. (PG)</span>
                            </a>
                        </div>
                    </div>
                    <div class="mb-8">
                        <h3 class="text-2xl font-bold mb-4 border-b pb-2">Arts</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/Arts-UG_Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">B.A. (UG)</span>
                            </a>
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/Arts-PG_Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">M.A. (PG)</span>
                            </a>
                        </div>
                    </div>
                     <div class="mb-8">
                        <h3 class="text-2xl font-bold mb-4 border-b pb-2">Science</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/Science-UG_Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">B.Sc. (UG)</span>
                            </a>
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/Science-PG_Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">M.Sc. (PG)</span>
                            </a>
                        </div>
                    </div>
                     <div class="mb-8">
                        <h3 class="text-2xl font-bold mb-4 border-b pb-2">Computer Science & Applications</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/BCAComputerScience-UG_Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">B.C.A.</span>
                            </a>
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/ComputerScience-PG_Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">M.Sc. IT, PGDCA (PG)</span>
                            </a>
                        </div>
                    </div>
                     <div class="mb-8">
                        <h3 class="text-2xl font-bold mb-4 border-b pb-2">Management</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/BBA-Classes_Time_Table_wef_July2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">B.B.A.</span>
                            </a>
                        </div>
                    </div>
                     <div class="mb-8">
                        <h3 class="text-2xl font-bold mb-4 border-b pb-2">B.Sc. Practical Labs</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <a href="https://www.subodhpgcollege.com/pdf/Sections-Classes/2025-26/BSc-III-V-Semester-Practical-Batches-2025.pdf" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                                <span class="font-semibold">Practical Batches (IIIâ€“V Sem)</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Generic Item Selection Modal (Used for AI Courses and Essentials) -->
        <div id="itemSelectionModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-lg flex flex-col max-h-[90vh]">
                 <button id="closeItemSelectionModalBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 z-20 button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                <div id="itemSelectionContent" class="overflow-y-auto">
                    <!-- Item selection content will be injected here -->
                </div>
            </div>
        </div>
        
        <!-- Course Selection Modal -->
        <div id="courseModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div> 
            <div class="modal-content flex flex-col">
                <button id="closeCourseModalBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 z-20 button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                <div id="courseModalContent" class="p-8 overflow-y-auto">
                    <!-- Course selection content will be injected here -->
                </div>
            </div>
        </div>
        
        <!-- NEW: Pickup Buddy Modal -->
        <div id="pickupBuddyModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div> 
            <div class="modal-content max-w-md">
                <button id="closePickupBuddyModalBtn" class="absolute top-3 right-3 bg-gray-200/80 rounded-full p-1 text-gray-600 hover:text-gray-900 hover:bg-gray-300 transition-all button-animation">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
                <div class="p-8 text-center">
                    <h3 class="text-xl font-bold mb-4">Pickup Buddy Support</h3>
                    <p class="text-gray-600 leading-relaxed">Book pickup ke time humari team ka ek dedicated member aapke saath hoga, taaki aapki safety aur comfort ka poora khayal rakha jaye. Yeh service aapke liye bilkul <span class="font-bold bg-yellow-300 text-black px-1.5 py-0.5 rounded">FREE</span> hai, koi charge nahi!</p>
                    <p class="text-gray-600 leading-relaxed mt-3">Agar aap female student hain, toh optional support chun sakti hain. Nexbook ka ek trained member aapko assist karega, taaki aapka book pickup hamesha safe, smooth, aur tension-free rahe.</p>
                </div>
            </div>
        </div>

        <!-- NEW: Trading Simplified Expanded Overlay -->
        <div id="trading-simplified-overlay">
            <div class="overlay-backdrop absolute inset-0"></div>
            <div class="overlay-content relative bg-white/80 backdrop-blur-2xl rounded-[28px] w-full max-w-2xl m-4 p-8 shadow-2xl">
                 <button id="close-trading-simplified-overlay" class="absolute top-4 right-4 bg-gray-200/80 rounded-full p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-300 transition-all button-animation">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
                <h2 class="text-4xl font-extrabold text-gray-900 mb-3">Trading, Simplified: Smarter, Faster, Better.</h2>
                <p class="text-lg text-gray-700">Step into a smarter way to exchange. We've streamlined the entire process, connecting you with campus peers to buy and sell with confidence and ease. It's more than a marketplaceâ€”it's your community-powered Business Center.</p>
            </div>
        </div>

        <!-- NEW: My Backpack Modal -->
        <div id="myBackpackModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen w-full max-w-2xl flex flex-col">
                <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">My Backpack</h2>
                    <button id="closeMyBackpackModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="myBackpackContent" class="p-8 overflow-y-auto">
                    <!-- Backpack content will be injected here -->
                </div>
            </div>
        </div>

        <!-- NEW: Edit Profile Modal -->
        <div id="editProfileModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-md">
                <!-- Content will be injected by JS -->
            </div>
        </div>

        <!-- NEW: Settings Modal -->
        <div id="settingsModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-md">
                <!-- Content will be injected by JS -->
            </div>
        </div>

        <!-- NEW: Legal & About Modal -->
        <div id="legalAboutModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-md">
                <!-- Content will be injected by JS -->
            </div>
        </div>

        <!-- NEW: Generic Legal Info Modal -->
        <div id="legalInfoModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen max-w-2xl flex flex-col">
                 <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Legal Information</h2>
                    <button id="closeLegalInfoModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="p-8 overflow-y-auto">
                    <h3 class="text-xl font-bold mb-4">Terms of Service</h3>
                    <p class="text-gray-600 mb-6">Placeholder for Terms of Service...</p>
                    <h3 class="text-xl font-bold mb-4">Privacy Policy</h3>
                    <p class="text-gray-600">Placeholder for Privacy Policy...</p>
                </div>
            </div>
        </div>

        <!-- NEW: Report a Problem Modal -->
        <div id="reportProblemModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-lg">
                <!-- Content will be injected by JS -->
            </div>
        </div>

        <!-- NEW: Invoice Modal -->
        <div id="invoiceModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen max-w-3xl flex flex-col">
                <!-- Content will be injected by JS -->
            </div>
        </div>

        <!-- NEW: Order Details Modal -->
        <div id="orderDetailsModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen max-w-2xl flex flex-col">
                <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Order Details</h2>
                    <button id="closeOrderDetailsModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="orderDetailsContent" class="p-8 overflow-y-auto">
                    <!-- Order details content will be injected here -->
                </div>
            </div>
        </div>

        <!-- NEW: Feedback Modal -->
        <div id="feedbackModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen flex flex-col">
                <!-- Content is injected by JS -->
            </div>
        </div>

        <!-- NEW: Join Us Modal -->
        <div id="joinUsModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen max-w-4xl flex flex-col">
                <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Join the Nexbook Revolution</h2>
                    <button id="closeJoinUsModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="joinUsContent" class="p-8 overflow-y-auto">
                    <!-- Content from the old section will be moved here -->
                    <p class="text-lg text-gray-600 max-w-3xl mx-auto text-center mb-16">Be part of a community that's changing how students learn, share, and grow.</p>

                    <!-- 2. Why Join Us? -->
                    <div class="mb-16">
                        <h3 class="text-3xl font-bold text-center mb-10 text-gray-800">Why Join Us?</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                            <div class="text-center p-6 bg-gray-50 rounded-2xl border border-gray-200"><h4 class="font-bold text-lg mb-2 text-blue-600">Make a Difference</h4><p class="text-gray-600 text-sm">Help fellow students access affordable books and quality education.</p></div>
                            <div class="text-center p-6 bg-gray-50 rounded-2xl border border-gray-200"><h4 class="font-bold text-lg mb-2 text-blue-600">Be an Innovator</h4><p class="text-gray-600 text-sm">Work on real problems, build real solutions.</p></div>
                            <div class="text-center p-6 bg-gray-50 rounded-2xl border border-gray-200"><h4 class="font-bold text-lg mb-2 text-blue-600">Grow Together</h4><p class="text-gray-600 text-sm">Learn from peers, mentors, and industry leaders.</p></div>
                            <div class="text-center p-6 bg-gray-50 rounded-2xl border border-gray-200"><h4 class="font-bold text-lg mb-2 text-blue-600">Flexible Commitment</h4><p class="text-gray-600 text-sm">Contribute as per your schedule and skills.</p></div>
                        </div>
                    </div>

                    <!-- 3. Open Positions -->
                    <div class="mb-16">
                        <h3 class="text-3xl font-bold text-center mb-10 text-gray-800">Open Positions/Roles</h3>
                        <div class="space-y-4 role-accordion">
                            <!-- Role 1: Campus Ambassador -->
                            <details><summary>Campus Ambassador</summary><div class="p-6 border-t"><h4 class="font-bold text-lg">What's This Role About?</h4><p class="text-gray-600 mb-4">Be the face of Nexbook on campus! Spread the word, organize events, and help students discover affordable books.</p><h5 class="font-semibold">What You'll Do:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸ“¢ Promote Nexbook through social media & campus events</li><li>ðŸŽ‰ Organize book exchange drives and workshops</li><li>ðŸ‘¥ Build student communities and WhatsApp groups</li><li>ðŸ“¸ Share success stories and user experiences</li><li>ðŸŽ¯ Help students use the app and trade books</li></ul><h5 class="font-semibold">Perfect For You If:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>âœ… You're a natural leader and people listen to you</li><li>âœ… Active on Instagram, WhatsApp, or LinkedIn</li><li>âœ… Good at talking to people and making friends</li><li>âœ… Want to make education affordable for students</li><li>âœ… Can give 5-7 hours/week (mostly online work)</li></ul><h5 class="font-semibold">What You Get:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸŽ“ Official Certificate for your resume</li><li>ðŸ‘• Free Merchandise (T-shirts, stickers, badges)</li><li>ðŸ’° Performance Incentives (rewards for referrals and engagement)</li><li>ðŸ“± Early Access to new features before public launch</li><li>ðŸ¤ Networking Opportunities with other campus leaders</li><li>ðŸŽ Exclusive Perks - Free premium features, special badges</li><li>ðŸŒŸ Early Access to new features</li><li>ðŸ“± Direct Contact with Nexbook team</li><li>ðŸŽ¯ Leadership Experience for resume and LinkedIn</li><li>ðŸ† Monthly Recognition - Top performers get featured!</li></ul><div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg my-4"><p class="font-semibold">ðŸŽ“ Learn directly from the founder who invested 5 years & â‚¹2L+ in university AI courses (Machine Learning, Deep Learning, LangChain) - get complete knowledge transfer, premium AI tools access & hands-on training on 32+ live production apps and websites, absolutely FREE.</p><p class="mt-2 font-semibold">ðŸš€ðŸ“š FREE access to â‚¹2L+ premium courses founder personally resources: AI, Machine Learning, Deep Learning, NLP, LangChain, Prompt Engineering, Video Editing, Graphic Design, Music & Video Production - zero cost for you.</p></div><p class="font-semibold">Time Needed: <span class="font-normal">5-7 hours/week | Flexible schedule | Mostly online</span></p></div></details>
                            <!-- Role 2: Content Creator -->
                            <details><summary>Content Creator</summary><div class="p-6 border-t"><h4 class="font-bold text-lg">What's This Role About?</h4><p class="text-gray-600 mb-4">Create cool reels, designs, and posts that make Nexbook go viral! Show your creative side.</p><h5 class="font-semibold">What You'll Do:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸŽ¥ Make Instagram reels, YouTube shorts, and videos</li><li>ðŸŽ¨ Design posters, stories, and carousel posts</li><li>âœï¸ Write blogs, book reviews, and study tips</li><li>ðŸ“· Capture campus events and behind-the-scenes</li><li>ðŸ˜‚ Create memes and relatable student content</li></ul><h5 class="font-semibold">Perfect For You If:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>âœ… You love making videos or designing graphics</li><li>âœ… Know how to use CapCut, Canva, Figma, or Photoshop</li><li>âœ… Understand what students like and share</li><li>âœ… Have your own Instagram/YouTube/portfolio</li><li>âœ… Can post consistently (8-12 hours/week)</li></ul><h5 class="font-semibold">What You Get:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸŽ“ Official Certificate & Letter of Recommendation (LOR)</li><li>ðŸ‘• Free Nexbook Merchandise (T-shirts, stickers, badges)</li><li>ðŸ¤ Networking with campus leaders, tech community & recruiters</li><li>ðŸŒŸ Early Access to new features & exclusive perks</li><li>ðŸ† Monthly Recognition & "Performer of the Month" awards</li><li>ðŸŽ¯ Real-world Leadership Experience for your resume</li><li>ðŸ’¼ Build a Strong Portfolio with live work samples</li><li>ðŸ“± Direct Contact with the Nexbook founding team</li><li>ðŸ’¡ Innovation Freedom to pitch and build your own ideas</li><li>ðŸ’° Performance-based Incentives & stipends (for select roles)</li><li>ðŸš€ We Promote You Too - Grow your personal brand!</li><li>ðŸ“Š Access to platform analytics & impact metrics</li></ul><div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg my-4"><p class="font-semibold">ðŸŽ“ Learn directly from the founder who invested 5 years & â‚¹2L+ in university AI courses (Machine Learning, Deep Learning, LangChain) - get complete knowledge transfer, premium AI tools access & hands-on training on 32+ live production apps and websites, absolutely FREE.</p><p class="mt-2 font-semibold">ðŸš€ðŸ“š FREE access to â‚¹2L+ premium courses founder personally resources: AI, Machine Learning, Deep Learning, NLP, LangChain, Prompt Engineering, Video Editing, Graphic Design, Music & Video Production - zero cost for you.</p></div><p class="font-semibold">Time Needed: <span class="font-normal">8-12 hours/week | Work from anywhere | Flexible deadlines</span></p></div></details>
                            <!-- Role 3: Tech Contributor -->
                            <details><summary>Tech Contributor</summary><div class="p-6 border-t"><h4 class="font-bold text-lg">What's This Role About?</h4><p class="text-gray-600 mb-4">Help build and improve Nexbook's website and app! Perfect for coding enthusiasts.</p><h5 class="font-semibold">What You'll Do:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸ› Fix bugs and technical issues</li><li>ðŸ”§ Build new features (search, notifications, etc.)</li><li>ðŸŽ¨ Improve UI/UX and animations</li><li>âš¡ Make the site faster and smoother</li><li>ðŸ“š Write code documentation and guides</li></ul><h5 class="font-semibold">Perfect For You If:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>âœ… Know HTML, CSS, JavaScript basics</li><li>âœ… Have used React or Firebase (or want to learn)</li><li>âœ… Have a GitHub account</li><li>âœ… Love solving coding problems</li><li>âœ… Can work 5-10 hours/week independently</li></ul><h5 class="font-semibold">What You Get:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸŽ“ Official Certificate & Letter of Recommendation (LOR)</li><li>ðŸ‘• Free Nexbook Merchandise (T-shirts, stickers, badges)</li><li>ðŸ¤ Networking with campus leaders, tech community & recruiters</li><li>ðŸŒŸ Early Access to new features & exclusive perks</li><li>ðŸ† Monthly Recognition & "Performer of the Month" awards</li><li>ðŸŽ¯ Real-world Leadership Experience for your resume</li><li>ðŸ’¼ Build a Strong Portfolio with live work samples</li><li>ðŸ“± Direct Contact with the Nexbook founding team</li><li>ðŸ’¡ Innovation Freedom to pitch and build your own ideas</li><li>ðŸ’° Performance-based Incentives & stipends (for select roles)</li><li>ðŸš€ We Promote You Too - Grow your personal brand!</li><li>ðŸ“Š Access to platform analytics & impact metrics</li></ul><div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg my-4"><p class="font-semibold">ðŸŽ“ Learn directly from the founder who invested 5 years & â‚¹2L+ in university AI courses (Machine Learning, Deep Learning, LangChain) - get complete knowledge transfer, premium AI tools access & hands-on training on 32+ live production apps and websites, absolutely FREE.</p><p class="mt-2 font-semibold">ðŸš€ðŸ“š FREE access to â‚¹2L+ premium courses founder personally resources: AI, Machine Learning, Deep Learning, NLP, LangChain, Prompt Engineering, Video Editing, Graphic Design, Music & Video Production - zero cost for you.</p></div><p class="font-semibold">Time Needed: <span class="font-normal">5-10 hours/week | Flexible | Work on your schedule</span></p></div></details>
                            <!-- Role 4: Community Moderator -->
                            <details><summary>Community Moderator</summary><div class="p-6 border-t"><h4 class="font-bold text-lg">What's This Role About?</h4><p class="text-gray-600 mb-4">Keep Nexbook safe and fair! Review listings, solve problems, and help users.</p><h5 class="font-semibold">What You'll Do:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>âœ… Review and approve book listings</li><li>âš–ï¸ Solve disputes between buyers and sellers</li><li>ðŸš« Remove spam and fake listings</li><li>ðŸ’¬ Answer student queries and help them</li><li>ðŸ“Š Report issues to the admin team</li></ul><h5 class="font-semibold">Perfect For You If:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>âœ… You're mature, responsible, and fair</li><li>âœ… Good at solving arguments peacefully</li><li>âœ… Patient and understanding</li><li>âœ… Can spare 1-2 hours daily (flexible timing)</li><li>âœ… Quick to respond and reliable</li></ul><h5 class="font-semibold">What You Get:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸŽ“ Official Certificate & Letter of Recommendation (LOR)</li><li>ðŸ‘• Free Nexbook Merchandise (T-shirts, stickers, badges)</li><li>ðŸ¤ Networking with campus leaders, tech community & recruiters</li><li>ðŸŒŸ Early Access to new features & exclusive perks</li><li>ðŸ† Monthly Recognition & "Performer of the Month" awards</li><li>ðŸŽ¯ Real-world Leadership Experience for your resume</li><li>ðŸ’¼ Build a Strong Portfolio with live work samples</li><li>ðŸ“± Direct Contact with the Nexbook founding team</li><li>ðŸ’¡ Innovation Freedom to pitch and build your own ideas</li><li>ðŸ’° Performance-based Incentives & stipends (for select roles)</li><li>ðŸš€ We Promote You Too - Grow your personal brand!</li><li>ðŸ“Š Access to platform analytics & impact metrics</li></ul><div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg my-4"><p class="font-semibold">ðŸŽ“ Learn directly from the founder who invested 5 years & â‚¹2L+ in university AI courses (Machine Learning, Deep Learning, LangChain) - get complete knowledge transfer, premium AI tools access & hands-on training on 32+ live production apps and websites, absolutely FREE.</p><p class="mt-2 font-semibold">ðŸš€ðŸ“š FREE access to â‚¹2L+ premium courses founder personally resources: AI, Machine Learning, Deep Learning, NLP, LangChain, Prompt Engineering, Video Editing, Graphic Design, Music & Video Production - zero cost for you.</p></div><p class="font-semibold">Time Needed: <span class="font-normal">7-10 hours/week | 1-2 hours daily | Flexible timings</span></p></div></details>
                            <!-- Role 5: Design Volunteer -->
                            <details><summary>Design Volunteer</summary><div class="p-6 border-t"><h4 class="font-bold text-lg">What's This Role About?</h4><p class="text-gray-600 mb-4">Design beautiful graphics, logos, and UI elements for Nexbook! Make it look stunning.</p><h5 class="font-semibold">What You'll Do:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸŽ¨ Design Instagram posts, banners, and ads</li><li>ðŸ–¼ï¸ Create icons, buttons, and UI elements</li><li>ðŸŽ Design T-shirts, stickers, and merchandise</li><li>ðŸ“Š Make infographics and data visualizations</li><li>ðŸŽ¬ Create animations and motion graphics (bonus!)</li></ul><h5 class="font-semibold">Perfect For You If:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>âœ… Portfolio Required (Behance, Dribbble, Instagram)</li><li>âœ… Know Figma, Photoshop, Illustrator, or Canva</li><li>âœ… Love modern, clean, Apple-style designs</li><li>âœ… Pay attention to small details</li><li>âœ… Can work 6-10 hours/week on projects</li></ul><h5 class="font-semibold">What You Get:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸŽ“ Official Certificate & Letter of Recommendation (LOR)</li><li>ðŸ‘• Free Nexbook Merchandise (T-shirts, stickers, badges)</li><li>ðŸ¤ Networking with campus leaders, tech community & recruiters</li><li>ðŸŒŸ Early Access to new features & exclusive perks</li><li>ðŸ† Monthly Recognition & "Performer of the Month" awards</li><li>ðŸŽ¯ Real-world Leadership Experience for your resume</li><li>ðŸ’¼ Build a Strong Portfolio with live work samples</li><li>ðŸ“± Direct Contact with the Nexbook founding team</li><li>ðŸ’¡ Innovation Freedom to pitch and build your own ideas</li><li>ðŸ’° Performance-based Incentives & stipends (for select roles)</li><li>ðŸš€ We Promote You Too - Grow your personal brand!</li><li>ðŸ“Š Access to platform analytics & impact metrics</li></ul><div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg my-4"><p class="font-semibold">ðŸŽ“ Learn directly from the founder who invested 5 years & â‚¹2L+ in university AI courses (Machine Learning, Deep Learning, LangChain) - get complete knowledge transfer, premium AI tools access & hands-on training on 32+ live production apps and websites, absolutely FREE.</p><p class="mt-2 font-semibold">ðŸš€ðŸ“š FREE access to â‚¹2L+ premium courses founder personally resources: AI, Machine Learning, Deep Learning, NLP, LangChain, Prompt Engineering, Video Editing, Graphic Design, Music & Video Production - zero cost for you.</p></div><p class="font-semibold">Time Needed: <span class="font-normal">6-10 hours/week | Project-based | Remote work</span></p></div></details>
                            <!-- Role 6: Campus Operations Associate -->
                            <details><summary>Campus Operations Associate</summary><div class="p-6 border-t"><h4 class="font-bold text-lg">What's This Role About?</h4><p class="text-gray-600 mb-4">Deliver books across campus! Earn money while helping students get their books on time.</p><h5 class="font-semibold">What You'll Do:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸ“¦ Pick up books from sellers on campus</li><li>ðŸš´ Deliver books to buyers safely</li><li>ðŸ“± Coordinate timing with both parties</li><li>âœ… Check book condition before pickup</li><li>ðŸ’¬ Handle queries professionally</li></ul><h5 class="font-semibold">Perfect For You If:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>âœ… Know the campus well</li><li>âœ… Punctual and reliable</li><li>âœ… Have a college ID</li><li>âœ… Available 1-2 hours daily (flexible)</li><li>âœ… Good communication skills</li><li>âœ… Honest and trustworthy</li></ul><h5 class="font-semibold">What You Get:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸŽ“ Official Certificate & Letter of Recommendation (LOR)</li><li>ðŸ‘• Free Nexbook Merchandise (T-shirts, stickers, badges)</li><li>ðŸ¤ Networking with campus leaders, tech community & recruiters</li><li>ðŸŒŸ Early Access to new features & exclusive perks</li><li>ðŸ† Monthly Recognition & "Performer of the Month" awards</li><li>ðŸŽ¯ Real-world Leadership Experience for your resume</li><li>ðŸ’¼ Build a Strong Portfolio with live work samples</li><li>ðŸ“± Direct Contact with the Nexbook founding team</li><li>ðŸ’¡ Innovation Freedom to pitch and build your own ideas</li><li>ðŸ’° Performance-based Incentives & stipends (for select roles)</li><li>ðŸš€ We Promote You Too - Grow your personal brand!</li><li>ðŸ“Š Access to platform analytics & impact metrics</li></ul><div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg my-4"><p class="font-semibold">ðŸŽ“ Learn directly from the founder who invested 5 years & â‚¹2L+ in university AI courses (Machine Learning, Deep Learning, LangChain) - get complete knowledge transfer, premium AI tools access & hands-on training on 32+ live production apps and websites, absolutely FREE.</p><p class="mt-2 font-semibold">ðŸš€ðŸ“š FREE access to â‚¹2L+ premium courses founder personally resources: AI, Machine Learning, Deep Learning, NLP, LangChain, Prompt Engineering, Video Editing, Graphic Design, Music & Video Production - zero cost for you.</p></div><h5 class="font-semibold">How It Works:</h5><ul class="list-disc list-inside text-gray-600 mb-4"><li>ðŸ“² Get notification for delivery</li><li>âœ… Accept if you're free</li><li>ðŸ“¦ Pick up book from seller</li><li>ðŸš´ Deliver to buyer</li><li>âœ”ï¸ Mark complete in app</li><li>ðŸ’° Get paid instantly!</li></ul><p class="font-semibold">Time Needed: <span class="font-normal">1-2 hours/day | Morning (9 AM - 2 PM) | Choose your slots</span></p></div></details>
                        </div>
                    </div>

                    <!-- 4 & 5. Application Form with Story Section -->
                    <div id="joinUsFormWrapper" class="bg-gray-50 rounded-3xl p-6 md:p-10 border border-gray-200">
                        <form id="joinUsForm" class="space-y-8">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div><label for="join_fullName" class="font-semibold text-gray-700">Full Name</label><input id="join_fullName" name="fullName" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                                <div><label for="join_email" class="font-semibold text-gray-700">Email Address</label><input id="join_email" name="email" type="email" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                                <div><label for="join_phone" class="font-semibold text-gray-700">Phone Number</label><input id="join_phone" name="phone" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                                <div><label for="join_roll_number" class="font-semibold text-gray-700">Roll Number / Registration Number</label><input id="join_roll_number" name="rollNumber" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                                <div><label for="join_course" class="font-semibold text-gray-700">Course & Year</label><input id="join_course" name="courseAndYear" required placeholder="e.g., B.Sc. 2nd Year" class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                                <div><label for="join_role" class="font-semibold text-gray-700">Role You're Interested In</label><select id="join_role" name="role" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"><option value="">Select a Role</option><option>Campus Ambassador</option><option>Content Creator</option><option>Tech Contributor</option><option>Community Moderator</option><option>Design Volunteer</option><option>Event Coordinator</option></select></div>
                            </div>
                            <div><label for="join_why_role" class="font-semibold text-gray-700">Why do you want to join this role? (100-200 words)</label><textarea id="join_why_role" name="whyJoinRole" rows="4" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea></div>
                            <div><label for="join_achievement" class="font-semibold text-gray-700">Tell us about your most impressive achievement or something extraordinary you've done that makes you proud. This could be academic, creative, technical, social, or personal. (150-300 words)</label><textarea id="join_achievement" name="achievement" rows="5" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea></div>
                            <div><label for="join_experience" class="font-semibold text-gray-700">Relevant experience/skills</label><textarea id="join_experience" name="experience" rows="3" class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea></div>
                            <div><label for="join_portfolio" class="font-semibold text-gray-700">Portfolio/Social Media links (if applicable)</label><input id="join_portfolio" name="portfolio" type="url" class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div><label for="join_availability" class="font-semibold text-gray-700">Availability (hours per week)</label><input id="join_availability" name="availability" type="number" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                                <div><label for="join_start_date" class="font-semibold text-gray-700">Expected start date</label><input id="join_start_date" name="startDate" type="date" required class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                            </div>
                            <div><label for="join_prior_experience" class="font-semibold text-gray-700">Any prior volunteer/work experience</label><textarea id="join_prior_experience" name="priorExperience" rows="3" class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea></div>
                            <div><label for="join_how_hear" class="font-semibold text-gray-700">How did you hear about Nexbook?</label><input id="join_how_hear" name="howHear" class="w-full mt-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                            <div class="pt-4 border-t border-gray-200">
                                <label class="flex items-center gap-3 cursor-pointer">
                                    <input type="checkbox" name="agreeTerms" required class="h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                    <span class="text-gray-700">I agree to the terms & conditions.</span>
                                </label>
                            </div>
                            <div class="text-center pt-6"><h3 class="text-2xl font-bold text-gray-800 mb-4">Ready to Make an Impact?</h3><button type="submit" class="w-full md:w-auto h-12 px-10 text-lg bg-blue-600 text-white rounded-lg font-semibold button-animation">Submit Application</button><p class="text-sm text-gray-500 mt-4">Questions? Reach out to us at <a href="mailto:team@nexbook.com" class="font-semibold text-blue-600 hover:underline">team@nexbook.com</a></p></div>
                        </form>
                    </div>

                    <div class="mt-16">
                        <h3 class="text-3xl font-bold text-center mb-10 text-gray-800">What You'll Gain</h3>
                        <div id="what-you-gain-wrapper" class="expandable-content-wrapper overflow-hidden">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                                <div class="bg-blue-50 border border-blue-200 rounded-2xl p-6">
                                    <h4 class="font-bold text-lg mb-3 text-blue-800">AI Education & Training ðŸŽ“</h4>
                                    <ul class="space-y-2 text-sm text-gray-700"><li>ðŸ†“ Free 5-Year AI Mastery Course (2 Lakh+)</li><li>ðŸ“š Weekly AI Workshops (Prompt Engineering, Automation, AI Tools)</li><li>ðŸ‘¨â€ðŸ« 1-on-1 AI Mentorship Sessions</li><li>ðŸ“œ Nexbook AI Academy Certification</li><li>ðŸ“– Access to University-Level AI Course Materials</li><li>ðŸŒ Lifetime Learning Community Access</li></ul>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-2xl p-6">
                                    <h4 class="font-bold text-lg mb-3 text-green-800">AI Tools & Resources ðŸ› ï¸</h4>
                                    <ul class="space-y-2 text-sm text-gray-700"><li>ðŸ”‘ Premium AI Tools Access (ChatGPT Plus, Claude Pro, Gemini Advanced)</li><li>ðŸ¤– Custom GPTs Built Specifically for Nexbook</li><li>âš™ï¸ AI Automation Scripts & Workflows</li><li>ðŸ“ 100000
                                        
                                        + Ready-Made Prompt Library</li><li>ðŸŽ¨ AI Content Creation Tools (Midjourney, RunwayML, etc.)</li><li>ðŸ’» Code Automation Tools (Cursor, Windsurf, GitHub Copilot)</li></ul>
                                </div>
                                
                                
                                <div class="bg-purple-50 border border-purple-200 rounded-2xl p-6">
                                    <h4 class="font-bold text-lg mb-3 text-purple-800">Career Development ðŸš€</h4>
                                    <ul class="space-y-2 text-sm text-gray-700"><li>ðŸ’¼ AI-Powered LinkedIn Profile Optimization</li><li>ðŸ“„ Professional Resume Building with AI</li><li>ðŸŽ¤ AI Mock Interview Preparation</li><li>ðŸ—‚ï¸ Portfolio Development Guidance</li><li>âœ‰ï¸ Recommendation Letters & LinkedIn Endorsements</li><li>ðŸ¤ Industry Networking Opportunities</li><li>ðŸŽ¯ Placement Assistance & Referrals</li></ul>
                                </div>
                                <div class="bg-yellow-50 border border-yellow-200 rounded-2xl p-6">
                                    <h4 class="font-bold text-lg mb-3 text-yellow-800">Core Perks ðŸŽ</h4>
                                    <ul class="space-y-2 text-sm text-gray-700"><li>ðŸ† Official Certificate for Resume</li><li>ðŸ‘• Free Merchandise (T-shirts, Stickers, Badges)</li><li>âš¡ Early Access to New Features</li><li>ðŸ‘¥ Direct Contact with Nexbook Leadership</li><li>ðŸ“‹ Leadership Experience Documentation</li><li>ðŸŒŸ Monthly Recognition & Featured Spotlights</li><li>â° Flexible Working Hours</li></ul>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-8">
                            <button class="view-toggle-btn" data-toggle="expand" data-controls="what-you-gain-wrapper" data-view-more-text="View All Benefits" data-view-less-text="Show Less">View All Benefits</button>
                        </div>
                    </div>

                    <!-- 8. FAQ Section -->
                    <div class="mt-16">
                        <h3 class="text-3xl font-bold text-center mb-10 text-gray-800">Frequently Asked Questions</h3>
                        <div id="faq-wrapper" class="expandable-content-wrapper max-w-3xl mx-auto">
                            <div class="space-y-4">
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">I'm a first-year student. Can I still apply?</summary><p class="mt-2 text-gray-600">Absolutely! We welcome students from all yearsâ€”first year to final year. Fresh perspectives and new energy are always valued.</p></details>
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">Is this a paid opportunity?</summary><p class="mt-2 text-gray-600">Some roles like Campus Operations Associate and Content Creator offer performance-based earnings. Other roles provide certificates, merchandise, learning opportunities, and exclusive perks. Check individual role descriptions for specific benefits.</p></details>
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">Can I work remotely?</summary><p class="mt-2 text-gray-600">Yes! Most roles (Ambassador, Content Creator, Tech Contributor, Moderator, Designer) are completely remote. Only Campus Operations Associate requires on-campus presence for deliveries.</p></details>
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">Will I get a certificate?</summary><p class="mt-2 text-gray-600">Yes! All team members receive official certificates upon successful completion of their tenure. These certificates mention your role, duration, and contributionsâ€”perfect for resumes and LinkedIn.</p></details>
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">What is the selection process?</summary><div class="mt-2 text-gray-600"><p>Simple 4-step process:</p><ol class="list-decimal list-inside mt-2 space-y-1"><li>Submit your application online</li><li>Our team reviews it (1-2 days)</li><li>Shortlisted candidates get an interview call</li><li>Selected candidates receive onboarding details</li></ol></div></details>
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">How long does the selection process take?</summary><p class="mt-2 text-gray-600">Typically 1-2 days from application submission to final decision. We'll keep you updated via email/WhatsApp throughout the process.</p></details>
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">What if I can't meet the time commitment due to exams?</summary><p class="mt-2 text-gray-600">We completely understand! Academics come first. Just inform us in advance, and we can adjust your workload or put your role on pause during exam periods.</p></details>
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">What are these â‚¹2L+ premium courses?</summary><p class="mt-2 text-gray-600">Our founder personally invested over â‚¹2 lakhs in premium courses from platforms like Coursera, Udemy, and specialized AI/ML programs. As a team member, you get FREE access to all these coursesâ€”including Machine Learning, Deep Learning, LangChain, NLP, Prompt Engineering, Video Editing, Graphic Design, and Music Production.</p></details>
                                <details class="p-4 border rounded-lg bg-gray-50"><summary class="font-semibold cursor-pointer">What does "hands-on training on 32+ live apps" mean?</summary><p class="mt-2 text-gray-600">You'll get direct training on 32+ real production-level applications and websites that our founder has built/worked on. This includes AI tools, automation systems, web apps, and moreâ€”giving you practical, industry-level experience.</p></details>
                            </div>
                        </div>
                        <div class="text-center mt-8">
                            <button class="view-toggle-btn" data-toggle="expand" data-controls="faq-wrapper" data-view-more-text="View More FAQs" data-view-less-text="Show Less">View More FAQs</button>
                        </div>
                    </div>

                    <!-- NEW: Founder Message Card -->
                    <div class="mt-16 text-center">
                        <div id="founderMessageCard" class="max-w-2xl mx-auto bg-blue-50 border border-blue-200 rounded-2xl p-8 shadow-sm cursor-pointer transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
                            <h4 class="text-2xl font-bold">ðŸ’¬ From Founder</h4>
                            <p class="text-lg text-gray-700 mt-4 italic">"I'm giving away 5 years of AI expertise and â‚¹2L+ worth of Premium courses â€” FREE. Here's why."</p>
                            <span class="mt-6 font-semibold text-blue-600 hover:underline button-animation inline-block">Read my message â†’</span>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- NEW: Founder Message Modal -->
        <div id="founderMessageModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen max-w-4xl flex flex-col">
                <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">ðŸ’¬ A Message from the Founder</h2>
                    <button id="closeFounderMessageModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="p-8 overflow-y-auto text-gray-700 leading-relaxed">
                    <h3 class="text-3xl font-bold text-gray-900 mb-4">"Why I'm Giving Away 5 Years of AI Expertise - For FREE"</h3>
                    <p class="mb-4">Hey, I'm Saurav Thakur.</p>
                    <p class="mb-4">For the last 5 years, I've been obsessed with AI. Not casually watching YouTube tutorials, but actually investing lakhs of rupees in paid university courses, certifications, and premium tools. I've mastered Machine Learning, Deep Learning, NLP, Computer Vision, LangChain, prompt engineering, full-stack development, cloud deployment (AWS, Firebase), and AI automation - the complete tech stack that companies pay â‚¹10-20 LPA for.</p>
                    <p class="mb-6">I've built 48+ production-grade AI applications (32 websites + 14 mobile apps + 1 custom browser) that 5,000+ real people use every day - applications that have improved productivity and decision-making across finance, legal, travel, insurance, healthcare, education, and social networking domains.</p>

                    <div class="space-y-8">
                        <div><h4 class="text-2xl font-bold text-gray-800 mb-3">ðŸš€ My Journey & What I've Built</h4><p>Currently pursuing B.Sc. Dual Specialization in Physics (Hons.) & Computer Science from SS Jain Subodh PG College, I've been working as an AI Systems Architect & Full-Stack Developer since August 2024, delivering end-to-end production solutions for clients worldwide.</p>
                            <h4 class="text-xl font-semibold text-gray-800 mb-3">ðŸ† Real Impact Numbers:</h4>
                            <ul class="list-disc list-inside space-y-1">
                                <li><b>48+</b> AI Applications deployed and live</li>
                                <li><b>5,000+</b> Active Users across all platforms</li>
                                <li><b>92%</b> User Retention Rate</li>
                                <li><b>90%</b> Reduction in client operational costs</li>
                                <li><b>80%</b> Reduction in research time</li>
                                <li><b>75%</b> Faster trip planning (TrueTrips)</li>
                                <li><b>70%</b> Better decision-making efficiency</li>
                            </ul>
                        </div>
                        <div><h4 class="text-xl font-semibold text-gray-800 mb-3">ðŸ’Ž Startup Ventures I've Founded</h4>
                            <ul class="list-disc list-inside space-y-2">
                                <li><b>AeroX Browser | Founder & CEO (August 2025)</b>
                                    <ul class="list-circle list-inside ml-4 space-y-1">
                                        <li>Built a custom web browser with proprietary rendering engine and JavaScript interpreter</li>
                                        <li>1,000+ active users with 4.3/5 rating</li>
                                        <li>Features: AI-powered intelligent search, content summarization, voice commands, auto-fill forms</li>
                                        <li>Agentic AI assistant that automatically fills online forms, performs web actions, manages tasks</li>
                                        <li>Cross-platform: Windows, macOS, iOS, Android</li>
                                        <li>Ad-free, privacy-first browsing with advanced ad-blocking and tracker protection</li>
                                        <li>Tech Stack: C++, JavaScript, WebKit, Node.js, Python, Firebase, Electron, Swift, Kotlin</li>
                                    </ul>
                                </li>
                                <li><b>NexBooK | Founder & CEO (November 2025 - Present)</b>
                                    <ul class="list-circle list-inside ml-4 space-y-1">
                                        <li>Campus marketplace serving 500+ students with 85% retention and 96% transaction success</li>
                                        <li>Thinkly AI: NLP-powered document analysis generating custom study plans, Q&A generation, exam prep</li>
                                        <li>87% accuracy in predicting likely exam questions</li>
                                        <li>AcademyX Integration: Curated 250,000+ free certified courses from Harvard, MIT, Google, Stanford</li>
                                        <li>90% transaction success rate with secure online payments</li>
                                        <li>Tech Stack: React, Python, Tailwind CSS, Firebase, Supabase, Google Cloud, AWS, Gemini API</li>
                                    </ul>
                                </li>
                                <li><b>NeX Social Platform | Founder & CEO (October 2025 - Present)</b>
                                    <ul class="list-circle list-inside ml-4 space-y-1">
                                        <li>Progressive Web App (PWA) working across 5+ platforms (Android, iOS, Windows, MacOS)</li>
                                        <li>300+ active users with 92% daily engagement</li>
                                        <li>25-minute average session time</li>
                                        <li>Features: Real-time messaging, 24-hour stories, event management, dynamic feed</li>
                                        <li>&lt;100ms latency using Firebase Firestore</li>
                                        <li>Built custom DOM morphing algorithm for efficient rendering</li>
                                        <li>Tech Stack: Vanilla JavaScript, Firebase, React, PWA APIs</li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                        <div><h4 class="text-xl font-semibold text-gray-800 mb-3">ðŸŽ¯ Production AI Systems I've Shipped</h4><ul class="list-disc list-inside space-y-2"><li><b>Jurisight â€“ AI Legal Assistant (June 2025)</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Legal guidance across 180+ countries</li>
                                <li>200+ users with 80% reduction in legal research time</li>
                                <li>RAG system with 50,000+ legal documents</li>
                                <li>Vector database (Pinecone) for context-aware responses</li>
                                <li>Tech: Python, LangChain, OpenAI API, React.js, PostgreSQL, AWS EC2</li>
                            </ul>
                        </li><li><b>Lexmont â€“ AI Tax & Invoicing (April 2025)</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Serving 27+ small businesses</li>
                                <li>96% accuracy and 91% reduction in manual effort</li>
                                <li>AI virtual CA providing real-time financial advice</li>
                                <li>Multi-currency, GST, income tax, TDS calculations</li>
                                <li>Tech: Python, Gemini API, FastAPI, React.js, MongoDB</li>
                            </ul>
                        </li><li><b>TrueTrips â€“ AI Travel Planner (March 2025)</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>500+ travelers across 156+ destinations</li>
                                <li>75% reduction in trip planning time</li>
                                <li>Real-time flight prices, hotel availability, weather forecasts</li>
                                <li>Tech: Python, OpenAI API, React.js, Google Maps API, Firebase</li>
                            </ul>
                        </li><li><b>InsaurÃ© â€“ AI Insurance Advisor (April 2025)</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Analyzing 25+ insurance providers across 5 categories</li>
                                <li>150+ users with 40% cost savings</li>
                                <li>Personalized health, life, auto, home, travel insurance plans</li>
                            </ul>
                        </li><li><b>BlindChef â€“ AI Recipe Generator (April 2025)</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>10,000+ global recipes across 50+ cuisines</li>
                                <li>50+ users with 95% satisfaction rate</li>
                                <li>Ingredient substitution for 20+ dietary restrictions</li>
                            </ul>
                        </li><li><b>YTV â€“ YouTube AI Summarizer (May 2025)</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Processing 100+ videos daily</li>
                                <li>60% improvement in content consumption</li>
                                <li>Reducing watch time from 10 minutes to 2 minutes</li>
                                <li>100+ active users</li>
                            </ul>
                        </li><li><b>FermWise â€“ Legal Knowledge Hub (July 2025)</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Multi-jurisdiction support for 100+ countries</li>
                                <li>5,000+ legal articles with real-time updates</li>
                                <li>300+ legal professionals with 70% faster information retrieval</li>
                            </ul>
                        </li></ul></div>
                        <div>
                            <h4 class="text-xl font-semibold text-gray-800 mb-4">ðŸ› ï¸ Complete Technical Arsenal</h4>
                            <div class="space-y-6 text-sm">
                                <div class="p-4 bg-gray-50 rounded-lg border">
                                    <h5 class="font-bold text-gray-800">AI/ML Vanguard</h5>
                                    <p class="text-gray-600 mt-1"><b class="text-gray-700">LLMs:</b> GPT-5 (multimodal), Claude 4.5 Sonnet, Gemini 2.5 Flash, Llama 3, Grok-4, Meta AI</p>
                                    <p class="text-gray-600 mt-1"><b class="text-gray-700">Frameworks:</b> LangChain/LangGraph, LlamaIndex/AutoGPT, Semantic Kernel</p>
                                    <p class="text-gray-600 mt-1"><b class="text-gray-700">ML Core:</b> PyTorch/TensorFlow, Hugging Face (PEFT/LoRA/ONNX), Scikit-learn</p>
                                    <p class="text-gray-600 mt-1"><b class="text-gray-700">Vector/RAG:</b> Pinecone, Chroma, FAISS, Weaviate, Milvus, Vespa, Qdrant</p>
                                    <p class="text-gray-600 mt-1"><b class="text-gray-700">CV:</b> OpenCV, YOLOv8, EfficientNet, Stable Diffusion, SAM</p>
                                    <p class="text-gray-600 mt-1"><b class="text-gray-700">NLP:</b> spaCy, Transformers (mT5, DeBERTa), zero-shot NER</p>
                                    <p class="text-gray-600 mt-1"><b class="text-gray-700">Prompts:</b> CoT, ReAct, ToT, meta-prompt chaining, adversarial robustness</p>
                                </div>
                                <div class="p-4 bg-gray-50 rounded-lg border"><h5 class="font-bold text-gray-800">Programming & Languages</h5><p class="text-gray-600 mt-1"><b class="text-gray-700">Expert:</b> Python, JavaScript (ES6+), C++, Java</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Web:</b> HTML5, CSS3, React.js, Vue.js</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Mobile:</b> React Native, Swift (iOS), Kotlin (Android)</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Scripting:</b> Bash, Python automation, Google Apps Script</p></div>
                                <div class="p-4 bg-gray-50 rounded-lg border"><h5 class="font-bold text-gray-800">Full-Stack Development</h5><p class="text-gray-600 mt-1"><b class="text-gray-700">Frontend:</b> React/Next.js (SSR), Vue (Composition API), Tailwind CSS, PWAs</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Backend:</b> Node.js/Express, FastAPI/Flask, Django, REST APIs, GraphQL</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Databases:</b> PostgreSQL, MongoDB, Redis, Supabase, Firebase Firestore</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Auth/Security:</b> JWT/OAuth, bcrypt, zero-trust microservices</p></div>
                                <div class="p-4 bg-gray-50 rounded-lg border"><h5 class="font-bold text-gray-800">Cloud & DevOps</h5><p class="text-gray-600 mt-1"><b class="text-gray-700">AWS:</b> EC2, S3, Lambda, RDS, Route 53, CloudFront, Elastic Beanstalk, SageMaker</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Firebase:</b> Authentication, Firestore, Cloud Functions, Hosting</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Supabase:</b> PostgreSQL backend, Auth, Storage, Edge Functions</p><p class="text-gray-600 mt-1"><b class="text-gray-700">CI/CD:</b> GitHub Actions, Docker, Kubernetes</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Version Control:</b> Git/GitHub - advanced rebasing, monorepo strategies</p></div>
                                <div class="p-4 bg-gray-50 rounded-lg border"><h5 class="font-bold text-gray-800">AI Integration & Automation</h5><p class="text-gray-600 mt-1"><b class="text-gray-700">APIs:</b> OpenAI, Google Gemini, Anthropic Claude, Grok, Meta AI</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Automation:</b> Zapier, Make.com, n8n, Python (Selenium/Scrapy)</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Data:</b> Pandas, NumPy, Polars, DuckDB, BeautifulSoup</p></div>
                                <div class="p-4 bg-gray-50 rounded-lg border"><h5 class="font-bold text-gray-800">Development Tools</h5><p class="text-gray-600 mt-1"><b class="text-gray-700">AI Assistants:</b> GitHub Copilot, Cursor IDE, Windsurf, Replit, CodeWhisperer, Tabnine</p><p class="text-gray-600 mt-1"><b class="text-gray-700">IDEs:</b> VS Code, PyCharm, Jupyter Notebooks, Google Colab</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Testing:</b> Postman, Insomnia, Swagger/OpenAPI, Thunder Client</p></div>
                                <div class="p-4 bg-gray-50 rounded-lg border"><h5 class="font-bold text-gray-800">Specialized Skills</h5><p class="text-gray-600 mt-1"><b class="text-gray-700">Multi-Agent Systems:</b> LangGraph RL loops, hierarchical task decomposition</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Custom Fine-Tuning:</b> LoRA/QLoRA, PEFT, instruction tuning, DPO</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Generative AI:</b> Whisper (transcription), TTS systems, diffusion models, ControlNet</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Real-Time Systems:</b> WebSockets, SSE, RAG hallucination guards</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Edge AI:</b> Model quantization (INT8/FP16), TensorRT, ONNX Runtime</p><p class="text-gray-600 mt-1"><b class="text-gray-700">Custom DOM Algorithm:</b> Built proprietary Virtual DOM diffing system achieving &lt;100ms render latency</p></div>
                            </div>
                        </div>
                        <div><h4 class="text-xl font-semibold text-gray-800 mb-3">ðŸ“š Research & Publications</h4><ul class="list-disc list-inside space-y-1"><li><b>"Challenging Bohr: Direct Evidence of Waveâ€“Particle Simultaneity"</b> Independent Researcher | Published August 2025
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Challenged Niels Bohr's 100-year-old complementarity principle</li>
                                <li>Presented groundbreaking theoretical analysis for simultaneous wave-particle existence</li>
                                <li>Designed 4 experimental architectures</li>
                                <li>Cited 70+ peer-reviewed sources spanning quantum optics and weak measurements</li>
                                <li>Published on OSF, Academia.edu, Zenodo</li>
                                <li>1,800+ researcher views with global quantum research community recognition</li>
                                <li>Key Innovation: Introduced 'Duality Illusion' theory with engineered proof from novel detectors</li>
                            </ul>
                        </li></ul></div>
                        <div><h4 class="text-xl font-semibold text-gray-800 mb-3">ðŸ“œ Credentials & Certifications</h4><ul class="list-disc list-inside space-y-1"><li><b>Internships & Industry Experience</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>IIT Delhi - Internship (September 2024)</li>
                                <li>J.P. Morgan - Investment Banking Job Simulation (January 2025)</li>
                                <li>TATA Group - Cybersecurity Analyst Job Simulation (January 2025)</li>
                                <li>Hamari Pahchan NGO - Social Entrepreneurship Internship (September 2024)</li>
                                <li>SEBI - Investor Certification Examination (February 2025)</li>
                            </ul>
                        </li><li><b>AI & Machine Learning Certifications</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>MIT, Stanford, Google AI, IBM AI, OpenAI, Anthropic, DeepLearning.ai</li>
                                <li>Andrew Ng's Machine Learning Specialization</li>
                                <li>Google Cloud ML Engineer, AWS SageMaker & ML Specialty</li>
                                <li>Microsoft Azure Data Scientist, NVIDIA Deep Learning</li>
                                <li>Hugging Face Transformers, DataCamp AI Fundamentals</li>
                            </ul>
                        </li><li><b>Specialized Certifications</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Advanced Prompt Engineering - IBM, Harvard, MIT, OpenAI, DeepLearning.AI</li>
                                <li>Generative AI & LLMs - Google GenAI Path, MIT Applied GenAI, Udacity</li>
                                <li>Cloud AI/ML - Google Cloud, AWS, Azure AI Fundamentals</li>
                                <li>Data Science - IBM, Stanford, Harvard CS50 AI, University of Michigan</li>
                                <li>FastAI, LangChain, Cohere, IITs, Meta official docs</li>
                            </ul>
                        </li></ul></div>
                        <div class="bg-blue-50 p-6 rounded-xl border border-blue-200"><h4 class="text-2xl font-bold text-gray-800 mb-3">ðŸ”¥ Here's the Raw Truth</h4><p class="text-lg">This knowledge shouldn't be locked behind expensive courses or elite college degrees. So here's my promise to every Nexbook team member:</p></div>
                        <div><h4 class="text-2xl font-bold text-gray-800 mb-3">What You'll Get:</h4><ul class="space-y-3"><li>âœ… <b>Personal Mentorship from Me:</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>I will personally teach you everything I know</li>
                                <li>Every AI tool, automation technique, prompt engineering secret</li>
                                <li>Every coding trick, deployment strategy that took me 5 years and lakhs to learn</li>
                                <li>Weekly live coding sessions, 1-on-1 doubt clearing, code reviews</li>
                            </ul>
                        </li><li>âœ… <b>Premium Tools Guide (Worth â‚¹2 Lakh+/year):</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>ChatGPT Plus, Claude Pro, Gemini Advanced</li>
                                <li>GitHub Copilot, Cursor AI, Windsurf, Amazon CodeWhisperer</li>
                                <li>Midjourney Pro, RunwayML, DALL-E 3</li>
                                <li>LangChain, OpenAI API credits, automation tools</li>
                            </ul>
                        </li><li>âœ… <b>Real Project Experience:</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Work on my LIVE projects with 5,000+ actual users</li>
                                <li>Access to complete source code of all 48+ applications</li>
                                <li>Production-grade architecture with real user feedback</li>
                                <li>AWS deployment workflows and cloud infrastructure</li>
                            </ul>
                        </li><li>âœ… <b>Portfolio Building with Impact:</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Build your own AI applications with my guidance</li>
                                <li>Not fake projects - real applications that solve problems</li>
                                <li>Go on your resume with measurable impact</li>
                            </ul>
                        </li><li>âœ… <b>Complete Knowledge Transfer:</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>University course materials (worth â‚¹2,00,000+)</li>
                                <li>My prompt engineering library (10,000+ tested prompts)</li>
                                <li>My automation workflows and client project templates</li>
                                <li>API integration patterns and architecture blueprints</li>
                                <li>My failures, learnings, and shortcuts from 5 years</li>
                            </ul>
                        </li></ul></div>
                        <div><h4 class="text-2xl font-bold text-gray-800 mb-3">ðŸ’­ Why Am I Doing This?</h4><p class="mb-4">Because I believe the future belongs to those who understand AI. I'm still a student, just like many of you. But I've spent countless nights learning, building, failing, and succeeding. I want to build a team of people who don't just USE AI - but truly UNDERSTAND it, BUILD with it, and CREATE the future with it.</p><p>This isn't a typical internship where you make PPTs or do data entry. This is your shortcut to becoming an AI expert. The same journey that took me 5 years and built 48+ applications serving 5,000+ users? You'll get it in 6-12 months with hands-on guidance. No gatekeeping. No holding back. Complete knowledge transfer.</p></div>
                        <div><h4 class="text-2xl font-bold text-gray-800 mb-3">ðŸŽ¯ What This Actually Means for You</h4><ul class="space-y-3"><li>ðŸ“š <b>Free Education (Worth â‚¹2,00,000+)</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>University-level Machine Learning courses</li>
                                <li>Deep Learning specializations</li>
                                <li>Advanced AI & NLP programs</li>
                                <li>Prompt Engineering masterclasses</li>
                                <li>Full-Stack AI development courses</li>
                                <li>AWS Cloud Architecture training</li>
                                <li>All materials I paid thousands for - yours FREE</li>
                            </ul>
                        </li><li>ðŸ¤– <b>Real AI Mastery Training</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Weekly live coding sessions</li>
                                <li>1-on-1 doubt clearing and code reviews</li>
                                <li>Learn by doing - write code from day one</li>
                                <li>Get feedback from someone who's shipped 48+ products</li>
                            </ul>
                        </li><li>ðŸš€ <b>Production Experience</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Work alongside me on live apps with 5,000+ active users</li>
                                <li>Client projects (paid opportunities for you)</li>
                                <li>New AI experiments and product launches</li>
                                <li>Your own product ideas with my technical mentorship</li>
                            </ul>
                        </li><li>ðŸ’Ž <b>Behind-the-Scenes Access</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Complete source code of 32 websites, 14 apps, 1 custom browser</li>
                                <li>Architecture decisions and database schemas</li>
                                <li>Deployment pipelines and user analytics</li>
                                <li>Revenue models and business logic</li>
                                <li>Not just demos. Real code. Real users. Real business.</li>
                            </ul>
                        </li><li>ðŸ’° <b>Earning While Learning</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Freelance project referrals</li>
                                <li>Revenue sharing on projects you work on</li>
                                <li>Paid opportunities for client work</li>
                                <li>Support to build your own AI services</li>
                            </ul>
                        </li><li>ðŸŽ¯ <b>Career Transformation</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Portfolio that stands out</li>
                                <li>Skills that pay â‚¹10-20 LPA+</li>
                                <li>Network in AI & startup ecosystem</li>
                                <li>Strong recommendation letters</li>
                                <li>Real startup experience on your resume</li>
                            </ul>
                        </li></ul></div>
                        <div><h4 class="text-2xl font-bold text-gray-800 mb-3">âš¡ This is NOT Available Anywhere Else</h4><ul class="space-y-2"><li>âŒ Online courses don't give you this level of personal mentorship</li><li>âŒ College doesn't teach production-ready AI skills</li><li>âŒ Paid bootcamps charge â‚¹2-5 lakhs for far less content</li><li>âŒ Other internships give you basic tasks, not complete knowledge transfer</li><li>âŒ YouTube tutorials don't show you the full picture</li><li>âœ… This is a once-in-a-lifetime opportunity to learn from someone who's:
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Built 48+ production applications</li>
                                <li>Serving 5,000+ real users</li>
                                <li>Founded 3 successful startups</li>
                                <li>Published quantum physics research</li>
                                <li>Deployed custom web browser</li>
                                <li>Mastered entire AI/ML stack</li>
                            </ul>
                        </li></ul></div>
                        <div><h4 class="text-2xl font-bold text-gray-800 mb-3">ðŸŽ My Personal Commitment to You</h4><p class="mb-3">If you're selected for Nexbook, here's what I promise:</p><ol class="list-decimal list-inside space-y-2"><li><b>âœ¨ Personal Time & Attention</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Weekly live sessions</li>
                                <li>Regular 1-on-1 calls</li>
                                <li>Quick responses to your questions</li>
                            </ul>
                        </li><li><b>âœ¨ No Question is Stupid</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>I'll answer every doubt</li>
                                <li>Explain concepts multiple ways until you understand</li>
                            </ul>
                        </li><li><b>âœ¨ Real Feedback</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Honest code reviews</li>
                                <li>Constructive criticism to help you improve</li>
                            </ul>
                        </li><li><b>âœ¨ Opportunity Creation</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Connect you with clients and my network</li>
                                <li>Collaborate on real projects with revenue potential</li>
                            </ul>
                        </li><li><b>âœ¨ Zero Gatekeeping</b>
                            <ul class="list-circle list-inside ml-4 space-y-1">
                                <li>Complete access to everything I know</li>
                                <li>No hidden costs, no paywalls</li>
                            </ul>
                        </li></ol></div>
                        <div><h4 class="text-2xl font-bold text-gray-800 mb-3">ðŸ“‹ All I Ask From You</h4><ul class="list-disc list-inside space-y-1"><li>âœ¨ Be curious - Ask questions, explore, experiment</li><li>âœ¨ Be consistent - Show up, put in the work</li><li>âœ¨ Be ready to learn - Stay humble and open-minded</li><li>âœ¨ Be collaborative - Help your teammates grow too</li></ul></div>
                        <div class="text-center bg-gray-100 p-8 rounded-2xl"><h4 class="text-3xl font-bold text-gray-800 mb-4">ðŸš€ Ready to Transform Your Career?</h4><p class="mb-6">This is your chance to learn AI from someone who's:</p>
                            <ul class="list-disc list-inside text-gray-700 mb-6 inline-block text-left">
                                <li>Built 48+ real products</li>
                                <li>Serving 5,000+ users</li>
                                <li>Founded 3 startups</li>
                                <li>Published research papers</li>
                                <li>Making real impact</li>
                            </ul>
                            <p class="font-semibold text-lg">ðŸ‘‰ Apply Now: <a href="#joinUsFormWrapper" id="applyNowLink" class="text-blue-600 hover:underline">Application Link</a></p><p class="mt-4">ðŸ’¬ Have Questions? Let's Talk:</p><p> Email: sauravthakur6310@gmail.com</p><p>Phone: +91 7229922079</p><p>LinkedIn: linkedin.com/in/sauravthakurq</p><p>GitHub: github.com/sauravthakurq</p><p class="mt-4 text-sm text-gray-500">â° Limited Spots Available. First 50 Applicants Get Founding Member Benefits.</p></div>
                        <div class="mt-12 border-t pt-8 text-center"><p class="text-lg italic">"I spent 5 years and lakhs of rupees learning this. Built 48+ real products serving 5,000+ users. Founded 3 startups. Published quantum research. You're getting access to everything - for free. Don't miss this."</p><p class="mt-4 font-bold">â€” Saurav Thakur</p><p class="text-sm text-gray-600">Founder, Nexbook | AI Systems Architect & Full-Stack Developer</p><div class="mt-4 flex justify-center gap-4 text-sm"><a href="https://www.linkedin.com/in/sauravthakurq" target="_blank" class="text-blue-600 hover:underline">LinkedIn</a><span>|</span><a href="https://github.com/saurav-thakurq" target="_blank" class="text-blue-600 hover:underline">GitHub</a></div>
                            <div class="mt-8 text-center"><h4 class="text-2xl font-bold text-gray-800 mb-3">ðŸ“Š Impact Summary</h4><p class="text-gray-600">48+ Applications | 5,000+ Users | 90% Automation | 3 Startups | 500+ Students | 180+ Countries Supported</p></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- NEW: My Orders Modal -->
        <div id="myOrdersModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen w-full max-w-2xl flex flex-col">
                <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">My Orders</h2>
                    <button id="closeMyOrdersModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="myOrdersContent" class="p-8 overflow-y-auto">
                    <!-- Orders content will be injected here -->
                </div>
            </div>
        </div>

        <!-- NEW: Profile Dashboard Modal -->
        <div id="profileDashboardModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content modal-content--fullscreen max-w-md flex flex-col">
                <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">My Dashboard</h2>
                    <button id="closeProfileDashboardModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div id="profileDashboardContent" class="p-8 overflow-y-auto">
                    <!-- Profile dashboard content will be injected here -->
                </div>
            </div>
        </div>

        <!-- NEW: Auth Modal -->
        <div id="authModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div> 
            <div class="modal-content w-full max-w-md">
                <button id="closeAuthModalBtn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 button-animation z-10"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                <div class="p-8">
                    <h2 class="text-2xl font-bold mb-4 text-center">Welcome</h2>
                    <div id="auth-view-container">
                        <!-- Auth content (login/register) will be injected here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- NEW: Backpack Checkout Modal -->
        <div id="backpackCheckoutModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div id="backpackCheckoutModalContent" class="modal-content modal-content--fullscreen flex flex-col">
                <!-- Backpack checkout content will be injected here -->
            </div>
        </div>

        <!-- NEW: Logout Confirmation Modal -->
        <div id="logoutConfirmModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="logoutConfirmTitle">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-sm">
                <div class="p-8 text-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto mb-4 h-12 w-12 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                    <h2 id="logoutConfirmTitle" class="text-2xl font-bold mb-2">Are you sure?</h2>
                    <p class="text-gray-600 mb-6">You will be logged out of your Nexbook account.</p>
                    <div class="flex justify-center gap-4">
                        <button id="cancelLogoutBtn" class="w-full h-12 bg-gray-200 text-gray-800 hover:bg-gray-300 rounded-lg font-semibold button-animation">Cancel</button>
                        <button id="confirmLogoutBtn" class="w-full h-12 bg-red-600 text-white hover:bg-red-700 rounded-lg font-semibold button-animation">Logout</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- NEW: Cancel Order Modal -->
        <div id="cancelOrderModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-lg">
                <!-- Content will be injected by JS -->
            </div>
        </div>

        <!-- NEW: Change Delivery Date Modal -->
        <div id="changeDateModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-md">
                <!-- Content will be injected by JS -->
            </div>
        </div>
        <!-- NEW: Order Options Dropdown (template) -->
        <div id="order-options-template" class="hidden">
            <div class="absolute top-full right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border z-20 py-2">
                <!-- Options will be injected here. Added max-h-60 and overflow-y-auto for scrollability -->
            </div>
        </div>

        <!-- NEW: Confirmation Modal (Generic) -->
        <div id="confirmActionModal" class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-backdrop" data-close-modal></div>
            <div class="modal-content max-w-sm">
                <div class="p-8 text-center">
                    <div id="confirmActionIcon" class="mx-auto mb-4 h-12 w-12 text-yellow-500"></div>
                    <h2 id="confirmActionTitle" class="text-2xl font-bold mb-2">Are you sure?</h2>
                    <p id="confirmActionMessage" class="text-gray-600 mb-6">This action cannot be undone.</p>
                    <div class="flex justify-center gap-4">
                        <button id="confirmActionCancelBtn" class="w-full h-12 bg-gray-200 text-gray-800 hover:bg-gray-300 rounded-lg font-semibold button-animation">Cancel</button>
                        <button id="confirmActionConfirmBtn" class="w-full h-12 bg-red-600 text-white hover:bg-red-700 rounded-lg font-semibold button-animation">Confirm</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
    
    <header class="fixed top-0 left-0 right-0 bg-white/80 backdrop-blur-md shadow-sm z-50 border-b border-gray-200/80">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
             <div class="flex justify-between items-center h-16">
                <a href="#top" id="logoLink" class="flex items-center gap-2 group">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 translate-y-0.5 transition-transform duration-300 group-hover:rotate-[-5deg] group-hover:scale-110"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                    <span class="logo-font text-2xl font-extrabold bg-gradient-to-r from-blue-600 to-indigo-400 text-transparent bg-clip-text transition-all duration-300 hover:opacity-80">Nexbook</span>
                </a>
                
                <!-- HAMBURGER BUTTON - ABSOLUTE RIGHT CORNER -->
                <button id="hamburgerBtn" 
                    class="absolute right-4 top-1/2 -translate-y-1/2 flex items-center justify-center p-2 h-10 w-10 rounded-md text-gray-600 hover:text-black hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors z-50">
                    <span class="sr-only">Toggle menu</span>
                    <div class="hamburger-icon-apple">
                        <span class="line-apple top"></span>
                        <span class="line-apple middle"></span>
                        <span class="line-apple bottom"></span>
                    </div>
                </button>
                
                <nav class="hidden md:flex md:space-x-2 items-center font-medium text-gray-600 mr-16">
                    <a href="#browse-courses" class="px-3 py-1.5 rounded-md hover:bg-gray-100 hover:text-gray-900 transition-colors button-animation font-playfair">Buy Books</a>
                    <a href="#academy-x" class="px-3 py-1.5 rounded-md text-blue-600 hover:bg-blue-50 hover:text-blue-700 transition-colors button-animation academyx-link font-playfair">AcademyX</a>
                    <div class="relative group">
                        <button class="font-medium text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-colors button-animation flex items-center gap-1 px-3 py-1.5 rounded-md">
                            <span>Join Groups</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform duration-300 group-hover:rotate-180"><polyline points="6 9 12 15 18 9"></polyline></svg>
                        </button>
                        <div class="absolute hidden group-hover:block opacity-0 group-hover:opacity-100 transform -translate-y-2 group-hover:translate-y-0 transition-all duration-300 pointer-events-none group-hover:pointer-events-auto bg-white rounded-lg shadow-xl mt-2 py-2 w-56 z-50 border">
                            <a href="https://t.me/your_telegram_group" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-100 transition-colors">
                                <svg class="w-5 h-5 text-blue-500" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/>
                                </svg>
                                <span>Join Telegram Group</span>
                            </a>
                            <a href="https://chat.whatsapp.com/your_whatsapp_group" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-100 transition-colors">
                                <svg class="w-5 h-5 text-green-500" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                                </svg>
                                <span>Join WhatsApp Group</span>
                            </a>
                        </div>
                    </div>
                    <a href="#about-us" class="px-3 py-1.5 rounded-md hover:bg-gray-100 hover:text-gray-900 transition-colors button-animation font-playfair">About Us</a>
                    <a href="#gamification" class="px-3 py-1.5 rounded-md hover:bg-gray-100 hover:text-gray-900 transition-colors button-animation font-playfair">Leaderboard</a>
                    <button id="aiHelperBtnNav" class="font-semibold py-1.5 px-3 text-sm bg-blue-100 text-blue-700 hover:bg-blue-200 rounded-md button-animation font-playfair">Thinkly AI</button>
                    <button id="requestBookBtnNav" class="font-semibold py-1.5 px-3 text-sm bg-yellow-400 text-gray-900 hover:bg-yellow-500 rounded-md button-animation font-playfair">Request Book</button>
                    <button id="authBtn" class="font-semibold py-1.5 px-3 text-sm bg-blue-600 text-white hover:bg-blue-700 rounded-md button-animation font-playfair">Login</button> <!-- This is for desktop -->
                </nav>
                <div class="flex items-center gap-4 mr-16">
                    <button id="authBtnMobile" class="md:hidden font-semibold py-1 px-3 text-sm bg-blue-600 text-white hover:bg-blue-700 rounded-lg button-animation">Login</button>
                    <a href="#academy-x" class="text-sm font-bold block button-animation md:hidden academyx-link mobile-academyx-glow text-blue-600">AcademyX</a>
                </div>
            </div>
        </div>
        
    </header>

    <!-- HERO SECTION -->
    <script>
        // NEW: Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed: ', error);
                    });
            });
        }
    </script>

    <section id="top" class="h-screen flex items-center justify-center text-center relative bg-white overflow-hidden">
        <div class="absolute inset-0 bg-cover bg-center opacity-75" style="background-image: url('heroimage.jpg');"></div>
        <div class="absolute inset-0 bg-gradient-to-t from-gray-50 via-white/80 to-transparent"></div>
        <div class="max-w-5xl w-full mx-auto px-4 sm:px-6 lg:px-8 z-10 relative">
            <h1 class="logo-font text-5xl md:text-8xl font-extrabold mb-3 tracking-tight" style="background: linear-gradient(135deg, #3A7BFF 0%, #FFFFFF 50%, #2d2d2d 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Nexbook</h1>
            <p class="body-font text-lg md:text-xl text-gray-600 font-normal mb-10 max-w-2xl mx-auto" style="text-shadow: 0 0 1px rgba(0,0,0,0.2);"><span class="bg-blue-100 text-blue-800 font-semibold px-2 py-1 rounded-full">S.S. Jain Subodh P.G. College</span><br class="md:hidden">Connect, Share, Learn: Your Student Book Marketplace</p>
            <div class="flex flex-col space-y-4 items-center sm:flex-row sm:space-y-0 sm:gap-6 justify-center">
                <a href="#browse-courses" class="button-animation">
                    <button class="h-14 w-60 text-lg text-white font-bold transform transition-transform duration-300 hover:scale-105 shadow-lg hover:shadow-xl rounded-xl flex items-center justify-center bg-red-500 hover:bg-red-600 font-playfair">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                        Buy Books
                    </button>
                </a>
                <button id="sellBookBtnHero" class="h-14 w-60 text-lg text-white font-bold transform transition-transform duration-300 hover:scale-105 shadow-lg hover:shadow-xl rounded-xl flex items-center justify-center bg-orange-500 hover:bg-orange-600 button-animation font-playfair">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                    Sell Your Book
                </button>
            </div>

        </div>
    </section>
    
    <!-- Thinkly AI Chat Interface -->
    <section class="py-12 bg-white px-4 sm:px-6 lg:px-8">
        <div id="thinkly-ai-hero" class="max-w-3xl mx-auto">
            <div id="mainContainer" class="w-full px-4 explosive-title">
                <div id="searchBarWrapper" class="AgWCw">
                    <div class="LmmD9"></div>
                    <div class="d4HWzd"></div>
                    
                    <div class="search-bar-title">
                       <h2><span class="shine-colorful">Thinkly AI</span></h2>
                    </div>
                    
                    <div id="middleTitle">
                        <span class="shine-colorful">Thinkly AI</span>
                    </div>

                    <button id="expandButton" style="cursor: pointer;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15 3H21M21 3V9M21 3L14 10M9 21H3M3 21V15M3 21L10 14" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>Expand</span>
                    </button>
                    <button id="clearChatButton" aria-label="Clear chat" style="cursor: pointer;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708 .708L8.707 8l2.647 2.646a.5.5 0 0 1-.708 .708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/></svg>
                    </button>
                    
                    <div class="esoFne">
                        <div id="chatOutput"></div>
                        
                        <!-- Quick Response Pills -->
                        <div class="ai-response-pills" id="quickPills" style="display: none; margin-bottom: 12px;">
                            <button class="ai-pill" data-pill="What is Nexbook?">What is Nexbook?</button>
                            <button class="ai-pill" data-pill="How to buy books?">How to buy books?</button>
                            <button class="ai-pill" data-pill="How to sell books?">How to sell books?</button>
                            <button class="ai-pill" data-pill="Is it safe?">Is it safe?</button>
                        </div>
                        
                        <div class="input-area">
                            <div class="textarea-wrapper">
                                <textarea id="searchInput" class="ITIRGe" rows="1"></textarea>
                                <span class="placeholder-text">Ask Anything...</span>
                            </div>
                            <div class="action-buttons">
                                <button id="fileButton" class="control-button" aria-label="Attach file">
                                   <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#56595e" viewBox="0 0 256 256"><path d="M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,224H56V40h88V88a8,8,0,0,0,8,8h48V224Z"></path></svg>
                                </button>
                                <button id="sendButton" class="OEueve disabled" aria-label="Send">
                                    <div class="emo-send-container">
                                        <div class="emo-send-face">
                                            <svg viewBox="0 0 100 50" preserveAspectRatio="xMidYMid meet" style="width:100%;height:100%;">
                                                <g id="sendLeftEye" class="emo-send-eye-group">
                                                    <path d="M20 25 C27 15, 40 15, 47 25" fill="transparent" stroke="#bffcff" stroke-width="4" stroke-linecap="round" opacity="0.98"/>
                                                </g>
                                                <g id="sendRightEye" class="emo-send-eye-group">
                                                    <path d="M53 25 C60 15, 73 15, 80 25" fill="transparent" stroke="#bffcff" stroke-width="4" stroke-linecap="round" opacity="0.98"/>
                                                </g>
                                            </svg>
                                        </div>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Expanded View -->
            <div id="expandedView">
                <div class="expanded-header grid grid-cols-3 items-center">
                    <div class="justify-self-start">
                        <button id="thinklyMenuButton" class="control-button" aria-label="Menu">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                        </button>
                    </div>
                    <div class="justify-self-center">
                        <span class="expanded-title"><span class="shine-colorful">Thinkly AI</span></span>
                    </div>
                    <button id="closeButton" class="control-button justify-self-end" aria-label="Close" style="cursor: pointer; z-index: 10001; pointer-events: auto; touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-width: 44px; min-height: 44px; display: flex; align-items: center; justify-content: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16" style="pointer-events: none;"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708 .708L8.707 8l5.147 5.146a.5.5 0 0 1-.708 .708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/></svg>
                    </button>
                </div>
                <!-- NEW: Thinkly AI Sidebar -->
                <div id="thinklySidebarOverlay"></div>
                <div id="thinklySidebar" class="w-4/5 max-w-xs bg-gray-50 transform -translate-x-full transition-transform duration-300 ease-in-out flex flex-col">
                    <div class="flex items-center justify-between p-4 border-b">
                        <h3 class="text-lg font-bold text-gray-800">Chat History</h3>
                        <button id="closeThinklySidebarBtn" class="p-1 rounded-full text-gray-500 hover:bg-gray-200 hover:text-gray-800 transition-colors button-animation" aria-label="Close sidebar">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708 .708L8.707 8l5.147 5.146a.5.5 0 0 1-.708 .708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/></svg>
                        </button>
                    </div>
                    <div id="thinklyHistoryContainer" class="flex-grow p-4 space-y-2 overflow-y-auto">
                        <!-- Placeholder for history items -->
                        <a href="#" class="block p-2 rounded-md hover:bg-gray-200 text-gray-700 truncate">Summary of Mechanics notes</a>
                        <a href="#" class="block p-2 rounded-md hover:bg-gray-200 text-gray-700 truncate">Key questions from Organic Chemistry</a>
                        <a href="#" class="block p-2 rounded-md hover:bg-gray-200 text-gray-700 truncate">Explain Quantum Physics</a>
                    </div>
                    <div id="thinklyAboutBtn" class="p-4 border-t mt-auto cursor-pointer hover:bg-gray-100 transition-colors">
                        <h4 class="font-bold">About Nexbook</h4>
                        <p class="text-sm text-gray-600 mt-1">Your exclusive campus marketplace. Buy, sell, and learn smarter.</p>
                    </div>
                </div>

                <div id="expandedChatOutput"></div>
                <div class="expanded-input-area">
                     <div class="input-area" style="opacity: 1; transform: none; pointer-events: auto;">
                        <textarea id="expandedSearchInput" class="ITIRGe" placeholder="Ask Anything..." rows="1"></textarea>
                        <div class="action-buttons">
                            <button class="control-button" aria-label="Attach file">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#56595e" viewBox="0 0 256 256"><path d="M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,224H56V40h88V88a8,8,0,0,0,8,8h48V224Z"></path></svg>
                            </button>
                            <button id="expandedSendButton" class="OEueve disabled" aria-label="Send">
                                <div class="emo-send-container">
                                    <div class="emo-send-face">
                                        <svg viewBox="0 0 100 50" preserveAspectRatio="xMidYMid meet" style="width:100%;height:100%;">
                                            <g id="expandedSendLeftEye" class="emo-send-eye-group">
                                                <path d="M20 25 C27 15, 40 15, 47 25" fill="transparent" stroke="#bffcff" stroke-width="4" stroke-linecap="round" opacity="0.98"/>
                                            </g>
                                            <g id="expandedSendRightEye" class="emo-send-eye-group">
                                                <path d="M53 25 C60 15, 73 15, 80 25" fill="transparent" stroke="#bffcff" stroke-width="4" stroke-linecap="round" opacity="0.98"/>
                                            </g>
                                        </svg>
                                    </div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Free Resources Card - Premium Compact Glass Tile -->
    <section class="py-8 bg-white px-4 sm:px-6 lg:px-8">
        <div class="max-w-sm mx-auto">
            <div class="backdrop-blur-xl bg-white/60 border border-white/40 shadow-lg rounded-2xl w-full p-3">
                <h2 class="text-lg font-semibold text-gray-900 mb-3 tracking-tight">Free Resources</h2>
                
                <div class="grid grid-cols-2 gap-2">
                    <!-- Notes -->
                    <button id="freeResourceNotesBtn" class="flex flex-col items-center justify-center bg-white/70 border border-white/40 rounded-xl py-4 active:scale-90 hover:shadow-md hover:bg-white/90 transition-all duration-200 cursor-pointer shadow-sm">
                        <span class="text-base font-bold text-gray-800 tracking-tight">ðŸ“ Notes</span>
                    </button>

                    <!-- PYQ -->
                    <button id="freeResourcePYQBtn" class="flex flex-col items-center justify-center bg-white/70 border border-white/40 rounded-xl py-4 active:scale-90 hover:shadow-md hover:bg-white/90 transition-all duration-200 cursor-pointer shadow-sm">
                        <span class="text-base font-bold text-gray-800 tracking-tight">ðŸ“„ PYQ</span>
                    </button>

                    <!-- Assignment -->
                    <button id="freeResourceAssignmentBtn" class="flex flex-col items-center justify-center bg-white/70 border border-white/40 rounded-xl py-4 active:scale-90 hover:shadow-md hover:bg-white/90 transition-all duration-200 cursor-pointer shadow-sm">
                        <span class="text-base font-bold text-gray-800 tracking-tight">âœï¸ Assignment</span>
                    </button>

                    <!-- Practicals -->
                    <button id="freeResourcePracticalsBtn" class="flex flex-col items-center justify-center bg-white/70 border border-white/40 rounded-xl py-4 active:scale-90 hover:shadow-md hover:bg-white/90 transition-all duration-200 cursor-pointer shadow-sm">
                        <span class="text-base font-bold text-gray-800 tracking-tight">ðŸ”¬ Practicals</span>
                    </button>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Payment and Delivery Info Section -->
    <section class="payment-info-section py-12 bg-gray-50 px-4 sm:px-6 lg:px-8">
        <div class="max-w-4xl mx-auto text-center p-6 bg-white rounded-2xl shadow-lg">
            <p class="text-md md:text-lg text-gray-700">
                You pay only after you have the book in your hands and youâ€™re fully satisfied. 
                <span class="font-semibold text-blue-600">Free Hand-on Delivery Within Campus!</span>
            </p>
        </div>
    </section>

    <section id="browse-courses" class="py-16 bg-gray-50 px-4 sm:px-6 lg:px-8">
        <div class="max-w-7xl mx-auto">
            <div id="browse-courses-heading" class="text-center mb-16"><h2 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-3 logo-font">Buy Books By Course</h2></div>
            <div id="course-selection-container-wrapper" class="expandable-content-wrapper">
                 <div id="course-selection-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- NEW: Skeleton loaders for better UX -->
                    <div class="skeleton-card">
                        <div class="skeleton-img"></div>
                        <div class="skeleton-text"></div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-img"></div>
                        <div class="skeleton-text"></div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-img"></div>
                        <div class="skeleton-text"></div>
                    </div>
                    <div class="skeleton-card">
                        <div class="skeleton-img"></div>
                        <div class="skeleton-text"></div>
                    </div>
                </div>
            </div>
            <div id="view-more-container-courses" class="text-center mt-16 mb-8 hidden">
                <button class="view-toggle-btn" data-toggle="expand" data-controls="course-selection-container-wrapper" data-view-more-text="View All Courses" data-view-less-text="View Less">View All Courses</button>
            </div>
        </div>
    </section>
    
    <style>
        /* NEW: Skeleton Loader for Course Cards */
        @keyframes pulse {
            50% { opacity: .5; }
        }
        .skeleton-card {
            background-color: #e5e7eb; /* gray-200 */
            border-radius: 1rem; /* rounded-2xl */
            overflow: hidden;
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .skeleton-img {
            height: 16rem; /* h-64 */
            background-color: #d1d5db; /* gray-300 */
        }
    </style>
    
    <!-- NEW: Free Books Section -->
    <section id="free-books" class="py-16 bg-white px-4 sm-px-6 lg:px-8">
        <div class="max-w-5xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-3 logo-font">Claim Your Free Books</h2>
                <p class="text-lg text-gray-600 max-w-2xl mx-auto">A community initiative to share knowledge freely. Grab, give, or swap books with fellow students.</p>
            </div>

            <!-- Apple-style Interactive Card -->
            <div class="bg-white/50 backdrop-blur-xl border border-gray-200/80 rounded-3xl shadow-2xl shadow-gray-200/50 overflow-hidden p-4 md:p-6">
                <div class="flex flex-col md:flex-row gap-6">
                    <!-- Image Section (Now Clickable) -->
                    <a href="#" id="claim-now-img-link" class="md:w-1/2 h-64 md:h-auto block cursor-pointer">
                        <div class="relative rounded-2xl overflow-hidden shadow-lg group h-full">
                            <img src="https://i.postimg.cc/k5Rxq1qX/Gemini-Generated-Image-1tj2xr1tj2xr1tj.jpg" alt="Students sharing books" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>
                            <div class="absolute bottom-0 left-0 right-0 p-6 text-white">
                                <div class="flex justify-between items-center">
                                    <span class="bg-white/20 backdrop-blur-md text-white text-xs font-bold px-3 py-1.5 rounded-full">Grab It â€¢ Give It â€¢ Swap It</span>
                                    <button id="claim-now-btn" class="claim-button bg-green-500 text-white font-bold text-sm px-5 py-2.5 rounded-full shadow-lg hover:bg-green-600 transition-all transform hover:scale-105 button-animation">Claim</button>
                                </div>
                            </div>
                        </div>
                    </a>

                    <!-- Options Section -->
                    <div class="md:w-1/2 flex flex-col gap-4">
                        <button data-action="grab" class="freebook-action-btn group bg-gray-50 hover:bg-blue-50 border border-gray-200/80 p-6 rounded-2xl text-left w-full transition-all duration-300 hover:border-blue-200 hover:shadow-lg hover:-translate-y-1">
                            <h3 class="text-xl font-bold text-gray-800">Grab It</h3>
                            <p class="text-gray-600 mt-1">Get a free book from fellow students.</p>
                        </button>
                        <button data-action="give" class="freebook-action-btn group bg-gray-50 hover:bg-blue-50 border border-gray-200/80 p-6 rounded-2xl text-left w-full transition-all duration-300 hover:border-blue-200 hover:shadow-lg hover:-translate-y-1">
                            <h3 class="text-xl font-bold text-gray-800">Give It</h3>
                            <p class="text-gray-600 mt-1">Donate your used books to help others.</p>
                        </button>
                        <button data-action="swap" class="freebook-action-btn group bg-gray-50 hover:bg-blue-50 border border-gray-200/80 p-6 rounded-2xl text-left w-full transition-all duration-300 hover:border-blue-200 hover:shadow-lg hover:-translate-y-1">
                            <h3 class="text-xl font-bold text-gray-800">Swap It</h3>
                            <p class="text-gray-600 mt-1">Exchange one of your books for another.</p>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

     <section id="college-essentials" class="py-16 bg-gray-50 px-4 sm:px-6 lg:px-8">
        <div class="max-w-5xl mx-auto">
            <div class="text-center mb-16"><h2 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-3 logo-font">College Essentials at Half Price</h2></div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Winter Blazer Card -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-2xl hover:-translate-y-1">
                    <img src="https://i.postimg.cc/59H8v63t/Blazer.jpg" alt="Winter Blazer" class="w-full h-64 object-cover">
                    <div class="p-6">
                        <h3 class="text-2xl font-bold mb-4">Winter Blazer</h3>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <button class="essential-buy-btn w-full h-12 bg-red-500 text-white font-bold rounded-lg hover:bg-red-600 transition-all button-animation" data-item="Winter Blazer" data-price="750">Buy Now</button>
                            <button class="essential-sell-btn w-full h-12 bg-orange-500 text-white font-bold rounded-lg hover:bg-orange-600 transition-all button-animation" data-item="Winter Blazer">Sell Yours</button>
                        </div>
                    </div>
                </div>
                <!-- Lab Coat Card -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 hover:shadow-2xl hover:-translate-y-1">
                    <img src="https://i.postimg.cc/rstym658/Lab-coat.jpg" alt="Lab Coat" class="w-full h-64 object-cover">
                    <div class="p-6">
                        <h3 class="text-2xl font-bold mb-4">Lab Coat</h3>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <button class="essential-buy-btn w-full h-12 bg-red-500 text-white font-bold rounded-lg hover:bg-red-600 transition-all button-animation" data-item="Lab Coat" data-price="400">Buy Now</button>
                            <button class="essential-sell-btn w-full h-12 bg-orange-500 text-white font-bold rounded-lg hover:bg-orange-600 transition-all button-animation" data-item="Lab Coat">Sell Yours</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- NEW ACADEMY-X SECTION -->
    <section id="academy-x" class="py-16 bg-white px-4 sm:px-6 lg:px-8">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-3 logo-font">AcademyX</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto">Explore Free Certified Courses from Top Institutions Worldwide</p>
            </div>

            <!-- Highlight Box -->
            <div class="max-w-5xl mx-auto mb-16 p-8 rounded-3xl bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-2xl transition-all duration-300 hover:scale-[1.02] hover:shadow-purple-400/50">
                <div class="flex flex-col md:flex-row items-center justify-between gap-8 text-center md:text-left">
                    <div class="flex-shrink-0 translate-y-0.5">
                        <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path><path d="M6 8h2"></path><path d="M6 12h2"></path></svg>
                    </div>
                    <div>
                        <h3 class="text-4xl font-extrabold mb-2">Explore <span class="counter-number" data-target="250000">0</span>+ Online Free Courses</h3>
                        <p class="text-lg opacity-90">Total courses listed on Class Central as of 2025 across all categories. <span class="counter-number" data-target="20000">0</span>+ courses come with <span class="font-bold text-yellow-300 bg-black/20 px-2 py-1 rounded">Free</span> certificates to boost your career and skills.</p>
                    </div>
                    <div class="flex-shrink-0">
                        <a href="https://www.classcentral.com/" target="_blank" class="block bg-white text-blue-600 font-bold text-lg py-4 px-8 rounded-full shadow-lg transition-transform duration-300 hover:scale-105 button-animation">Browse Courses</a>
                    </div>
                </div>
            </div>

            <!-- Search Bar -->
            <div class="max-w-2xl mx-auto mb-4 relative">
                <input id="academySearchInput" type="text" placeholder="Search Books, Courses, or Study Material" class="w-full p-4 pr-12 text-lg border-2 border-gray-300 rounded-full focus:ring-blue-500 focus:border-blue-500 transition-all">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute top-1/2 right-5 -translate-y-1/2 text-gray-400"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            </div>
            <!-- Search Results Container -->
            <div id="academySearchResults" class="max-w-2xl mx-auto mb-12"></div>
            
            <!-- AcademyX content will be injected here -->
            <div id="academy-x-content" class="mt-16 space-y-16">
                 <!-- This container will be populated by JS in the new order -->
            </div>
        </div>
    </section>

    <!-- Study Material Section -->
    <section id="study-material" class="py-16 bg-gray-50 px-4 sm:px-6 lg:px-8">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-extrabold logo-font text-gray-900">Study Material</h2>
                <p class="mt-4 text-lg text-gray-600">All your academic resources, in one place.</p>
            </div>
            
            <!-- Study Material Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto" style="display: none;">
                <!-- PYQ Card -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-shadow duration-300">
                    <div class="p-6">
                        <div class="w-14 h-14 bg-blue-50 rounded-lg flex items-center justify-center mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Find PYQ</h3>
                        <p class="text-gray-600 mb-4">Previous year question papers to help you prepare for exams.</p>
                        <button onclick="openStudyMaterialModal('pyq')" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-300">
                            Browse PYQs
                        </button>
                    </div>
                </div>
                
                <!-- Practicals Card -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-shadow duration-300">
                    <div class="p-6">
                        <div class="w-14 h-14 bg-green-50 rounded-lg flex items-center justify-center mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Practicals</h3>
                        <p class="text-gray-600 mb-4">Lab manuals and practical guides for hands-on learning.</p>
                        <button onclick="openStudyMaterialModal('practicals')" class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-300">
                            View Practicals
                        </button>
                    </div>
                </div>
                
                <!-- Assignments Card -->
                <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-100 hover:shadow-lg transition-shadow duration-300">
                    <div class="p-6">
                        <div class="w-14 h-14 bg-purple-50 rounded-lg flex items-center justify-center mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Assignments</h3>
                        <p class="text-gray-600 mb-4">Solved assignments and project guidelines for better understanding.</p>
                        <button onclick="openStudyMaterialModal('assignments')" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-300">
                            View Assignments
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Study Material Modal with overlay class -->
        <div id="studyMaterialModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 px-4 py-6 opacity-0 pointer-events-none transition-opacity duration-300 modal-overlay">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden">
                <!-- Modal Header -->
                <div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gray-50">
                    <div class="flex items-center">
                        <button id="backButton" class="text-blue-600 hover:text-blue-800 mr-4 hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                            </svg>
                        </button>
                        <h3 id="modalTitle" class="text-xl font-bold text-gray-900">Find PYQ</h3>
                    </div>
                    <button id="closeModal" class="text-gray-500 hover:text-gray-700 p-2 -m-2" onclick="closeStudyMaterialModal()">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                
                <!-- Modal Content -->
                <div id="modalContent" class="p-6 overflow-y-auto flex-1">
                    <!-- Content will be dynamically loaded here -->
                </div>
                
                <!-- Modal Footer -->
                <div class="px-6 py-4 border-t border-gray-200 bg-gray-50 flex-shrink-0">
                    <div class="flex justify-between items-center">
                        <span id="stepIndicator" class="text-sm text-gray-500">Step 1 of 3</span>
                        <button id="nextButton" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-300 button-animation">
                            Next
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // Study Material Data
            const studyMaterialData = {
                streams: [
                    { id: 'bsc', name: 'B.Sc. (Bachelor of Science)' },
                    { id: 'bcom', name: 'B.Com. (Bachelor of Commerce)' },
                    { id: 'ba', name: 'B.A. (Bachelor of Arts)' },
                    { id: 'bca', name: 'B.C.A. (Bachelor of Computer Applications)' },
                    { id: 'bba', name: 'B.B.A. (Bachelor of Business Administration)' },
                    { id: 'msc', name: 'M.Sc. (Master of Science)' },
                    { id: 'ma', name: 'M.A. (Master of Arts)' },
                    { id: 'mcom', name: 'M.Com. (Master of Commerce)' },
                    { id: 'mca', name: 'M.C.A. (Master of Computer Applications)' },
                    { id: 'other', name: 'Additional Programs' }
                ],
                
                subjects: {
                    bsc: ['Mathematics', 'Physics', 'Chemistry', 'Zoology', 'Botany', 'Microbiology', 'Biotechnology', 'Psychology', 'Statistics', 'Computer Science', 'Geography', 'Economics', 'Environmental Science'],
                    bcom: ['ABST (Accountancy and Business Statistics)', 'EAFM (Economic Administration and Financial Management)', 'BADM (Business Administration)'],
                    ba: ['Geography', 'History', 'Political Science', 'English', 'Hindi', 'Sociology', 'Public Administration', 'Sanskrit', 'Philosophy', 'Psychology', 'Economics', 'Physical Education', 'Journalism and Mass Communication', 'Music', 'Yoga'],
                    bca: ['Computer Applications'],
                    bba: ['Hotel Management', 'Retail Management', 'General BBA'],
                    msc: ['Physics', 'Chemistry', 'Mathematics', 'Zoology', 'Botany', 'Environmental Science', 'Forensic Science', 'Microbiology', 'Biotechnology', 'Geography', 'Statistics', 'Economics', 'Psychology', 'Information Technology (IT)', 'Cyber Security', 'Artificial Intelligence & Data Science'],
                    ma: ['Mathematics', 'Political Science', 'History', 'Public Administration', 'Hindi', 'English', 'Journalism and Mass Communication', 'Sociology', 'Yoga', 'Economics', 'Geography', 'Psychology'],
                    mcom: ['ABST', 'EAFM', 'BADM'],
                    mca: ['Computer Applications'],
                    other: ['Diploma', 'Certificate Courses', 'VAC (Value Added Courses)', 'GEC (Generic Electives)', 'Ph.D. Programs']
                },
                
                years: ['2025', '2024', '2023', '2022', '2021', '2020', '2019', '2018', '2017', '2016', '2015']
            };
            
            // Modal State
            let modalState = {
                currentStep: 1,
                selectedType: '',
                selectedStream: null,
                selectedSubject: null,
                selectedYear: null
            };
            
            // DOM Elements
            const modal = document.getElementById('studyMaterialModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            const backButton = document.getElementById('backButton');
            const closeButton = document.getElementById('closeModal');
            const nextButton = document.getElementById('nextButton');
            const stepIndicator = document.getElementById('stepIndicator');
            
            // Open Modal
            function openStudyMaterialModal(type) {
                resetModalState();
                document.body.classList.add('modal-open'); // Add this line to lock scroll
                modalState.selectedType = type;
                
                // Update modal title based on type
                const titles = {
                    'PYQ': 'Find PYQs',
                    'Practicals': 'Find Practicals',
                    'Assignments': 'Find Assignments',
                    'Notes': 'Find Notes'
                };
                modalTitle.textContent = titles[type] || 'Find Study Material';
                
                showStep(1);
                // The new ModalManager will handle opening
                window.ModalManager.open('studyMaterialModal');
                modal.classList.remove('opacity-0', 'pointer-events-none');
            }
            
            // Close Modal (scoped to Study Material modal only)
            function closeStudyMaterialModal() {
                // The new ModalManager will handle closing
                window.ModalManager.close('studyMaterialModal');
                document.body.classList.remove('modal-open'); // Add this line to unlock scroll
                modal.classList.add('opacity-0', 'pointer-events-none');
                resetModalState();
            }
            
            // Make close function globally available for inline onclick
            window.closeStudyMaterialModal = closeStudyMaterialModal;
            
            // Reset Modal State
            function resetModalState() {
                modalState = {
                    currentStep: 1,
                    selectedType: '',
                    selectedStream: null,
                    selectedSubject: null,
                    selectedYear: null
                };
            }
            
            // Update Modal Title
            function updateModalTitle(type) {
                let title = '';
                switch(type) {
                    case 'pyq':
                        title = 'Find PYQ';
                        break;
                    case 'practicals':
                        title = 'Practicals';
                        break;
                    case 'assignments':
                        title = 'Assignments';
                        break;
                    default:
                        title = 'Study Material';
                }
                modalTitle.textContent = title;
            }
            
            // Show Step
            function showStep(step) {
                modalState.currentStep = step;
                updateModalTitle(modalState.selectedType);
                updateStepIndicator();
                
                switch(step) {
                    case 1:
                        showStreams();
                        backButton.classList.add('hidden');
                        nextButton.disabled = !modalState.selectedStream;
                        break;
                    case 2:
                        showSubjects();
                        backButton.classList.remove('hidden');
                        nextButton.disabled = !modalState.selectedSubject;
                        break;
                    case 3:
                        showYears();
                        nextButton.textContent = 'View Resources';
                        nextButton.disabled = !modalState.selectedYear;
                        break;
                }
            }
            
            // Update Step Indicator
            function updateStepIndicator() {
                stepIndicator.textContent = `Step ${modalState.currentStep} of 3`;
            }
            
            // Show Streams
            function showStreams() {
                let html = /*html*/`
                    <h4 class="text-lg font-medium text-gray-700 mb-6">Select your main stream</h4>
                    <div class="grid grid-cols-1 gap-3">
                `;
                
                studyMaterialData.streams.forEach(stream => {
                    const isSelected = modalState.selectedStream === stream.id;
                    html += `
                        <button 
                            onclick="selectStream('${stream.id}')" 
                            class="w-full text-left p-4 rounded-xl border ${isSelected ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'} transition-colors duration-200"
                        >
                            <div class="flex items-center">
                                <div class="flex-1">
                                    <h4 class="font-medium text-gray-900">${stream.name}</h4>
                                </div>
                                ${isSelected ? `
                                    <div class="w-5 h-5 rounded-full bg-blue-600 flex items-center justify-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-white" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                        </svg>
                                    </div>
                                ` : ''}
                            </div>
                        </button>
                    `;
                });
                
                html += '</div>';
                modalContent.innerHTML = html;
            }
            
            // Show Subjects
            function showSubjects() {
                if (!modalState.selectedStream) return;
                
                const streamName = studyMaterialData.streams.find(s => s.id === modalState.selectedStream)?.name || '';
                const subjects = studyMaterialData.subjects[modalState.selectedStream] || [];
                
                let html = /*html*/`
                    <h4 class="text-lg font-medium text-gray-700 mb-6">Select subject in ${streamName}</h4>
                    <div class="grid grid-cols-1 gap-3">
                `;
                
                subjects.forEach(subject => {
                    const isSelected = modalState.selectedSubject === subject;
                    html += `
                        <button 
                            onclick="selectSubject('${subject}')" 
                            class="w-full text-left p-4 rounded-xl border ${isSelected ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'} transition-colors duration-200"
                        >
                            <div class="flex items-center">
                                <div class="flex-1">
                                    <h4 class="font-medium text-gray-900">${subject}</h4>
                                </div>
                                ${isSelected ? `
                                    <div class="w-5 h-5 rounded-full bg-blue-600 flex items-center justify-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-white" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                        </svg>
                                    </div>
                                ` : ''}
                            </div>
                        </button>
                    `;
                });
                
                html += '</div>';
                modalContent.innerHTML = html;
            }
            
            // Show Years
            function showYears() {
                let html = /*html*/`
                    <div class="mb-6">
                        <h4 class="text-lg font-medium text-gray-700 mb-2">Select Year</h4>
                        <p class="text-sm text-gray-500">Choose a year to view available resources</p>
                    </div>
                    <div class="space-y-4">
                        <button 
                            onclick="selectYear('pyq-pack')" 
                            class="w-full text-left p-4 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-colors duration-200"
                        >
                            <h4 class="font-medium text-white">PYQ Pack (Complete Set)</h4>
                            <p class="text-sm text-white/80 mt-1">Get all previous year questions in one pack</p>
                        </button>
                        
                        <div class="grid grid-cols-2 sm:grid-cols-3 gap-3 mt-6">
                `;
                
                studyMaterialData.years.forEach(year => {
                    const isSelected = modalState.selectedYear === year;
                    html += `
                        <button 
                            onclick="selectYear('${year}')" 
                            class="p-3 rounded-lg border ${isSelected ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'} transition-colors duration-200 text-center"
                        >
                            <span class="font-medium text-gray-900">${year}</span>
                        </button>
                    `;
                });
                
                html += '</div></div>';
                modalContent.innerHTML = html;
            }
            
            // Select Stream
            function selectStream(streamId) {
                modalState.selectedStream = streamId;
                nextButton.disabled = false;
                showStreams();
                // Auto-advance to next step
                setTimeout(() => showStep(2), 100);
            }
            
            // Select Subject
            function selectSubject(subject) {
                modalState.selectedSubject = subject;
                nextButton.disabled = false;
                showSubjects();
                // Auto-advance to next step
                setTimeout(() => showStep(3), 100);
            }
            
            // Select Year
            function selectYear(year) {
                modalState.selectedYear = year;
                nextButton.disabled = false;
                showYears();
            }
            
            // Event Listeners
            document.addEventListener('DOMContentLoaded', () => {
                // Next Button
                nextButton.addEventListener('click', () => {
                    if (modalState.currentStep < 3) {
                        showStep(modalState.currentStep + 1);
                    } else {
                        // Final action when all steps are complete
                        const { selectedType, selectedStream, selectedSubject, selectedYear } = modalState;
                        console.log('Final Selection:', { selectedType, selectedStream, selectedSubject, selectedYear });
                        // Here you would typically redirect to the resource page or show the content
                        alert(`Loading ${selectedType} for ${selectedSubject} (${selectedYear})...`);
                    }
                });
                
                // Back Button
                backButton.addEventListener('click', () => {
                    if (modalState.currentStep > 1) {
                        showStep(modalState.currentStep - 1);
                    }
                });
                
                // Close Button - Ensure it works properly
                if (closeButton) {
                    closeButton.onclick = function() {
                        closeStudyMaterialModal();
                    };
                }
            });
            
            // Make functions available globally
            window.openStudyMaterialModal = openStudyMaterialModal;
            window.selectStream = selectStream;
            window.selectSubject = selectSubject;
            window.selectYear = selectYear;
        </script>
                <div id="study-material-wrapper" class="expandable-content-wrapper">
                    <div id="study-material-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                        <!-- Card 1: Syllabus -->
                        <a href="javascript:void(0);" id="syllabusBtn" class="relative block rounded-2xl shadow-lg overflow-hidden h-72 md:h-80 group">
                            <img src="https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?q=80&w=1973&auto=format&fit=crop" alt="An open book with notes" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/90 to-transparent p-6">
                                <h2 class="text-3xl font-bold mb-2 text-white">Syllabus</h2>
                                <p class="text-gray-200 mb-4 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300">Download the topic-wise syllabus for all your subjects.</p>
                                <p class="font-semibold text-white self-start group-hover:underline">Check Syllabus</p>
                            </div>
                        </a>

                        <!-- Card 2: PYQs -->
                        <a href="javascript:void(0);" id="pyqBtn" class="relative block rounded-2xl shadow-lg overflow-hidden h-72 md:h-80 group">
                            <img src="https://images.unsplash.com/photo-1516321497487-e288fb19713f?q=80&w=2070&auto=format&fit=crop" alt="People collaborating over documents" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/90 to-transparent p-6">
                                <h2 class="text-3xl font-bold mb-2 text-white">PYQs</h2>
                                <p class="text-gray-200 mb-4 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300">Practice with previous year question papers for exams.</p>
                                <p class="font-semibold text-white self-start group-hover:underline">Explore PYQs</p>
                            </div>
                        </a>

                        <!-- Card 3: Practicals -->
                        <a href="javascript:void(0);" id="practicalsBtn" class="relative block rounded-2xl shadow-lg overflow-hidden h-72 md:h-80 group">
                            <img src="https://images.unsplash.com/photo-1518152006812-edab29b069ac?q=80&w=2070&auto=format&fit=crop" alt="Science lab equipment" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/90 to-transparent p-6">
                                <h2 class="text-3xl font-bold mb-2 text-white">Practicals</h2>
                                <p class="text-gray-200 mb-4 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300">Lab manuals and practical guides for hands-on learning.</p>
                                <p class="font-semibold text-white self-start group-hover:underline">View Practicals</p>
                            </div>
                        </a>

                        <!-- Card 4: Assignments -->
                        <a href="javascript:void(0);" id="assignmentsBtn" class="relative block rounded-2xl shadow-lg overflow-hidden h-72 md:h-80 group">
                            <img src="https://images.unsplash.com/photo-1484480974693-6ca0a78fb36b?q=80&w=2072&auto=format&fit=crop" alt="Person writing on a clipboard" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/90 to-transparent p-6">
                                <h2 class="text-3xl font-bold mb-2 text-white">Assignments</h2>
                                <p class="text-gray-200 mb-4 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300">Solved assignments and project guidelines for better understanding.</p>
                                <p class="font-semibold text-white self-start group-hover:underline">View Assignments</p>
                            </div>
                        </a>

                        <!-- Hidden Cards -->
                        <!-- Card 5: Notes -->
                        <a href="javascript:void(0);" id="notesBtn" class="relative block rounded-2xl shadow-lg overflow-hidden h-72 md:h-80 group">
                            <img src="https://images.unsplash.com/photo-1501504905252-473c47e087f8?q=80&w=2074&auto=format&fit=crop" alt="Person taking notes" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/90 to-transparent p-6">
                                <h2 class="text-3xl font-bold mb-2 text-white">Notes</h2>
                                <p class="text-gray-200 mb-4 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300">Comprehensive notes and summaries for quick revision.</p>
                                <p class="font-semibold text-white self-start group-hover:underline">View Notes</p>
                            </div>
                        </a>

                        <!-- Card 6: Time Table -->
                        <a href="javascript:void(0);" id="timeTableBtn" class="relative block rounded-2xl shadow-lg overflow-hidden h-72 md:h-80 group">
                            <img src="https://i.postimg.cc/m2dzrG6m/pexels-pixabay-256455.jpg" alt="A girl reading a book" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/90 to-transparent p-6">
                                <h2 class="text-3xl font-bold mb-2 text-white">Time Table</h2>
                                <p class="text-gray-200 mb-4 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300">View your complete schedule for all classes and labs.</p>
                                <p class="font-semibold text-white self-start group-hover:underline">View Timetable</p>
                            </div>
                        </a>

                        <a href="https://www.subodhpgcollege.com/autonomous_courses_results" target="_blank" class="relative block rounded-2xl shadow-lg overflow-hidden h-72 md:h-80 group">
                            <img src="https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?q=80&w=2070&auto=format&fit=crop" alt="Calculator and papers" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/90 to-transparent p-6">
                                <h2 class="text-3xl font-bold mb-2 text-white">Result</h2>
                                <p class="text-gray-200 mb-4 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300">Check your official semester and internal results here.</p>
                                <p class="font-semibold text-white self-start group-hover:underline">Check Result</p>
                            </div>
                        </a>

                        <a href="https://www.subodhpgcollege.com/notice_board" target="_blank" class="relative block rounded-2xl shadow-lg overflow-hidden h-72 md:h-80 group">
                            <img src="https://i.postimg.cc/d1dr7STM/pexels-cottonbro-2925303.jpg" alt="Notice board on a beach" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                            <div class="absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/90 to-transparent p-6">
                                <h2 class="text-3xl font-bold mb-2 text-white">Notification</h2>
                                <p class="text-gray-200 mb-4 opacity-100 md:opacity-0 group-hover:opacity-100 transition-opacity duration-300">Stay updated with the latest college notices and announcements.</p>
                                <p class="font-semibold text-white self-start group-hover:underline">View Notices</p>
                            </div>
                        </a>
                    </div>
                </div>
                <div id="view-more-container-study" class="text-center mt-16 mb-8">
                    <button class="view-toggle-btn" data-toggle="expand" data-controls="study-material-wrapper" data-view-more-text="View More" data-view-less-text="View Less">View More</button>
                </div>
            </div>
        </div>
    </section>

    <!-- REDESIGNED: HOW IT WORKS SECTION -->
    <section id="how-it-works" class="py-16 bg-gray-50 px-4">
        <div class="max-w-5xl mx-auto">
            <!-- New Trading, Simplified Card -->
            <div id="trading-simplified-card" class="mb-16">
                 <h2 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-2">Trading, Simplified: Smarter, Faster, Better.</h2>
                 <p class="text-md md:text-lg text-gray-600">Step into a smarter way to exchange. Weâ€™ve streamlined the entire process, connecting you with campus peers to buy and sell with confidence and ease. Itâ€™s more than a marketplaceâ€”itâ€™s your community-powered Business Center.</p>
                 <div class="mt-4 text-right">
                    <!-- This button now controls the steps below -->
                    <button class="view-toggle-btn" data-toggle="expand" data-controls="how-it-works-steps-wrapper" data-view-more-text="View Steps" data-view-less-text="Hide Steps">View Steps</button>
                 </div>
            </div>
            
            <!-- Wrapper for the expandable steps -->
            <div id="how-it-works-steps-wrapper" class="expandable-content-wrapper">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-8 pt-8">
                    <div class="step-box-apple text-center flex flex-col items-center">
                        <div class="flex items-center justify-center w-20 h-20 bg-blue-100 rounded-full mb-4 shadow-sm border-2 border-white">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600"><path d="M12 2a3 3 0 0 0-3 3v2a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><path d="M14 19v3"/><path d="M10 19v3"/><path d="M12 19v3"/></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">1. List Your Item</h3>
                        <p class="text-gray-600">Snap a photo, set a price, and post your used book or essential in seconds.</p>
                    </div>
                    <div class="step-box-apple text-center flex flex-col items-center">
                        <div class="flex items-center justify-center w-20 h-20 bg-red-100 rounded-full mb-4 shadow-sm border-2 border-white">
                            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-red-600"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">2. Find & Order</h3>
                        <p class="text-gray-600">Browse listings, find what you need, and place your order securely through the platform.</p>
                    </div>
                    <div class="step-box-apple text-center flex flex-col items-center">
                        <div class="flex items-center justify-center w-20 h-20 bg-orange-100 rounded-full mb-4 shadow-sm border-2 border-white">
                             <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-orange-600"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">3. Meet on Campus</h3>
                        <p class="text-gray-600">The seller hands the item to our campus rep, who ensures a safe, free, and fast delivery to you.</p>
                    </div>
                    <div class="step-box-apple text-center flex flex-col items-center">
                        <div class="flex items-center justify-center w-20 h-20 bg-green-100 rounded-full mb-4 shadow-sm border-2 border-white">
                             <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-600"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">4. Get Paid</h3>
                        <p class="text-gray-600">Once the buyer confirms receipt, payment is released to the seller. Simple, secure, and fair for all.</p>
                    </div>
                </div>
                <!-- NEW: Hide Steps button at the bottom -->
                <div class="text-center mt-8 pt-4">
                    <button class="view-toggle-btn" data-toggle="expand" data-controls="how-it-works-steps-wrapper" data-view-more-text="View Steps" data-view-less-text="Hide Steps">Hide Steps</button>
                </div>
            </div>
        </div>
    </section>

    <section id="gamification" class="py-16 bg-white px-4 relative">
        <div class="max-w-4xl mx-auto text-center relative">
            <svg xmlns="http://www.w3.org/2000/svg" width="0.48" height="0.48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mx-auto text-blue-500 mb-4"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path></svg>
            <div class="masking-container">
                <h2 class="masked-text text-4xl md:text-5xl font-extrabold mb-4 logo-font">Join the Leaderboard!</h2>
            </div>
            
            <!-- Header with Profile Icon -->
            <div class="flex items-center justify-center gap-2 mb-10 max-w-2xl mx-auto">
                <p class="text-lg text-gray-600">Our Top Donors</p>
                <!-- Profile Icon Button -->
                <button onclick="showProfileModalNexbook('YOU', 5, 'Royal Supporter', 14, event)" title="Your Profile" class="rounded-full hover:opacity-80 transition-all duration-300 shadow-md hover:shadow-lg relative w-8 h-8 md:w-10 md:h-10">
                    <img id="main-profile-img-nexbook" src="https://placehold.co/40x40/4f46e5/ffffff?text=YOU" alt="Your Profile" class="w-full h-full rounded-full object-cover">
                    <div id="main-profile-loader-nexbook" class="loader-nexbook loader-hidden-nexbook" style="width: 20px; height: 20px; margin-top: -10px; margin-left: -10px;"></div>
                </button>
            </div>
            
            <!-- Leaderboard Content -->
            <div id="content-month-nexbook" class="w-full" role="tabpanel">
                
                <!-- Top 3 Players - Monthly -->
                <section id="top-3-section-nexbook" class="w-full max-w-6xl mb-12 md:mb-16 mx-auto">
                    <div class="grid grid-cols-3 gap-2 md:gap-4 items-end">
                        
                        <!-- Rank 2: Ananya Choudhary -->
                        <div onclick="showProfileModalNexbook('Ananya Choudhary', 32, 'King', 2, event)" class="rounded-xl p-2 pt-4 md:p-4 md:pt-6 transition-all duration-300 hover:shadow-2xl hover:shadow-brand-king/20 hover:-translate-y-2 relative flex flex-col items-center order-1 md:order-1 md:mt-8 cursor-pointer drop-shadow-silver">
                            <div class="absolute -top-3 md:-top-6 drop-shadow-silver">
                                <svg class="w-8 h-8 md:w-14 md:h-14 text-brand-king" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5m14 3c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-1h14v1z"></path>
                                </svg>
                            </div>
                            <img src="https://placehold.co/100x100/7c2d12/fb923c?text=AC" alt="Donor Avatar" class="w-10 h-10 md:w-16 md:h-16 rounded-full border-4 border-brand-king/80 mb-2">
                            <h3 class="text-sm md:text-xl font-bold text-gray-800 font-playfair">Ananya Choudhary</h3>
                            <p class="text-base md:text-2xl font-black text-brand-king mt-1 font-playfair">King</p>
                            <p class="text-sm md:text-xl font-light text-indigo-600 mt-2"><span data-target="32" class="counter-val-nexbook">0</span> <span class="text-xs md:text-base font-light">Books</span></p>
                            <p class="text-xs md:text-sm font-medium text-green-600 mt-1">â†‘ 1</p>
                            <span class="text-[10px] md:text-xs mt-1 bg-gray-200 text-gray-700 font-medium px-1.5 py-0.5 md:px-2 rounded-full">New Donor</span>
                        </div>

                        <!-- Rank 1: Aarav Sharma -->
                        <div onclick="showProfileModalNexbook('Aarav Sharma', 45, 'Emperor', 1, event)" class="rounded-xl p-2 pt-5 md:p-5 md:pt-8 transition-all duration-300 hover:shadow-2xl hover:shadow-brand-emperor/20 hover:-translate-y-3 relative flex flex-col items-center order-2 md:order-2 z-10 cursor-pointer drop-shadow-gold">
                            <div class="absolute -top-4 md:-top-8 drop-shadow-gold">
                                <svg class="w-10 h-10 md:w-16 md:h-16 text-brand-emperor" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5m14 3c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-1h14v1z"></path>
                                </svg>
                            </div>
                            <img src="https://placehold.co/120x120/714b1b/fde047?text=AS" alt="Donor Avatar" class="w-12 h-12 md:w-20 md:h-20 rounded-full border-4 border-brand-emperor/80 mb-3">
                            <h3 class="text-sm md:text-2xl font-bold text-black font-playfair">Aarav Sharma</h3>
                            <p class="text-lg md:text-3xl font-black text-brand-emperor mt-1 font-playfair">Emperor</p>
                            <p class="text-base md:text-2xl font-light text-indigo-600 mt-3"><span data-target="45" class="counter-val-nexbook">0</span> <span class="text-xs md:text-lg font-light">Books</span></p>
                            <p class="text-xs md:text-base font-medium text-green-600 mt-1">â†‘ 1</p>
                            <span class="text-[10px] md:text-xs mt-1 bg-red-500 text-white font-medium px-1.5 py-0.5 md:px-2 rounded-full">ðŸ”¥ 5mo</span>
                        </div>

                        <!-- Rank 3: Rohit Meena -->
                        <div onclick="showProfileModalNexbook('Rohit Meena', 28, 'Crown Prince', 3, event)" class="rounded-xl p-2 pt-4 md:p-4 md:pt-6 transition-all duration-300 hover:shadow-2xl hover:shadow-brand-prince/20 hover:-translate-y-2 relative flex flex-col items-center order-3 md:order-3 md:mt-8 cursor-pointer drop-shadow-bronze">
                            <div class="absolute -top-3 md:-top-6 drop-shadow-bronze">
                                <svg class="w-8 h-8 md:w-14 md:h-14 text-brand-prince" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5m14 3c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-1h14v1z"></path>
                                </svg>
                            </div>
                            <img src="https://placehold.co/100x100/4a5568/e2e8f0?text=RM" alt="Donor Avatar" class="w-10 h-10 md:w-16 md:h-16 rounded-full border-4 border-brand-prince/80 mb-2">
                            <h3 class="text-sm md:text-xl font-bold text-gray-800 font-playfair">Rohit Meena</h3>
                            <p class="text-base md:text-2xl font-black text-brand-prince mt-1 font-playfair">Crown Prince</p>
                            <p class="text-sm md:text-xl font-light text-indigo-600 mt-2"><span data-target="28" class="counter-val-nexbook">0</span> <span class="text-xs md:text-base font-light">Books</span></p>
                            <p class="text-xs md:text-sm font-medium text-red-600 mt-1">â†“ 1</p>
                            <span class="text-[10px] md:text-xs mt-1 bg-red-500 text-white font-medium px-1.5 py-0.5 md:px-2 rounded-full">ðŸ”¥ 3mo</span>
                        </div>
                    </div>
                </section>

                <!-- View More Button -->
                <div id="view-more-container-nexbook" class="w-full flex justify-center mt-6">
                    <button onclick="showFullListNexbook()" class="glass-card rounded-lg px-6 py-3 text-lg font-medium text-indigo-600 hover:bg-white/60 transition-all shadow-md hover:shadow-lg">
                        View More
                    </button>
                </div>

            </div>

            <!-- Full Donor List (Hidden by default) -->
            <section id="full-donor-list-nexbook" class="w-full max-w-5xl mx-auto hidden">
                <!-- Go Back Button -->
                <div class="w-full flex justify-center mb-6">
                    <button onclick="showTop3Nexbook()" class="glass-card rounded-lg px-6 py-3 text-lg font-medium text-gray-700 hover:bg-white/60 transition-all shadow-md hover:shadow-lg">
                        â† Go Back
                    </button>
                </div>
                
                <!-- List Header -->
                <div class="hidden md:grid grid-cols-12 gap-4 px-4 mb-3 text-sm font-semibold uppercase text-gray-500">
                    <div class="md:col-span-1">Rank</div>
                    <div class="md:col-span-5">Donor</div>
                    <div class="md:col-span-3 text-right">Books</div>
                    <div class="md:col-span-3 text-right">Score & Activity</div>
                </div>

                <!-- Player Rows (Vertical) -->
                <div class="space-y-3">
                    
                    <!-- Rank 1: Aarav Sharma -->
                    <div onclick="showProfileModalNexbook('Aarav Sharma', 45, 'Emperor', 1, event)" class="glass-card rounded-lg p-3 md:p-4 grid grid-cols-12 gap-4 items-center transition-all duration-300 hover:bg-white/60 hover:scale-[1.02] hover:shadow-blue cursor-pointer">
                        <div class="col-span-1 text-xl font-bold text-gray-500">#1</div>
                        <div class="col-span-8 md:col-span-5 flex items-center gap-3">
                            <img src="https://placehold.co/120x120/714b1b/fde047?text=AS" alt="Player Avatar" class="w-10 h-10 rounded-full">
                            <div class="flex flex-col">
                                <span class="text-lg font-medium">Aarav Sharma</span>
                                <div class="flex flex-wrap gap-1 mt-1">
                                    <span class="text-xs bg-gradient-to-r from-yellow-400 to-amber-500 text-white font-medium px-2 py-0.5 rounded-full">ðŸ¥‡ Emperor</span>
                                    <span class="text-xs bg-red-500 text-white font-medium px-2 py-0.5 rounded-full">ðŸ”¥ 5mo</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-span-3 md:col-span-3 text-right">
                            <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Books</span>
                            <p class="text-xl font-bold text-indigo-600"><span data-target="45" class="counter-val-nexbook">0</span></p>
                        </div>
                        
                        <!-- Score & Activity -->
                        <div class="col-span-12 md:col-span-3 text-left md:text-right mt-2 md:mt-0">
                            <div class="md:mb-1">
                                <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Score</span>
                                <p class="text-xl font-light text-gray-600"><span data-target="500" class="counter-val-nexbook">0</span></p>
                            </div>
                            <div class="mt-2 md:mt-0 flex justify-start md:justify-end items-center">
                                <span class="text-sm uppercase text-gray-500 md:hidden mr-2 font-semibold">Activity</span>
                                <svg viewBox="0 0 100 30" class="w-48 md:w-24 h-8">
                                    <path class="sparkline-path-nexbook" style="--path-length: 103" d="M 0 28 L 20 25 L 40 20 L 60 18 L 80 10 L 100 5" fill="none" stroke="#16a34a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Rank 2: Ananya Choudhary -->
                    <div onclick="showProfileModalNexbook('Ananya Choudhary', 32, 'King', 2, event)" class="glass-card rounded-lg p-3 md:p-4 grid grid-cols-12 gap-4 items-center transition-all duration-300 hover:bg-white/60 hover:scale-[1.02] hover:shadow-blue cursor-pointer">
                        <div class="col-span-1 text-xl font-bold text-gray-500">#2</div>
                        <div class="col-span-8 md:col-span-5 flex items-center gap-3">
                            <img src="https://placehold.co/100x100/7c2d12/fb923c?text=AC" alt="Player Avatar" class="w-10 h-10 rounded-full">
                            <div class="flex flex-col">
                                <span class="text-lg font-medium">Ananya Choudhary</span>
                                <div class="flex flex-wrap gap-1 mt-1">
                                    <span class="text-xs bg-gradient-to-r from-gray-400 to-gray-500 text-white font-medium px-2 py-0.5 rounded-full">ðŸ¥ˆ King</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-span-3 md:col-span-3 text-right">
                            <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Books</span>
                            <p class="text-xl font-bold text-indigo-600"><span data-target="32" class="counter-val-nexbook">0</span></p>
                        </div>

                        <!-- Score & Activity -->
                        <div class="col-span-12 md:col-span-3 text-left md:text-right mt-2 md:mt-0">
                            <div class="md:mb-1">
                                <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Score</span>
                                <p class="text-xl font-light text-gray-600"><span data-target="410" class="counter-val-nexbook">0</span></p>
                            </div>
                            <div class="mt-2 md:mt-0 flex justify-start md:justify-end items-center">
                                <span class="text-sm uppercase text-gray-500 md:hidden mr-2 font-semibold">Activity</span>
                                <svg viewBox="0 0 100 30" class="w-48 md:w-24 h-8">
                                    <path class="sparkline-path-nexbook" style="--path-length: 100" d="M 0 20 L 20 18 L 40 20 L 60 15 L 80 10 L 100 12" fill="none" stroke="#4f46e5" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Rank 3: Rohit Meena -->
                    <div onclick="showProfileModalNexbook('Rohit Meena', 28, 'Crown Prince', 3, event)" class="glass-card rounded-lg p-3 md:p-4 grid grid-cols-12 gap-4 items-center transition-all duration-300 hover:bg-white/60 hover:scale-[1.02] hover:shadow-blue cursor-pointer">
                        <div class="col-span-1 text-xl font-bold text-gray-500">#3</div>
                        <div class="col-span-8 md:col-span-5 flex items-center gap-3">
                            <img src="https://placehold.co/100x100/4a5568/e2e8f0?text=RM" alt="Player Avatar" class="w-10 h-10 rounded-full">
                            <div class="flex flex-col">
                                <span class="text-lg font-medium">Rohit Meena</span>
                                <div class="flex flex-wrap gap-1 mt-1">
                                    <span class="text-xs bg-gradient-to-r from-yellow-600 to-amber-700 text-white font-medium px-2 py-0.5 rounded-full">ðŸ¥‰ Crown Prince</span>
                                    <span class="text-xs bg-red-500 text-white font-medium px-2 py-0.5 rounded-full">ðŸ”¥ 3mo</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-span-3 md:col-span-3 text-right">
                            <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Books</span>
                            <p class="text-xl font-bold text-indigo-600"><span data-target="28" class="counter-val-nexbook">0</span></p>
                        </div>
                        
                        <!-- Score & Activity -->
                        <div class="col-span-12 md:col-span-3 text-left md:text-right mt-2 md:mt-0">
                            <div class="md:mb-1">
                                <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Score</span>
                                <p class="text-xl font-light text-gray-600"><span data-target="350" class="counter-val-nexbook">0</span></p>
                            </div>
                            <div class="mt-2 md:mt-0 flex justify-start md:justify-end items-center">
                                <span class="text-sm uppercase text-gray-500 md:hidden mr-2 font-semibold">Activity</span>
                                <svg viewBox="0 0 100 30" class="w-48 md:w-24 h-8">
                                    <path class="sparkline-path-nexbook" style="--path-length: 103" d="M 0 28 L 20 25 L 40 20 L 60 18 L 80 10 L 100 5" fill="none" stroke="#16a34a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Rank 4: Tanisha Singh -->
                    <div onclick="showProfileModalNexbook('Tanisha Singh', 25, 'Emperor', 4, event)" class="glass-card rounded-lg p-3 md:p-4 grid grid-cols-12 gap-4 items-center transition-all duration-300 hover:bg-white/60 hover:scale-[1.02] hover:shadow-blue cursor-pointer">
                        <div class="col-span-1 text-xl font-bold text-gray-500">#4</div>
                        <div class="col-span-8 md:col-span-5 flex items-center gap-3">
                            <img src="https://placehold.co/40x40/1e293b/94a3b8?text=TS" alt="Player Avatar" class="w-10 h-10 rounded-full">
                            <div class="flex flex-col">
                                <span class="text-lg font-medium">Tanisha Singh</span>
                                <div class="flex flex-wrap gap-1 mt-1">
                                    <span class="text-xs bg-gradient-to-r from-yellow-400 to-amber-500 text-white font-medium px-2 py-0.5 rounded-full">ðŸ¥‡ Emperor</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-span-3 md:col-span-3 text-right">
                            <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Books</span>
                            <p class="text-xl font-bold text-indigo-600"><span data-target="25" class="counter-val-nexbook">0</span></p>
                        </div>

                        <!-- Score & Activity -->
                        <div class="col-span-12 md:col-span-3 text-left md:text-right mt-2 md:mt-0">
                            <div class="md:mb-1">
                                <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Score</span>
                                <p class="text-xl font-light text-gray-600"><span data-target="300" class="counter-val-nexbook">0</span></p>
                            </div>
                            <div class="mt-2 md:mt-0 flex justify-start md:justify-end items-center">
                                <span class="text-sm uppercase text-gray-500 md:hidden mr-2 font-semibold">Activity</span>
                                <svg viewBox="0 0 100 30" class="w-48 md:w-24 h-8">
                                    <path class="sparkline-path-nexbook" style="--path-length: 100" d="M 0 20 L 20 18 L 40 20 L 60 15 L 80 10 L 100 12" fill="none" stroke="#4f46e5" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Rank 5: Riddhi Gupta -->
                    <div onclick="showProfileModalNexbook('Riddhi Gupta', 20, 'Emperor', 5, event)" class="glass-card rounded-lg p-3 md:p-4 grid grid-cols-12 gap-4 items-center transition-all duration-300 hover:bg-white/60 hover:scale-[1.02] hover:shadow-blue cursor-pointer">
                        <div class="col-span-1 text-xl font-bold text-gray-500">#5</div>
                        <div class="col-span-8 md:col-span-5 flex items-center gap-3">
                            <img src="https://placehold.co/40x40/1e293b/94a3b8?text=RG" alt="Player Avatar" class="w-10 h-10 rounded-full">
                            <div class="flex flex-col">
                                <span class="text-lg font-medium">Riddhi Gupta</span>
                                <div class="flex flex-wrap gap-1 mt-1">
                                    <span class="text-xs bg-gradient-to-r from-yellow-400 to-amber-500 text-white font-medium px-2 py-0.5 rounded-full">ðŸ¥‡ Emperor</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-span-3 md:col-span-3 text-right">
                            <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Books</span>
                            <p class="text-xl font-bold text-indigo-600"><span data-target="20" class="counter-val-nexbook">0</span></p>
                        </div>

                        <!-- Score & Activity -->
                        <div class="col-span-12 md:col-span-3 text-left md:text-right mt-2 md:mt-0">
                            <div class="md:mb-1">
                                <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Score</span>
                                <p class="text-xl font-light text-gray-600"><span data-target="295" class="counter-val-nexbook">0</span></p>
                            </div>
                            <div class="mt-2 md:mt-0 flex justify-start md:justify-end items-center">
                                <span class="text-sm uppercase text-gray-500 md:hidden mr-2 font-semibold">Activity</span>
                                <svg viewBox="0 0 100 30" class="w-48 md:w-24 h-8">
                                    <path class="sparkline-path-nexbook" style="--path-length: 103" d="M 0 28 L 20 25 L 40 20 L 60 18 L 80 10 L 100 5" fill="none" stroke="#16a34a" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Rank 14: YOU -->
                    <div onclick="showProfileModalNexbook('YOU', 5, 'Royal Supporter', 14, event)" class="glass-card rounded-lg p-3 md:p-4 grid grid-cols-12 gap-4 items-center transition-all duration-300 scale-[1.02] shadow-blue border-indigo-500/50 bg-indigo-100/50 cursor-pointer">
                        <div class="col-span-1 text-xl font-bold text-indigo-700">#14</div>
                        <div class="col-span-8 md:col-span-5 flex items-center gap-3">
                            <img id="list-profile-img-you-nexbook" src="https://placehold.co/40x40/4f46e5/ffffff?text=YOU" alt="Player Avatar" class="w-10 h-10 rounded-full">
                            <div class="flex flex-col">
                                <span class="text-lg font-bold text-black">YOU</span>
                                <div class="flex flex-wrap gap-1 mt-1">
                                    <span class="text-xs bg-indigo-100 text-indigo-700 font-medium px-2 py-0.5 rounded-full">Royal Supporter</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-span-3 md:col-span-3 text-right">
                            <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Books</span>
                            <p class="text-xl font-bold text-indigo-600"><span data-target="5" class="counter-val-nexbook">0</span></p>
                        </div>

                        <!-- Score & Activity -->
                        <div class="col-span-12 md:col-span-3 text-left md:text-right mt-2 md:mt-0">
                            <div class="md:mb-1">
                                <span class="text-sm uppercase text-gray-500 md:hidden font-semibold">Score</span>
                                <p class="text-xl font-light text-gray-600"><span data-target="40" class="counter-val-nexbook">0</span></p>
                            </div>
                            <div class="mt-2 md:mt-0 flex justify-start md:justify-end items-center">
                                <span class="text-sm uppercase text-gray-500 md:hidden mr-2 font-semibold">Activity</span>
                                <svg viewBox="0 0 100 30" class="w-48 md:w-24 h-8">
                                    <path class="sparkline-path-nexbook" style="--path-length: 101" d="M 0 20 L 20 20 L 40 20 L 60 20 L 80 20 L 100 15" fill="none" stroke="#888" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </div>
                    </div>

                </div>
            </section>
            
        </div>
    </section>
    
    <script>
        // Leaderboard Global Functions - Defined early for onclick handlers
        
        // Scroll Position Save/Restore for Modal
        let savedScrollYNexbook = 0;
        
        // Badge Logic
        const badgesNexbook = [
            { name: "Royal Supporter", min: 1, color: "gray" },
            { name: "Crown Prince", min: 10, color: "yellow" },
            { name: "King", min: 15, color: "gray" },
            { name: "Emperor", min: 20, color: "yellow" },
            { name: "Legend", min: 50, color: "purple" }
        ];

        function getBadgeInfoNexbook(books) {
            let currentBadge = { name: "New Donor", min: 0 };
            let nextBadge = badgesNexbook[0];

            for (let i = badgesNexbook.length - 1; i >= 0; i--) {
                if (books >= badgesNexbook[i].min) {
                    currentBadge = badgesNexbook[i];
                    nextBadge = (i + 1 < badgesNexbook.length) ? badgesNexbook[i+1] : null; 
                    break;
                }
            }
            if (books === 0) nextBadge = badgesNexbook[0];
            return { currentBadge, nextBadge };
        }

        // Mock Data
        const mockHistoryNexbook = {
            "YOU": [
                { qty: 3, date: "Nov 10, 2025" },
                { qty: 2, date: "Nov 2, 2025" },
            ],
            "Aarav Sharma": [
                { qty: 20, date: "Nov 14, 2025" },
                { qty: 15, date: "Nov 8, 2025" },
                { qty: 10, date: "Nov 1, 2025" },
            ],
            "Ananya Choudhary": [
                { qty: 32, date: "Nov 12, 2025" },
            ],
            "Rohit Meena": [
                { qty: 18, date: "Nov 8, 2025" },
                { qty: 10, date: "Nov 3, 2025" },
            ],
            "Tanisha Singh": [
                { qty: 15, date: "Nov 10, 2025" },
                { qty: 10, date: "Nov 2, 2025" },
            ],
            "Riddhi Gupta": [
                { qty: 20, date: "Nov 13, 2025" },
            ]
        };
        
        const mockMessagesNexbook = {
            "Aarav Sharma": "Every book is a new world. Keep donating! ðŸ“š",
            "Ananya Choudhary": "Khushi milti hai is nek kaam mein hissa lekar! ðŸ˜Š",
            "Rohit Meena": "Chalo, milkar badlaav laayein. Har kitaab se farak padta hai.",
            "Tanisha Singh": "Reading is my superpower!",
            "Riddhi Gupta": "Let's aim for the top! ðŸš€"
        };

        const mockGraphDataNexbook = {
            "Aarav Sharma": [10, 20, 15, 30, 25, 45],
            "Ananya Choudhary": [5, 15, 10, 8, 20, 32],
            "Rohit Meena": [0, 0, 5, 10, 15, 28],
            "Tanisha Singh": [5, 5, 10, 15, 20, 25],
            "Riddhi Gupta": [0, 0, 0, 5, 10, 20],
            "Default": [1, 2, 1, 3, 2, 4]
        };

        let donationChartNexbook = null;
        let observerNexbook = null;

        // List Toggle Functions
        function showFullListNexbook() {
            event.preventDefault();
            event.stopPropagation();
            
            document.getElementById('top-3-section-nexbook').classList.add('hidden');
            document.getElementById('view-more-container-nexbook').classList.add('hidden');
            document.getElementById('full-donor-list-nexbook').classList.remove('hidden');
            
            // Scroll to gamification section
            const section = document.getElementById('gamification');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            runAllCountersNexbook(true);
        }
        
        function showTop3Nexbook() {
            event.preventDefault();
            event.stopPropagation();
            
            document.getElementById('top-3-section-nexbook').classList.remove('hidden');
            document.getElementById('view-more-container-nexbook').classList.remove('hidden');
            document.getElementById('full-donor-list-nexbook').classList.add('hidden');
            
            // Scroll to gamification section
            const section = document.getElementById('gamification');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            runAllCountersNexbook(false);
        }

        // Modal Functions
        function showProfileModalNexbook(name, books, badgeName, rank, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            // CRITICAL FIX: Save scroll position AND prevent scroll jump
            savedScrollYNexbook = window.scrollY;
            
            // Freeze body scroll BEFORE showing modal
            document.body.style.position = 'fixed';
            document.body.style.top = `-${savedScrollYNexbook}px`;
            document.body.style.left = '0';
            document.body.style.right = '0';
            document.body.style.width = '100%';
            
            const modalNexbook = document.getElementById('profile-modal-nexbook');
            const modalName = document.getElementById('modal-name-nexbook');
            const modalBadge = document.getElementById('modal-badge-nexbook');
            const modalAvatar = document.getElementById('modal-avatar-nexbook');
            const avatarUploadSection = document.getElementById('avatar-upload-section-nexbook');
            const goalText = document.getElementById('modal-goal-text-nexbook');
            const goalProgressText = document.getElementById('modal-goal-progress-text-nexbook');
            const progressBar = document.getElementById('modal-progress-bar-nexbook');
            const goalRemaining = document.getElementById('modal-goal-remaining-nexbook');
            const historyList = document.getElementById('modal-history-list-nexbook');
            const bioSection = document.getElementById('modal-bio-section-nexbook');
            const bioLocked = document.getElementById('modal-bio-locked-nexbook');
            const bioUnlocked = document.getElementById('modal-bio-unlocked-nexbook');
            const bioText = document.getElementById('modal-bio-text-nexbook');

            modalName.innerText = name;
            modalBadge.innerText = badgeName;
            
            // Handle YOU profile special cases
            if (name === 'YOU') {
                // Load avatar from localStorage or use default
                const savedAvatar = localStorage.getItem('userAvatarUrlNexbook');
                if (savedAvatar) {
                    modalAvatar.src = savedAvatar;
                } else {
                    modalAvatar.src = `https://ui-avatars.com/api/?name=YOU&background=6366f1&color=fff&size=128`;
                }
                
                // Show upload section and make avatar clickable
                if (avatarUploadSection) {
                    avatarUploadSection.classList.remove('hidden');
                }
                modalAvatar.classList.add('cursor-pointer', 'hover:opacity-80', 'transition-opacity');
                modalAvatar.onclick = triggerAvatarUploadNexbook;
            } else {
                // Set Avatar for other users
                const avatarText = name.split(' ').map(n => n[0]).join('').substring(0,2);
                let avatarColor = "1e293b/94a3b8"; 
                if(name === "Aarav Sharma") avatarColor = "714b1b/fde047";
                if(name === "Ananya Choudhary") avatarColor = "7c2d12/fb923c";
                if(name === "Rohit Meena") avatarColor = "4a5568/e2e8f0";
                if(name === "Tanisha Singh") avatarColor = "1e293b/94a3b8";
                if(name === "Riddhi Gupta") avatarColor = "1e293b/94a3b8";
                
                modalAvatar.src = `https://placehold.co/80x80/${avatarColor}?text=${avatarText}`;
                
                // Hide upload section and make avatar not clickable
                if (avatarUploadSection) {
                    avatarUploadSection.classList.add('hidden');
                }
                modalAvatar.classList.remove('cursor-pointer', 'hover:opacity-80', 'transition-opacity');
                modalAvatar.onclick = null;
            }

            // Calculate Goal
            const { currentBadge, nextBadge } = getBadgeInfoNexbook(books);
            modalBadge.innerText = currentBadge.name;

            if (nextBadge) {
                const progressBooks = books;
                const targetBooks = nextBadge.min;
                const percent = Math.max(0, (progressBooks / targetBooks) * 100);
                const remaining = nextBadge.min - books;

                goalText.innerText = `Next: ${nextBadge.name} (${targetBooks} books)`;
                goalProgressText.innerText = `${progressBooks} / ${targetBooks}`;
                progressBar.style.width = `${percent}%`;
                goalRemaining.innerText = (remaining > 0) ? `You need to donate ${remaining} more books!` : `You've completed this goal!`;
            } else {
                goalText.innerText = "You've achieved the highest badge!";
                goalProgressText.innerText = `${books} Books`;
                progressBar.style.width = '100%';
                goalRemaining.innerText = "You're a superstar! ðŸŽ‰";
            }

            // Populate History
            historyList.innerHTML = ""; 
            const history = mockHistoryNexbook[name] || [{ qty: books, date: "N/A" }];
            if(history.length === 0 || (history.length === 1 && history[0].date === "N/A")) {
                historyList.innerHTML = `<li class="text-gray-500 history-li-nexbook" style="animation-delay: 200ms;">No history for this month.</li>`;
            } else {
                history.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.className = "flex justify-between items-center text-gray-600 p-2 bg-gray-50 rounded-lg history-li-nexbook";
                    li.style.animationDelay = `${(index * 100) + 200}ms`;
                    li.innerHTML = `
                        <span>${item.qty} books</span>
                        <span class="text-sm font-medium text-gray-500">${item.date}</span>
                    `;
                    historyList.appendChild(li);
                });
            }

            // Populate Bio/Message
            if (rank <= 5) {
                bioSection.style.display = 'block';
                bioLocked.style.display = 'none';
                bioUnlocked.style.display = 'block';
                
                const message = mockMessagesNexbook[name] || "This donor hasn't set a message yet.";
                bioText.innerText = message;
            } else {
                bioSection.style.display = 'block';
                bioLocked.style.display = 'block';
                bioUnlocked.style.display = 'none';
            }

            // Show modal
            modalNexbook.classList.add('modal-visible-nexbook');
            document.body.classList.add('body-no-scroll-nexbook');

            // Delay chart creation
            setTimeout(() => {
                const chartCanvas = document.getElementById('modal-donation-chart-nexbook');
                const graphData = mockGraphDataNexbook[name] || mockGraphDataNexbook["Default"];

                if (donationChartNexbook) {
                    donationChartNexbook.destroy();
                }

                if (typeof Chart !== 'undefined') {
                    donationChartNexbook = new Chart(chartCanvas, {
                        type: 'line',
                        data: {
                            labels: ['Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov'],
                            datasets: [{
                                label: 'Books Donated',
                                data: graphData,
                                fill: true,
                                backgroundColor: 'rgba(79, 70, 229, 0.1)',
                                borderColor: 'rgba(79, 70, 229, 1)',
                                borderWidth: 2,
                                tension: 0.3,
                                pointBackgroundColor: 'rgba(79, 70, 229, 1)',
                            }]
                        },
                        options: {
                            animation: {
                                duration: 2000,
                                delay: 100,
                                easing: 'easeOutQuart'
                            },
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: { beginAtZero: true, ticks: { precision: 0 } },
                                x: { grid: { display: false } }
                            },
                            plugins: {
                                legend: { display: false }
                            }
                        }
                    });
                }
            }, 100);
        }

        function hideProfileModalNexbook(event) {
            const modalNexbook = document.getElementById('profile-modal-nexbook');
            if (event && event.target !== modalNexbook.querySelector('.modal-backdrop-nexbook') && event.target !== modalNexbook) {
                return;
            }
            modalNexbook.classList.remove('modal-visible-nexbook');
            document.body.classList.remove('body-no-scroll-nexbook');
            
            // CRITICAL FIX: Restore body scroll perfectly
            const scrollY = savedScrollYNexbook;
            document.body.style.position = '';
            document.body.style.top = '';
            document.body.style.left = '';
            document.body.style.right = '';
            document.body.style.width = '';
            
            // Restore scroll to exact position instantly
            window.scrollTo({
                top: scrollY,
                left: 0,
                behavior: 'instant'
            });
        }

        // Avatar Upload Functions
        function triggerAvatarUploadNexbook() {
            const fileInput = document.getElementById('avatar-upload-input-nexbook');
            if (fileInput) {
                fileInput.click();
            }
        }

        async function uploadImageNexbook(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Validate file type
            if (!file.type.startsWith('image/')) {
                alert('Please select an image file');
                return;
            }

            // Validate file size (max 5MB)
            if (file.size > 5 * 1024 * 1024) {
                alert('Image size should be less than 5MB');
                return;
            }

            const statusElement = document.getElementById('avatar-upload-status-nexbook');
            const modalAvatar = document.getElementById('modal-avatar-nexbook');
            const mainProfileImg = document.getElementById('main-profile-img-nexbook');
            const listProfileImg = document.getElementById('list-profile-img-you-nexbook');
            const modalLoader = document.getElementById('modal-avatar-loader-nexbook');
            const mainLoader = document.getElementById('main-profile-loader-nexbook');

            try {
                // Show loaders
                if (modalLoader) {
                    modalLoader.classList.remove('loader-hidden-nexbook');
                    modalAvatar.classList.add('uploading-image-nexbook');
                }
                if (mainLoader) mainLoader.classList.remove('loader-hidden-nexbook');
                if (mainProfileImg) mainProfileImg.classList.add('uploading-image-nexbook');
                
                if (statusElement) {
                    statusElement.textContent = 'Uploading...';
                    statusElement.className = 'text-sm text-indigo-600 mt-2';
                }

                // Compress image
                const compressedBlob = await compressImageNexbook(file, 300);
                
                // Upload to imgbb
                const formData = new FormData();
                formData.append('image', compressedBlob);
                
                const response = await fetch('https://api.imgbb.com/1/upload?key=4322223c4efdf8f955f8b7d7be19339c', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                
                if (data.success) {
                    const imageUrl = data.data.url;
                    
                    // Update all avatar images
                    if (modalAvatar) modalAvatar.src = imageUrl;
                    if (mainProfileImg) mainProfileImg.src = imageUrl;
                    if (listProfileImg) listProfileImg.src = imageUrl;
                    
                    // Save to localStorage
                    localStorage.setItem('userAvatarUrlNexbook', imageUrl);
                    
                    if (statusElement) {
                        statusElement.textContent = 'Photo updated successfully!';
                        statusElement.className = 'text-sm text-green-600 mt-2';
                        setTimeout(() => {
                            statusElement.textContent = '';
                        }, 3000);
                    }
                } else {
                    throw new Error('Upload failed');
                }
            } catch (error) {
                console.error('Upload error:', error);
                if (statusElement) {
                    statusElement.textContent = 'Upload failed. Please try again.';
                    statusElement.className = 'text-sm text-red-600 mt-2';
                }
            } finally {
                // Hide loaders
                if (modalLoader) {
                    modalLoader.classList.add('loader-hidden-nexbook');
                    modalAvatar.classList.remove('uploading-image-nexbook');
                }
                if (mainLoader) mainLoader.classList.add('loader-hidden-nexbook');
                if (mainProfileImg) mainProfileImg.classList.remove('uploading-image-nexbook');
                
                // Reset file input
                event.target.value = '';
            }
        }

        function compressImageNexbook(file, maxWidth) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        let width = img.width;
                        let height = img.height;

                        if (width > maxWidth) {
                            height = (height * maxWidth) / width;
                            width = maxWidth;
                        }

                        canvas.width = width;
                        canvas.height = height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, width, height);

                        canvas.toBlob((blob) => {
                            resolve(blob);
                        }, file.type, 0.8);
                    };
                    img.onerror = reject;
                    img.src = e.target.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // Load saved avatar on page load
        function loadSavedAvatarNexbook() {
            const savedAvatar = localStorage.getItem('userAvatarUrlNexbook');
            if (savedAvatar) {
                const mainProfileImg = document.getElementById('main-profile-img-nexbook');
                const listProfileImg = document.getElementById('list-profile-img-you-nexbook');
                
                if (mainProfileImg) mainProfileImg.src = savedAvatar;
                if (listProfileImg) listProfileImg.src = savedAvatar;
            }
        }

        // Counter Animation
        const animateCounterNexbook = (el) => {
            const target = +el.getAttribute('data-target');
            if (el.dataset.animated === 'true' && +el.innerText.replace(/,/g, '') === target) return;
            
            el.dataset.animated = 'true';
            const duration = Math.max(1500, target / 10);
            const stepTime = 20;
            const steps = duration / stepTime;
            const increment = target / steps;
            let current = 0;
            
            const updateCounter = () => {
                current += increment;
                if (current < target) {
                    el.innerText = Math.ceil(current).toLocaleString();
                    setTimeout(updateCounter, stepTime);
                } else {
                    el.innerText = target.toLocaleString();
                }
            };
            el.innerText = '0';
            updateCounter();
        };

        function runAllCountersNexbook(fullList = false) {
            const selector = fullList ? '#full-donor-list-nexbook .glass-card' : '#top-3-section-nexbook > div > div';
            const cards = document.querySelectorAll(selector);
            
            if (observerNexbook) {
                observerNexbook.disconnect();
            }
            observerNexbook = new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('card-in-view-nexbook');
                        const countersInEntry = entry.target.querySelectorAll('.counter-val-nexbook');
                        countersInEntry.forEach(animateCounterNexbook);
                        obs.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            
            cards.forEach(card => {
                observerNexbook.observe(card);
            });
        }

        // Initialize counters and load avatars when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                runAllCountersNexbook(false);
                loadSavedAvatarNexbook();
            });
        } else {
            runAllCountersNexbook(false);
            loadSavedAvatarNexbook();
        }
    </script>
    
    <style>
        .masked-text {
            font-size: clamp(2.5rem, 8vw, 4rem); /* Responsive font size */
            font-weight: 900;
            color: transparent;
            background-image: url('https://images.unsplash.com/photo-1732535725600-f805d8b33c9c?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
            background-size: 200%; /* Enlarged for smooth animation */
            background-position: 0 50%;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: animate-background 5s infinite alternate linear;
        }

        @keyframes animate-background {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        
        /* Leaderboard Styles */
        .glass-card {
            background: rgba(255, 255, 255, 0.6); 
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }
        
        .font-playfair {
            font-family: 'Playfair Display', serif;
        }
        
        .drop-shadow-gold {
            filter: drop-shadow(0 0 20px rgba(250, 204, 21, 0.7));
        }
        
        .drop-shadow-silver {
            filter: drop-shadow(0 0 20px rgba(156, 163, 175, 0.7));
        }
        
        .drop-shadow-bronze {
            filter: drop-shadow(0 0 20px rgba(202, 138, 4, 0.7));
        }
        
        .drop-shadow-blue {
            filter: drop-shadow(0 0 15px rgba(59, 130, 246, 0.4));
        }
        
        .sparkline-path-nexbook {
            stroke-dasharray: var(--path-length);
            stroke-dashoffset: var(--path-length);
        }
        
        .card-in-view-nexbook .sparkline-path-nexbook {
            animation: draw-sparkline-nexbook 1.5s 0.3s ease-out forwards;
        }
        
        @keyframes draw-sparkline-nexbook {
            to {
                stroke-dashoffset: 0;
            }
        }
        
        :root {
            --brand-emperor: #facc15;
            --brand-king: #9ca3af;
            --brand-prince: #ca8a04;
        }
        
        .border-brand-emperor {
            border-color: var(--brand-emperor);
        }
        
        .border-brand-emperor\/50 {
            border-color: rgba(250, 204, 21, 0.5);
        }
        
        .border-brand-king {
            border-color: var(--brand-king);
        }
        
        .border-brand-king\/50 {
            border-color: rgba(156, 163, 175, 0.5);
        }
        
        .border-brand-prince {
            border-color: var(--brand-prince);
        }
        
        .border-brand-prince\/50 {
            border-color: rgba(202, 138, 4, 0.5);
        }
        
        .text-brand-emperor {
            color: var(--brand-emperor);
        }
        
        .text-brand-king {
            color: var(--brand-king);
        }
        
        .text-brand-prince {
            color: var(--brand-prince);
        }
        
        .hover\:shadow-brand-emperor\/20:hover {
            box-shadow: 0 25px 50px -12px rgba(250, 204, 21, 0.2);
        }
        
        .hover\:shadow-brand-king\/20:hover {
            box-shadow: 0 25px 50px -12px rgba(156, 163, 175, 0.2);
        }
        
        .hover\:shadow-brand-prince\/20:hover {
            box-shadow: 0 25px 50px -12px rgba(202, 138, 4, 0.2);
        }
        
        .hover\:shadow-blue {
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
        }
        
        .border-brand-king\/80 {
            border-color: rgba(156, 163, 175, 0.8);
        }
        
        .border-brand-emperor\/80 {
            border-color: rgba(250, 204, 21, 0.8);
        }
        
        .border-brand-prince\/80 {
            border-color: rgba(202, 138, 4, 0.8);
        }
        
        /* Gamification Section Styles */
        #gamification {
            min-height: 100vh;
            position: relative;
        }
        
        #full-donor-list-nexbook {
            position: relative !important;
            transform: none !important;
            left: auto !important;
            margin-top: 0 !important;
        }
        
        /* Modal Styles for Leaderboard */
        .modal-container-nexbook {
            position: fixed;
            inset: 0;
            z-index: 99999; 
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            pointer-events: none; 
        }
        
        .modal-backdrop-nexbook {
            position: absolute;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(4px); 
            -webkit-backdrop-filter: blur(4px);
            z-index: 10;
        }
        
        .modal-content-nexbook {
            position: fixed;
            top: 50%;
            left: 50%;
            background-color: #f9fafb; 
            z-index: 20;
            border-radius: 1rem; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); 
            width: 91.666667%; 
            max-width: 32rem; 
            max-height: 90vh;
            opacity: 0;
            visibility: hidden;
            transform: translate(-50%, -50%) scale(0.95);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .body-no-scroll-nexbook {
            overflow: hidden !important;
            position: fixed;
            width: 100%;
            height: 100%;
        }
        
        .modal-visible-nexbook {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        
        .modal-visible-nexbook .modal-content-nexbook {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }
        
        .history-li-nexbook {
            opacity: 0;
            transform: translateY(10px);
        }
        
        .modal-visible-nexbook .history-li-nexbook {
            animation: fadeInUpNexbook 0.5s ease-out forwards;
        }
        
        @keyframes fadeInUpNexbook {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Loader for Avatar Upload */
        .loader-nexbook {
            border: 3px solid rgba(156, 163, 175, 0.3); 
            border-top-color: #2563eb; 
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin-nexbook 1s linear infinite;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -12px;
            margin-left: -12px;
            z-index: 10;
        }
        
        @keyframes spin-nexbook {
            to { transform: rotate(360deg); }
        }
        
        .loader-hidden-nexbook {
            display: none;
        }
        
        .uploading-image-nexbook {
            opacity: 0.5; 
        }
    </style>

    <section id="secure-chat" class="py-16 bg-gray-50 px-4"><div class="max-w-4xl mx-auto flex flex-col md:flex-row items-center gap-12">
        <div class="md:w-1/2 text-center md:text-left"><svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-500 mx-auto md:mx-0 mb-6"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
            <h2 class="text-4xl font-extrabold text-gray-900 mb-4 logo-font">Spam-Free Communication</h2>
            <p class="text-lg text-gray-600">Our secure chat system protects your privacy. Buyers send a chat request, and sellers must approve it before any conversation begins. No unwanted messages, ever.</p>
        </div>
        <div class="md:w-1/2"><div class="bg-white rounded-2xl shadow-xl overflow-hidden"><div class="p-6"><div class="space-y-4"><div class="p-3 rounded-lg bg-blue-500 text-white self-end max-w-xs ml-auto">Hey! Is the Physics book still available? <button class="font-semibold py-2 px-4 rounded-lg transition-all duration-300 flex items-center justify-center !p-0 !bg-transparent text-white/80 w-full justify-end !text-xs button-animation">Send Chat Request â†’</button></div><div class="p-3 rounded-lg bg-gray-200 text-gray-800 self-start max-w-xs"><p class="font-bold text-gray-500">Seller must approve your request to chat.</p></div></div></div></div></div>
    </div></section>

    <!-- ABOUT US SECTION -->
    <section id="about-us" class="py-16 bg-white px-4 sm:px-6 lg:px-8 overflow-hidden">
        <div class="max-w-4xl mx-auto">
            <div class="text-center">
                <!-- NEW: Desktop Animated Title Container -->
                <div id="about-us-animated-title-desktop" class="hidden md:block h-48 flex items-center justify-center"></div>
                <!-- Mobile Animated Title -->
                <div id="about-us-animated-title" class="md:hidden h-48 flex items-center justify-center"></div>
                <p class="scroll-reveal text-lg text-blue-600 font-semibold">Your Campus, Your Community, Your Success â€“ We Are Family</p>
            </div>
            <div class="mt-16 space-y-12">
                <div class="scroll-reveal">
                    <p class="text-xl font-semibold text-gray-800">Welcome to Nexbook - A Gift from Seniors to Every Student</p>
                    <p class="mt-4 text-gray-600">Think about this: It's 2 AM, exam tomorrow, and you desperately need that one textbook, Notes or PYQs. Or it's the beginning of semester, and you're calculating if you can afford both the Winter Blazer, lab coat AND the reference books. We've been there. Every single one of us.</p>
                    <p class="mt-4 text-gray-600">That's why we, a group of final-year students from S.S. Jain Subodh College, built Nexbook - not as a project, not for marks, but as our legacy. A gift to every junior who walks the same corridors we did, faces the same struggles we faced, and dreams the same dreams we dreamed.</p>
                </div>

                <div class="text-center">
                    <button class="view-toggle-btn" data-toggle="expand" data-controls="about-us-expandable-wrapper" data-view-more-text="Read Our Story" data-view-less-text="Show Less">Read Our Story</button>
                </div>

                <div id="about-us-expandable-wrapper" class="expandable-content-wrapper">
                    <div class="space-y-12 pt-12">
                        <div class="scroll-reveal border-t pt-10">
                            <h3 class="text-2xl font-bold">Born from Real Student Struggles</h3>
                            <p class="mt-4 text-gray-600">Remember when seniors used to pass down their books and notes? That beautiful tradition of helping each other? We've digitized that spirit. Nexbook isn't just another website - it's that helpful senior you always wished you had, available 24/7 in your pocket.</p>
                            <p class="mt-4 text-gray-600">We spent our final year not just studying, but building something that would outlive our time in college. Every late-night coding session, every feedback form, every feature - everything was designed with one question in mind: "Will this actually help a student like us?"</p>
                        </div>
                        
                        <div class="scroll-reveal border-t pt-10">
                            <h3 class="text-2xl font-bold">What Makes Nexbook Different</h3>
                            <p class="mt-2 text-gray-600">We didn't create just a marketplace. We built a complete student ecosystem:</p>
                            <ol class="space-y-4 list-decimal list-inside pl-4 mt-6 text-gray-600">
                                <li class="scroll-reveal"><span class="font-bold text-gray-800">Books That Don't Break Your Bank:</span> Buy and sell textbooks at 50-70% less than market price. Your used books aren't waste - they're someone else's treasure.</li>
                                <li class="scroll-reveal"><span class="font-bold text-gray-800"><span class="counter-number" data-target="250000">0</span>+ Free Courses and Certificates at Your Fingertips:</span> Yes, you read that right. A quarter of a million courses. With certificates. From Google, MIT, Harvard. For free.</li>
                                <li class="scroll-reveal"><span class="font-bold text-gray-800">Trust-First Marketplace:</span> Your money stays safe until the book is in your hands. Check it, verify it, and only when you're satisfied, the payment goes through. No scams, no stress.</li>
                                <li class="scroll-reveal"><span class="font-bold text-gray-800">Everything Academic, One Click Away:</span> Syllabus? Check. Previous year questions? Check. Assignments, practicals, results, college notifications? All check.</li>
                                <li class="scroll-reveal"><span class="font-bold text-gray-800">Your AI Study Buddy - Thinkly:</span> Upload any notes or syllabus, and get instant summaries, study plans, and key questions. Study smarter, not just harder.</li>
                                <li class="scroll-reveal"><span class="font-bold text-gray-800">Learn, Earn, Lead:</span> Every book you sell, every student you help - earn points and climb the leaderboard. Be the senior you wished you had.</li>
                            </ol>
                        </div>
                        
                        <div class="text-center pt-12 mt-10 border-t">
                            <h3 class="scroll-reveal text-3xl font-extrabold logo-font text-blue-600">Join the Revolution</h3>
                            <p class="scroll-reveal mt-2 text-lg text-gray-700">This is more than a platform. It's a movement. A promise from every senior to every junior: "We've got your back."</p>
                            <p class="scroll-reveal mt-6 text-gray-500 italic">"The beautiful thing about learning is that nobody can take it away from you. But we can definitely make it more affordable."<br>- Team Nexbook</p>
                        </div>
                        
                        <!-- REDESIGNED: Leadership Section -->
                        <div class="scroll-reveal pt-10 mt-10 border-t">
                             <h3 class="text-3xl text-center font-bold mb-10 text-gray-900">Leadership</h3>
                            <div class="max-w-3xl mx-auto bg-white rounded-2xl shadow-lg border border-gray-100 p-8 md:p-12 transition-all duration-300 hover:shadow-2xl hover:-translate-y-1">
                                <div class="text-center">
                                    <h4 class="text-4xl font-extrabold logo-font bg-gradient-to-r from-blue-600 to-indigo-400 text-transparent bg-clip-text">Saurav Thakur</h4>
                                    <p class="font-semibold text-gray-600 mt-2 text-lg">Founder & CEO</p>
                                    <p class="text-gray-500 text-sm mt-1">Saurav Thakur & Team Nexbook</p>
                                    <div class="w-20 h-1 bg-gray-200 mx-auto mt-6 mb-6 rounded-full"></div>
                                    <p class="text-gray-700 text-lg leading-relaxed italic">
                                        "Driving the vision to create a connected, affordable, and empowering academic ecosystem for every student."
                                    </p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <footer class="bg-gray-900 text-white">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div class="col-span-2 md:col-span-1">
                    <h3 class="logo-font text-2xl font-extrabold text-blue-500 mb-2">Nexbook</h3>
                    <p class="text-gray-400">Exclusively for S.S. Jain Subodh P.G. College.</p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-200 mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="#browse-courses" class="text-gray-400 hover:text-white">Buy Books</a></li>
                        <li><a href="#sellBookBtnHero" class="text-gray-400 hover:text-white sell-book-footer">Sell Books</a></li>
                        <li><a href="#about-us" class="text-gray-400 hover:text-white">About Us</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-200 mb-4">Support</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">Help Center</a></li>
                        <li><a href="mailto:nexbookofficial@gmail.com" class="text-gray-400 hover:text-white">Contact Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Safety Tips</a></li>
                    </ul>
                </div>
                 <div>
                    <h4 class="font-semibold text-gray-200 mb-4">Connect With Us</h4>
                    <div class="flex flex-wrap gap-4">
                        <!-- Instagram (Latest Logo - SVG) -->
                        <a href="https://www.instagram.com/your_instagram" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-transform duration-200 hover:scale-110" title="Instagram">
                            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="2" y="2" width="20" height="20" rx="5" stroke="currentColor" stroke-width="2"/>
                                <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/>
                                <circle cx="17.5" cy="6.5" r="1.5" fill="currentColor"/>
                            </svg>
                        </a>
                        <!-- WhatsApp (Latest Logo - SVG) -->
                        <a href="https://chat.whatsapp.com/your_whatsapp_group" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-transform duration-200 hover:scale-110" title="WhatsApp">
                            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                            </svg>
                        </a>
                        <!-- Telegram (Latest Logo - SVG) -->
                        <a href="https://t.me/your_telegram_group" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-transform duration-200 hover:scale-110" title="Telegram">
                            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/>
                            </svg>
                        </a>
                        <!-- Facebook (Latest Logo - SVG) -->
                        <a href="https://www.facebook.com/your_facebook" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-transform duration-200 hover:scale-110" title="Facebook">
                            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                        </a>
                        <!-- Twitter/X (New Logo) -->
                        <a href="https://x.com/your_twitter" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-transform duration-200 hover:scale-110" title="X (Twitter)">
                            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <!-- NeX -->
                        <a href="https://qxds.netlify.app/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transition-transform duration-200 hover:scale-110" title="NeX">
                            <div class="w-6 h-6 bg-gradient-to-br from-blue-500 to-purple-600 rounded flex items-center justify-center">
                                <span class="text-white font-bold text-xs" style="font-family: 'Orbitron', sans-serif;">Nâ‰¡X</span>
                            </div>
                        </a>
                    </div>
                 </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-800 text-center text-gray-500">
                <p>&copy; 2025 Nexbook All rights reserved</p> 
                <p class="mt-1">Designed and developed by <a href="#" class="glowing-blue-text font-semibold">Saurav Thakur & Team Nexbook</a></p>
                <p class="mt-4 text-sm text-gray-400 italic">"Albert Einstein â€“ â€œEducation is not the learning of facts, but the training of the mind to think.â€"</p>
            </div>
        </div>
    </footer>

    <!-- Success Modal -->
    <div id="successModal" class="success-modal">
        <div class="success-modal-content">
            <div class="success-icon">
                <svg width="48" height="48" fill="white" viewBox="0 0 24 24">
                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
                </svg>
            </div>
            <h2 id="successTitle" style="font-size: 2.2rem; font-weight: bold; margin-bottom: 12px; color: #1f2937;">Order Confirmed!</h2>
            <p id="successProductName" style="font-size: 1.2rem; margin-bottom: 8px; color: #6b7280; font-weight: 600;">Product Name</p>
            <p id="successMessage" style="margin-bottom: 32px; color: #6b7280; line-height: 1.6;">Your order has been placed successfully and will be processed shortly.</p>
            <button id="successContinueBtn" style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 14px 32px; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);">Continue</button>
        </div>
    </div>

    <script>
        // --- GLOBAL FIREBASE INITIALIZATION ---
        // TODO: Replace this with your own Firebase project configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDUPekN9JiKAPi157pPM-Eft0g1a0sYiR0",
            authDomain: "nexbookx.firebaseapp.com",
            projectId: "nexbookx",
            storageBucket: "nexbookx.firebasestorage.app",
            messagingSenderId: "236199659180",
            appId: "1:236199659180:web:65f53382fcd232a2aa8109",
            measurementId: "G-VVSGG5W95E"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(); // Initialize db in the global scope
    </script>

    <script>
        // --- JAVASCRIPT LOGIC ---
        // --- DATA ---
        const courseData = { "Bachelor of Science (B.Sc.)": { image: "https://images.unsplash.com/photo-1576267423445-b2e0074d68a4?q=80&w=2670&auto-format&fit=crop", groups: { "Physical Science Group (Maths Side)": ["Physics", "Chemistry", "Mathematics", "Statistics", "Computer Science", "Geography"], "Biological Science Group (Bio Side)": ["Zoology", "Botany", "Biotechnology", "Microbiology", "Psychology", "Economics"] } }, "B.Sc. (Honours/Major Subjects)": { image: "https://images.unsplash.com/photo-1532012197267-da84d127e765?q=80&w=2574&auto-format&fit=crop", groups: { "Honours Subjects": ["Physics (Major/Minor)", "Chemistry (Major/Minor)", "Mathematics (Major/Minor)", "Zoology (Major/Minor)", "Botany (Major/Minor)", "Microbiology (Major/Minor)", "Biotechnology (Major/Minor)", "Computer Science (Major/Minor)", "Psychology (Major/Minor)", "Statistics (Major/Minor)", "Geography (Major/Minor)", "Economics (Major/Minor)"] } }, "Bachelor of Arts (B.A.)": { image: "https://images.unsplash.com/photo-1523240795612-9a054b0db644?q=80&w=2670&auto-format&fit=crop", groups: { "Subjects": ["Hindi Literature", "English Literature", "History", "Political Science", "Sociology", "Philosophy", "Sanskrit", "Public Administration", "Geography", "Economics", "Psychology", "Statistics", "Physical Education", "Indian Music"] } }, "B.A. (Honours/Major Subjects)": { image: "https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?q=80&w=2573&auto-format&fit=crop", groups: { "Honours Subjects": ["Hindi Literature (Major/Minor)", "English Literature (Major/Minor)", "History (Major/Minor)", "Political Science (Major/Minor)", "Sociology (Major/Minor)", "Philosophy (Major/Minor)", "Sanskrit (Major/Minor)", "Public Administration (Major/Minor)", "Geography (Major/Minor)", "Economics (Major/Minor)", "Psychology (Major/Minor)", "Statistics (Major/Minor)", "Physical Education (Major/Minor)", "Indian Music (Major/Minor)"] } }, "Bachelor of Commerce (B.Com.)": { image: "https://images.unsplash.com/photo-1556740738-b6a63e27c4df?q=80&w=2670&auto-format&fit=crop", groups: { "Subjects": ["ABST (Accountancy & Business Statistics)", "EAFM (Economic Administration & Financial Management)", "BADM (Business Administration)", "General Commerce Papers"] } }, "B.Com. (Honours)": { image: "https://i.postimg.cc/D0LzykKq/bcom.jpg", groups: { "Honours Subjects": ["ABST (Honours)", "EAFM (Honours)", "BADM (Honours)"] } }, "Bachelor of Computer Application (B.C.A.)": { image: "https://images.unsplash.com/photo-1542831371-29b0f74f9713?q=80&w=2670&auto-format&fit=crop", groups: { "Subjects": ["Programming (C, C++, Java, Web, DBMS)", "Computer Science Electives"] } }, "Bachelor of Business Administration (B.B.A.)": { image: "https://i.postimg.cc/3xKw7cfv/bba.jpg", groups: { "Specializations": ["HR", "Finance", "Marketing", "Retail Management"], "Core Subjects": ["Business Law", "Economics", "Accounting"] } }, "Master of Science (M.Sc.)": { image: "https://i.postimg.cc/7Yr6t6gX/msc.jpg", groups: { "Specializations": ["Physics", "Chemistry", "Mathematics", "Botany", "Zoology", "Biotechnology", "Environmental Science", "Microbiology", "IT", "Forensic Science", "Statistics", "Psychology", "Geography"] } }, "Master of Arts (M.A.)": { image: "https://images.unsplash.com/photo-1531545514256-b1400bc00f31?q=80&w=2574&auto-format&fit=crop", groups: { "Specializations": ["Hindi", "English", "Geography", "Political Science", "Public Admin", "History", "Economics", "Journalism & Mass Comm", "MSW (Social Work)", "Sociology", "Psychology", "Yoga"] } }, "Master of Commerce (M.Com.)": { image: "https://i.postimg.cc/kXN50msC/mcom.jpg", groups: { "Specializations": ["EAFM", "ABST", "BADM"] } }, "Master of Computer Application (M.C.A.)": { image: "https://images.unsplash.com/photo-1517694712202-14dd9538aa97?q=80&w=2670&auto-format&fit=crop", groups: { "Specializations": ["Computer Applications"] } } };
        const booksDatabase = { "Physics": { "1": { "Sem 1": { books: [ { id: 'p1s1b1', title: 'Mechanics - D.S. Mathur', author: 'D.S. Mathur', price: 350, condition: 'Good', rating: 4.5, verified: true }, { id: 'p1s1b2', title: 'Electricity and Magnetism', author: 'B.S. Agarwal', price: 400, condition: 'Okay', rating: 4.0, verified: true }, { id: 'p1s1b3', title: 'University Physics', author: 'Young & Freedman', price: 750, condition: 'New', rating: 5.0, verified: false }, ], bundlePrice: 1400 }, "Sem 2": { books: [ { id: 'p1s2b1', title: 'Optics by Ajoy Ghatak', author: 'Ajoy Ghatak', price: 450, condition: 'Old', rating: 3.5, verified: true }, { id: 'p1s2b2', title: 'Thermal Physics', author: 'Garg, Bansal, Ghosh', price: 380, condition: 'Good', rating: 4.0, verified: true }, ], bundlePrice: 800 }, }, }, "Chemistry": { "1": { "Sem 1": { books: [ { id: 'c1s1b1', title: 'Inorganic Chemistry', author: 'Puri, Sharma, Kalia', price: 500, condition: 'New', rating: 5.0, verified: true }, { id: 'c1s1b2', title: 'Organic Chemistry', author: 'Paula Yurkanis Bruice', price: 650, condition: 'Good', rating: 4.5, verified: true }, ], bundlePrice: 1100 } } } };
        const topSellers = [ { rank: 1, name: 'Riya Gupta', points: 1250, college: 'S.S. Jain Subodh College', avatar: 'https://placehold.co/40x40/fecaca/881337?text=RG' }, { rank: 2, name: 'Arjun Singh', points: 1180, college: 'S.S. Jain Subodh College', avatar: 'https://placehold.co/40x40/a7f3d0/052e16?text=AS' }, { rank: 3, name: 'Sameer Khan', points: 990, college: 'S.S. Jain Subodh College', avatar: 'https://placehold.co/40x40/bae6fd/0c4a6e?text=SK' } ];
        const syllabusData = { "Compulsory/Foundation": { "General English": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_general_english.pdf", "General Hindi": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_general_hindi.pdf", "Environmental Science (EVS)": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_EVS.pdf", "Elementary Computer": "https://www.subodhpgcollege.com/pdf/syllabus/Elementary_Computer_Syllabus.pdf" }, "B.Sc. (Honours & Pass)": { "Physics": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_bsc_physics_wef_July2025.pdf", "Chemistry": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_bsc_chemistry_2023-24.pdf", "Zoology": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_UG_zoology_2023-24.pdf", "Botany": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_BSc_botany_Oct2023.pdf", "Biotechnology": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_BSc_biotechnology_wef_Oct2023.pdf", "Microbiology": "https://www.subodhpgcollege.com/pdf/syllabus/BSc_Microbiology_syllabus_2023-24.pdf", "Mathematics": "https://www.subodhpgcollege.com/pdf/syllabus/Syllabus_BSc_Mathematics_wef_Oct2023.pdf", "Computer Science": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_BSc_ComputerSci_2023-24.pdf", "Statistics": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_ba_bsc_statistics_wef_oct2023.pdf", "Psychology": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_UG_psychology_2023-24.pdf", "Economics": "https://www.subodhpgcollege.com/pdf/syllabus/Syllabus-BSc-Economics-2023-24.pdf", "Geography": "https://www.subodhpgcollege.com/pdf/syllabus/Syllabus_Geography_new.pdf" }, "B.A. (Honours & Pass)": { "Hindi Literature": "https://www.subodhpgcollege.com/pdf/syllabus/Syllabus_Hindi_Literature_2023-24-NEP.pdf", "English Literature": "https://www.subodhpgcollege.com/pdf/syllabus/Syllabus_UG_English_Literature_2023-24.pdf", "History": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_ba_history_wef_2023.pdf", "Political Science": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_ba_political_science_wef_Oct2023.pdf", "Public Administration": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_ba_public_admin_new.pdf", "Sociology": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_BA_sociology_Oct2023.pdf", "Philosophy": "https://www.subodhpgcollege.com/pdf/syllabus/Syllabus_UG_Philosophy_2023-24.pdf", "Sanskrit": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_ba_Sanskrit_wef_Oct2023.pdf", "Physical Education": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_ba_phy_edu_Oct2023.pdf", "Indian Music": "https://www.subodhpgcollege.com/pdf/syllabus/UG_syllabus-Indian-Music-2023-25.pdf" }, "B.Com.": { "BADM": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_bcom_BADM_2023-24.pdf", "ABST": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_bcom_abst_Oct2023.pdf", "EAFM": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_bcom_eafm_2023-24.pdf" }, "Professional": { "BCA": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_bca_2023-24.pdf", "BBA": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_bba_HR_Finance_Marketing_wef_Oct2023.pdf", "BBA Retail": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_bba_Retail_Management_wef_Oct2023.pdf" }, "PG (M.Sc., M.A., M.Com., MCA)": { "M.Sc. Physics": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_msc_physics_new.pdf", "M.Sc. Chemistry": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_msc_chemistry_new.pdf", "M.Sc. Zoology": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_msc_zoology_new.pdf", "M.Sc. Botany": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_MSc_botany_Oct2023.pdf", "M.Sc. Mathematics": "https://www.subodhpgcollege.com/pdf/syllabus/Syllabus_MSc_Mathematics_wef_Oct2023.pdf", "M.Com. BADM": "https://www.subodhpgcollege.com/pdf/syllabus/syllabus_mcom_business_admin_2023-24.pdf", "MCA": "https://rtu.ac.in/index/view_menudata.php?page=RTU-Syllabus-MCA10" } };
        
        // Study Material Nested Data Structure
        const studyMaterialNestedData = {
            "B.Sc. (Bachelor of Science)": {
                "Physics": "#",
                "Chemistry": "#",
                "Mathematics": "#",
                "Zoology": "#",
                "Botany": "#",
                "Biotechnology": "#",
                "Microbiology": "#",
                "Computer Science": "#",
                "Statistics": "#"
            },
            "B.Com. (Bachelor of Commerce)": {
                "ABST (Accounting and Business Statistics)": "#",
                "EAFM (Economic Administration & Financial Management)": "#",
                "BADM (Business Administration)": "#"
            },
            "B.A. (Bachelor of Arts)": {
                "English": "#",
                "Hindi": "#",
                "History": "#",
                "Political Science": "#",
                "Geography": "#",
                "Economics": "#",
                "Sociology": "#",
                "Philosophy": "#",
                "Sanskrit": "#",
                "Psychology": "#",
                "Public Administration": "#",
                "Physical Education": "#",
                "Music": "#"
            },
            "B.C.A. (Bachelor of Computer Applications)": {
                "Programming in C/C++": "#",
                "Data Structures": "#",
                "DBMS": "#",
                "Operating Systems": "#",
                "Web Technologies": "#"
            },
            "B.B.A. (Bachelor of Business Administration)": {
                "Business Communication": "#",
                "Financial Management": "#",
                "Human Resource Management": "#",
                "Marketing Management": "#",
                "Organizational Behavior": "#"
            },
            "M.Sc. (Master of Science)": {
                "Physics": "#",
                "Chemistry": "#",
                "Mathematics": "#",
                "Zoology": "#",
                "Botany": "#",
                "Biotechnology": "#",
                "Microbiology": "#"
            },
            "M.A. (Master of Arts)": {
                "English": "#",
                "Hindi": "#",
                "History": "#",
                "Political Science": "#",
                "Sociology": "#",
                "Sanskrit": "#",
                "Geography": "#",
                "Economics": "#"
            },
            "M.Com. (Master of Commerce)": {
                "ABST": "#",
                "EAFM": "#",
                "BADM": "#"
            },
            "M.C.A. (Master of Computer Applications)": {
                "Programming Languages": "#",
                "Data Structures": "#",
                "DBMS": "#",
                "Operating Systems": "#",
                "Software Engineering": "#"
            },
            "Additional Programs": {
                "Diploma Programs": "#",
                "PG Diploma Programs": "#",
                "Certification Courses": "#",
                "Ph.D.": "#"
            }
        };
        
        // Mathematics Notes Data - Organized by Semester
        const mathematicsNotesData = {
            "Sem 1": [
                { name: "1sem calculus unit 1 Hindi medium", url: "https://tinyurl.com/228vwuvh" },
                { name: "Calculus unit 2", url: "https://tinyurl.com/2ymw3k8y" },
                { name: "CALCULUS UNIT I CURVE TRACING", url: "https://drive.google.com/file/d/1cb9b3IA5GW6W98ih_t7KQtyhEPuLqGAd/view?usp=drivesdk" },
                { name: "B.Sc. I Sem Calculus I", url: "https://tinyurl.com/29kd4yhn" },
                { name: "B.Sc.  I sem (HONS) MATHS  Calculus-I", url: "https://tinyurl.com/2d2e7bzm" },
                { name: "B.Sc.  I sem (HONS) MATHS NUMBER THEORY", url: "https://tinyurl.com/2aerhgbo" },
                { name: "BSC-MATHS-1", url: "https://tinyurl.com/24dzrdwc" },
                { name: "B_Sc_I_Sem_Maths_Hons_Three_dimensional_geometry_and_vector_calculus", url: "https://tinyurl.com/2ygy3fd6" },
                { name: "B_Sc_I_Sem_Maths_THREE_DIMENTIONLA_GEOMETRY_AND_VECTOR_CALCULUS", url: "https://tinyurl.com/2aopzjnw" },
                { name: "3D Bsc 1 sem", url: "https://tinyurl.com/24f9dr9a" },
                { name: "3D UNIT-1ST SPHARE SEM-1ST", url: "https://tinyurl.com/2ymfa7hf" },
                { name: "Differential equation unit 1st", url: "https://tinyurl.com/2xs7w6om" },
                { name: "discrete 1 sem", url: "https://tinyurl.com/22bdf5x9" },
                { name: "DISCRETE MATH UNIT 1ST  SEM-1ST", url: "https://tinyurl.com/2ytalro7" },
                { name: "envelope 1st sem math", url: "https://tinyurl.com/278xstd2" },
                { name: "NA 1st unit", url: "https://tinyurl.com/2yzcu4qs" },
                { name: "Real 1st unit maths", url: "https://tinyurl.com/259s85gg" },
                { name: "Real analysis unit 1", url: "https://tinyurl.com/288jp4my" },
                { name: "vector calculas pdf for semaster 1", url: "https://tinyurl.com/25l2nr36" },
                { name: "Unit 1 DE Complete", url: "https://tinyurl.com/22fd6n2q" }
            ],
            "Sem 2": [
                { name: "2nd sem discrete 2nd unit", url: "https://tinyurl.com/2y8d3mmz" },
                { name: "Calculus unit-1 (Sem-2) Notes", url: "https://tinyurl.com/279aaekh" },
                { name: "B.Sc. II Sem Graph Theory", url: "https://tinyurl.com/2825zchp" },
                { name: "B.Sc II sem Calculus II", url: "https://tinyurl.com/23ymqwfk" },
                { name: "DE UNIT-II", url: "https://tinyurl.com/26rejzcn" },
                { name: "differential calculs chapter 2nd", url: "https://tinyurl.com/2dblcl63" },
                { name: "real analysis chapter 2nd", url: "https://tinyurl.com/26hmon5m" },
                { name: "u-2  (1)", url: "https://tinyurl.com/2y98dcrh" },
                { name: "Unit - All sem 2 (1)", url: "https://tinyurl.com/2cbgl7wk" }
            ],
            "Sem 3": [
                { name: "3D CONE-1", url: "https://tinyurl.com/2dn7bk76" },
                { name: "B.Sc (Hons.) III Sem Maths - DIFFERENTIAL EQUATION-I", url: "https://tinyurl.com/2yvfd33l" },
                { name: "B.Sc (HONS.) III SEM Maths Real analysis", url: "https://tinyurl.com/2xhocbtq" },
                { name: "B.Sc III Sem (hons.) maths-operational research", url: "https://tinyurl.com/2amz5qnf" },
                { name: "B.Sc III Sem (Hons.) Maths- Numerical Analysis", url: "https://tinyurl.com/25xl2st2" },
                { name: "B.Sc III Sem Maths - DIFFERENTIAL EQUATION", url: "https://tinyurl.com/2acj8hf6" },
                { name: "B.Sc III Sem Maths - NUMERICAL ANALYSIS", url: "https://tinyurl.com/2y7ppjes" },
                { name: "B.Sc III Sem Maths - REAL ANALYSIS", url: "https://tinyurl.com/27fzavjj" },
                { name: "BSc III sem Real Analysis (2)", url: "https://tinyurl.com/24wx5x77" },
                { name: "BSc III sem Differential equation I", url: "https://tinyurl.com/27n5eze6" },
                { name: "BSc III sem Numerical analysis", url: "https://tinyurl.com/2desgxoo" },
                { name: "differential equations & nuemrical analysis", url: "https://tinyurl.com/22e3p4sb" },
                { name: "differential equations 1,2 unit . 3 sem", url: "https://tinyurl.com/28kya79w" },
                { name: "differential equations 3 unit 3sem", url: "https://tinyurl.com/2cfjyan7" },
                { name: "Differential equations 4 unit 3sem", url: "https://tinyurl.com/24pqxm46" },
                { name: "Newton_Raphson_Numerical_Method", url: "https://tinyurl.com/28lyxqs3" },
                { name: "Numerical analysis 3rd sem", url: "https://tinyurl.com/22wrqmph" },
                { name: "P.C. Unit-3 SPECTROSCOPY II", url: "https://tinyurl.com/23vgy3na" },
                { name: "real analysis 3,4 unit 3rd sem", url: "https://tinyurl.com/22mz98vt" },
                { name: "Real analysis 3rd sem notes ðŸ“‘ English", url: "https://tinyurl.com/2a4klk66" },
                { name: "real analysis sem 3", url: "https://tinyurl.com/25u3mszd" }
            ],
            "Sem 4": [
                { name: "4 th unit mathematical", url: "https://tinyurl.com/284vguxu" },
                { name: "BSc IV sem Advanced Analysis and metric space  (2)", url: "https://tinyurl.com/2affopff" },
                { name: "calculus(partial diff.) ", url: "https://tinyurl.com/29tfseow" },
                { name: "mathematical  unit (4)4th sem @  (1)", url: "https://tinyurl.com/28aabhvw" },
                { name: "Real analysis Unit-1 Sem IV", url: "https://tinyurl.com/267d79cy" },
                { name: "Real analysis Unit-2 Sem IV (2)", url: "https://tinyurl.com/2acfnqv2" },
                { name: "Unit 4B", url: "https://tinyurl.com/2y6fesbc" }
            ],
            "Sem 5": [
                { name: "Abstract Algebra All Units", url: "https://tinyurl.com/259e3aex" },
                { name: "B.Sc (HONS.) V SEM Maths complex analysis", url: "https://tinyurl.com/26j2nvu8" },
                { name: "B.Sc (HONS.) V SEM Maths complex analysis - Copy", url: "https://tinyurl.com/2cqe4fwg" },
                { name: "B.Sc Hons V&VI Sem, Algebra I,II", url: "https://tinyurl.com/24c6ob3r" },
                { name: "B.Sc V Sem (hons.) Maths - abstract algebra", url: "https://tinyurl.com/296mdr46" },
                { name: "B.Sc V Sem (hons.) maths statistics", url: "https://tinyurl.com/29989uj3" },
                { name: "B.Sc V Sem Algebra I", url: "https://tinyurl.com/2xmm24pc" },
                { name: "Bsc 5th sem abstract algebra all unit notes _edited60", url: "https://tinyurl.com/2acwh6ll" }
            ],
            "Sem 6": [
                { name: "Abstract algebra BSc sem 6th unit -2 notes by RD", url: "https://tinyurl.com/22amjb8f" },
                { name: "B.Sc V& VI Sem (Hons) Complex Analysis", url: "https://tinyurl.com/22jtokst" },
                { name: "B.Sc VI Sem Algebra II (1) (1)", url: "https://tinyurl.com/29kk6fzv" },
                { name: "B.Sc VI Sem Algebra II (1)", url: "https://tinyurl.com/2a4p2gjb" },
                { name: "B.Sc. VI Sem Complex Analysis II (1)", url: "https://tinyurl.com/298k2lfc" },
                { name: "B.Sc. VI Sem Complex Analysis II", url: "https://tinyurl.com/26lsmgdd" },
                { name: "complexe Part -1 6th sem", url: "https://tinyurl.com/29cfda4o" },
                { name: "maths sem 6 abstract", url: "https://tinyurl.com/22q3svvu" },
                { name: "Subodh Bsc sem. -6th Abstract Algebra Unit-1 Notes", url: "https://tinyurl.com/28ss6rnv" },
                { name: "Subodh_Bsc_semester_6_Complex_analysis_unit_3_Notes_ðŸ“_pdf", url: "https://tinyurl.com/2yu2drc2" },
                { name: "unit 3 complex", url: "https://tinyurl.com/22b6cnwy" },
                { name: "unit 8 complex", url: "https://tinyurl.com/23q6sxdb" }
            ],
            "Unknown": [
                { name: "Calculas unit 1", url: "https://tinyurl.com/249ngpax" },
                { name: "calculas unit 4", url: "https://tinyurl.com/2degwnab" },
                { name: "differential equations u3 complete notes(1)", url: "https://tinyurl.com/23sn2j75" },
                { name: "LPP 1", url: "https://tinyurl.com/2684w8wt" },
                { name: "mathematics pyq", url: "https://tinyurl.com/22yy96zz" },
                { name: "maths assn", url: "https://tinyurl.com/2cwsb83p" },
                { name: "maths assignment _1", url: "https://tinyurl.com/26u346fn" },
                { name: "Numerical unit 4", url: "https://tinyurl.com/25r2po4w" },
                { name: "probability", url: "https://tinyurl.com/29xwwykp" },
                { name: "series math", url: "https://tinyurl.com/2xpbfvod" },
                { name: "Sphere", url: "https://tinyurl.com/23zv7ox4" },
                { name: "sphere book...math...", url: "https://tinyurl.com/28895x3m" },
                { name: "unit 2 DE", url: "https://tinyurl.com/24bwlu2j" },
                { name: "unit-2_mathsà¤…à¤šà¤°_à¤—à¥à¤£à¤¾à¤‚à¤•à¥‹_à¤µà¤¾à¤²à¥‡_à¤°à¥‡à¤–à¤¿à¤•_à¤…à¤µà¤•à¤²à¤¨_à¤¸à¤®à¥€à¤•à¤°à¤£", url: "https://tinyurl.com/2c7sdxbg" },
                { name: "unit-3 DE", url: "https://tinyurl.com/22f649yz" },
                { name: "vector field", url: "https://tinyurl.com/2xvt7ecq" },
                { name: "alkene", url: "https://tinyurl.com/256nqazv" },
                { name: "alkenes  chemistry notes", url: "https://tinyurl.com/272xqwb9" },
                { name: "ACID AND BASES", url: "https://tinyurl.com/24te8tpa" },
                { name: "Chemical Equilibrium", url: "https://tinyurl.com/296tg85e" },
                { name: "chemistry ï¸ organic", url: "https://tinyurl.com/2albcq43" },
                { name: "chemistry pyq", url: "https://tinyurl.com/22vpezja" },
                { name: "chemistry radicals pdf", url: "https://tinyurl.com/28xomuu5" },
                { name: "Chemistry_organic_unit_1", url: "https://tinyurl.com/2cmecutw" },
                { name: "gas state", url: "https://tinyurl.com/29y659pw" },
                { name: "inorganic [Chemistry]", url: "https://tinyurl.com/25dj4upn" },
                { name: "inorganic chemistry", url: "https://tinyurl.com/2484b8d7" },
                { name: "inorganic chemistry notes", url: "https://tinyurl.com/2yahrvyw" },
                { name: "inorganic chemistry notes-1", url: "https://tinyurl.com/25uoxvq3" },
                { name: "INORGANIC SEM6", url: "https://tinyurl.com/29cmfo5w" },
                { name: "inorganic unit 4 @ ", url: "https://tinyurl.com/2xnr2qjm" },
                { name: "isomerism", url: "https://tinyurl.com/258x7sqd" },
                { name: "liquid State created by PUNEET (1)", url: "https://tinyurl.com/25u9t3nk" },
                { name: "Machanism 1,2,3 unit", url: "https://tinyurl.com/2afbat2a" },
                { name: "MOT(inorganic notes)", url: "https://tinyurl.com/25hskehz" },
                { name: "organic chemistry", url: "https://tinyurl.com/269h2bse" },
                { name: "organic chemistry unit 1", url: "https://tinyurl.com/294ak4nh" },
                { name: "organic chemistry unit 2", url: "https://tinyurl.com/2cughzn3" },
                { name: "organic_1", url: "https://tinyurl.com/24hpld34" },
                { name: "unit 1DE", url: "https://tinyurl.com/2dgq4s2u" },
                { name: "unit 1(1)", url: "https://tinyurl.com/2yk652ot" },
                { name: "unit 1(2)", url: "https://tinyurl.com/2bq2alop" },
                { name: "unit 1(3)", url: "https://tinyurl.com/2yufmgzh" },
                { name: "unit 2", url: "https://tinyurl.com/268lplnf" },
                { name: "unit 2 imp. topics  ", url: "https://tinyurl.com/25tso8l4" }
            ],
            "All": [
                { name: "3 dimenstion maths", url: "https://tinyurl.com/25bzrzqe" },
                { name: "3-D Geometry", url: "https://tinyurl.com/2yp3rskf" },
                { name: "3-D", url: "https://tinyurl.com/2cuk2977" },
                { name: "3D Cylinder-1 (1)", url: "https://tinyurl.com/278jeksn" },
                { name: "3d geometry", url: "https://tinyurl.com/225otzct" },
                { name: "3d sphere ex 2a", url: "https://tinyurl.com/27ut2spu" },
                { name: "9.2 examples (boolean algebra)", url: "https://tinyurl.com/2xsm4yr5" },
                { name: "398afe62-3d2f-4c84-8cc1-dfbe4940fd2c", url: "https://tinyurl.com/27do6rph" },
                { name: "abst nterpolation_&_extrapolation_By_SP_Kothari_&_dr_n_k_purohit", url: "https://tinyurl.com/2cxg8xe5" },
                { name: "Abstract algebra", url: "https://tinyurl.com/2b9gxc7x" },
                { name: "ABSTRACT ALGEBRA 2", url: "https://tinyurl.com/22zd7lk6" },
                { name: "Abstract Algebra Unit-4 English", url: "https://tinyurl.com/2bu226r9" },
                { name: "Abstract Algebra. Unit-1", url: "https://tinyurl.com/2yb6vdyo" },
                { name: "Abstract alzebra 5th sem by_Abhishek rao", url: "https://tinyurl.com/24bs8xme" },
                { name: "algebra", url: "https://tinyurl.com/2c8aeyax" },
                { name: "algebra 6 sem", url: "https://tinyurl.com/2yqhna82" },
                { name: "B SC SEM I P-II  DC CHP 10 SERIES-1", url: "https://tinyurl.com/287kyz3u" },
                { name: "B.SC (HONS.) I SEM MATHEMATICS - DISCRETE MATHEMATICS", url: "https://tinyurl.com/2yptgy4b" },
                { name: "B.sc-3(Abstract algebra)Unit 3 English", url: "https://tinyurl.com/28of6kew" },
                { name: "B.sc-3(Abstract algebra)unit 4 hindi", url: "https://tinyurl.com/29ztk29x" },
                { name: "B.Sc.I Sem 3D & Vector", url: "https://tinyurl.com/25m2edla" },
                { name: "Boolean algebra", url: "https://tinyurl.com/2cz28thy" },
                { name: "Boolean algebra maths", url: "https://tinyurl.com/24mnb5vn" },
                { name: "boolean theorem", url: "https://tinyurl.com/24l39g5t" },
                { name: "Bsc 2nd sem abstract algebra all unit  (1)", url: "https://tinyurl.com/2dklfgp9" },
                { name: "Bsc I sem Discrete mathematics pass course paper I", url: "https://tinyurl.com/2abyscaf" },
                { name: "calculas maths", url: "https://tinyurl.com/2dxc4krb" },
                { name: "calculs 3 rd (1)", url: "https://tinyurl.com/29lybale" },
                { name: "chapter name= homogeneous LDE", url: "https://tinyurl.com/29rtmus6" },
                { name: "Complex Analysis", url: "https://tinyurl.com/2ysmezkg" },
                { name: "complex analysis 5th sem by_    ", url: "https://tinyurl.com/2885k9jz" },
                { name: "complex analysis unit 1.pdf(1)", url: "https://tinyurl.com/246uz7qs" },
                { name: "Complex Analysis Unit 2", url: "https://tinyurl.com/26ard2vu" },
                { name: "Complex Analysis Unit-3", url: "https://tinyurl.com/2ysbre24" },
                { name: "Complex Analysis. Unit-4", url: "https://tinyurl.com/29q63hz8" },
                { name: "complex-taylor series", url: "https://tinyurl.com/2cel32u5" },
                { name: "conicoid 1", url: "https://tinyurl.com/27k5djtq" },
                { name: "DE UNIT-I", url: "https://tinyurl.com/2b3u3a7n" },
                { name: "DE UNIT-III", url: "https://tinyurl.com/29ltlxqd" },
                { name: "DE UNIT-IV", url: "https://tinyurl.com/23p8tpk9" },
                { name: "diff 1", url: "https://tinyurl.com/2abdbmos" },
                { name: "diff. eq. u-4 book", url: "https://tinyurl.com/24v26pe5" },
                { name: "Differential Equations of second  order - 1  (1)(1)", url: "https://tinyurl.com/2dl2kbrp" },
                { name: "Differentrial Equation II", url: "https://tinyurl.com/2yn7275a" },
                { name: "DISCRETE MATHEMATICS (CBH)", url: "https://tinyurl.com/23ewcbql" },
                { name: "discrete mathematics(10)", url: "https://tinyurl.com/23t7p4qp" },
                { name: "Discrete maths", url: "https://tinyurl.com/24d93fay" },
                { name: "Discrete mathematics last year paper", url: "https://tinyurl.com/2ctuvr7f" },
                { name: "DjC6RjqphaELv2OiE0sdiWe7jdTwm1ueO6KDfQ3d", url: "https://tinyurl.com/27loj3qj" },
                { name: "envolep and maxima Minima", url: "https://tinyurl.com/2xpm339p" },
                { name: "Graph theory unit I", url: "https://tinyurl.com/2cl29sye" },
                { name: "graph_theory_short_notes_Follow_on_Instagram_@iktiyarchouhan_", url: "https://tinyurl.com/2xpxsr6y" },
                { name: "HXE1j4bqRmEVz8WV4qc3DIgKBB7AMATuMKAS9P4I", url: "https://tinyurl.com/275t4lxl" },
                { name: "Integral Calculus unit II Beta Gamma Function", url: "https://tinyurl.com/239df9rb" },
                { name: "Math", url: "https://tinyurl.com/2yevob6w" },
                { name: "MATH 3", url: "https://tinyurl.com/2bxfugkr" },
                { name: "math notes", url: "https://tinyurl.com/25ezshar" },
                { name: "mathematical 4th unit", url: "https://tinyurl.com/22yfeyly" },
                { name: "Mathematical expectations", url: "https://tinyurl.com/22xr6pha" },
                { name: "mathematical pyq", url: "https://tinyurl.com/26zxbroy" },
                { name: "mathematics notes", url: "https://tinyurl.com/27hxvow8" },
                { name: "Maxima & Minima ~ ", url: "https://tinyurl.com/2cwl8r2h" },
                { name: "Maxima& minima (calculus", url: "https://tinyurl.com/2c474pnc" },
                { name: "metric space", url: "https://tinyurl.com/2ak6c49q" },
                { name: "metric space 1", url: "https://tinyurl.com/253eydc7" },
                { name: "metric space iii(English)", url: "https://tinyurl.com/2dnsztau" },
                { name: "metric space iii(Hindi)-converted", url: "https://tinyurl.com/2ddbwygy" },
                { name: "Notes,sphere (part 1 )", url: "https://tinyurl.com/26wxqxqt" },
                { name: "Numerical unit 3", url: "https://tinyurl.com/2ct9oz3o" },
                { name: "peper 2 unit2,3,4(math)", url: "https://tinyurl.com/2cwalmh5" },
                { name: "PERMUTATION AND COMBINATION  By SP Kothari", url: "https://tinyurl.com/298tqk4n" },
                { name: "PPT OF GRAPH THEORY IN ENGLISH", url: "https://tinyurl.com/24o9gmsg" },
                { name: "Principle of Inclusion Exclusion", url: "https://tinyurl.com/27droz9l" },
                { name: "Principle Of Mathematical Induction", url: "https://tinyurl.com/2yjptdze" },
                { name: "RA_unit_II_Cauchy's Squance_example", url: "https://tinyurl.com/2cjps9qw" },
                { name: "RA_unit_II_Cauchy's Squance", url: "https://tinyurl.com/28xt3raa" },
                { name: "real analysis", url: "https://tinyurl.com/29lfg5nu" },
                { name: "real analysis chapter 1 st", url: "https://tinyurl.com/27pjtpfv" },
                { name: "real analysis chapter 1 st(1)", url: "https://tinyurl.com/29b9gfed" },
                { name: "Real_Analysis_à¤à¤•à¤¸à¤®à¤¾à¤¨_à¤…à¤­à¤¿à¤¸à¤°à¤£_Arun_Sir", url: "https://tinyurl.com/2y95os6e" },
                { name: "series (à¤¶à¥à¤°à¥‡à¤£à¥€)", url: "https://tinyurl.com/24lvj6as" },
                { name: "series", url: "https://tinyurl.com/28ydqctu" },
                { name: "set theory (1)", url: "https://tinyurl.com/22rvx2pw" },
                { name: "shorts- COMPLEX", url: "https://tinyurl.com/22u69ymh" },
                { name: "special function-2", url: "https://tinyurl.com/2378oyeu" },
                { name: "Sphere", url: "https://tinyurl.com/28zzmdua" },
                { name: "Syllabus_BSc_Mathematics_wef_Oct2023 (2)", url: "https://tinyurl.com/23cv5qvb" },
                { name: "syllabus_bsc_maths_new (1)", url: "https://tinyurl.com/249ruln5" },
                { name: "syllabus_bsc_maths_new", url: "https://tinyurl.com/2292hlfl" },
                { name: "topology", url: "https://tinyurl.com/2y9jtn8u" },
                { name: "UNIT - I Coordinate Transformation", url: "https://tinyurl.com/24npna4u" },
                { name: "UNIT - III Special functions", url: "https://tinyurl.com/2auyonxv" },
                { name: "Unit 1 - Power Series", url: "https://tinyurl.com/2d6nmsah" },
                { name: "unit 1 discrete mathematics  (1)", url: "https://tinyurl.com/27f39ul2" },
                { name: "Unit 1 NA Complete", url: "https://tinyurl.com/2a8kd58n" },
                { name: "Unit 1 RA", url: "https://tinyurl.com/25fsa2z9" },
                { name: "unit 1 series", url: "https://tinyurl.com/2c4xvhz5" },
                { name: "unit 1 imp.  ", url: "https://tinyurl.com/2bczmscg" },
                { name: "unit 1st", url: "https://tinyurl.com/2ah8wndg" },
                { name: "Unit 2 NA", url: "https://tinyurl.com/2c5lx7aw" },
                { name: "Unit 2 pdf", url: "https://tinyurl.com/24t76fo2" },
                { name: "unit 2nd", url: "https://tinyurl.com/26lh65wx" },
                { name: "Unit 3 abstract algebra hindi", url: "https://tinyurl.com/2dho32sw" },
                { name: "unit 3 pdf", url: "https://tinyurl.com/233u6pg4" },
                { name: "unit 3B", url: "https://tinyurl.com/2yq66wqm" },
                { name: "Unit-1 Complex Analysis", url: "https://tinyurl.com/27mh79af" },
                { name: "Unit-2 Complex Analysis", url: "https://tinyurl.com/27yv5en6" },
                { name: "unit-2(real analysis)", url: "https://tinyurl.com/269w3cqv" },
                { name: "Unit-3 Eng. Complex Analysis", url: "https://tinyurl.com/25u77j2h" },
                { name: "unit-3(real analysis)", url: "https://tinyurl.com/28yodhf9" },
                { name: "unit-4 ( real analysis)", url: "https://tinyurl.com/232w8hn2" },
                { name: "unit-5 (real analysis)", url: "https://tinyurl.com/2c9gatxb" },
                { name: "Unti 2 DE Complete", url: "https://tinyurl.com/2c2kw8qj" },
                { name: "u-1 notes  (1)", url: "https://tinyurl.com/257j3xnu" },
                { name: "u-2 notes  (1)", url: "https://tinyurl.com/2cslh9xx" },
                { name: "u-1   (1) (1)", url: "https://tinyurl.com/29cp48r2" },
                { name: "u-4  (1)", url: "https://tinyurl.com/24szw6kb" },
                { name: "P.C. Unit-4 MO Theory", url: "https://tinyurl.com/2d39hynl" },
                { name: "RA_Unit_I_example", url: "https://tinyurl.com/28pol5me" },
                { name: "RA_Unit_I", url: "https://tinyurl.com/2cdpqcp6" }
            ]
        };

        // Mathematics PYQ Data - Organized by Semester
        const mathematicsPyqData = {
            "Sem 1": [
                { name: "B.A. B.Sc I Sem Math mathematics_calculus_1400_date 2-12-19", url: "https://tinyurl.com/2yqre8ud" },
                { name: "BA_B_SC_I_SEM_MATHEMATICS_I DISCRETE MATHEMATICS_1500_date 28 11", url: "https://tinyurl.com/29ub54tv" },
                { name: "sem 1 paper bsc maths 2022 session", url: "https://tinyurl.com/2acg3rrf" }
            ],
            "Sem 2": [
                { name: "Abstract algebra 1 question paper 2 semester", url: "https://tinyurl.com/2bwkva96" },
                { name: "B.SC II SEM Mathematics Calculus- II 1300 date 4-5-19", url: "https://tinyurl.com/23crl3e7" },
                { name: "B.Sc II Sem Maths GRAPH THEORY 1300 date 17-5-19", url: "https://tinyurl.com/2b2g7sk3" }
            ],
            "Sem 3": [
                { name: "B.Sc III Sem Maths - REAL ANALYSIS 1200 date 6-12-19", url: "https://tinyurl.com/2asb59ox" },
                { name: "B.Sc III Sem Maths - DIFFERENTIAL EQUATION 1200 date 7-12-19", url: "https://tinyurl.com/22s8k7bb" },
                { name: "B.Sc III Sem Maths - NUMERICAL ANALYSIS 1200 date 10-12-19", url: "https://tinyurl.com/2bfu74b9" },
                { name: "Bsc 3 sem maths 1stpaper (Real analysis) 2023 (1)", url: "https://tinyurl.com/27e27f82" },
                { name: "Real analysis 3rd sem final exam 22-24", url: "https://tinyurl.com/26f4w7j9" }
            ],
            "Sem 4": [
                { name: "B Sc IV Sem Maths ADVANCED ANALYSIS AND METRIC SPACE 1300 date 21", url: "https://tinyurl.com/266shnpe" },
                { name: "B Sc Mathematic IV Sem Differential Equation 1400 date 21 5 19", url: "https://tinyurl.com/2b3yqk2o" },
                { name: "DE (16,17,18,19,21)", url: "https://tinyurl.com/2dxnkv8o" }
            ],
            "Sem 5": [
                { name: "5th sem abstract alg pyp 15,16,17,18,19,22", url: "https://tinyurl.com/26za2qdc" },
                { name: "Abstract algebra 1 question paper 5 semester", url: "https://tinyurl.com/26qlvcsr" },
                { name: "BSC sem5 2023 maths paper", url: "https://tinyurl.com/24o6s57d" },
                { name: "Numerical analysis (16,17,18,22)", url: "https://tinyurl.com/26h7bx9z" },
                { name: "topology (16,17,18,19,22)", url: "https://tinyurl.com/26aemnyy" },
                { name: "Real analysis (16,17,18,19,20,21,22)", url: "https://tinyurl.com/2ycpgcpn" },
                { name: "Topology (15,18)", url: "https://tinyurl.com/2xzb8xf4" }
            ],
            "Sem 6": [
                { name: "Bsc 6 sem maths honor algebra 2023", url: "https://tinyurl.com/22gfzr9x" },
                { name: "Metric space and advance analysis pyp 15,16,19,20,22 _2", url: "https://tinyurl.com/2cg3q39s" },
                { name: "Complex analysis pyp 15,16,17,18,19,22", url: "https://tinyurl.com/29hvdzb4" },
                { name: "Complex analysis - Copy", url: "https://tinyurl.com/23b8z9k3" }
            ],
            "All": [
                { name: "3D and Vector calculas last year papers", url: "https://tinyurl.com/2c8gk9f7" },
                { name: "Algebra previous year paper", url: "https://tinyurl.com/2cns8chj" },
                { name: "All previous year paper Bsc Maths", url: "https://tinyurl.com/22vwgwkz" },
                { name: "mathematical pyq", url: "https://tinyurl.com/26zxbroy" },
                { name: "Discrete mathematics last year paper", url: "https://tinyurl.com/2ctuvr7f" },
                { name: "maths previous year question papers", url: "https://tinyurl.com/28ue49je" },
                { name: "question Paper 2016-2022", url: "https://tinyurl.com/26hucz2d" },
                { name: "Maths Papers Dec 2023", url: "https://tinyurl.com/2a3vqdws" }
            ]
        };

        // Mathematics Assignments Data - Organized by Semester
        const mathematicsAssignmentsData = {
            "Sem 1": [
                { name: "BSc-Maths-Assignemnts (2)", url: "https://tinyurl.com/29xf9gy5" },
                { name: "BSc-Maths-Assignemnts (1)", url: "https://tinyurl.com/2y783xs8" },
                { name: "BSc-Maths-Assignemnts_1", url: "https://tinyurl.com/2dogq5el" }
            ],
            "Sem 3": [
                { name: "3 sem math assignment", url: "https://tinyurl.com/266lf9o6" }
            ],
            "Sem 4": [
                { name: "4 sem math assignment", url: "https://tinyurl.com/28try8dy" }
            ],
            "Sem 5": [
                { name: "5 sem Math assignment", url: "https://tinyurl.com/255bn7nd" }
            ],
            "Sem 6": [
                { name: "Abstract and complex complete assignment 6 th sem (hitesh) (1)", url: "https://tinyurl.com/22w7fjhr" },
                { name: "Abstract and complex complete assignment 6 th sem (hitesh)", url: "https://tinyurl.com/224q24nq" }
            ],
            "Unknown": [
                { name: "Complex assignment", url: "https://tinyurl.com/23qzbaro" }
            ],
            "All": [
                { name: "3D assignment", url: "https://tinyurl.com/255wugr4" },
                { name: "ADITYA SHARMA (MATHS)ASSIGN", url: "https://tinyurl.com/227bv85n" },
                { name: "BA_BSc_Mathematics", url: "https://tinyurl.com/23azfvll" },
                { name: "BSC-HONS-MATHS", url: "https://tinyurl.com/29jotpdw" }
            ]
        };

        // Mathematics Other/Practicals Data
        const mathematicsOtherData = {
            "Sem 1": [
                { name: "Physics Practical BSC 1st Semester", url: "https://tinyurl.com/2y3rn9f9" },
                { name: "Statistics practical file (Sem-1)", url: "https://tinyurl.com/2bezayna" },
                { name: "PRACTICAL NO. 1", url: "https://tinyurl.com/29or6eu9" },
                { name: "Physics practical 1st sem", url: "https://tinyurl.com/27xwzsek" }
            ],
            "Sem 2": [
                { name: "IInd Semester Physics Practical file", url: "https://tinyurl.com/29ujq5m8" },
                { name: "physics practical 2nd sem", url: "https://tinyurl.com/23xa2z4z" },
                { name: "IInd Sem Chemistry Practical File", url: "https://tinyurl.com/22coxnh9" },
                { name: "practical no. 2", url: "https://tinyurl.com/2534geuf" }
            ],
            "Sem 3": [
                { name: "Physics III Sem Practical Record hindi", url: "https://tinyurl.com/2ywefb68" },
                { name: "Physics III Sem Practical Record hindi", url: "https://tinyurl.com/2bcy6axf" },
                { name: "Chemistry III Sem Practical Record hindi medium", url: "https://tinyurl.com/29voadt3" },
                { name: "3rd sem statistics practical file", url: "https://tinyurl.com/2ypj3nwg" }
            ],
            "Sem 4": [
                { name: "Maths Practical 4th Semester", url: "https://tinyurl.com/27g23ozh" },
                { name: "Practical File Chemistry 4th Sem", url: "https://tinyurl.com/2d4yvf6h" },
                { name: "Maths Practical File 4th Sem", url: "https://tinyurl.com/2c4fpqfm" },
                { name: "Practical File Physics 4th Sem", url: "https://tinyurl.com/22q2w6b8" },
                { name: "Physics Practical File Sem IV", url: "https://tinyurl.com/2982ku99" },
                { name: "BSc-Mathematics-Practical-2024", url: "https://tinyurl.com/2yr57dnb" },
                { name: "NA practical 4th sem", url: "https://tinyurl.com/2ypxg5au" },
                { name: "Elementary-Computer-Application-Practical-Exam-2024", url: "https://tinyurl.com/2baycbll" },
                { name: "chemistry 4th sem practical file", url: "https://tinyurl.com/2257tdla" },
                { name: "statistics practical 4 sem", url: "https://tinyurl.com/29rjaknb" },
                { name: "4 sem practical physics 2024", url: "https://tinyurl.com/2bb39tdb" }
            ],
            "Sem 5": [
                { name: "physics practical 5th sem_2", url: "https://tinyurl.com/2ybsdgzw" },
                { name: "5th Sem. Physics Practical file English medium", url: "https://tinyurl.com/28rq2hv8" },
                { name: "5th Sem Chemistry Practical file English medium", url: "https://tinyurl.com/26euyx3y" },
                { name: "chemistry practical 5th sem", url: "https://tinyurl.com/27sx9ykm" }
            ],
            "Sem 6": [
                { name: "B Sc, VI th Sem Practical file", url: "https://tinyurl.com/2ag7ojgr" },
                { name: "B. Sc. VI Sem practical file", url: "https://tinyurl.com/2bkvmf4g" },
                { name: "Botany VI Sem Practical Record English", url: "https://tinyurl.com/2an336nj" },
                { name: "Chemistry VI Sem Practical English", url: "https://tinyurl.com/26opdzr6" },
                { name: "Chemistry VI Sem Practical Hindi", url: "https://tinyurl.com/25etng9n" },
                { name: "Zoology VI sem practical record english", url: "https://tinyurl.com/2a2v675q" },
                { name: "physics practical 6 sem", url: "https://tinyurl.com/28x76cz4" },
                { name: "Chemistry practical sem 6", url: "https://tinyurl.com/29clpzhh" },
                { name: "Physics VI Sem Practical English", url: "https://tinyurl.com/274xyddh" },
                { name: "Maths VI Sem Practical ( Hindi)", url: "https://tinyurl.com/23uht3t8" },
                { name: "Math practical complete 6th sem", url: "https://tinyurl.com/26h998v7" },
                { name: "Geo practical file 6 sem", url: "https://tinyurl.com/27lzknyt" },
                { name: "Bsc Practical may June 2025 Sem 2,4,6", url: "https://tinyurl.com/27wuh8yo" }
            ],
            "All": [
                { name: "BSC-MATHS", url: "https://tinyurl.com/25hefjf2" },
                { name: "Syllabus_BSc_Mathematics_wef_Oct2023 (2)", url: "https://tinyurl.com/23cv5qvb" },
                { name: "syllabus_bsc_maths_new (1)", url: "https://tinyurl.com/249ruln5" },
                { name: "syllabus_bsc_maths_new", url: "https://tinyurl.com/2292hlfl" },
                { name: "physics practical", url: "https://tinyurl.com/2dx45e5e" },
                { name: "physics practical book semester 1", url: "https://tinyurl.com/2a4o5nvm" },
                { name: "Psychology 1st Sem Practical File", url: "https://tinyurl.com/22rqzjl6" },
                { name: "maths pratical by shubham bansal", url: "https://tinyurl.com/263zjyhn" },
                { name: "chemistry practical hindi", url: "https://tinyurl.com/2xpqa7lu" },
                { name: "C-Programming NA practical file", url: "https://tinyurl.com/2cduxh4b" },
                { name: "Chemistry Practical", url: "https://tinyurl.com/2952jvot" },
                { name: "physics practical ,2nd sem Ajeet agrwal", url: "https://tinyurl.com/2dymn6bb" },
                { name: "BSc-Chemistry-Practical-Examination-May-2023", url: "https://tinyurl.com/2ak32866" },
                { name: "UG Physics Practical Time-Table", url: "https://tinyurl.com/2ya4r39y" },
                { name: "BSc-Maths-Practical-Examination-May-2023", url: "https://tinyurl.com/2cmmjc7p" },
                { name: "Computer Practical File", url: "https://tinyurl.com/25yk53vm" },
                { name: "BA-BSc-Geography-Sem-VI-Practical-Examination-May2023", url: "https://tinyurl.com/2746m8x8" },
                { name: "Geography Practical File", url: "https://tinyurl.com/292nq9b7" },
                { name: "Statistical Practical(1-11)", url: "https://tinyurl.com/29x4u5ta" },
                { name: "statistical practical(12â€“20)", url: "https://tinyurl.com/27b93988" },
                { name: "statistical practical(21â€“23)", url: "https://tinyurl.com/2y6unnnd" },
                { name: "Physics practical__ Yogesh Agrawal", url: "https://tinyurl.com/2dyyfu7k" },
                { name: "timetable-geography-practical-final-examination-2023", url: "https://tinyurl.com/2ycupkp6" },
                { name: "chem. practical record", url: "https://tinyurl.com/28czsb9y" },
                { name: "chemistry Practical 5-9", url: "https://tinyurl.com/2yhzdgsq" },
                { name: "Geo. Practical file", url: "https://tinyurl.com/24saya4u" },
                { name: "Physics Practical Record Sem 1st -merged", url: "https://tinyurl.com/29xg2z82" },
                { name: "Chenistry Practical Record SEM 1ST", url: "https://tinyurl.com/26snauvn" },
                { name: "BSc-Chemistry-Sem-I-Practical-Examination-Feb-2023", url: "https://tinyurl.com/2ayvdqeo" },
                { name: "BSc-Physics-Sem-I-Practical-Examination-Feb-2023", url: "https://tinyurl.com/24ok9rle" },
                { name: "chemistry last practical", url: "https://tinyurl.com/2yh9rrw6" },
                { name: "Chemistry Practical BSC 1st Semester pdf-1", url: "https://tinyurl.com/22hoa6sx" },
                { name: "BSc-Chemistry-Practical-2024", url: "https://tinyurl.com/27alnbrk" },
                { name: "BSc Physics Practical Exam-May2024", url: "https://tinyurl.com/2yxa8t7w" },
                { name: "Revised_Physics_Practical_Examination_Dec2023", url: "https://tinyurl.com/22zap46m" },
                { name: "physics practical file", url: "https://tinyurl.com/2ych2c47" },
                { name: "physics practical file bsc first year", url: "https://tinyurl.com/27k9ko8v" },
                { name: "physics practicals", url: "https://tinyurl.com/2debftx5" },
                { name: "physics practical_1", url: "https://tinyurl.com/2xjq8ak4" },
                { name: "math practical of 4th semester", url: "https://tinyurl.com/2c7tvk2z" },
                { name: "Maths Practical (English Medium)", url: "https://tinyurl.com/24vrl5uy" },
                { name: "Chemistry Practical(1-4).pdf", url: "https://tinyurl.com/29fjldy9" },
                { name: "chemistry practical file", url: "https://tinyurl.com/2xhlh27n" },
                { name: "chemistry practical file", url: "https://tinyurl.com/2bjfk2aa" },
                { name: "chemistry practical record 2023", url: "https://tinyurl.com/2yfv85o3" },
                { name: "BSc-Chemistry-Practical-Exam-TT-Dec2023", url: "https://tinyurl.com/2ag2eh7l" },
                { name: "BSc-Math-Practical-Examination-Apr-2025", url: "https://tinyurl.com/26xp5uky" },
                { name: "BSc-MSc-Physics-Practical-Exam-TT-Dec2023", url: "https://tinyurl.com/2dk4xpj6" },
                { name: "BSc-Physics-Practical-Examination-Apr-2025", url: "https://tinyurl.com/2xns6qt7" },
                { name: "BSc-Physics-Practical-Examination-Dec-2024", url: "https://tinyurl.com/2bxckkh7" },
                { name: "2nd chemistry practical English medium", url: "https://tinyurl.com/2c8ho9op" },
                { name: "practical", url: "https://tinyurl.com/26zb6qmu" },
                { name: "mscbiotechnologypracticalexamjan2023", url: "https://tinyurl.com/2dbw7k4w" },
                { name: "Geography practical 2021", url: "https://tinyurl.com/27uj552j" },
                { name: "Practical Schedule 19 May, 2022", url: "https://tinyurl.com/28dxepqy" },
                { name: "ElementaryPracticalScheduleMay2022", url: "https://tinyurl.com/2afjvtrk" },
                { name: "GEOGRAPHY SEM 5th 2022 THEORY AND PRACTICAL PAPER", url: "https://tinyurl.com/2aocvtb2" },
                { name: "B.Sc. Practical Batch schedule 2023", url: "https://tinyurl.com/25kyfn6h" },
                { name: "ElementaryPracticalScheduleMay2022", url: "https://tinyurl.com/23r3na9c" }
            ]
        };
        
        // PYQ Data - Merging with Mathematics data
        const pyqData = JSON.parse(JSON.stringify(studyMaterialNestedData));
        pyqData["B.Sc. (Bachelor of Science)"]["Mathematics"] = mathematicsPyqData;
        
        // Practicals Data - Merging with Mathematics data
        const practicalsData = JSON.parse(JSON.stringify(studyMaterialNestedData));
        practicalsData["B.Sc. (Bachelor of Science)"]["Mathematics"] = mathematicsOtherData;
        
        // Assignments Data - Merging with Mathematics data
        const assignmentsData = JSON.parse(JSON.stringify(studyMaterialNestedData));
        assignmentsData["B.Sc. (Bachelor of Science)"]["Mathematics"] = mathematicsAssignmentsData;
        
        // Notes Data - Merging with Mathematics data
        const notesData = JSON.parse(JSON.stringify(studyMaterialNestedData));
        notesData["B.Sc. (Bachelor of Science)"]["Mathematics"] = mathematicsNotesData;

        // ==================== CHEMISTRY DATA ====================
        const chemistryNotesData = {
            "Sem 1": [
                { name: "B.Sc I Sem BOTANY-II MICROBIOLOGY", url: "https://tinyurl.com/2yw68tsf" },
                { name: "B.Sc Sem1 M.O.T chem Notes", url: "https://tinyurl.com/27rolxsc" },
                { name: "B.Sc Sem1 M.O.T Hindi Notes", url: "https://tinyurl.com/2awdzcek" },
                { name: "B.Sc.Sem 1 Inorganic Notes.pdf unit 1st", url: "https://tinyurl.com/28htzvuz" },
                { name: "Bsc 1sem unit-3 liquid state hindi medium", url: "https://tinyurl.com/242bbpcm" },
                { name: "CH.4 Organic chemistry [Bsc 1st year]", url: "https://tinyurl.com/2bbgao69" },
                { name: "CH.5 Organic chemistry [Bsc 1st year]", url: "https://tinyurl.com/22nrnr6b" },
                { name: "d-block Elements", url: "https://tinyurl.com/24jpvp2d" },
                { name: "Full Organic Chemistry Notes for B.SC 1st Year(1)", url: "https://tinyurl.com/25ex9ps6" },
                { name: "Gas state hindi medium", url: "https://tinyurl.com/2yc5pqnr" },
                { name: "Inorganic 1st Unit", url: "https://tinyurl.com/2dc2hg8j" },
                { name: "Inorganic (Chemical Bonding) Notes", url: "https://tinyurl.com/22f8pqml" },
                { name: "Inorganic (Covalent Bonding) Notes", url: "https://tinyurl.com/2y3mgas7" },
                { name: "Organic 1st Unit", url: "https://tinyurl.com/25oscv4f" },
                { name: "unit-1 Chemical Bonding Part-I", url: "https://tinyurl.com/2ab698nk" },
                { name: "alkane cyclo alkane alkene [Chemistry]", url: "https://tinyurl.com/22pza7g9" },
                { name: "Alkane", url: "https://tinyurl.com/2b6bzh9f" },
                { name: "alkanes and cyclo hindi", url: "https://tinyurl.com/293mcsjq" },
                { name: "alkene sem first notes", url: "https://tinyurl.com/22xmpt45" },
                { name: "cycloalkanes", url: "https://tinyurl.com/25wxfhxz" },
                { name: "cycloalkanes (1)", url: "https://tinyurl.com/24znjkt6" },
                { name: "cycloalkanes", url: "https://tinyurl.com/2a3b7yvo" },
                { name: "cyloalkanes", url: "https://tinyurl.com/29p6cvx4" },
                { name: "covalent bond bsc sem1", url: "https://tinyurl.com/25onwyoa" },
                { name: "covalent bond chemistry", url: "https://tinyurl.com/282y4g4k" },
                { name: "d-block Elements (1)(1)", url: "https://tinyurl.com/2y6cqan9" },
                { name: "Inorganic Covalent bond (3)", url: "https://tinyurl.com/2da7h6zg" }
            ],
            "Sem 2": [
                { name: "B.sc (Hons) II sem inorganic", url: "https://tinyurl.com/247wucx2" },
                { name: "Bsc II sem inorganic unit I", url: "https://tinyurl.com/2bo2x9pg" },
                { name: "II SEM INORG CHEM UNIT-IV", url: "https://tinyurl.com/2xoy57ku" },
                { name: "II SEM INORGANIC UNIT-III (1)", url: "https://tinyurl.com/28rht3kf" },
                { name: "UNIT - II Phase Equilibrium II", url: "https://tinyurl.com/2clj37px" },
                { name: "unit-1 Acids and Bases", url: "https://tinyurl.com/22vfnjtw" },
                { name: "unit-2 Phenol", url: "https://tinyurl.com/275cb8a2" },
                { name: "unit-4 Chemical equilibrium", url: "https://tinyurl.com/252sfltj" },
                { name: "alkyene and diene hindi", url: "https://tinyurl.com/25wq3mhe" },
                { name: "Co-ordination Compounds", url: "https://tinyurl.com/22ptqhum" },
                { name: "Coordination compounds in hindi", url: "https://tinyurl.com/297opvad" },
                { name: "Stereochemistry IInd sem Unit I", url: "https://tinyurl.com/2bs4dcg3" },
                { name: "organic chemistry unit 2nd phenol", url: "https://tinyurl.com/27kqktxh" },
                { name: "Unit 2 Organic (1)", url: "https://tinyurl.com/2afmr6gn" },
                { name: "Unit 2 Organic", url: "https://tinyurl.com/23pfw6lh" },
                { name: "UNIT - I phase Euilibrium I", url: "https://tinyurl.com/2767kvfy" },
                { name: "UNIT - I Coordination Compounds (1)(1)", url: "https://tinyurl.com/2a9b8wxh" },
                { name: "UNIT - I Coordination Compounds", url: "https://tinyurl.com/287r3w55" }
            ],
            "Sem 3": [
                { name: "B.SC III CHEMISTRY -INORGANIC CHEMISTRY", url: "https://tinyurl.com/28gadfxp" },
                { name: "B.Sc III Sem CHEMISTRY ORGANIC CHEMISTRY", url: "https://tinyurl.com/27jo8ora" },
                { name: "Bsc 3rd sem Chemistry- Inorganic Chemistry (1)", url: "https://tinyurl.com/23gmvp3j" },
                { name: "Bsc 3rd sem Chemistry- Organic Chemistry", url: "https://tinyurl.com/2xkvfofe" },
                { name: "UNIT - III Heterocyclic compounds- I(1)", url: "https://tinyurl.com/2xvf2jaa" },
                { name: "UNIT - III Heterocyclic compounds- I", url: "https://tinyurl.com/29oz5ltd" },
                { name: "unit-3 inorganic bsc part 3rd year", url: "https://tinyurl.com/287vhsza" },
                { name: "solid -unit 3", url: "https://tinyurl.com/2238lwj2" },
                { name: "P.C. Unit-3 SPECTROSCOPY II", url: "https://tinyurl.com/23vgy3na" },
                { name: "alkyl halide and aryl halide organic chemistry", url: "https://tinyurl.com/2544u74y" },
                { name: "arenes and arometicity", url: "https://tinyurl.com/27facbma" },
                { name: "CHEM_3rd_year_SVà¤¨à¥€_à¤…à¤¶à¥à¤µà¤¿à¤¨à¥€_à¤²à¤¾à¤Ÿà¤¾", url: "https://tinyurl.com/265cxogo" },
                { name: "Colloidal State Unit 1", url: "https://tinyurl.com/22qp382l" },
                { name: "Solid hindi", url: "https://tinyurl.com/2ykazw5y" },
                { name: "Solid Unit -1 âˆ†âˆ†", url: "https://tinyurl.com/2b7lx2gu" },
                { name: "organic unit 3", url: "https://tinyurl.com/2yo5tkrd" },
                { name: "unit 4 chemistry", url: "https://tinyurl.com/2d8v2lby" },
                { name: "Unit 4 Inorganic chemistry(1)", url: "https://tinyurl.com/27m32e7w" },
                { name: "unit_4_ _inorganic_bsc_part_3rd_year_edited_signed", url: "https://tinyurl.com/26x78hju" }
            ],
            "Sem 4": [
                { name: "Oxidation and Reduction Inorganic Sem IV", url: "https://tinyurl.com/23dmuqj6" },
                { name: "chemistry paper 2nd unit 4th 07-Apr-2025 11-59-18", url: "https://tinyurl.com/265sr47a" },
                { name: "UNIT - IV Adsorption", url: "https://tinyurl.com/2y35mv4l" },
                { name: "UNIT - IV Heterocyclic compounds- II(1)", url: "https://tinyurl.com/24sgalw8" },
                { name: "UNIT - IV Heterocyclic compounds- II", url: "https://tinyurl.com/2b98uv5p" },
                { name: "chemical kinetics bsc", url: "https://tinyurl.com/25y4t8jl" }
            ],
            "Sem 5": [
                { name: "inorganic chemisry 5th sem by -Abhishek rao", url: "https://tinyurl.com/232by8jb" }
            ],
            "Sem 6": [
                { name: "b. SC. VI sem organic", url: "https://tinyurl.com/26bc2lzh" },
                { name: "b. SC. VI sem organic unit IV", url: "https://tinyurl.com/2yyf3hrn" },
                { name: "B.Sc VI Sem Inorganic Chemistry unit 4", url: "https://tinyurl.com/2aekf2ag" },
                { name: "B.Sc VI Sem Inorganic chemistry unit 4 hindi medium", url: "https://tinyurl.com/22ww7j5m" },
                { name: "B.Sc VI Sem- Inorganic Chemistry- unit 2", url: "https://tinyurl.com/22khvtwk" },
                { name: "Bsc VI sem inorganic chemistry Unit 2 hindi medium", url: "https://tinyurl.com/2cc99dgg" },
                { name: "BSc-VI-Sem-OrgChem-III-unit", url: "https://tinyurl.com/228hs2ty" },
                { name: "BSc-VI-Sem-OrgChem-IV-unit", url: "https://tinyurl.com/243rsolc" },
                { name: "carbohydrates unit 2 Sem 6", url: "https://tinyurl.com/2bfpq7v4" },
                { name: "carbohydrates (1)", url: "https://tinyurl.com/2cv4orqr" },
                { name: "Chemistry of Lanthanides", url: "https://tinyurl.com/24n74zm9" },
                { name: "Chemistry_organic_unit_3", url: "https://tinyurl.com/28t8fgud" },
                { name: "organic chemistry unit-3", url: "https://tinyurl.com/2xp7v879" },
                { name: "organic u4", url: "https://tinyurl.com/26mvykjk" },
                { name: "u2_ Bsc_VI_sem_inorganic_chemistry_Unit_2_hindi_medium", url: "https://tinyurl.com/27gh5c8m" }
            ],
            "Unknown": [
                { name: "chemistry notes", url: "https://tinyurl.com/25bszhfp" },
                { name: "Dipole moment", url: "https://tinyurl.com/2ykrcbsk" },
                { name: "HSAB", url: "https://tinyurl.com/2yz5rnpk" },
                { name: "HSAB Inorganic chemistry", url: "https://tinyurl.com/2bypcys9" },
                { name: "inorganic", url: "https://tinyurl.com/25dj4upn" },
                { name: "inorganic chemistry", url: "https://tinyurl.com/2484b8d7" },
                { name: "Inorganic chemistry notes", url: "https://tinyurl.com/2yahrvyw" },
                { name: "inorganic polymer", url: "https://tinyurl.com/2bh6lmzo" },
                { name: "INORGANIC SEM6", url: "https://tinyurl.com/29cmfo5w" },
                { name: "inorganic unit 1", url: "https://tinyurl.com/27aayy5l" },
                { name: "inorganic unit 2 last topic-1", url: "https://tinyurl.com/2bug7ytp" },
                { name: "Ionic Solids", url: "https://tinyurl.com/23nsyawm" },
                { name: "liquid state ~ymn", url: "https://tinyurl.com/2xujpt5b" },
                { name: "Liquid State", url: "https://tinyurl.com/2bg6v3xk" },
                { name: "matraaatamk chapter4 inorganic", url: "https://tinyurl.com/2ylkxhcg" },
                { name: "mechanism of organic reactions", url: "https://tinyurl.com/2btulae4" },
                { name: "Metal Chemistry (1) (1)", url: "https://tinyurl.com/2a3mncd4" },
                { name: "metallic bond", url: "https://tinyurl.com/2db2qtnf" },
                { name: "NUCLEAR CHEMISTRY", url: "https://tinyurl.com/2ylmm2xj" },
                { name: "nuclear chemistry", url: "https://tinyurl.com/29rb46cz" },
                { name: "organic chemistry âš—ï¸", url: "https://tinyurl.com/2bfn4nay" },
                { name: "Organic chemistry unit 1 (3)", url: "https://tinyurl.com/2d2sc6l5" },
                { name: "organic chemistry unit-2", url: "https://tinyurl.com/238z5jmc" },
                { name: "organic u1", url: "https://tinyurl.com/2xmxrsll" },
                { name: "ORGANIC UNIT1", url: "https://tinyurl.com/2bun9fvx" },
                { name: "ORGANIC UNIT2", url: "https://tinyurl.com/223k5axf" },
                { name: "ORGANIC UNIT4", url: "https://tinyurl.com/255ps2pt" },
                { name: "Organic_unit_I-1", url: "https://tinyurl.com/2a4zx2z3" },
                { name: "Organic_unit_II (1)", url: "https://tinyurl.com/2avwdhc4" },
                { name: "P-Block chemistry", url: "https://tinyurl.com/2cvztmta" },
                { name: "P.C. Unit-4 MO Theory", url: "https://tinyurl.com/2d39hynl" },
                { name: "Solutions", url: "https://tinyurl.com/2cngp236" },
                { name: "sterio chemistry unit 1 organic chemistry", url: "https://tinyurl.com/26oa4nf5" },
                { name: "u1 Metal Chemistry", url: "https://tinyurl.com/272qf4s5" },
                { name: "Unit 1 Organic Complete (1)", url: "https://tinyurl.com/24jg7qd2" },
                { name: "Unit 1 Organic Complete", url: "https://tinyurl.com/24tpp76n" }
            ],
            "All": [
                { name: "alkane cyclo alkane alkene [Chemistry]", url: "https://tinyurl.com/22pza7g9" },
                { name: "Alkane", url: "https://tinyurl.com/2b6bzh9f" },
                { name: "alkanes and cyclo hindi", url: "https://tinyurl.com/293mcsjq" },
                { name: "alkene sem first notes", url: "https://tinyurl.com/22xmpt45" },
                { name: "alkyene and diene hindi", url: "https://tinyurl.com/25wq3mhe" },
                { name: "alkyl halide and aryl halide organic chemistry", url: "https://tinyurl.com/2544u74y" },
                { name: "arenes and arometicity", url: "https://tinyurl.com/27facbma" },
                { name: "B.Sc VI Sem- Inorganic Chemistry- unit 2", url: "https://tinyurl.com/22khvtwk" },
                { name: "BSc-VI-Sem-OrgChem-IV-unit", url: "https://tinyurl.com/243rsolc" },
                { name: "carbohydrates (1)", url: "https://tinyurl.com/2cv4orqr" },
                { name: "CH.5 Organic chemistry [Bsc 1st year]", url: "https://tinyurl.com/22nrnr6b" },
                { name: "CHEM_3rd_year_SVà¤¨à¥€_à¤…à¤¶à¥à¤µà¤¿à¤¨à¥€_à¤²à¤¾à¤Ÿà¤¾", url: "https://tinyurl.com/265cxogo" },
                { name: "chemical kinetics bsc", url: "https://tinyurl.com/25y4t8jl" },
                { name: "chemistry notes", url: "https://tinyurl.com/25bszhfp" },
                { name: "Co-ordination Compounds", url: "https://tinyurl.com/22ptqhum" },
                { name: "Colloidal State Unit 1", url: "https://tinyurl.com/22qp382l" },
                { name: "Coordination compounds in hindi", url: "https://tinyurl.com/297opvad" },
                { name: "covalent bond bsc sem1", url: "https://tinyurl.com/25onwyoa" },
                { name: "covalent bond chemistry", url: "https://tinyurl.com/282y4g4k" },
                { name: "cycloalkanes", url: "https://tinyurl.com/25wxfhxz" },
                { name: "cycloalkanes (1)", url: "https://tinyurl.com/24znjkt6" },
                { name: "cycloalkanes", url: "https://tinyurl.com/2a3b7yvo" },
                { name: "cyloalkanes", url: "https://tinyurl.com/29p6cvx4" },
                { name: "d-block Elements (1)(1)", url: "https://tinyurl.com/2y6cqan9" },
                { name: "Dipole moment", url: "https://tinyurl.com/2ykrcbsk" },
                { name: "Full Organic Chemistry Notes for B.SC 1st Year(1)", url: "https://tinyurl.com/25ex9ps6" },
                { name: "Gas state hindi medium", url: "https://tinyurl.com/2yc5pqnr" },
                { name: "HSAB", url: "https://tinyurl.com/2yz5rnpk" },
                { name: "HSAB Inorganic chemistry", url: "https://tinyurl.com/2bypcys9" },
                { name: "Inorganic (Chemical Bonding) Notes", url: "https://tinyurl.com/22f8pqml" },
                { name: "Inorganic (Covalent Bonding) Notes", url: "https://tinyurl.com/2y3mgas7" },
                { name: "inorganic", url: "https://tinyurl.com/25dj4upn" },
                { name: "Inorganic 1st Unit", url: "https://tinyurl.com/2dc2hg8j" },
                { name: "inorganic chemistry", url: "https://tinyurl.com/2484b8d7" },
                { name: "Inorganic chemistry notes", url: "https://tinyurl.com/2yahrvyw" },
                { name: "Inorganic Covalent bond (3)", url: "https://tinyurl.com/2da7h6zg" },
                { name: "inorganic polymer", url: "https://tinyurl.com/2bh6lmzo" },
                { name: "INORGANIC SEM6", url: "https://tinyurl.com/29cmfo5w" },
                { name: "inorganic unit 1", url: "https://tinyurl.com/27aayy5l" },
                { name: "inorganic unit 2 last topic-1", url: "https://tinyurl.com/2bug7ytp" },
                { name: "Ionic Solids", url: "https://tinyurl.com/23nsyawm" },
                { name: "liquid state ~ymn", url: "https://tinyurl.com/2xujpt5b" },
                { name: "Liquid State", url: "https://tinyurl.com/2bg6v3xk" },
                { name: "matraaatamk chapter4 inorganic", url: "https://tinyurl.com/2ylkxhcg" },
                { name: "mechanism of organic reactions", url: "https://tinyurl.com/2btulae4" },
                { name: "Metal Chemistry (1) (1)", url: "https://tinyurl.com/2a3mncd4" },
                { name: "metallic bond", url: "https://tinyurl.com/2db2qtnf" },
                { name: "NUCLEAR CHEMISTRY", url: "https://tinyurl.com/2ylmm2xj" },
                { name: "nuclear chemistry", url: "https://tinyurl.com/29rb46cz" },
                { name: "organic chemistry âš—ï¸", url: "https://tinyurl.com/2bfn4nay" },
                { name: "Organic chemistry unit 1 (3)", url: "https://tinyurl.com/2d2sc6l5" },
                { name: "organic chemistry unit 2nd phenol", url: "https://tinyurl.com/27kqktxh" },
                { name: "organic chemistry unit-2", url: "https://tinyurl.com/238z5jmc" },
                { name: "organic u1", url: "https://tinyurl.com/2xmxrsll" },
                { name: "organic unit 3", url: "https://tinyurl.com/2yo5tkrd" },
                { name: "ORGANIC UNIT1", url: "https://tinyurl.com/2bun9fvx" },
                { name: "ORGANIC UNIT4", url: "https://tinyurl.com/255ps2pt" },
                { name: "ORGANIC UNIT2", url: "https://tinyurl.com/223k5axf" },
                { name: "Organic_unit_I-1", url: "https://tinyurl.com/2a4zx2z3" },
                { name: "Organic_unit_II (1)", url: "https://tinyurl.com/2avwdhc4" },
                { name: "P-Block chemistry", url: "https://tinyurl.com/2cvztmta" },
                { name: "P.C. Unit-4 MO Theory", url: "https://tinyurl.com/2d39hynl" },
                { name: "Solid hindi", url: "https://tinyurl.com/2ykazw5y" },
                { name: "Solid Unit -1 âˆ†âˆ†", url: "https://tinyurl.com/2b7lx2gu" },
                { name: "Solutions", url: "https://tinyurl.com/2cngp236" },
                { name: "Stereochemistry IInd sem Unit I", url: "https://tinyurl.com/2bs4dcg3" },
                { name: "sterio chemistry unit 1 organic chemistry", url: "https://tinyurl.com/26oa4nf5" },
                { name: "u1 Metal Chemistry", url: "https://tinyurl.com/272qf4s5" },
                { name: "u2_ Bsc_VI_sem_inorganic_chemistry_Unit_2_hindi_medium", url: "https://tinyurl.com/27gh5c8m" },
                { name: "UNIT - I Coordination Compounds (1)(1)", url: "https://tinyurl.com/2a9b8wxh" },
                { name: "UNIT - I Coordination Compounds", url: "https://tinyurl.com/287r3w55" },
                { name: "UNIT - I phase Euilibrium I", url: "https://tinyurl.com/2767kvfy" },
                { name: "UNIT - IV Heterocyclic compounds- II", url: "https://tinyurl.com/2b98uv5p" },
                { name: "Unit 1 Organic Complete (1)", url: "https://tinyurl.com/24jg7qd2" },
                { name: "Unit 2 Organic (1)", url: "https://tinyurl.com/2afmr6gn" },
                { name: "Unit 1 Organic Complete", url: "https://tinyurl.com/24tpp76n" },
                { name: "Unit 2 Organic", url: "https://tinyurl.com/23pfw6lh" },
                { name: "unit 4 chemistry", url: "https://tinyurl.com/2d8v2lby" },
                { name: "Unit 4 Inorganic chemistry(1)", url: "https://tinyurl.com/27m32e7w" },
                { name: "unit_4_ _inorganic_bsc_part_3rd_year_edited_signed", url: "https://tinyurl.com/26x78hju" },
                { name: "UNIT_II_Organometallic,Organolithium,Organo_sulphur_compound_", url: "https://tinyurl.com/2aprunu6" },
                { name: "UNIT_II_Organometallic,Organolithium,Organo_sulphur_compound_1", url: "https://tinyurl.com/23wbaqs9" },
                { name: "unit-1 Alcohols", url: "https://tinyurl.com/24wblalk" },
                { name: "unit-1 Chemical Bonding Part-I", url: "https://tinyurl.com/23z6foc9" },
                { name: "unit-1 Mechanism of organic reaction", url: "https://tinyurl.com/2ccne8zw" },
                { name: "unit-1st Gaseous State 1", url: "https://tinyurl.com/2b6nyrns" },
                { name: "unit-2 Alkanes", url: "https://tinyurl.com/24s25qtp" },
                { name: "unit-2 Alkanes & Cycloalkanes", url: "https://tinyurl.com/23bb445h" },
                { name: "unit-2 Chemical Bonding Part-II", url: "https://tinyurl.com/29j3mga8" },
                { name: "unit-2 Hard and soft acids and bases (HSAB)", url: "https://tinyurl.com/22ck85jl" },
                { name: "unit-2 Themochemistry", url: "https://tinyurl.com/276lpqhh" },
                { name: "unit-3 Alkenes or Cycloalkenes", url: "https://tinyurl.com/28m3cvya" },
                { name: "unit-3 liquid state", url: "https://tinyurl.com/28wcubrv" },
                { name: "unit-3 Non-aqueous solvent", url: "https://tinyurl.com/26l7f79m" },
                { name: "unit-3 p block -", url: "https://tinyurl.com/27p33cpc" },
                { name: "unit-3rd Liquid State", url: "https://tinyurl.com/26ulmuvb" },
                { name: "unit-4 Alkynes and Dienes", url: "https://tinyurl.com/227ffvmr" },
                { name: "unit-4 Ether and Epoxides", url: "https://tinyurl.com/26hsuvat" },
                { name: "à¤à¤²à¤•à¤¾à¤¡à¤¾à¤ˆà¤‡à¤¨", url: "https://tinyurl.com/285fa9og" },
                { name: "VBT", url: "https://tinyurl.com/2yjf99x2" },
                { name: "Chemistry_organic_unit_1", url: "https://tinyurl.com/2cmecutw" },
                { name: "Chemistry_organic_unit_2", url: "https://tinyurl.com/24wlc9av" },
                { name: "Chemistry_organic_unit_4", url: "https://tinyurl.com/26gcdw26" },
                { name: "chemistry unit 1", url: "https://tinyurl.com/24p979dk" },
                { name: "chemistry unit 1St and 2nd", url: "https://tinyurl.com/25nehggs" }
            ],
            "Unknown": [
                { name: "alkene", url: "https://tinyurl.com/256nqazv" },
                { name: "alkenes chemistry notes", url: "https://tinyurl.com/272xqwb9" },
                { name: "chemistry ï¸ organic", url: "https://tinyurl.com/2albcq43" },
                { name: "Chemical Equilibrium", url: "https://tinyurl.com/296tg85e" },
                { name: "Chemistry of Lanthanides (1)(1)", url: "https://tinyurl.com/2a7p3f3o" },
                { name: "chemistry radicals pdf", url: "https://tinyurl.com/28xomuu5" },
                { name: "gas state", url: "https://tinyurl.com/29y659pw" },
                { name: "Inorganic chemistry notes-1", url: "https://tinyurl.com/25uoxvq3" },
                { name: "inorganic unit 4 @", url: "https://tinyurl.com/2xnr2qjm" },
                { name: "isomerism", url: "https://tinyurl.com/258x7sqd" },
                { name: "liquid State created by (1)", url: "https://tinyurl.com/25u9t3nk" },
                { name: "Machanism 1,2,3 unit", url: "https://tinyurl.com/2afbat2a" },
                { name: "MOT(inorganic notes)", url: "https://tinyurl.com/25hskehz" },
                { name: "organic chemistry", url: "https://tinyurl.com/269h2bse" },
                { name: "organic chemistry unit 1", url: "https://tinyurl.com/294ak4nh" },
                { name: "organic chemistry unit 2", url: "https://tinyurl.com/2cughzn3" },
                { name: "organic_1", url: "https://tinyurl.com/24hpld34" },
                { name: "solvent extraction", url: "https://tinyurl.com/29r8flof" },
                { name: "unit 2 organic ymn", url: "https://tinyurl.com/282qpllg" },
                { name: "unit-1 Mechaniam of organic reaction -", url: "https://tinyurl.com/2bq6oz4u" },
                { name: "à¤à¤²à¤•à¥‡à¤¨", url: "https://tinyurl.com/2a8yrdq2" }
            ]
        };

        const chemistryPyqData = {
            "Sem 1": [
                { name: "B.Sc I Sem chemistry-II Organic Chemistry 1400 dated 5-1-19", url: "https://tinyurl.com/2ywvu2cb" },
                { name: "B_Sc_I_Sem_chemistry_II_Organic_Chemistry_1300_date_10_12_19", url: "https://tinyurl.com/26rxena7" },
                { name: "B.SC I CHEMISTRY -INORGANIC CHEMISTRY 1300 date 7-12-19", url: "https://tinyurl.com/2adp5c5h" },
                { name: "chemistry sem 1 pyq", url: "https://tinyurl.com/24q4gwzj" },
                { name: "inorganic chemistry old pape 3 year sem-1st", url: "https://tinyurl.com/24mudjwv" }
            ],
            "Sem 3": [
                { name: "B.SC III CHEMISTRY -INORGANIC CHEMISTRY 1200 date 10-11-19", url: "https://tinyurl.com/23xrh9al" },
                { name: "B.Sc III Sem chemistry organic Chemistry 1300 date 20-11-19", url: "https://tinyurl.com/2bou9wuf" }
            ],
            "Sem 4": [
                { name: "B.Sc IV sem chemistry- Inorganic chemistry 1200 date 4-5-19", url: "https://tinyurl.com/2654vafg" },
                { name: "b.sc IV sem chemistry- Organic chemistry 1300 date 21-5-19", url: "https://tinyurl.com/2955trsg" }
            ],
            "Sem 5": [
                { name: "BSc 5sem pass22 chemistry", url: "https://tinyurl.com/27tf7e5a" }
            ],
            "All": [
                { name: "chemistry paper 2nd unit 1st 07-Apr-2025 11-51-15(1)", url: "https://tinyurl.com/2bml4s4t" },
                { name: "chemistry paper 2nd unit 2nd", url: "https://tinyurl.com/2d82pv62" },
                { name: "chemistry pyq", url: "https://tinyurl.com/22vpezja" },
                { name: "Inorganic pyp", url: "https://tinyurl.com/232dmq7e" },
                { name: "organic chemistry old 3 year paper", url: "https://tinyurl.com/28g3bxwh" },
                { name: "organic chemistry papers", url: "https://tinyurl.com/2cpszogs" },
                { name: "total chem pyq", url: "https://tinyurl.com/2ap7g2xk" }
            ]
        };

        const chemistryAssignmentsData = {
            "Sem 3": [
                { name: "sem 3rd Inorganic and physical chemistry ASSIGNMENT", url: "https://tinyurl.com/2auwmurx" }
            ],
            "Sem 5": [
                { name: "organic chemistery assignment 5th sem", url: "https://tinyurl.com/2aen3jvj" }
            ],
            "Sem 6": [
                { name: "chemistry assignment 6th sem", url: "https://tinyurl.com/29l8domm" }
            ],
            "All": [
                { name: "BSc-Chemistry-Assignments_1", url: "https://tinyurl.com/28utdcj8" },
                { name: "BSC-HONS-CHEMISTRY", url: "https://tinyurl.com/2c4bzm3h" },
                { name: "chemistry assignment (1)_edited", url: "https://tinyurl.com/238lna6g" },
                { name: "chemistry assignment BSc first year", url: "https://drive.google.com/file/d/1zW-kBWr742FFKf4yCbqnHvV1aKnKVTtK/view?usp=drivesdk" },
                { name: "Chemistry Assignment_1", url: "https://tinyurl.com/2alylrep" },
                { name: "chemistry assignment", url: "https://tinyurl.com/2y7f5etg" },
                { name: "inorganic and organic assignment (1)", url: "https://tinyurl.com/2b2klpx8" },
                { name: "Inorganic assignment", url: "https://tinyurl.com/23zrnxgx" },
                { name: "inorganic chemistry assignment", url: "https://tinyurl.com/27l7po3x" },
                { name: "MSc-ChemistrywithSpec-Assignemnts", url: "https://tinyurl.com/24hwnr4c" },
                { name: "organic chemistry assignment", url: "https://tinyurl.com/264goybp" },
                { name: "physical chemistry assignment (1)", url: "https://tinyurl.com/2ynvr6q5" },
                { name: "physical chemistry assignment", url: "https://tinyurl.com/2yzjwzs3" }
            ],
            "Unknown": [
                { name: "BSc-Chemistry-Hons-Assignements", url: "https://tinyurl.com/2yatb8gc" },
                { name: "chemistry assignment Hindi medium", url: "https://tinyurl.com/2bgwj8hg" },
                { name: "Chemistry Assignment_1", url: "https://tinyurl.com/2alylrep" }
            ]
        };

        const chemistryOtherData = {
            "Sem 1": [
                { name: "physics practical book semester 1", url: "https://tinyurl.com/2a4o5nvm" },
                { name: "Physics Practical BSC 1st Semester", url: "https://tinyurl.com/2y3rn9f9" },
                { name: "Chemistry Practical BSC 1st Semester pdf-1", url: "https://tinyurl.com/22hoa6sx" },
                { name: "Physics Practical Record Sem 1st -merged", url: "https://tinyurl.com/29xg2z82" },
                { name: "Chenistry Practical Record SEM 1ST", url: "https://tinyurl.com/26snauvn" },
                { name: "BSc-Chemistry-Sem-I-Practical-Examination-Feb-2023", url: "https://tinyurl.com/2ayvdqeo" }
            ],
            "Sem 2": [
                { name: "IInd Semester Physics Practical file", url: "https://tinyurl.com/29ujq5m8" },
                { name: "physics practical 2nd sem", url: "https://tinyurl.com/23xa2z4z" },
                { name: "IInd Sem Chemistry Practical File", url: "https://tinyurl.com/22coxnh9" },
                { name: "2nd chemistry practical English medium", url: "https://tinyurl.com/2c8ho9op" }
            ],
            "Sem 3": [
                { name: "Chemistry III Sem Practical Record hindi medium", url: "https://tinyurl.com/29voadt3" }
            ],
            "Sem 4": [
                { name: "Practical File Chemistry 4th Sem", url: "https://tinyurl.com/2d4yvf6h" },
                { name: "chemistry 4th sem practical file", url: "https://tinyurl.com/2257tdla" }
            ],
            "Sem 5": [
                { name: "5th Sem Chemistry Practical file English medium", url: "https://tinyurl.com/26euyx3y" },
                { name: "chemistry practical 5th sem", url: "https://tinyurl.com/27sx9ykm" }
            ],
            "Sem 6": [
                { name: "Chemistry VI Sem Practical English", url: "https://tinyurl.com/26opdzr6" },
                { name: "Chemistry VI Sem Practical Hindi", url: "https://tinyurl.com/25etng9n" },
                { name: "Chemistry practical sem 6", url: "https://tinyurl.com/29clpzhh" }
            ],
            "All": [
                { name: "bsc_1st_year_chemistry_paper_2nd_most_Question_", url: "https://tinyurl.com/2cmpt8bc" },
                { name: "BSc_Chemistry_1", url: "https://tinyurl.com/26txp29g" },
                { name: "chemistry chitt", url: "https://tinyurl.com/29gvv7ur" },
                { name: "MSC(CHEMISTRY)", url: "https://tinyurl.com/263ebu5z" },
                { name: "short question inorganic (2)", url: "https://tinyurl.com/2daq2vy4" },
                { name: "chemistry practical hindi", url: "https://tinyurl.com/2xpqa7lu" },
                { name: "Chemistry Practical", url: "https://tinyurl.com/2952jvot" },
                { name: "BSc-Chemistry-Practical-Examination-May-2023", url: "https://tinyurl.com/2ak32866" },
                { name: "chemistry Practical 5-9", url: "https://tinyurl.com/2yhzdgsq" },
                { name: "chem. practical record", url: "https://tinyurl.com/28czsb9y" },
                { name: "chemistry last practical", url: "https://tinyurl.com/2yh9rrw6" },
                { name: "BSc-Chemistry-Practical-2024", url: "https://tinyurl.com/27alnbrk" },
                { name: "Chemistry Practical(1-4).pdf", url: "https://tinyurl.com/29fjldy9" },
                { name: "chemistry practical file", url: "https://tinyurl.com/2xhlh27n" },
                { name: "chemistry practical file", url: "https://tinyurl.com/2bjfk2aa" },
                { name: "chemistry practical record 2023", url: "https://tinyurl.com/2yfv85o3" },
                { name: "BSc-Chemistry-Practical-Exam-TT-Dec2023", url: "https://tinyurl.com/2ag2eh7l" }
            ],
            "Unknown": [
                { name: "syllabus_bsc_chemistry_new (1)", url: "https://tinyurl.com/2248cj46" },
                { name: "syllabus_bsc_chemistry_wef_Oct2023 (1)", url: "https://tinyurl.com/22myft8a" }
            ]
        };

        // Assign Chemistry Data
        pyqData["B.Sc. (Bachelor of Science)"]["Chemistry"] = chemistryPyqData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Chemistry"] = chemistryOtherData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Chemistry"] = chemistryAssignmentsData;
        notesData["B.Sc. (Bachelor of Science)"]["Chemistry"] = chemistryNotesData;

        // ==================== PHYSICS DATA ====================
        const physicsNotesData = {
            "Sem 1": [
                { name: "physics unit 1 vector space BSC 1st semester", url: "https://tinyurl.com/24fspvpx" },
                { name: "ELECTROMAGNETIC INDUCTION  (PART -1)", url: "https://tinyurl.com/24qgmtrz" },
                { name: "ELECTROMAGNETIC INDUCTION  (PART -2)", url: "https://tinyurl.com/29pwqjcd" },
                { name: "ELECTROMAGNETIC INDUCTION (PART-3)", url: "https://tinyurl.com/28cwg2z5" },
                { name: "POTENTAIL (PART-1)", url: "https://tinyurl.com/2ygbkj8s" },
                { name: "notes", url: "https://tinyurl.com/2dxutvud" },
                { name: "Calculus_and_Analytical_Geometry_Notes_Sharjeel", url: "https://tinyurl.com/2csb33cl" },
                { name: "notes notes", url: "https://tinyurl.com/2cjcowog" }
            ],
            "Sem 2": [
                { name: "unit 2nd Special Theory of Relativity", url: "https://tinyurl.com/275jdmba" },
                { name: "unit-2 Network Theorems -", url: "https://tinyurl.com/26v9u722" },
                { name: "Oscillation wave notes unit 1 bsc 2nd sem physics part 2", url: "https://tinyurl.com/23jlw66f" },
                { name: "bsc 2nd semester phy notes unit2", url: "https://tinyurl.com/27qltqpf" },
                { name: "dc & ac circuit notes", url: "https://tinyurl.com/25s2yv3q" },
                { name: "bsc semester 2 vector anaysis unit 1 part 1", url: "https://tinyurl.com/2ce42j3t" },
                { name: "bsc 2nd sem physics oscillation and wave", url: "https://tinyurl.com/2c8fcwvm" },
                { name: "bsc 2nd sem physics unit 2", url: "https://tinyurl.com/26fwrhm7" },
                { name: "dc & ac curcuit", url: "https://tinyurl.com/22mjyzbp" },
                { name: "unit 3 vector analysis notes", url: "https://tinyurl.com/2bf5mqar" },
                { name: "Physics II", url: "https://tinyurl.com/2b7o96t6" },
                { name: "sem 2 physics notes", url: "https://tinyurl.com/27rgaqlf" },
                { name: "unit 4 vector analysis bsc 2nd sem notes", url: "https://tinyurl.com/2ykmuwow" },
                { name: "sem 2 physics notes", url: "https://tinyurl.com/2b7hbvdw" },
                { name: "unit 2 vector analysis  bsc 2nd sem notes", url: "https://tinyurl.com/268w3vqo" },
                { name: "bsc semester 2 vector anaysis unit 1 part 2", url: "https://tinyurl.com/2a8e9m5l" },
                { name: "bsc 2nd sem physics unit 3", url: "https://tinyurl.com/2cnd5yge" },
                { name: "bsc 2nd semester phy notes unit 3", url: "https://tinyurl.com/2cykukf3" },
                { name: "oscillation and wave unit 1 bsc 2nd sem physics notes part 1", url: "https://tinyurl.com/25ztjzxo" },
                { name: "notes unit 2 dc and ac circuit", url: "https://tinyurl.com/2a3ghwxc" },
                { name: "Oscillation wave notes unit 1 bsc 2nd sem physics part 3", url: "https://tinyurl.com/2yy3vn7d" },
                { name: "bsc 2nd semester phy notes unit 4", url: "https://tinyurl.com/2cj4vqpf" },
                { name: "unit 4 dc and ac circuit", url: "https://tinyurl.com/2d72rhbx" },
                { name: "unit 1 dc and ac notes", url: "https://tinyurl.com/2asrpx4r" },
                { name: "BSC 2ND SEM PHYSICS NOTES NEERAJ BAIS", url: "https://tinyurl.com/2bem88vd" },
                { name: "bsc 2nd semester phy notes unit 1", url: "https://tinyurl.com/28pq3agr" },
                { name: "unit 3 dc ac circuit", url: "https://tinyurl.com/2dzcsgup" },
                { name: "bsc 2nd sem physics unit 4", url: "https://tinyurl.com/2xknchz8" },
                { name: "2nd semester notes physics", url: "https://tinyurl.com/24rucpjc" },
                { name: "bsc 2nd sem physics unit 1", url: "https://tinyurl.com/23dpbaxr" }
            ],
            "Sem 3": [
                { name: "unit 3rd polarization", url: "https://tinyurl.com/24nsbrqx" },
                { name: "unit-2 Thermodynamics Laws", url: "https://tinyurl.com/28kryzzf" },
                { name: "optics unit 3 interference", url: "https://tinyurl.com/23wvd72r" },
                { name: "note", url: "https://tinyurl.com/25xo9nrp" },
                { name: "UNIT-II B.Sc 3rd sem  physics notes", url: "https://tinyurl.com/24xdjjst" },
                { name: "notes 3", url: "https://tinyurl.com/2dx2h47h" },
                { name: "sem 3 unit 1 quantum physics", url: "https://tinyurl.com/2aklg8ce" },
                { name: "unit 2 quantum physics", url: "https://tinyurl.com/2cthxdfv" },
                { name: "optics unit 1 reflection&refraction", url: "https://tinyurl.com/2b46fvef" },
                { name: "phy 3 sem optics", url: "https://tinyurl.com/2cmzl92s" },
                { name: "UNIT-IV BSc 3rd sem physics notes", url: "https://tinyurl.com/28x7f22n" },
                { name: "optics notes", url: "https://tinyurl.com/29vrbkmh" },
                { name: "notes 3 sem", url: "https://tinyurl.com/2ay3bm5z" },
                { name: "optics and modern physics", url: "https://tinyurl.com/28aeg74b" },
                { name: "UNIT-I Bsc 3rd sem physics notes", url: "https://tinyurl.com/28k2sjfw" },
                { name: "sem 3 physics notes 2", url: "https://tinyurl.com/29lp3p7n" },
                { name: "SEMESTER 3", url: "https://tinyurl.com/27lvk6cs" },
                { name: "UNIT-III B.Sc 3rd sem physics notes", url: "https://tinyurl.com/26xrpjkg" },
                { name: "notes sem 3", url: "https://tinyurl.com/29szdwo5" },
                { name: "optics unit 2 diffraction", url: "https://tinyurl.com/25mvsltg" },
                { name: "optics unit 4", url: "https://tinyurl.com/22hqkntw" },
                { name: "sem 3 physics notes", url: "https://tinyurl.com/2bvggtcy" },
                { name: "thermal physics bsc 3 rd sem notes 1unit", url: "https://tinyurl.com/2xwmhuhz" },
                { name: "3 semester notes", url: "https://tinyurl.com/2co9kpnc" },
                { name: "thermal physics unit 1 notes", url: "https://tinyurl.com/292trgms" },
                { name: "notes 3 th", url: "https://tinyurl.com/28v69b2w" },
                { name: "thermal physics bsc 3 sem unit 3 notes", url: "https://tinyurl.com/26lf6hlv" },
                { name: "thermal bsc 3 sem unit 4 notes", url: "https://tinyurl.com/2ctmktvm" },
                { name: "unit 3 thermal", url: "https://tinyurl.com/2asnrx4m" },
                { name: "bsc 3 rd sem thermal physics", url: "https://tinyurl.com/2ctzgddw" },
                { name: "unit 3 quantum physics", url: "https://tinyurl.com/28xkk4xt" },
                { name: "quantum physics notes sem 3", url: "https://tinyurl.com/2cw7qlng" },
                { name: "thermal unit 2 notes", url: "https://tinyurl.com/22zzk3p7" },
                { name: "note physics 3 rd sem", url: "https://tinyurl.com/24j3kcod" },
                { name: "quantum unit 4 notes", url: "https://tinyurl.com/2b8lxq4h" },
                { name: "thermal physics bsc 3 sem unit 2 notes", url: "https://tinyurl.com/2ahr9afm" }
            ],
            "Sem 4": [
                { name: "Unit 1 sem- 4 tharmo", url: "https://tinyurl.com/25keghwf" },
                { name: "Physics sem 4 notes and solution", url: "https://tinyurl.com/22rzvk42" },
                { name: "bsc 4th sem physics notes", url: "https://tinyurl.com/25yuvyvk" },
                { name: "quantum physics important point", url: "https://tinyurl.com/2d5n8hnu" },
                { name: "Physics IV Sem Notes", url: "https://tinyurl.com/2y5fhsqe" },
                { name: "2nd unit solid state physics", url: "https://tinyurl.com/2xmfbwf8" },
                { name: "UNIT 2 SEM 4", url: "https://tinyurl.com/284bxfxs" },
                { name: "1st quantum unit", url: "https://tinyurl.com/288vxzl2" },
                { name: "solid physics unit 4", url: "https://tinyurl.com/29p3ujbe" },
                { name: "Physics 4th sem notes", url: "https://tinyurl.com/27l28lbo" },
                { name: "solid state physics 3rd unit", url: "https://tinyurl.com/2b6l5thl" },
                { name: "solid state physics 1st unit", url: "https://tinyurl.com/2bf7nrlx" },
                { name: "2nd unit quantum", url: "https://tinyurl.com/27uklcwo" },
                { name: "4 sem physics 3 unit", url: "https://tinyurl.com/2xk8k84x" },
                { name: "unit 3 quantum physics sem 4", url: "https://tinyurl.com/2ywctgr6" },
                { name: "4 SEM PHYSICS NOTES", url: "https://tinyurl.com/265oy5qy" },
                { name: "4th unit quantum", url: "https://tinyurl.com/26mq6lru" },
                { name: "unit 4 quantum physics sem 4", url: "https://tinyurl.com/25wr97kx" }
            ],
            "Sem 5": [
                { name: "5th sem physics notes unit 1", url: "https://tinyurl.com/2d8tn6pr" },
                { name: "2nd semester Physics notes", url: "https://tinyurl.com/24w8lkzz" },
                { name: "sem 5 notes atomic and molecular physics", url: "https://tinyurl.com/28ulk9y4" },
                { name: "physics 5th sem notes Madhav sir", url: "https://tinyurl.com/2yd3zqk2" },
                { name: "physics 5th sem notes", url: "https://tinyurl.com/2cbswu5l" },
                { name: "physics notes sem 5", url: "https://tinyurl.com/2ah5v7xv" },
                { name: "5th sem physics notes unit 2", url: "https://tinyurl.com/2yzx6fuu" },
                { name: "Physics 5th", url: "https://tinyurl.com/24fxj4ux" },
                { name: "atomic and molecular physics notes", url: "https://tinyurl.com/27huww7w" },
                { name: "5th sem physics notes unit 3", url: "https://tinyurl.com/27hqrxu7" },
                { name: "AMP AND NSP _5TH SEM_", url: "https://tinyurl.com/29fcvjp3" }
            ],
            "Sem 6": [
                { name: "physics note semster  6 unit 4", url: "https://tinyurl.com/2czo7yrl" },
                { name: "note physics 6 semester unit 1", url: "https://tinyurl.com/24kzd6rb" },
                { name: "nuclear physics bsc 6th semester notes unit 3", url: "https://tinyurl.com/26slyh2c" },
                { name: "sem 6 physics notes", url: "https://tinyurl.com/2aqz7u4y" },
                { name: "note nuclear semster 6 unit 2", url: "https://tinyurl.com/28g4lvu4" },
                { name: "6 SEMESTER PHYSICS NOTES", url: "https://tinyurl.com/2dhhkz26" },
                { name: "nuclear physics 6th sem notes", url: "https://tinyurl.com/24kxe62w" }
            ],
            "All": [
                { name: "B.sc 1 year machanics", url: "https://tinyurl.com/29bdy5vh" },
                { name: "Dayanmics", url: "https://tinyurl.com/22m44dtd" },
                { name: "machenics", url: "https://tinyurl.com/24ywsev9" },
                { name: "SHORTS QM-1", url: "https://tinyurl.com/266o3rc9" },
                { name: "Unit 2 & 4 sem 4 tharmo", url: "https://tinyurl.com/26xoyuag" },
                { name: "Unit 3 (Semi Conductor)", url: "https://tinyurl.com/28ttmqy4" },
                { name: "unit-2 curl and the field of stationary charge - Copy", url: "https://tinyurl.com/2dlqg5jj" },
                { name: "unit-3 Production of Low Temperature", url: "https://tinyurl.com/26jjhbkr" },
                { name: "unit-3 Semiconducter", url: "https://tinyurl.com/2bngez9s" },
                { name: "ELECTROMAGNETIC INDUCTION NOTES (PART-1)", url: "https://tinyurl.com/22nqo2ar" },
                { name: "ELECTROMAGNETIC INDUCTION NOTES  (PART -2)", url: "https://tinyurl.com/29jmfqzh" },
                { name: "PHYSICS NOTES (PART-1)", url: "https://tinyurl.com/2ay8hthw" },
                { name: "PHYSICS NOTES  (PART-2)", url: "https://tinyurl.com/2bj2ufef" },
                { name: "PHYSICS NOTES (PART-3)", url: "https://tinyurl.com/27pccgum" },
                { name: "ELECTROMAGNETIC INDUCTION NOTES  (PART-3)", url: "https://tinyurl.com/2a9fhfro" },
                { name: "notes physics unit 1 vector analysis", url: "https://tinyurl.com/289zprm2" },
                { name: "unit 2 notes vector analysis", url: "https://tinyurl.com/236eglqc" },
                { name: "notes vector physics unit 3", url: "https://tinyurl.com/27rgdzzm" },
                { name: "physics notes unit 4", url: "https://tinyurl.com/2ylfxb54" },
                { name: "polarisation notes", url: "https://tinyurl.com/2cy22q7r" },
                { name: "notes physics", url: "https://tinyurl.com/23v56tct" },
                { name: "notes physics electromagnetic unit 1", url: "https://tinyurl.com/27qy7h9c" },
                { name: "Thermal & Statistical physics", url: "https://tinyurl.com/2b7c6vdt" },
                { name: "optics notes pdf", url: "https://tinyurl.com/24jxtdx6" },
                { name: "physics pdf", url: "https://tinyurl.com/2ylfzrmn" },
                { name: "bsc physics notes", url: "https://tinyurl.com/24a5ww3o" },
                { name: "BPAS-183-UNIT-1", url: "https://tinyurl.com/29tofujl" },
                { name: "BPAS-183-UNIT-2", url: "https://tinyurl.com/22qnwktz" },
                { name: "BPAS-183-UNIT-3", url: "https://tinyurl.com/2yh7quzv" },
                { name: "BPAS-183-UNIT-4", url: "https://tinyurl.com/22vwabcg" },
                { name: "BPAS-183-UNIT-5", url: "https://tinyurl.com/25cqtnab" },
                { name: "BPAS-184-UNIT-1", url: "https://tinyurl.com/27l9pctd" },
                { name: "BPAS-184-UNIT-2", url: "https://tinyurl.com/27mwoxcz" },
                { name: "BPAS-184-UNIT-3", url: "https://tinyurl.com/243hg8hv" },
                { name: "BPAS-184-UNIT-4", url: "https://tinyurl.com/2bu5qo6v" },
                { name: "BPAS-184-UNIT-5", url: "https://tinyurl.com/2y9xudl5" },
                { name: "PHYSICS NOTES", url: "https://tinyurl.com/2ytk5ehn" },
                { name: "physics notes electromagnetic unit 2", url: "https://tinyurl.com/2d9h2ruj" },
                { name: "notes  physics electromagnetic unit 3", url: "https://tinyurl.com/2anupzqn" },
                { name: "physics notes electromagnetic unit 4", url: "https://tinyurl.com/25ppnx5h" },
                { name: "notes physics unit 4", url: "https://tinyurl.com/29e7nxyh" },
                { name: "unit 2 notes physics", url: "https://tinyurl.com/26o8ulv3" },
                { name: "notes physics unit 3", url: "https://tinyurl.com/2xtx5moy" },
                { name: "unit notes physics unit 1", url: "https://tinyurl.com/27rq6yl5" },
                { name: "physics notes quantum mechanics", url: "https://tinyurl.com/2b6hwjdy" },
                { name: "Physics notes and Syllabus", url: "https://tinyurl.com/2ya9scxq" },
                { name: "physics notes", url: "https://tinyurl.com/2b73l5pe" },
                { name: "quantum notes pdf", url: "https://tinyurl.com/25hxgyjb" },
                { name: "Physics notes", url: "https://tinyurl.com/29vt4clo" },
                { name: "Bsc all physics notes", url: "https://tinyurl.com/29jhvg94" },
                { name: "physics note", url: "https://tinyurl.com/26z62hk9" },
                { name: "physics mechanics notes", url: "https://tinyurl.com/254tqyql" },
                { name: "physics notes", url: "https://tinyurl.com/27vp8qd9" },
                { name: "solid state physics notes", url: "https://tinyurl.com/27xpj6uw" },
                { name: "quantum notes of physics", url: "https://tinyurl.com/2ykhkh56" },
                { name: "notes of physics", url: "https://tinyurl.com/2yzo3b64" },
                { name: "bsc physics notes semester 2", url: "https://tinyurl.com/2xzrbtam" },
                { name: "notes physics all", url: "https://tinyurl.com/2dbwywrk" },
                { name: "Physics Notes _6th sem", url: "https://tinyurl.com/28gf4wyj" },
                { name: "Nuclear Physics notes", url: "https://tinyurl.com/2ytb57aw" },
                { name: "unit 1 oscillation and waves notes", url: "https://tinyurl.com/2brcwscx" },
                { name: "notes 1", url: "https://tinyurl.com/24cqxutf" },
                { name: "BSC SEM 3 PHYSICS NOTES", url: "https://tinyurl.com/26u4c8f6" },
                { name: "notes 2", url: "https://tinyurl.com/2aa4xvnq" },
                { name: "notes 4", url: "https://tinyurl.com/2cywcqod" },
                { name: "Physics Notes By Lokesh Raj", url: "https://tinyurl.com/2yxwpjwz" },
                { name: "notes physics", url: "https://tinyurl.com/27hgk4vj" },
                { name: "physics notes", url: "https://tinyurl.com/24e8f7vt" },
                { name: "All notes of physics PDF", url: "https://tinyurl.com/298xt4ka" },
                { name: "physics notes", url: "https://tinyurl.com/29wvl5yj" },
                { name: "nuclear physics notes", url: "https://tinyurl.com/244xdlax" },
                { name: "physics notes all", url: "https://tinyurl.com/25k6lmza" },
                { name: "Untitled document", url: "https://tinyurl.com/2ybdkx2o" },
                { name: "PDF Scanner Jun 02, 2024 2-25 PM", url: "https://tinyurl.com/27rdt4l5" }
            ],
            "Unknown": [
                { name: "LTC3108_Step_Up_Converter_Power_Manager", url: "https://tinyurl.com/26sgvmzu" },
                { name: "Magnetostatics_Lorentz_Force_Ampere_Law", url: "https://tinyurl.com/26jdb3fk" },
                { name: "unit-1 Circuit Analysis", url: "https://tinyurl.com/2ceexlsu" },
                { name: "unit-4 Polarization", url: "https://tinyurl.com/2anu8tjx" }
            ]
        };

        const physicsAssignmentsData = {
            "Sem 3": [
                { name: "physics 3rd sem assignment (1)", url: "https://tinyurl.com/22tzypzq" },
                { name: "physics assignment", url: "https://tinyurl.com/23kz9dpv" },
                { name: "physics assignment sem 3rd hindi (3)", url: "https://tinyurl.com/2yjascju" },
                { name: "physics assignment sem3", url: "https://tinyurl.com/2ybokvlb" },
                { name: "physics assignment_edited", url: "https://tinyurl.com/29vdh935" }
            ],
            "Sem 5": [
                { name: "5 sem physics assignment..", url: "https://tinyurl.com/2chs6ffq" }
            ],
            "Sem 6": [
                { name: "physics 6th sem. assignment", url: "https://tinyurl.com/2d62fj6q" },
                { name: "PHYSICS Assignment ( Sem 6 )", url: "https://tinyurl.com/28w9clar" }
            ],
            "All": [
                { name: "electromagnetic assignment", url: "https://tinyurl.com/2apwbkab" },
                { name: "Electromagnetism assignment", url: "https://tinyurl.com/29qk8cko" },
                { name: "machanics assignment", url: "https://tinyurl.com/244n5eqb" },
                { name: "MSc-Physics-Assignments", url: "https://tinyurl.com/2bcgyaod" },
                { name: "Nuclear physics assignment (1)", url: "https://tinyurl.com/28ya8mcq" },
                { name: "optics assignment", url: "https://tinyurl.com/25kbsxbc" },
                { name: "physics assignment (1)", url: "https://tinyurl.com/2dgcxxxe" },
                { name: "physics assignment BSc 1st year", url: "https://tinyurl.com/2bxmwum2" },
                { name: "physics assignment pdf", url: "https://tinyurl.com/248pzhgv" },
                { name: "physics assignment Hindi medium", url: "https://tinyurl.com/2xha7gra" },
                { name: "quantum physics assignment", url: "https://tinyurl.com/22w3utxn" },
                { name: "solid state assignment (1)", url: "https://tinyurl.com/2yjmbnya" }
            ]
        };

        const physicsOtherData = {
            "Sem 1": [
                { name: "physics practical book semester 1", url: "https://tinyurl.com/2a4o5nvm" },
                { name: "Physics Practical BSC 1st Semester", url: "https://tinyurl.com/2y3rn9f9" },
                { name: "Physics Practical Record Sem 1st -merged", url: "https://tinyurl.com/29xg2z82" },
                { name: "physics practical 1st sem", url: "https://tinyurl.com/27xwzsek" },
                { name: "BSc-Physics-Sem-I-Practical-Examination-Feb-2023", url: "https://tinyurl.com/24ok9rle" }
            ],
            "Sem 2": [
                { name: "IInd Semester Physics Practical file", url: "https://tinyurl.com/29ujq5m8" },
                { name: "physics practical 2nd sem", url: "https://tinyurl.com/23xa2z4z" },
                { name: "physics practical ,2nd sem Ajeet agrwal", url: "https://tinyurl.com/2dymn6bb" }
            ],
            "Sem 3": [
                { name: "Physics III Sem Practical Record hindi", url: "https://tinyurl.com/2ywefb68" },
                { name: "Physics III Sem Practical Record hindi", url: "https://tinyurl.com/2bcy6axf" }
            ],
            "Sem 4": [
                { name: "Practical File Physics 4th Sem", url: "https://tinyurl.com/22q2w6b8" },
                { name: "Physics Practical File Sem IV", url: "https://tinyurl.com/2982ku99" },
                { name: "4 sem practical physics 2024", url: "https://tinyurl.com/2bb39tdb" }
            ],
            "Sem 5": [
                { name: "physics practical 5th sem_2", url: "https://tinyurl.com/2ybsdgzw" },
                { name: "5th Sem. Physics Practical file English medium", url: "https://tinyurl.com/28rq2hv8" },
                { name: "BSc-Physics-Practical-Examination-Apr-2025", url: "https://tinyurl.com/2xns6qt7" }
            ],
            "Sem 6": [
                { name: "physics cia 6th sem 2025", url: "https://tinyurl.com/2454a9sr" },
                { name: "physics practical 6 sem", url: "https://tinyurl.com/28x76cz4" },
                { name: "Physics VI Sem Practical English", url: "https://tinyurl.com/274xyddh" }
            ],
            "All": [
                { name: "Important Question CIA (physics)..", url: "https://tinyurl.com/22e79scf" },
                { name: "physics practical", url: "https://tinyurl.com/2dx45e5e" },
                { name: "UG Physics Practical Time-Table", url: "https://tinyurl.com/2ya4r39y" },
                { name: "Physics practical__ Yogesh Agrawal", url: "https://tinyurl.com/2dyyfu7k" },
                { name: "BSc Physics Practical Exam-May2024", url: "https://tinyurl.com/2yxa8t7w" },
                { name: "Revised_Physics_Practical_Examination_Dec2023", url: "https://tinyurl.com/22zap46m" },
                { name: "physics practical file", url: "https://tinyurl.com/2ych2c47" },
                { name: "physics practical file bsc first year", url: "https://tinyurl.com/27k9ko8v" },
                { name: "physics practicals", url: "https://tinyurl.com/2debftx5" },
                { name: "physics practical_1", url: "https://tinyurl.com/2xjq8ak4" },
                { name: "BSc-MSc-Physics-Practical-Exam-TT-Dec2023", url: "https://tinyurl.com/2dk4xpj6" },
                { name: "BSc-Physics-Practical-Examination-Dec-2024", url: "https://tinyurl.com/2bxckkh7" }
            ]
        };

        const physicsPyqData = {
            "Sem 1": [
                { name: "3D semester-1 questions paper 2020-2015", url: "https://tinyurl.com/237ssclk" },
                { name: "sphere & cone old paper Q Soulaction", url: "https://tinyurl.com/27gg2ebl" },
                { name: "Real answer 2021", url: "https://tinyurl.com/27epgyyn" },
                { name: "B.Sc I Sem Physics Mechanics  1300 date 23-11-19", url: "https://tinyurl.com/2c9kzxcg" },
                { name: "B.Sc I Sem Physics Electromagnetism 1300 date 25-11-19", url: "https://tinyurl.com/246w3rhu" },
                { name: "B_Sc_I_Sem_Physics_III_paper_Oscillation_&_Waves_1300_date_28_11", url: "https://tinyurl.com/28e2caho" },
                { name: "B_Sc_I_Sem_Physics_Electromagnetism_I_1200_dated_4_12_18", url: "https://tinyurl.com/2c53zg4t" }
            ],
            "Sem 2": [
                { name: "MECHANICS   (  2016-2022 )", url: "https://tinyurl.com/2adhxx78" },
                { name: "B.Sc. II Sem Physics Mechanics-II  1200 DATE 26-4-19", url: "https://tinyurl.com/23hfd5jf" },
                { name: "Physics second paper", url: "https://tinyurl.com/2a9crzoj" },
                { name: "PHYSICS PREVIOUS YEAR QUESTION PAPER Oct 24, 2024 10-22 AM", url: "https://tinyurl.com/24btqkdg" }
            ],
            "Sem 3": [
                { name: "3 -D old paper", url: "https://tinyurl.com/23z5cqf8" },
                { name: "cylinder pyq", url: "https://tinyurl.com/24jf4sgy" },
                { name: "B.Sc III Sem Physics Optics 1100 date2-12-19", url: "https://tinyurl.com/234r22c5" },
                { name: "Physics and Maths Dec. 2023", url: "https://tinyurl.com/2dnzl5kj" },
                { name: "sem 3 physics pyq", url: "https://tinyurl.com/2dnpnjlr" }
            ],
            "Sem 4": [
                { name: "B.Sc- IV Sem Physics-II Optics 1200 date 14-5-19", url: "https://tinyurl.com/294ltn3u" },
                { name: "B_Sc_IV_sem_Physics_Statistical_&_Thermod_phy_1200_date_4_5_19", url: "https://tinyurl.com/2borx3qs" },
                { name: "B.Sc. 4th Sem Physics previous year papers", url: "https://tinyurl.com/23tmjdo9" }
            ],
            "Sem 6": [
                { name: "physics 6th sem pyq", url: "https://tinyurl.com/2cmvsofj" },
                { name: "bsc physics 6th sem pyq", url: "https://tinyurl.com/23oaopq7" },
                { name: "B.Sc 6th Sem Physics Papers", url: "https://tinyurl.com/286pss8g" }
            ],
            "All": [
                { name: "physics last year paper", url: "https://tinyurl.com/2646qale" },
                { name: "physics last 5years paper", url: "https://tinyurl.com/2bxd26vo" },
                { name: "hydrodynamics previous year papaer", url: "https://tinyurl.com/2c6rjftb" },
                { name: "tensor previous year paper", url: "https://tinyurl.com/29zjmbzm" },
                { name: "dynamic short question 15,16,17,18,19,22", url: "https://tinyurl.com/222eut55" },
                { name: "geography previous years question papers", url: "https://tinyurl.com/25adk4v4" },
                { name: "physical chemistry papers", url: "https://tinyurl.com/2ygjferr" }
            ]
        };

        // Assign Physics Data
        pyqData["B.Sc. (Bachelor of Science)"]["Physics"] = physicsPyqData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Physics"] = physicsOtherData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Physics"] = physicsAssignmentsData;
        notesData["B.Sc. (Bachelor of Science)"]["Physics"] = physicsNotesData;

        // ==================== COMMERCE DATA ====================
        // Commerce ABST (Accounting, Business Statistics & Tax) Notes Data
        const commerceABSTNotesData = {
            "Sem 1": [
                { name: "B.Com.  I Sem  ABST BUSINESS STATISTICS", url: "https://tinyurl.com/2c9zwdle" },
                { name: "B_Com_I_Sem_ABST_First_Paper_Financial_Accounting_I_1200_date_18", url: "https://tinyurl.com/2yz2ax8g" },
                { name: "B.Com I Sem. ABST First  Paper  Financial Accounting", url: "https://tinyurl.com/29ljxt8y" },
                { name: "Business_Statistics_Data_Collection_Methods", url: "https://tinyurl.com/22vyzorg" },
                { name: "math paper 1st algebra assignment", url: "https://tinyurl.com/2apb4b6k" }
            ],
            "Sem 3": [
                { name: "B_Com_III_Sem_ABST_II_ELEMENTARY_COST_ACCOUNTING_1000_date_18_11", url: "https://tinyurl.com/2bk28omw" },
                { name: "B. Com. III Sem ABST- II ELEMENTARY COST ACCOUNTING", url: "https://tinyurl.com/2yxfcv9j" },
                { name: "B.com.-III Sem ABST - I INCOME TAX law", url: "https://tinyurl.com/2988jbxw" }
            ],
            "Sem 4": [
                { name: "B.Com Hons.ABST Sem IV Corporate Tax 2 - Copy-converted (1)", url: "https://tinyurl.com/233kfqqq" },
                { name: "B.Com. Hons ABST Sem IV Corporate Tax 1 - Copy-converted", url: "https://tinyurl.com/27v359r5" },
                { name: "BCOM_HONS_ABST_B_com_+Hons_+IV+sem+ABST+_++Income+Tax+Law+&+Practices", url: "https://tinyurl.com/25m52v9d" },
                { name: "Hin_B_Com_IV_Sem_ABST_I_Income_Tax_Law_&_Sec_C", url: "https://tinyurl.com/25ll9zzr" },
                { name: "Income_Tax_Residential_Status", url: "https://tinyurl.com/2bss967u" },
                { name: "Introduction_to_Income_Tax_India", url: "https://tinyurl.com/28lhr6zm" },
                { name: "Lesson 3 Income from salary Final", url: "https://tinyurl.com/26co5oe2" },
                { name: "salary", url: "https://tinyurl.com/286oorvv" }
            ],
            "Sem 5": [
                { name: "B_Com_V_Sem_ABST_II_Functional_Accounting_900_date_18_11_19", url: "https://tinyurl.com/2av6pbs8" },
                { name: "B.Com V Sem. ABST -II Functional Accounting", url: "https://tinyurl.com/2xzy3aj4" },
                { name: "B.com.-V Sem ABST - AUDITING  800 DATE 10-11-19", url: "https://tinyurl.com/2d7ll33j" },
                { name: "B.com.-V Sem ABST - AUDITING", url: "https://tinyurl.com/2d3535ag" }
            ],
            "Unknown": [
                { name: "abst functional accounting assignment", url: "https://tinyurl.com/284376sv" },
                { name: "ABST auditing assignment", url: "https://tinyurl.com/2d74rndx" }
            ]
        };

        // Commerce EAFM (Economics, Accounting & Financial Management) Notes Data
        const commerceEAFMNotesData = {
            "Sem 1": [
                { name: "B.Com.  I Sem EAFM-I BUSINESS ECONOMICS", url: "https://tinyurl.com/23ruedn9" },
                { name: "B.Com.  I Sem EAFM-II BANKING", url: "https://tinyurl.com/2587a9rl" },
                { name: "business economics", url: "https://tinyurl.com/26u7z2ss" }
            ],
            "Sem 2": [
                { name: "B_COM_PASS_COURSE_II_SEM_PUBLIC_FINANCE_AND_FINANCIAL_SYSTEM_IN", url: "https://tinyurl.com/2357hgjk" },
                { name: "English_Bcom_Pass_Course_2_Sem_Paper_1_Managerial_Eco_National_Income", url: "https://tinyurl.com/28s3es33" },
                { name: "English_Bcom_Pass_Course_2_Sem_Paper_2_Public_Finance_Foreign_Ecchange", url: "https://tinyurl.com/279lqpyu" },
                { name: "Govt_Assistance_to_Industries_English_ppt_B_Com_Hons_B_Adm_Honors", url: "https://tinyurl.com/28e5m6lb" },
                { name: "Hindi_Bcom_Pass_Course_2_Sem_Paper_2_Public_Finance_Foreign_Ecchange", url: "https://tinyurl.com/2conz2mz" },
                { name: "Managerial_Economics_Hindi_M_ComBusiness_Administration_II_Sem", url: "https://tinyurl.com/2y4xwl9k" },
                { name: "VIKAS_B_COM_PASS_COURSE_EAFM_SEM_II_PAPER_I_MANAGERIAL_ECONOMICS", url: "https://tinyurl.com/2ac8lctr" },
                { name: "VIKAS_B_COM_PASS_COURSE_EAFM_SEM_II_PAPER_II_PUBLIC_FIN_&_FSI_ENGLISH", url: "https://tinyurl.com/2bersx52" },
                { name: "VIKAS_B_COM_PASS_COURSE_EAFM_SEM_II_PAPER_II_PUBLIC_FIN_&_FSI_HINDI", url: "https://tinyurl.com/29kr8tk6" },
                { name: "VIKAS_M_COM_EAFM_II_SEM_PAPER_I_MANAGERIAL_ECONOMICS_ENGLISH_", url: "https://tinyurl.com/2dcnopca" },
                { name: "VIKAS_M_COM_EAFM_SEM_II_PAPER_I_MANAGERIAL_ECONOMICSHINDI_I", url: "https://tinyurl.com/27vveww4" },
                { name: "VIKAS_M_COM_EAFM_SEM_II_PAPER_I_MANAGERIAL_ECONOMICS_HINDI_II", url: "https://tinyurl.com/2yrk2ee9" },
                { name: "à¤‰à¤¦à¥à¤¯à¥‹à¤—à¥‹à¤‚_à¤•à¥‹_à¤¸à¤°à¤•à¤¾à¤°à¥€_à¤¸à¤¹à¤¾à¤¯à¤¤à¤¾_à¤ªà¤°_à¤ªà¥€à¤ªà¥€à¤Ÿà¥€_à¤¬à¥€_à¤•à¥‰à¤®_à¤‘à¤¨à¤°à¥à¤¸_à¤¸à¥‡à¤®_à¤¦à¥à¤µà¤¿à¤¤à¥€à¤¯_1", url: "https://tinyurl.com/28ak2gla" }
            ],
            "Sem 3": [
                { name: "B_Com_III_Sem_EAFM_II_FINANCIAL_MANAGEMENT_900_date_23_11_19", url: "https://tinyurl.com/23o2wutv" },
                { name: "B_Com_III_Sem_EAFM_Economic_Environment_in_India_1000_date_20_11", url: "https://tinyurl.com/26y56pcw" },
                { name: "B.Com  III Sem EAFM Economic Environment in India", url: "https://tinyurl.com/24ounvw7" },
                { name: "B.Com.-III Sem EAFM - II __FINANCIAL MANAGEMENT", url: "https://tinyurl.com/2youlkf8" },
                { name: "EAFM Economic environment in India", url: "https://tinyurl.com/2b76s7ee" }
            ],
            "Sem 4": [
                { name: "B_Com_EAFM_IV_Sem_international_trade_and_finance_1000_date_27_4", url: "https://tinyurl.com/27ttc97q" },
                { name: "B_COM_PASS_COURSE_IV_SEM_INTERNATIONAL_TRADE_AND_FINANCE_HINDI", url: "https://tinyurl.com/2xjxqu48" },
                { name: "B.Com4semEafm-I FTZ(hindi)-converted", url: "https://tinyurl.com/27ah3f6t" },
                { name: "International_Trade_Finance_Documentary_Credits", url: "https://tinyurl.com/22hdh222" },
                { name: "à¤¸à¤¾à¤– à¤ªà¤¤à¥à¤°", url: "https://tinyurl.com/2y2dypkp" }
            ],
            "Sem 5": [
                { name: "B_Com_V_sem_EAFM_II_BUSINESS_BUDGETING_800_date_25_11_19", url: "https://tinyurl.com/238don97" },
                { name: "B_Com_V_Sem_EAFM_I_RURAL_DEVELOPMENT_AND_CO_OPERATION_900_date_22", url: "https://tinyurl.com/25vjalv2" },
                { name: "B.Com  V sem EAFM -II --BUSINESS BUDGETING", url: "https://tinyurl.com/2b94hypk" },
                { name: "B.Com V sem (HONS.)  EAFM  Indian Economic Envir.", url: "https://tinyurl.com/2ccbuv4j" },
                { name: "B.Com.  V Sem EAFM-I  RURAL DEVELOPMENT AND CO-OPERATION", url: "https://tinyurl.com/22n6gz2k" },
                { name: "BCOMEAFM(PC),SEMV(1) (1)", url: "https://tinyurl.com/26auuqgy" }
            ],
            "Unknown": [
                { name: "bank", url: "https://tinyurl.com/28pvnjnm" },
                { name: "Banking", url: "https://tinyurl.com/244u7srj" },
                { name: "Indian_Banking_and_Financial_System", url: "https://tinyurl.com/25sd3f8f" }
            ]
        };

        // Commerce BADM (Business Administration) Notes Data
        const commerceBADMNotesData = {
            "Sem 1": [
                { name: "B.Com.  I Sem BADM BUSINESS LAW  1000 date 10-11-19", url: "https://tinyurl.com/27ntac6x" },
                { name: "B.Com.  I Sem BADM BUSINESS LAW", url: "https://tinyurl.com/2cdseud9" },
                { name: "B.Com. I sem Bus. Admn. - II  BUSINESS ORGANISATION", url: "https://tinyurl.com/28adx2k2" },
                { name: "BADM Company law", url: "https://tinyurl.com/23tdvcvw" },
                { name: "I Sem Business Origination Important Questions ðŸ™‚", url: "https://tinyurl.com/23f6eprt" }
            ],
            "Sem 2": [
                { name: "Hindi BBA II Conpany Law Unit III", url: "https://tinyurl.com/26ygn2rc" },
                { name: "Indian_Partnership_Act_1932_Notes", url: "https://tinyurl.com/23pbza8c" },
                { name: "Industrial_Democracy_English_ppt_B_Com_Hons_BAdm_Sem_II_converted", url: "https://tinyurl.com/24juclfz" },
                { name: "Industrial_Policy_English_ppt_B_Com_Hons_Sem_II_B_Adm_converted", url: "https://tinyurl.com/2dq7czoj" },
                { name: "à¤”à¤¦à¥à¤¯à¥‹à¤—à¤¿à¤•_à¤¨à¥€à¤¤à¤¿_hindi_à¤ªà¥€à¤ªà¥€à¤Ÿà¥€_B_Com_à¤‘à¤¨à¤°à¥à¤¸_à¤¸à¥‡à¤®_à¤¦à¥à¤µà¤¿à¤¤à¥€à¤¯_B_Adm_", url: "https://tinyurl.com/2bvzj62w" },
                { name: "à¤”à¤¦à¥à¤¯à¥‹à¤—à¤¿à¤•_à¤²à¥‹à¤•à¤¤à¤‚à¤¤à¥à¤°_Hindi_ppt_B_com_à¤‘à¤¨à¤°à¥à¤¸_BAdm_Sem_à¤¦à¥à¤µà¤¿à¤¤à¥€à¤¯", url: "https://tinyurl.com/2y8okx3v" }
            ],
            "Sem 3": [
                { name: "B.Com.  III Sem BADM CORPORATE LAW", url: "https://tinyurl.com/24z9epqn" },
                { name: "B.Com.  III Sem BADM CORPORATE LAW 900 date 23-11-19", url: "https://tinyurl.com/2b2ucnmj" },
                { name: "corporate law (badm) notes", url: "https://tinyurl.com/25v55qsj" },
                { name: "Presentation Company Law Complete", url: "https://tinyurl.com/2737jwul" },
                { name: "Members and Shareholders", url: "https://tinyurl.com/28q9ao9y" }
            ],
            "Sem 5": [
                { name: "B_Com_V_Sem_badm_sales_promotions_and_sales_management_800_daet", url: "https://tinyurl.com/2d2gst6p" },
                { name: "B.Com V Sem. badm  sales promotions and sales management", url: "https://tinyurl.com/257cxjmm" },
                { name: "B.com.-V Sem BADM-I Functional Management", url: "https://tinyurl.com/24mbrsha" },
                { name: "B.com.-V Sem BADM-I Functional Management 900  date 11-11-19", url: "https://tinyurl.com/2askt8db" }
            ],
            "Unknown": [
                { name: "B.COM Business Management", url: "https://tinyurl.com/2933r445" },
                { name: "buissness", url: "https://tinyurl.com/28zosm2h" },
                { name: "buisness management", url: "https://tinyurl.com/29uz7zv6" },
                { name: "Finsl_PPT_ON_NEGOTIABLE_INSTRUMENT_ACT_1881_for_B_com_pass_course", url: "https://tinyurl.com/26x2rl6p" },
                { name: "hindi_ppt_on_negotiable_instrument_act_1881_for_b_com_converted", url: "https://tinyurl.com/29f8brkt" },
                { name: "Organization", url: "https://tinyurl.com/2dg7j3k9" },
                { name: "Welfare State English ppt B.Com.Hons.B.Adm.SemII-converted", url: "https://tinyurl.com/26bj52jp" },
                { name: "à¤•à¤²à¥à¤¯à¤¾à¤£à¤•à¤¾à¤°à¥€_à¤°à¤¾à¤œà¥à¤¯_à¤¹à¤¿à¤‚à¤¦à¥€_à¤ªà¥€à¤ªà¥€à¤Ÿà¥€_B_com_à¤‘à¤¨à¤°à¥à¤¸_B_adm_SemII", url: "https://tinyurl.com/2akyv7tl" }
            ]
        };

        // Commerce PYQ Data
        const commercePyqData = {
            "Sem 1": [
                { name: "B.Com.  I Sem BADM BUSINESS LAW  1000 date 10-11-19", url: "https://tinyurl.com/27ntac6x" },
                { name: "B.Com.  I Sem EAFM-I BUSINESS ECONOMICS 1000 date  11-11-19", url: "https://tinyurl.com/28bfc6q9" },
                { name: "B.Com.  I Sem EAFM-II BANKING 1000 date 11-11-9", url: "https://tinyurl.com/2xqr3p42" }
            ],
            "Sem 3": [
                { name: "B.Com.  III Sem BADM CORPORATE LAW 900 date 23-11-19", url: "https://tinyurl.com/2b2ucnmj" },
                { name: "B.com.-III Sem ABST - I INCOME TAX law  900 date 10-11-19", url: "https://tinyurl.com/22un2ed3" }
            ],
            "Sem 4": [
                { name: "B_Com_EAFM_IV_Sem_international_trade_and_finance_1000_date_27_4", url: "https://tinyurl.com/27ttc97q" }
            ],
            "Sem 5": [
                { name: "B.com.-V Sem BADM-I Functional Management 900  date 11-11-19", url: "https://tinyurl.com/2askt8db" },
                { name: "B.com.-V Sem ABST - AUDITING  800 DATE 10-11-19", url: "https://tinyurl.com/2d7ll33j" }
            ],
            "Unknown": [
                { name: "BCom_Business_Management_Exam_Paper", url: "https://tinyurl.com/22zmvk9h" }
            ]
        };

        // Commerce Assignments Data
        const commerceAssignmentsData = {
            "Unknown": [
                { name: "ABST auditing assignment", url: "https://tinyurl.com/2d74rndx" },
                { name: "abst functional accounting assignment", url: "https://tinyurl.com/284376sv" },
                { name: "BA-Business-Admin-Assignment", url: "https://tinyurl.com/2yudxvue" },
                { name: "BCom-ABST-PassCourse-Assignemnt", url: "https://tinyurl.com/293atz5d" },
                { name: "BCom-ABST-PassCourse-Assignemnt", url: "https://tinyurl.com/22jmm6rl" },
                { name: "BCom-EAFM-Assignments", url: "https://tinyurl.com/2cppu6sp" },
                { name: "BCOM-HONS-ABST", url: "https://tinyurl.com/26nxn57n" },
                { name: "BCOM-HONS-BADM", url: "https://tinyurl.com/27xa7jyb" },
                { name: "BCOM-HONS-EAFM", url: "https://tinyurl.com/2d4lk4j6" },
                { name: "BCom-PassCourse-Assignments", url: "https://tinyurl.com/2yvqx7mx" },
                { name: "MA-Business-Admini-Assignment (1)", url: "https://tinyurl.com/27daywny" },
                { name: "MA-Business-Admini-Assignment", url: "https://tinyurl.com/234mrvxx" },
                { name: "MCom-ABST-Assignments", url: "https://tinyurl.com/26kj7v5v" },
                { name: "MCom-BADM-Assignments", url: "https://tinyurl.com/239rk4tr" },
                { name: "MCom-EAFM-Assignments (1)", url: "https://tinyurl.com/2xhh9usz" },
                { name: "MCom-EAFM-Assignments", url: "https://tinyurl.com/2bb6jpgv" },
                { name: "MCOM(EAFM)", url: "https://tinyurl.com/2yjw2lnl" }
            ]
        };

        // Commerce Other/Syllabus Data
        const commerceOtherData = {
            "Unknown": [
                { name: "BBA-Section-List-2024", url: "https://tinyurl.com/274dgrkw" },
                { name: "BCom-Section-List-2024", url: "https://tinyurl.com/26nmqk7f" },
                { name: "First-merit-list-BBA-2024-25", url: "https://tinyurl.com/2xqkyb2r" },
                { name: "First-merit-list-BBA-RM-2024-25", url: "https://tinyurl.com/24gqqwey" },
                { name: "MCOM(ABST)", url: "https://tinyurl.com/2699wur6" },
                { name: "syllabus_bcom_abst (1)", url: "https://tinyurl.com/2atuaqkq" },
                { name: "syllabus_bcom_abst", url: "https://tinyurl.com/2docc9yg" },
                { name: "syllabus_bcom_eafm_new", url: "https://tinyurl.com/2awg6u2n" },
                { name: "syllabus_bcom_pass_course (1)", url: "https://tinyurl.com/27wqon43" }
            ]
        };

        // Assign Commerce Data
        pyqData["B.Com. (Bachelor of Commerce)"] = {};
        pyqData["B.Com. (Bachelor of Commerce)"]["ABST"] = commercePyqData;
        pyqData["B.Com. (Bachelor of Commerce)"]["EAFM"] = commercePyqData;
        pyqData["B.Com. (Bachelor of Commerce)"]["BADM"] = commercePyqData;
        
        assignmentsData["B.Com. (Bachelor of Commerce)"] = {};
        assignmentsData["B.Com. (Bachelor of Commerce)"]["ABST"] = commerceAssignmentsData;
        assignmentsData["B.Com. (Bachelor of Commerce)"]["EAFM"] = commerceAssignmentsData;
        assignmentsData["B.Com. (Bachelor of Commerce)"]["BADM"] = commerceAssignmentsData;
        
        practicalsData["B.Com. (Bachelor of Commerce)"] = {};
        practicalsData["B.Com. (Bachelor of Commerce)"]["ABST"] = commerceOtherData;
        practicalsData["B.Com. (Bachelor of Commerce)"]["EAFM"] = commerceOtherData;
        practicalsData["B.Com. (Bachelor of Commerce)"]["BADM"] = commerceOtherData;
        
        notesData["B.Com. (Bachelor of Commerce)"] = {};
        notesData["B.Com. (Bachelor of Commerce)"]["ABST"] = commerceABSTNotesData;
        notesData["B.Com. (Bachelor of Commerce)"]["EAFM"] = commerceEAFMNotesData;
        notesData["B.Com. (Bachelor of Commerce)"]["BADM"] = commerceBADMNotesData;

        // ==================== ECONOMICS DATA ====================
        // Economics Notes Data
        const economicsNotesData = {
            "Sem 5": [
                { name: "Economic, CIA ( 5th Semester)", url: "https://tinyurl.com/2563f7b8" },
                { name: "Environmental Economics ( 5th semester)", url: "https://tinyurl.com/27hm6y2w" },
                { name: "International Trade and Development economics , Semester 5th", url: "https://tinyurl.com/262lnolm" }
            ],
            "Sem 6": [
                { name: "eco 6 th sem unit 1pdf", url: "https://tinyurl.com/284cv5z9" },
                { name: "Eco 6th Sem Assignment..", url: "https://tinyurl.com/2dpyfoy8" }
            ],
            "Unknown": [
                { name: "APPROACH ANSWER DAY -11 ( INDIAN ECONOMY )", url: "https://tinyurl.com/28dr5t6v" },
                { name: "APPROACH ANSWER DAY-12 ( INDIAN ECONOMY)", url: "https://tinyurl.com/2532z2ur" },
                { name: "APPROACH ANSWER DAY 13 ( INDIAN ECONOMY )", url: "https://tinyurl.com/24c2aenm" },
                { name: "APPROACH ANSWER DAY -14 ( INDIAN ECONOMY ) (1)", url: "https://tinyurl.com/26elrzp8" },
                { name: "APPROACH ANSWER DAY 15 ( INDIAN ECONOMY ) (1)", url: "https://tinyurl.com/24aboydo" },
                { name: "APPROACH ANSWER DAY -16 ( INDIAN ECONOMY )", url: "https://tinyurl.com/2xmazraw" },
                { name: "Economic Unit-1", url: "https://tinyurl.com/2awubp56" },
                { name: "Economic_Theories_of_Interest_Rates", url: "https://tinyurl.com/24vjx54o" },
                { name: "environment eco...", url: "https://tinyurl.com/2a3z9fww" },
                { name: "Indian Economics", url: "https://tinyurl.com/25e7c6te" },
                { name: "Indian_Banking_and_Financial_System", url: "https://tinyurl.com/25sd3f8f" },
                { name: "Interest  hindi", url: "https://tinyurl.com/2ajw9n8z" },
                { name: "International_Trade_Finance_Documentary_Credits", url: "https://tinyurl.com/22hdh222" },
                { name: "Introduction_to_Game_Theory", url: "https://tinyurl.com/295r43w7" },
                { name: "Macro economics, 4 semester", url: "https://tinyurl.com/26758mep" },
                { name: "Macro&Statics", url: "https://tinyurl.com/28peyy42" },
                { name: "managerial economics pdf", url: "https://tinyurl.com/26yjbkff" },
                { name: "Managerial economics in hindi pdf", url: "https://tinyurl.com/22z8qp7y" },
                { name: "Managerial Economics_English_M.COM_II", url: "https://tinyurl.com/28efd5am" },
                { name: "Marginal Productivity Theory Of Distribution", url: "https://tinyurl.com/2xv3j8su" },
                { name: "Market unit 1 (micro economics)", url: "https://tinyurl.com/2cvfbwc6" },
                { name: "national income Analysis", url: "https://tinyurl.com/2dcc8euu" },
                { name: "national income  Analysis hindi", url: "https://tinyurl.com/299avf76" },
                { name: "Partial Differentiation", url: "https://tinyurl.com/24k7wqxu" },
                { name: "PROFIT", url: "https://tinyurl.com/26nswscm" },
                { name: "Profit hindi", url: "https://tinyurl.com/2cxbr4yx" },
                { name: "public debt notes", url: "https://tinyurl.com/24b7xozn" },
                { name: "Public Debt.pptx", url: "https://tinyurl.com/22ffs7nt" },
                { name: "Public Finance (  in hindi)pdf", url: "https://tinyurl.com/288y6d6d" },
                { name: "public fin..", url: "https://tinyurl.com/2ahoxocx" },
                { name: "Public finance pdf", url: "https://tinyurl.com/29tynjmg" },
                { name: "RENT", url: "https://tinyurl.com/2b4kw3wh" },
                { name: "second paper statistics unit 1", url: "https://tinyurl.com/25z3jyer" },
                { name: "SourceCode#07_RG_Rivers_English", url: "https://tinyurl.com/2djlou75" },
                { name: "TRADE & ENV _Hindi", url: "https://tinyurl.com/24duaodp" },
                { name: "UNEMPLOYMENT AND COST.(HINDI MEDIUM)", url: "https://tinyurl.com/26mgtph4" },
                { name: "WAGES", url: "https://tinyurl.com/2bsl6p6m" },
                { name: "Wages-hindi", url: "https://tinyurl.com/2ap6neqf" },
                { name: "à¤¸à¥€à¤®à¤¾à¤‚à¤¤_à¤‰à¤¤à¥à¤ªà¤¾à¤¦à¤•à¤¤à¤¾_à¤µà¤¿à¤¤à¤°à¤£_à¤•à¤¾_à¤¸à¤¿à¤¦à¥à¤§à¤¾à¤‚à¤¤", url: "https://tinyurl.com/22o8sm8r" }
            ]
        };

        // Economics PYQ Data
        const economicsPyqData = {
            "Sem 1": [
                { name: "sem 1 paper micro & indian economy", url: "https://tinyurl.com/2bwogxqa" }
            ]
        };

        // Economics Assignments Data
        const economicsAssignmentsData = {
            "Sem 6": [
                { name: "public finance 6 th sem assignment", url: "https://tinyurl.com/27uwkjay" }
            ]
        };

        // Economics Other Data
        const economicsOtherData = {
            "Unknown": [
                { name: "Differentrial Equation II", url: "https://tinyurl.com/2yn7275a" },
                { name: "Human_Impact_on_Ecosystems", url: "https://tinyurl.com/226tu776" },
                { name: "Magnetostatics_Lorentz_Force_Ampere_Law", url: "https://tinyurl.com/26jdb3fk" },
                { name: "political notes ðŸˆ second paper (third semester)", url: "https://tinyurl.com/2c3bs2zd" }
            ]
        };

        // Assign Economics Data - Economics appears in both B.Sc. and B.A. streams
        // For B.Sc. (Bachelor of Science) - Economics
        if (!pyqData["B.Sc. (Bachelor of Science)"]["Economics"]) {
            pyqData["B.Sc. (Bachelor of Science)"]["Economics"] = economicsPyqData;
        }
        if (!assignmentsData["B.Sc. (Bachelor of Science)"]["Economics"]) {
            assignmentsData["B.Sc. (Bachelor of Science)"]["Economics"] = economicsAssignmentsData;
        }
        if (!practicalsData["B.Sc. (Bachelor of Science)"]["Economics"]) {
            practicalsData["B.Sc. (Bachelor of Science)"]["Economics"] = economicsOtherData;
        }
        if (!notesData["B.Sc. (Bachelor of Science)"]["Economics"]) {
            notesData["B.Sc. (Bachelor of Science)"]["Economics"] = economicsNotesData;
        }

        // For B.A. (Bachelor of Arts) - Economics (same data)
        pyqData["B.A. (Bachelor of Arts)"] = pyqData["B.A. (Bachelor of Arts)"] || {};
        pyqData["B.A. (Bachelor of Arts)"]["Economics"] = economicsPyqData;
        
        assignmentsData["B.A. (Bachelor of Arts)"] = assignmentsData["B.A. (Bachelor of Arts)"] || {};
        assignmentsData["B.A. (Bachelor of Arts)"]["Economics"] = economicsAssignmentsData;
        
        practicalsData["B.A. (Bachelor of Arts)"] = practicalsData["B.A. (Bachelor of Arts)"] || {};
        practicalsData["B.A. (Bachelor of Arts)"]["Economics"] = economicsOtherData;
        
        notesData["B.A. (Bachelor of Arts)"] = notesData["B.A. (Bachelor of Arts)"] || {};
        notesData["B.A. (Bachelor of Arts)"]["Economics"] = economicsNotesData;

        // ==================== ENGLISH DATA ====================
        // English Notes Data
        const englishNotesData = {
            "Sem 1": [
                { name: "BA,B.SC,B.COM I SEM  -  General English", url: "https://tinyurl.com/2y5vlfkq" },
                { name: "SEM I English Literature", url: "https://tinyurl.com/25p9hq6v" },
                { name: "English semester 1st", url: "https://tinyurl.com/2ce6v7rm" }
            ],
            "Sem 2": [
                { name: "English Book (Semester -2)", url: "https://tinyurl.com/2aspa4qg" }
            ],
            "Sem 3": [
                { name: "ba 3 sem english", url: "https://tinyurl.com/2crggk5n" },
                { name: "English literature 3 semester", url: "https://tinyurl.com/25j9ft55" }
            ],
            "Sem 6": [
                { name: "English literary terms 6 th sem", url: "https://tinyurl.com/245zf4va" }
            ],
            "Unknown": [
                { name: "Aanandam ( ENGLISH )", url: "https://tinyurl.com/26fxat6l" },
                { name: "Animal-Farm-plot-summary", url: "https://tinyurl.com/29ftj3ok" },
                { name: "Blue book English", url: "https://tinyurl.com/2dyqx2ev" },
                { name: "Comprehension Skills -Poetry Updated", url: "https://tinyurl.com/2afyjucw" },
                { name: "Daffodils gen english neha raghav", url: "https://tinyurl.com/22pmo3te" },
                { name: "Dollshouse summary", url: "https://tinyurl.com/2xvm5xbz" },
                { name: "Dramatic_Monologue_Literary_Form", url: "https://tinyurl.com/2y9qw4a5" },
                { name: "English", url: "https://tinyurl.com/27859pq7" },
                { name: "English Grammer. PDF", url: "https://tinyurl.com/27sa6pbx" },
                { name: "English literature 4 sem unit 1", url: "https://tinyurl.com/23twh4ek" },
                { name: "English PDF", url: "https://tinyurl.com/2c3udryy" },
                { name: "English pdf", url: "https://tinyurl.com/23ez7go5" },
                { name: "Envelope", url: "https://tinyurl.com/2584lp6z" },
                { name: "General English", url: "https://tinyurl.com/29danx9n" },
                { name: "Govt_Assistance_to_Industries_English_ppt_B_Com_Hons_B_Adm_Honors", url: "https://tinyurl.com/28e5m6lb" },
                { name: "Industrial_Policy_English_ppt_B_Com_Hons_Sem_II_B_Adm_converted", url: "https://tinyurl.com/2dq7czoj" },
                { name: "Letter Writing (2)", url: "https://tinyurl.com/2b6fwdmk" },
                { name: "Pre-Raphaelite movement", url: "https://tinyurl.com/23bz6z6p" },
                { name: "Romantic movement", url: "https://tinyurl.com/29tk9b54" },
                { name: "the_open_window", url: "https://tinyurl.com/2ytho8pf" },
                { name: "Victorian movement", url: "https://tinyurl.com/2bdbbxtc" },
                { name: "Welfare State English ppt B.Com.Hons.B.Adm.SemII-converted", url: "https://tinyurl.com/26bj52jp" },
                { name: "Wordsworth_The_World_Is_Too_Much_Analysis", url: "https://tinyurl.com/273sr9yc" }
            ]
        };

        // English PYQ Data
        const englishPyqData = {
            "Sem 1": [
                { name: "BA,B.SC,B.COM I SEM  -  General English 3200 date  16-11-19", url: "https://tinyurl.com/2aofrlyl" }
            ],
            "Unknown": [
                { name: "B_A_B_Sc_B_Com_II_Semester_General_English_3300_date_27_4_19", url: "https://tinyurl.com/27pa5qqk" }
            ]
        };

        // English Assignments Data
        const englishAssignmentsData = {
            "Unknown": [
                { name: "BA-English-let-Asignment", url: "https://tinyurl.com/23m8sr2t" },
                { name: "MA(ENGLISH)", url: "https://tinyurl.com/264nqfdx" }
            ]
        };

        // English Other Data
        const englishOtherData = {
            "Unknown": [
                { name: "BA_ENGLISH", url: "https://tinyurl.com/28zf4nd6" },
                { name: "syllabus_general_english_new", url: "https://tinyurl.com/24rs3csh" }
            ]
        };

        // Assign English Data
        pyqData["B.A. (Bachelor of Arts)"]["English"] = englishPyqData;
        assignmentsData["B.A. (Bachelor of Arts)"]["English"] = englishAssignmentsData;
        practicalsData["B.A. (Bachelor of Arts)"]["English"] = englishOtherData;
        notesData["B.A. (Bachelor of Arts)"]["English"] = englishNotesData;

        // ==================== HINDI DATA ====================
        // Hindi Notes Data
        const hindiNotesData = {
            "Sem 1": [
                { name: "1st Sem complete Hindi", url: "https://tinyurl.com/2c3nbcwq" },
                { name: "BA, B.Sc., B.com I Sem Pass & Hon. General hindi", url: "https://tinyurl.com/2dkshuqh" }
            ],
            "Sem 6": [
                { name: "VI Sem.-P2-Unit III-Hindi", url: "https://tinyurl.com/24x6khx8" },
                { name: "Vivek YadavVI Sem.-P2-Unit III-Hindi", url: "https://tinyurl.com/25l74ngb" }
            ],
            "Unknown": [
                { name: "alkanes and cyclo hindi", url: "https://tinyurl.com/293mcsjq" },
                { name: "alkyene and diene hindi", url: "https://tinyurl.com/25wq3mhe" },
                { name: "B.Sc Sem1 M.O.T Hindi Notes", url: "https://tinyurl.com/2awdzcek" },
                { name: "Bsc 1sem unit-3 liquid state hindi medium", url: "https://tinyurl.com/242bbpcm" },
                { name: "Complete Blue Book Hindi", url: "https://tinyurl.com/2crnjy6v" },
                { name: "Coordination compounds in hindi", url: "https://tinyurl.com/297opvad" },
                { name: "Gas state hindi medium", url: "https://tinyurl.com/2yc5pqnr" },
                { name: "hindi 2 pyq", url: "https://tinyurl.com/27cabd4u" },
                { name: "Hindi pdf", url: "https://tinyurl.com/2cj4lxn8" },
                { name: "Muhavere (1)", url: "https://tinyurl.com/22dydxm4" },
                { name: "Paribhashik Sabdawali", url: "https://tinyurl.com/28r854v4" },
                { name: "Sanchapen", url: "https://tinyurl.com/2cw73wxy" },
                { name: "sem2 hindi", url: "https://tinyurl.com/27zltkl3" },
                { name: "Solid hindi", url: "https://tinyurl.com/2ykazw5y" },
                { name: "TRADE & ENV _Hindi", url: "https://tinyurl.com/24duaodp" },
                { name: "UNEMPLOYMENT AND COST.(HINDI MEDIUM)", url: "https://tinyurl.com/26mgtph4" },
                { name: "unit-4-hindi", url: "https://tinyurl.com/25ygcjyy" },
                { name: "unit-4-hindi Vivek Yadav", url: "https://tinyurl.com/284hcyve" },
                { name: "à¤à¤²à¤•à¤¾à¤¡à¤¾à¤ˆà¤‡à¤¨", url: "https://tinyurl.com/285fa9og" },
                { name: "à¤à¤²à¤•à¥‡à¤¨", url: "https://tinyurl.com/2a8yrdq2" },
                { name: "à¤à¤²à¤•à¥‡à¤¨ section-d (mam)", url: "https://tinyurl.com/26rllwdv" },
                { name: "à¤•à¤¿à¤°à¤¾à¤ à¤ªà¤° à¤¨à¤¿à¤¬à¤‚à¤§", url: "https://tinyurl.com/23ts38yf" },
                { name: "à¤”à¤¦à¥à¤¯à¥‹à¤—à¤¿à¤•_à¤¨à¥€à¤¤à¤¿_hindi_à¤ªà¥€à¤ªà¥€à¤Ÿà¥€_B_Com_à¤‘à¤¨à¤°à¥à¤¸_à¤¸à¥‡à¤®_à¤¦à¥à¤µà¤¿à¤¤à¥€à¤¯_B_Adm_", url: "https://tinyurl.com/2bvzj62w" },
                { name: "hindi_ppt_on_negotiable_instrument_act_1881_for_b_com_converted", url: "https://tinyurl.com/29f8brkt" }
            ]
        };

        // Hindi PYQ Data
        const hindiPyqData = {
            "Sem 1": [
                { name: "BA,_B_Sc_,_B_com_I_Sem_Pass_&_Hon_General_hindi_3200_date_16_11", url: "https://tinyurl.com/28eqtfp2" }
            ],
            "Unknown": [
                { name: "General Hindi   3300 date 25-4-19", url: "https://tinyurl.com/24fku4nn" },
                { name: "hindi pyq", url: "https://tinyurl.com/22jz8aeg" }
            ]
        };

        // Hindi Assignments Data
        const hindiAssignmentsData = {
            "Unknown": [
                { name: "MA-Hindi-Assignment", url: "https://tinyurl.com/26h524j2" }
            ]
        };

        // Hindi Other Data
        const hindiOtherData = {
            "Unknown": [
                { name: "BA_Hindi", url: "https://tinyurl.com/27ncgwfe" },
                { name: "PDF Gallery_20240124_131758", url: "https://tinyurl.com/23awkqo4" },
                { name: "syllabus_general_hindi_new", url: "https://tinyurl.com/25cl6mwl" },
                { name: "syllabus_general_hindi_New_Oct2024", url: "https://tinyurl.com/2yl5smax" }
            ]
        };

        // Assign Hindi Data
        pyqData["B.A. (Bachelor of Arts)"]["Hindi"] = hindiPyqData;
        assignmentsData["B.A. (Bachelor of Arts)"]["Hindi"] = hindiAssignmentsData;
        practicalsData["B.A. (Bachelor of Arts)"]["Hindi"] = hindiOtherData;
        notesData["B.A. (Bachelor of Arts)"]["Hindi"] = hindiNotesData;

        // ==================== COMPUTER SCIENCE DATA ====================
        // Computer Science Notes Data
        const computerScienceNotesData = {
            "Sem 3": [
                { name: "Bcom 3rd sem computer paper", url: "https://tinyurl.com/25n4qhrh" },
                { name: "Bsc 3rd sem Elementary Computer Application  (1) (1) (1)", url: "https://tinyurl.com/28c8xca5" },
                { name: "Computer Applications Series (B.Sc. III Sem.)", url: "https://tinyurl.com/26vv4g5q" }
            ],
            "Sem 4": [
                { name: "Computer compulsory file Semester 4", url: "https://tinyurl.com/2d9glcqm" }
            ],
            "Unknown": [
                { name: "Computer", url: "https://tinyurl.com/2c86tapt" },
                { name: "Computer Applications Hindi", url: "https://tinyurl.com/257ngu42" },
                { name: "computer elementary", url: "https://tinyurl.com/2b8knm2y" },
                { name: "computer very most notes pdf", url: "https://tinyurl.com/2cks7ex6" },
                { name: "ELEMENTRY COMPUTER APPLICATION", url: "https://tinyurl.com/28dvjpk3" },
                { name: "operating system", url: "https://tinyurl.com/28rmaxxk" },
                { name: "SEC-Elementary-Computer-Applications", url: "https://tinyurl.com/25dggd4k" }
            ]
        };

        // Computer Science Practicals Data
        const computerSciencePracticalsData = {
            "Sem 4": [
                { name: "Elementary-Computer-Application-Practical-Exam-2024", url: "https://tinyurl.com/2baycbll" }
            ],
            "All": [
                { name: "C-Programming NA practical file", url: "https://tinyurl.com/2cduxh4b" },
                { name: "Computer Practical File", url: "https://tinyurl.com/25yk53vm" }
            ],
            "Unknown": [
                { name: "C Programming Practice Problems", url: "https://tinyurl.com/23eb52mu" },
                { name: "Data Structure Study Materials and Practice Problems", url: "https://tinyurl.com/287385db" },
                { name: "programs", url: "https://tinyurl.com/2d2l9pju" }
            ]
        };

        // Computer Science Assignments Data
        const computerScienceAssignmentsData = {
            "Unknown": [
                { name: "BCA-Assignments", url: "https://tinyurl.com/26ej6y45" },
                { name: "MScIT-Assignments", url: "https://tinyurl.com/2yt3jdmw" },
                { name: "MScIT-Assignments (1)", url: "https://tinyurl.com/25dnzr5s" },
                { name: "PGDCAAssignments (1)", url: "https://tinyurl.com/2ddq3tzh" },
                { name: "PGDCAAssignments", url: "https://tinyurl.com/2bvplk47" }
            ]
        };

        // Computer Science Other Data
        const computerScienceOtherData = {
            "Unknown": [
                { name: "BCAComputerScience-UG_Classes_Time_Table_wef_July2025", url: "https://tinyurl.com/2667aeln" },
                { name: "Elementary_Computer_Syllabus", url: "https://tinyurl.com/2a9yzxb6" },
                { name: "Elementary_Computer_Syllabus", url: "https://tinyurl.com/272ca9pm" },
                { name: "First-merit-list-BCA-2024-25", url: "https://tinyurl.com/26d2mysf" },
                { name: "Time_Table_for_BSc_BA_BCA", url: "https://tinyurl.com/2a9mp9eu" }
            ]
        };

        const computerSciencePyqData = {
            "Sem 3": [
                { name: "Bsc 3rd semester computer old paper", url: "https://tinyurl.com/2yspnxh2" },
                { name: "computer pyq semester 3", url: "https://tinyurl.com/2a6puwoe" }
            ],
            "Sem 4": [
                { name: "BSC  4th semester computer old paper", url: "https://tinyurl.com/28tllb7c" }
            ],
            "Sem 5": [
                { name: "computer notes all sem 5", url: "https://tinyurl.com/294m2fzl" }
            ],
            "All": [
                { name: "bsc computer sci pyp (sem 3-6)", url: "https://tinyurl.com/2bxfxwgo" },
                { name: "computer science old paper bsc", url: "https://tinyurl.com/24r29pzz" }
            ]
        };

        // Assign Computer Science Data - appears in both B.Sc. and B.C.A.
        pyqData["B.Sc. (Bachelor of Science)"]["Computer Science"] = computerSciencePyqData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Computer Science"] = computerScienceAssignmentsData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Computer Science"] = computerSciencePracticalsData;
        notesData["B.Sc. (Bachelor of Science)"]["Computer Science"] = computerScienceNotesData;

        // For B.C.A. (Bachelor of Computer Applications)
        pyqData["B.C.A. (Bachelor of Computer Applications)"] = pyqData["B.C.A. (Bachelor of Computer Applications)"] || {};
        assignmentsData["B.C.A. (Bachelor of Computer Applications)"] = {};
        assignmentsData["B.C.A. (Bachelor of Computer Applications)"]["BCA"] = computerScienceAssignmentsData;
        practicalsData["B.C.A. (Bachelor of Computer Applications)"] = {};
        practicalsData["B.C.A. (Bachelor of Computer Applications)"]["BCA"] = computerSciencePracticalsData;
        notesData["B.C.A. (Bachelor of Computer Applications)"] = {};
        notesData["B.C.A. (Bachelor of Computer Applications)"]["BCA"] = computerScienceNotesData;

        // ==================== POLITICAL SCIENCE DATA ====================
        const politicalScienceNotesData = {
            "Sem 3": [
                { name: "political notes ðŸˆ first paper (third semester )", url: "https://tinyurl.com/2djq5qka" }
            ],
            "Sem 5": [
                { name: "BA V -sem POLITICAL SCIENCE  international relations (1)", url: "https://tinyurl.com/2af8mbe7" },
                { name: "BA V -sem POLITICAL SCIENCE  international relations", url: "https://tinyurl.com/2b9n2q88" }
            ],
            "Sem 6": [
                { name: "Pol science 6th semester (1)", url: "https://tinyurl.com/278qhytv" }
            ],
            "Unknown": [
                { name: "Centre_State_Relations_In_India", url: "https://tinyurl.com/27jvb5sz" },
                { name: "GovernmentsinStates", url: "https://tinyurl.com/225aonad" },
                { name: "international realation", url: "https://tinyurl.com/2ar8q5hq" },
                { name: "PoliticalPartiesInIndia", url: "https://tinyurl.com/24epkezo" },
                { name: "Representative western political thinkers", url: "https://tinyurl.com/244yv5mk" },
                { name: "Representative_Western_Political_Thinkers", url: "https://tinyurl.com/27eqzvvo" },
                { name: "TheExecutive..", url: "https://tinyurl.com/2b4zajbe" },
                { name: "TheJudiciaryinIndia", url: "https://tinyurl.com/284rw6gq" },
                { name: "à¤…à¤°à¤¸à¥à¤¤à¥‚_à¤•à¥‡_à¤¨à¤¾à¤—à¤°à¤¿à¤•à¤¤à¤¾_à¤¸à¤‚à¤¬à¤‚à¤§à¥€_Margdarshan", url: "https://tinyurl.com/23ukodzb" },
                { name: "à¤•à¤²à¥à¤¯à¤¾à¤£à¤•à¤¾à¤°à¥€_à¤°à¤¾à¤œà¥à¤¯_à¤¹à¤¿à¤‚à¤¦à¥€_à¤ªà¥€à¤ªà¥€à¤Ÿà¥€_B_com_à¤‘à¤¨à¤°à¥à¤¸_B_adm_SemII", url: "https://tinyurl.com/2akyv7tl" }
            ]
        };

        const politicalSciencePyqData = {
            "Sem 3": [
                { name: "political_science_old_third_semester_paper_create_by_Deepak_  ", url: "https://tinyurl.com/2b7pdvu2" },
                { name: "pol sci sem 3 political theory & constitutions", url: "https://tinyurl.com/23xh2hgw" }
            ]
        };

        const politicalScienceCIAData = {
            "Sem 2": [
                { name: "POLITICAL SCIENCE old cia 2", url: "https://tinyurl.com/23mfv844" }
            ],
            "Unknown": [
                { name: "POLITICAL SCIENCE cia", url: "https://tinyurl.com/2yu5vht6" },
                { name: "POLITICAL SCIENCE old cia", url: "https://tinyurl.com/2a8dao7f" },
                { name: "POLITICAL SCIENCE pyq cia", url: "https://tinyurl.com/2a43s7fk" }
            ]
        };

        const politicalScienceAssignmentsData = {
            "Unknown": [
                { name: "BA-Hons-PolSci-Assignment", url: "https://tinyurl.com/27yrko62" },
                { name: "MA-PolSci-Assignments (1)", url: "https://tinyurl.com/22rdah6c" },
                { name: "MA-PolSci-Assignments", url: "https://tinyurl.com/2awkkqfs" }
            ]
        };

        const politicalScienceOtherData = {
            "Unknown": [
                { name: "BA_Pol_Sci", url: "https://tinyurl.com/2d3nltq4" }
            ]
        };

        // Assign Political Science Data
        pyqData["B.A. (Bachelor of Arts)"]["Political Science"] = politicalSciencePyqData;
        assignmentsData["B.A. (Bachelor of Arts)"]["Political Science"] = politicalScienceAssignmentsData;
        practicalsData["B.A. (Bachelor of Arts)"]["Political Science"] = { ...politicalScienceOtherData, ...politicalScienceCIAData };
        notesData["B.A. (Bachelor of Arts)"]["Political Science"] = politicalScienceNotesData;

        // ==================== HISTORY DATA ====================
        const historyNotesData = {
            "Sem 3": [
                { name: "B_A_III_Sem_history_MAIN_TRENDS_IN_THE_CULTURAL_HISTORY_&_INDIA", url: "https://tinyurl.com/2cxnaefd" },
                { name: "BA_III_SEM_HISTORY_History_&_Medieval_India_I_1200_1526_AD", url: "https://tinyurl.com/26379g4a" },
                { name: "BA_III_SEM_HISTORY_History_&_Medieval_India_I_1200_1526_AD_Copy", url: "https://tinyurl.com/2436lfhl" }
            ],
            "Unknown": [
                { name: "1857_1947_Socio_religious_reform_Movements_Study_Notes_@_abhipedia", url: "https://tinyurl.com/23a8owwa" }
            ]
        };

        const historyPyqData = {
            "Sem 2": [
                { name: "history sem 2 pyp", url: "https://tinyurl.com/26h3gdbv" }
            ],
            "Sem 4": [
                { name: "History sem 4 paper 1", url: "https://tinyurl.com/29d3kj8f" },
                { name: "History sem 4 paper 2", url: "https://tinyurl.com/2ajz4s62" },
                { name: "Semester exam History paper for sem 4", url: "https://tinyurl.com/2dp5xezc" }
            ],
            "Sem 6": [
                { name: "history 6th sem pyp (1)", url: "https://tinyurl.com/29er6wzd" }
            ]
        };

        const historyAssignmentsData = {
            "Sem 1": [
                { name: "History_Assignment_Paper1stà¤†à¤§à¥à¤¨à¤¿à¤•_à¤­à¤¾à¤°à¤¤_à¤•à¤¾_à¤‡à¤¤à¤¿à¤¹à¤¾à¤¸", url: "https://tinyurl.com/27gqtavx" }
            ],
            "Unknown": [
                { name: "BA_History", url: "https://tinyurl.com/22gydw6h" },
                { name: "BA-History-Assignments", url: "https://tinyurl.com/28r4keex" },
                { name: "MA-History-Assignments", url: "https://tinyurl.com/22ymgfm9" },
                { name: "MA-History-Assignments (1)", url: "https://tinyurl.com/255zplol" },
                { name: "MA(HISTORY)", url: "https://tinyurl.com/2xnoe8vj" }
            ]
        };

        const historyOtherData = {
            "Unknown": [
                { name: "syllabus_ba_history", url: "https://tinyurl.com/27c7msgr" }
            ]
        };

        // Assign History Data
        pyqData["B.A. (Bachelor of Arts)"]["History"] = historyPyqData;
        assignmentsData["B.A. (Bachelor of Arts)"]["History"] = historyAssignmentsData;
        practicalsData["B.A. (Bachelor of Arts)"]["History"] = historyOtherData;
        notesData["B.A. (Bachelor of Arts)"]["History"] = historyNotesData;

        // ==================== GEOGRAPHY DATA ====================
        const geographyNotesData = {
            "Sem 1": [
                { name: "rj geo 1 semester", url: "https://tinyurl.com/27foh6oq" },
                { name: "geography sem 1st notes", url: "https://tinyurl.com/29sffxfb" },
                { name: "geographical thought notes", url: "https://tinyurl.com/24dfgxyh" },
                { name: "geography praticals notes", url: "https://tinyurl.com/2y8ggrdq" },
                { name: "geography physical notes", url: "https://tinyurl.com/232a8xsw" }
            ],
            "Sem 2": [
                { name: "geo 2nd 1 paper", url: "https://tinyurl.com/24usjx7o" },
                { name: "B.A_ B.Sc. II Sem geography paper II part 1", url: "https://tinyurl.com/22jw39sl" },
                { name: "B.A_ B.Sc. II Sem geography paper II part 2", url: "https://tinyurl.com/23zqslev" },
                { name: "geo 2nd 2nd paper", url: "https://tinyurl.com/28yjjkp6" }
            ],
            "Sem 3": [
                { name: "Geography notes 3 sem", url: "https://tinyurl.com/25blcxv7" },
                { name: "Geography 3rd sem notes", url: "https://tinyurl.com/29vk7e9x" },
                { name: "geo  3 sem notes", url: "https://tinyurl.com/2aybgdpl" }
            ],
            "Sem 5": [
                { name: "Geography 5th sem notes", url: "https://tinyurl.com/2d64nxxb" },
                { name: "geography notes 5 sem", url: "https://tinyurl.com/26qxu6vf" }
            ],
            "Sem 6": [
                { name: "geo 6th sem notes", url: "https://tinyurl.com/232cxjf5" }
            ],
            "All": [
                { name: "Geography notes All", url: "https://tinyurl.com/254r4hjn" }
            ],
            "Unknown": [
                { name: "b.a b.sc IV geog - human geog.", url: "https://tinyurl.com/267jdhh8" },
                { name: "Evolution of geographical thought", url: "https://tinyurl.com/28wfztgy" },
                { name: "Geo.Metho. unit 1", url: "https://tinyurl.com/23ws46zs" }
            ]
        };

        const geographyCIAData = {
            "Sem 3": [
                { name: "É¢á´‡á´É¢Ê€á´€á´˜ÊœÊ 3 sem imp question", url: "https://tinyurl.com/294kb3cs" }
            ],
            "Sem 6": [
                { name: "geography 6th sem cia", url: "https://tinyurl.com/2crc2npz" },
                { name: "BA-BSc-Geography-Sem-VI-Practical-Examination-May2023", url: "https://tinyurl.com/2746m8x8" },
                { name: "Geo practical file 6 sem", url: "https://tinyurl.com/27lzknyt" }
            ],
            "All": [
                { name: "Geography Practical File", url: "https://tinyurl.com/292nq9b7" },
                { name: "Geo. Practical file", url: "https://tinyurl.com/24saya4u" },
                { name: "timetable-geography-practical-final-examination-2023", url: "https://tinyurl.com/2ycupkp6" },
                { name: "Geography practical 2021", url: "https://tinyurl.com/27uj552j" }
            ]
        };

        const geographyAssignmentsData = {
            "Sem 6": [
                { name: "Geo Assign. 6 sem", url: "https://tinyurl.com/29ge8mb7" }
            ],
            "Unknown": [
                { name: "MA-MSc-Geography-Assignments", url: "https://tinyurl.com/2d3uoarc" }
            ]
        };

        // Coming Soon message for empty sections
        const comingSoonData = {
            "Coming Soon": [
                { name: "Coming soonâ€¦ thank you for staying with us âœ¨", url: "javascript:void(0)" }
            ]
        };

        // Assign Geography Data
        pyqData["B.A. (Bachelor of Arts)"]["Geography"] = comingSoonData;
        assignmentsData["B.A. (Bachelor of Arts)"]["Geography"] = geographyAssignmentsData;
        practicalsData["B.A. (Bachelor of Arts)"]["Geography"] = geographyCIAData;
        notesData["B.A. (Bachelor of Arts)"]["Geography"] = geographyNotesData;

        // Also in B.Sc.
        pyqData["B.Sc. (Bachelor of Science)"]["Geography"] = comingSoonData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Geography"] = geographyAssignmentsData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Geography"] = geographyCIAData;
        notesData["B.Sc. (Bachelor of Science)"]["Geography"] = geographyNotesData;

        // ==================== BOTANY DATA ====================
        const botanyNotesData = {
            "Sem 1": [
                { name: "B.Sc I Sem BOTANY-II MICROBIOLOGY", url: "https://tinyurl.com/2yw68tsf" },
                { name: "B.Sc I Sem BOTANY-III  ALGAE & LICHENS", url: "https://tinyurl.com/2yzfzmev" },
                { name: "B.Sc I Sem Botay Cell Biology", url: "https://tinyurl.com/27rvnetk" },
                { name: "Botany Cell Bio Part 1st", url: "https://tinyurl.com/25l9q84e" }
            ],
            "Sem 3": [
                { name: "B.Sc III Sem BOTANY-I MOLECULAR BIOLOGY", url: "https://tinyurl.com/2b8g9plt" },
                { name: "B.Sc III Sem BOTANY-II Biotechnology", url: "https://tinyurl.com/2clq5lq8" }
            ],
            "Sem 4": [
                { name: "B.Sc- IV Sem Botany - Gymnosperms & Paleabotany", url: "https://tinyurl.com/27938xj9" }
            ],
            "Unknown": [
                { name: "Microbiology botany part 2nd", url: "https://tinyurl.com/2ck2j8ga" },
                { name: "Plant morphology.... flowering plant ... general body stru.", url: "https://tinyurl.com/2c82feco" },
                { name: "Taxonomy...indexes..hebarium...etc..", url: "https://tinyurl.com/278fxofz" }
            ]
        };

        const botanyAssignmentsData = {
            "Unknown": [
                { name: "BSc-Botany-Assignemnts", url: "https://tinyurl.com/28d5vk37" },
                { name: "MSc-Botany-Assignments", url: "https://tinyurl.com/25y9a4wq" }
            ]
        };

        const botanyOtherData = {
            "Unknown": [
                { name: "MSC(BOTANY)", url: "https://tinyurl.com/27ty2j2r" }
            ]
        };

        const botanyPracticalsData = {
            "Sem 6": [
                { name: "Botany VI Sem Practical Record English", url: "https://tinyurl.com/2an336nj" }
            ],
            "All": [
                { name: "Botany VI Sem Practical Record English", url: "https://tinyurl.com/2an336nj" }
            ]
        };

        // Assign Botany Data
        pyqData["B.Sc. (Bachelor of Science)"]["Botany"] = comingSoonData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Botany"] = botanyAssignmentsData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Botany"] = botanyPracticalsData;
        notesData["B.Sc. (Bachelor of Science)"]["Botany"] = botanyNotesData;

        // ==================== ZOOLOGY DATA ====================
        const zoologyNotesData = {
            "Unknown": [
                { name: "B.sc IV sem  Zoology- Biochemistry & Endocrinology", url: "https://tinyurl.com/25m9grmz" }
            ]
        };

        const zoologyAssignmentsData = {
            "Unknown": [
                { name: "BSC-MICROBIOLOGY-ASSIGNMENTS", url: "https://tinyurl.com/2cbojrtt" },
                { name: "MSc-Biotech-Assignments (1)", url: "https://tinyurl.com/27va7nsd" },
                { name: "MSc-Biotech-Assignments", url: "https://tinyurl.com/28zt9zfm" },
                { name: "MSc-Microbiology-Assignments (1)", url: "https://tinyurl.com/28aogdyf" },
                { name: "MSc-Microbiology-Assignments", url: "https://tinyurl.com/24an7bs4" },
                { name: "MSc-Zoology-Assignments", url: "https://tinyurl.com/2ah6b5pd" }
            ]
        };

        const zoologyPracticalsData = {
            "Sem 6": [
                { name: "Zoology VI sem practical record english", url: "https://tinyurl.com/2a2v675q" }
            ],
            "All": [
                { name: "Zoology VI sem practical record english", url: "https://tinyurl.com/2a2v675q" }
            ]
        };

        // Assign Zoology Data
        pyqData["B.Sc. (Bachelor of Science)"]["Zoology"] = comingSoonData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Zoology"] = zoologyAssignmentsData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Zoology"] = zoologyPracticalsData;
        notesData["B.Sc. (Bachelor of Science)"]["Zoology"] = zoologyNotesData;

        // ==================== BIOLOGY DATA ====================
        const biologyAssignmentsData = {
            "Unknown": [
                { name: "BSc_Microbiology", url: "https://tinyurl.com/27tm9s6z" }
            ]
        };

        const biologyOtherData = {
            "Unknown": [
                { name: "BSC-BIOLOGY", url: "https://tinyurl.com/27aqrdt7" },
                { name: "BSc_Microbiology_syllabus_new", url: "https://tinyurl.com/2326kc66" }
            ]
        };

        // Assign Biology Data
        pyqData["B.Sc. (Bachelor of Science)"]["Biology"] = comingSoonData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Biology"] = biologyAssignmentsData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Biology"] = biologyOtherData;
        notesData["B.Sc. (Bachelor of Science)"]["Biology"] = comingSoonData;

        // ==================== ENVIRONMENTAL SCIENCE DATA ====================
        const environmentalScienceNotesData = {
            "Sem 1": [
                { name: "ENVIRONMENTAL STUDIES  3000 Date 27-11-19", url: "https://tinyurl.com/26xhsm59" }
            ],
            "Sem 3": [
                { name: "Environmental Studies Series (B. Sc. III Sem.)(1)", url: "https://tinyurl.com/2y4m6udb" }
            ],
            "Unknown": [
                { name: "Concept_of_Sustainable_Agriculture", url: "https://tinyurl.com/2ckusvl9" },
                { name: "Environment Compulsory", url: "https://tinyurl.com/2bx5ac2f" },
                { name: "ENVIRONMENTAL STUDIES", url: "https://tinyurl.com/2aqkzte2" },
                { name: "Environmental_Institutions_and_Organizations", url: "https://tinyurl.com/2bvxtkgc" },
                { name: "Environmental Studies Series_compressed(1)", url: "https://tinyurl.com/22b3o6av" },
                { name: "Environmental_Laws_and_Acts_India", url: "https://drive.google.com/file/d/1W1DFFsshKo_TPo6f2P7ylPO1eSfItI7A/view?usp=drivesdk" },
                { name: "ENVS-1", url: "https://tinyurl.com/2czuzjmx" },
                { name: "MSc(ENVIRONMENTAL-SCIENCE)", url: "https://tinyurl.com/27t9y6x3" },
                { name: "National_Environmental_Issues_and_Population", url: "https://tinyurl.com/225lbrsp" },
                { name: "Origin_of_Earth_and_Environment", url: "https://tinyurl.com/22cgnf2h" },
                { name: "WATER RESOURCE AND WATER CONSERVATION", url: "https://tinyurl.com/2ajp797a" }
            ]
        };

        const environmentalSciencePyqData = {
            "Sem 1": [
                { name: "ENVIRONMENTAL STUDIES  3000 Date 27-11-19", url: "https://tinyurl.com/26xhsm59" },
                { name: "Environmental Study paper 17 and 18", url: "https://tinyurl.com/29wgejx5" }
            ],
            "Sem 2": [
                { name: "EVS  question paper 19,20", url: "https://tinyurl.com/23p6wzha" }
            ],
            "Sem 3": [
                { name: "Environmental Studies Series (B. Sc. III Sem.)(1)", url: "https://tinyurl.com/2y4m6udb" }
            ],
            "All": [
                { name: "environmental pyq", url: "https://tinyurl.com/2yzqnx34" }
            ],
            "Unknown": [
                { name: "EVS PRIVIOUS PAPER (1)", url: "https://tinyurl.com/27ao5t84" }
            ]
        };

        const environmentalScienceAssignmentsData = {
            "Unknown": [
                { name: "MSc-ENVS-Assignments (1)", url: "https://tinyurl.com/2bjbcuv5" },
                { name: "MSc-ENVS-Assignments", url: "https://tinyurl.com/23frmyvk" }
            ]
        };

        const environmentalScienceOtherData = {
            "Unknown": [
                { name: "syllabus_EVS", url: "https://tinyurl.com/29bk3jwp" },
                { name: "syllabus_EVS", url: "https://tinyurl.com/25cvqrzx" },
                { name: "syllabus_EVS_Oct2023", url: "https://tinyurl.com/25rx46gt" }
            ]
        };

        // Assign Environmental Science Data
        pyqData["B.Sc. (Bachelor of Science)"]["Environmental Science"] = environmentalSciencePyqData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Environmental Science"] = environmentalScienceAssignmentsData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Environmental Science"] = environmentalScienceOtherData;
        notesData["B.Sc. (Bachelor of Science)"]["Environmental Science"] = environmentalScienceNotesData;

        // ==================== SANSKRIT, SOCIOLOGY, PHILOSOPHY, JOURNALISM DATA ====================
        const sanskritAssignmentsData = {
            "Unknown": [
                { name: "BA-Sanskrit-assignments", url: "https://tinyurl.com/297salrh" }
            ]
        };

        const sociologyNotesData = {
            "Unknown": [
                { name: "Indian_Tribes_Gonds_Nagas_Bhils", url: "https://tinyurl.com/27yo3xlv" },
                { name: "Samaj Shastra (139) (1)", url: "https://tinyurl.com/2buubtw8" }
            ]
        };

        const sociologyOtherData = {
            "Unknown": [
                { name: "BA_Sociology_and_Social_Work_MSW", url: "https://tinyurl.com/29px6mru" }
            ]
        };

        const philosophyNotesData = {
            "Unknown": [
                { name: "à¤ªà¥à¤²à¥‡à¤Ÿà¥‹_à¤…à¤°à¤¸à¥à¤¤à¥‚_à¤•à¥‡_à¤µà¤¿à¤šà¤¾à¤°à¥‹_à¤•à¤¾_à¤¤à¥à¤²à¤¨à¤¾à¤¤à¥à¤®à¤•_à¤…à¤§à¥à¤¯à¤¯à¤¨_Margdarshan", url: "https://tinyurl.com/257geg2r" },
                { name: "à¤…à¤°à¤¸à¥à¤¤à¥‚_à¤•à¥‡_à¤¦à¤¾à¤¸_à¤ªà¥à¤°à¤¥à¤¾_à¤ªà¤°_à¤µà¤¿à¤šà¤¾à¤°_à¤®à¤¾à¤°à¥à¤—à¤¦à¤°à¥à¤¶à¤¨", url: "https://tinyurl.com/2a8rfj9v" }
            ]
        };

        const philosophyAssignmentsData = {
            "Unknown": [
                { name: "BA-Philosophy-Assignments", url: "https://tinyurl.com/225vvwe4" }
            ]
        };

        const journalismAssignmentsData = {
            "Unknown": [
                { name: "MAJMC-Assignments (1)", url: "https://tinyurl.com/23d8pvgn" },
                { name: "MAJMC-Assignments", url: "https://tinyurl.com/26uspbwj" }
            ]
        };

        // Assign Sanskrit Data
        pyqData["B.A. (Bachelor of Arts)"]["Sanskrit"] = comingSoonData;
        assignmentsData["B.A. (Bachelor of Arts)"]["Sanskrit"] = sanskritAssignmentsData;
        practicalsData["B.A. (Bachelor of Arts)"]["Sanskrit"] = comingSoonData;
        notesData["B.A. (Bachelor of Arts)"]["Sanskrit"] = comingSoonData;

        // Assign Sociology Data
        pyqData["B.A. (Bachelor of Arts)"]["Sociology"] = comingSoonData;
        assignmentsData["B.A. (Bachelor of Arts)"]["Sociology"] = comingSoonData;
        practicalsData["B.A. (Bachelor of Arts)"]["Sociology"] = sociologyOtherData;
        notesData["B.A. (Bachelor of Arts)"]["Sociology"] = sociologyNotesData;

        // Assign Philosophy Data
        pyqData["B.A. (Bachelor of Arts)"]["Philosophy"] = comingSoonData;
        assignmentsData["B.A. (Bachelor of Arts)"]["Philosophy"] = philosophyAssignmentsData;
        practicalsData["B.A. (Bachelor of Arts)"]["Philosophy"] = comingSoonData;
        notesData["B.A. (Bachelor of Arts)"]["Philosophy"] = philosophyNotesData;

        // Assign Journalism Data
        pyqData["M.A. (Master of Arts)"] = pyqData["M.A. (Master of Arts)"] || {};
        pyqData["M.A. (Master of Arts)"]["Journalism & Mass Comm."] = comingSoonData;
        assignmentsData["M.A. (Master of Arts)"] = assignmentsData["M.A. (Master of Arts)"] || {};
        assignmentsData["M.A. (Master of Arts)"]["Journalism & Mass Comm."] = journalismAssignmentsData;
        practicalsData["M.A. (Master of Arts)"] = practicalsData["M.A. (Master of Arts)"] || {};
        practicalsData["M.A. (Master of Arts)"]["Journalism & Mass Comm."] = comingSoonData;
        notesData["M.A. (Master of Arts)"] = notesData["M.A. (Master of Arts)"] || {};
        notesData["M.A. (Master of Arts)"]["Journalism & Mass Comm."] = comingSoonData;

        // ==================== PSYCHOLOGY DATA ====================
        const psychologyPracticalsData = {
            "Sem 1": [
                { name: "Psychology 1st Sem Practical File", url: "https://tinyurl.com/22rqzjl6" }
            ],
            "All": [
                { name: "Psychology 1st Sem Practical File", url: "https://tinyurl.com/22rqzjl6" }
            ]
        };

        // Assign Psychology Data
        pyqData["B.Sc. (Bachelor of Science)"]["Psychology"] = comingSoonData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Psychology"] = comingSoonData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Psychology"] = psychologyPracticalsData;
        notesData["B.Sc. (Bachelor of Science)"]["Psychology"] = comingSoonData;

        pyqData["B.A. (Bachelor of Arts)"]["Psychology"] = comingSoonData;
        assignmentsData["B.A. (Bachelor of Arts)"]["Psychology"] = comingSoonData;
        practicalsData["B.A. (Bachelor of Arts)"]["Psychology"] = psychologyPracticalsData;
        notesData["B.A. (Bachelor of Arts)"]["Psychology"] = comingSoonData;

        // ==================== STATISTICS DATA ====================
        const statisticsPracticalsData = {
            "Sem 1": [
                { name: "Statistics practical file (Sem-1)", url: "https://tinyurl.com/2bezayna" }
            ],
            "Sem 3": [
                { name: "3rd sem statistics practical file", url: "https://tinyurl.com/2ypj3nwg" }
            ],
            "Sem 4": [
                { name: "statistics practical 4 sem", url: "https://tinyurl.com/29rjaknb" }
            ],
            "All": [
                { name: "Statistical Practical(1-11)", url: "https://tinyurl.com/29x4u5ta" },
                { name: "statistical practical(12â€“20)", url: "https://tinyurl.com/27b93988" },
                { name: "statistical practical(21â€“23)", url: "https://tinyurl.com/2y6unnnd" }
            ]
        };

        // Assign Statistics Data
        pyqData["B.Sc. (Bachelor of Science)"]["Statistics"] = comingSoonData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Statistics"] = comingSoonData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Statistics"] = statisticsPracticalsData;
        notesData["B.Sc. (Bachelor of Science)"]["Statistics"] = comingSoonData;

        pyqData["B.A. (Bachelor of Arts)"]["Statistics"] = comingSoonData;
        assignmentsData["B.A. (Bachelor of Arts)"]["Statistics"] = comingSoonData;
        practicalsData["B.A. (Bachelor of Arts)"]["Statistics"] = statisticsPracticalsData;
        notesData["B.A. (Bachelor of Arts)"]["Statistics"] = comingSoonData;

        // ==================== BIOTECHNOLOGY DATA ====================
        const biotechnologyPracticalsData = {
            "Sem 6": [
                { name: "Botany VI Sem Practical Record English", url: "https://tinyurl.com/2an336nj" }
            ],
            "All": [
                { name: "mscbiotechnologypracticalexamjan2023", url: "https://tinyurl.com/2dbw7k4w" }
            ]
        };

        // Assign Biotechnology Data
        pyqData["B.Sc. (Bachelor of Science)"]["Biotechnology"] = comingSoonData;
        assignmentsData["B.Sc. (Bachelor of Science)"]["Biotechnology"] = comingSoonData;
        practicalsData["B.Sc. (Bachelor of Science)"]["Biotechnology"] = biotechnologyPracticalsData;
        notesData["B.Sc. (Bachelor of Science)"]["Biotechnology"] = comingSoonData;

        // ==================== GENERAL/ADMINISTRATIVE OTHER FILES ====================
        // Mental Ability, Operations Research, and General Documents
        const generalOtherData = {
            "Mental Ability": [
                { name: "Mental Ability Solved Practice Sets", url: "https://tinyurl.com/25uacxqy" }
            ],
            "Operations Research": [
                { name: "Operations Research notes", url: "https://tinyurl.com/2ya5vfua" }
            ],
            "Administrative": [
                { name: "college new student guide book", url: "https://tinyurl.com/23zp4zcx" },
                { name: "Subodh_College_2023-24_prospectus_brochure", url: "https://tinyurl.com/28e6z7ca" },
                { name: "Ragging Act", url: "https://tinyurl.com/2dygpejb" },
                { name: "Anti-Ragging-Undertaking-by-Student", url: "https://tinyurl.com/28n5o3kr" },
                { name: "Result-Analysis-2022-23", url: "https://tinyurl.com/2ag2s5wj" },
                { name: "GIRLS-SCHOLARSHIP-APPLICATION-2018-19", url: "https://tinyurl.com/26kufczw" },
                { name: "Timetable-BCA-BBA-May-2024", url: "https://tinyurl.com/23skf893" },
                { name: "B Sc Final Year Time Table May 2024", url: "https://tinyurl.com/22xwl7pj" },
                { name: "BCA Time Table May 2024", url: "https://tinyurl.com/22j7g84f" },
                { name: "MA final year timetable may 2024", url: "https://tinyurl.com/25qstjqe" },
                { name: "msc biotechnology timetable May 2024", url: "https://tinyurl.com/26wllnyv" },
                { name: "msc maths timetable May 2024", url: "https://tinyurl.com/2xvhzz6q" },
                { name: "MSc chemistry time table may 2024", url: "https://tinyurl.com/25kd34qn" },
                { name: "MSc Botany Time table May 2024", url: "https://tinyurl.com/2cqxfdto" },
                { name: "Time table 2nd year BSc.( Hons.)-MSc zoology(1)", url: "https://tinyurl.com/24zy6gvy" },
                { name: "BA II year time table", url: "https://tinyurl.com/2y4n45vx" },
                { name: "BA III year Time Table May 2024", url: "https://tinyurl.com/22qs88sm" },
                { name: "Revised_Date_Sheet_Semester_End_Examination_Dec2023", url: "https://tinyurl.com/22o5o3hp" },
                { name: "BA BSc I Year Revised-Date-Sheet_Dec-2024", url: "https://tinyurl.com/2dg8s9tx" },
                { name: "Time_Table_Session_2023-24", url: "https://tinyurl.com/28cgxghz" },
                { name: "subodh pg college time table", url: "https://tinyurl.com/2y8ktvzy" },
                { name: "Subodh college Prospectus 2021-22", url: "https://tinyurl.com/24qf2tqv" },
                { name: "BSc computer Time Table May 2024", url: "https://tinyurl.com/2xu8wsvz" },
                { name: "timetable BSc III year Hons May 2024", url: "https://tinyurl.com/2dy6mgom" },
                { name: "BSc 1 and 2nd year timetable may 2024", url: "https://tinyurl.com/23ynfvr8" },
                { name: "bsc computer sci timetable May 2024", url: "https://tinyurl.com/26y8xqhj" },
                { name: "BBA time table may 2024 (1)", url: "https://tinyurl.com/2ywtbrsa" },
                { name: "Timetable-MSc-Physics-May-2024", url: "https://tinyurl.com/23egrbtd" },
                { name: "BA I year Time Table May 2024", url: "https://tinyurl.com/2ct4hqcf" }
            ]
        };

        // Note: These general files are not assigned to specific streams/subjects
        // They can be accessed via a separate "General Resources" or "Other" section in the UI

        const sellStreamsData = {
            'B.Sc. (Bachelor of Science)': ['Mathematics', 'Biology', 'Physics', 'Chemistry', 'Zoology', 'Botany', 'Microbiology', 'Biotechnology', 'Psychology', 'Statistics', 'Computer Science', 'Geography', 'Economics'],
            'B.Com. (Bachelor of Commerce)': ['ABST', 'EAFM', 'BADM'],
            'B.A. (Bachelor of Arts)': ['English', 'Hindi', 'History', 'Political Science', 'Geography', 'Economics', 'Sociology', 'Philosophy', 'Sanskrit', 'Psychology', 'Public Administration', 'Physical Education', 'Music'],
            'B.C.A. (Bachelor of Computer Applications)': [],
            'B.B.A. (Bachelor of Business Administration)': ['General BBA', 'BBA Retail Management', 'Hotel Management'],
            'M.Sc. (Master of Science)': ['Physics', 'Chemistry', 'Mathematics', 'Botany', 'Zoology', 'Environmental Science', 'Microbiology', 'Biotechnology', 'Information Technology (IT)', 'Forensic Science', 'Statistics', 'Psychology', 'Geography'],
            'M.A. (Master of Arts)': ['Hindi', 'English', 'Political Science', 'Public Administration', 'History', 'Economics', 'Geography', 'Journalism & Mass Comm.', 'Sociology', 'Psychology', 'Yoga', 'MSW (Master of Social Work)'],
            'M.Com. (Master of Commerce)': ['ABST', 'BADM', 'EAFM'],
            'M.C.A. (Master of Computer Applications)': [],
            'Additional Programs': ['Diploma Programs', 'PG Diploma Programs', 'Certification Courses', 'Ph.D.']
        };
        const aiCoursesData = [
            // New courses from user
            { name: "Artificial Intelligence", provider: "MIT", duration: "24 hours (Free)", short_duration: "24 hours", description: "This course introduces students to the basic knowledge representation, problem-solving, and learning methods of artificial intelligence.", topics: ["Reasoning & Search", "Machine Learning (Neural Nets, SVMs)", "Genetic Algorithms", "Probabilistic Inference", "Human-Computer Interaction"], link: "https://www.classcentral.com/course/mit-ocw-6-034-artificial-intelligence-fall-2010-40938", imageUrl: "https://i.postimg.cc/v82Y9fpM/artificial-intelligence-4389372-1280.jpg", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/200px-MIT_logo.svg.png" },
            { name: "Introduction to Responsible AI", provider: "Google", duration: "30 minutes", short_duration: "30 mins", description: "Focus on responsible AI development, Googleâ€™s AI principles, basic fairness and transparency, real-world responsible AI use-case examples explained simply.", topics: ["Responsible AI Development", "Googleâ€™s AI Principles", "Fairness & Transparency", "Real-world Use Cases"], link: "https://www.classcentral.com/course/introduction-to-responsible-ai-199886", imageUrl: "https://i.postimg.cc/VNs7cWbx/IMAGE2025-10-19152023.jpg", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Google_%22G%22_logo.svg/200px-Google_%22G%22_logo.svg.png" },
            { name: "CS50â€™s Artificial Intelligence with Python", provider: "Harvard University", duration: "12 hours (Free Video)", short_duration: "12 hours", description: "Explore AI fundamentals through hands-on Python projects. The course covers graph search, classification, optimization, reinforcement learning, and more.", topics: ["Graph Search Algorithms", "Classification", "Optimization", "Reinforcement Learning", "Hands-on Python Projects"], link: "https://www.classcentral.com/course/freecodecamp-harvard-cs50-s-artificial-intelligence-with-python-full-university-course-205357", imageUrl: "https://i.postimg.cc/dt7q9DYt/growtika-n-Go-CBxia-RO0-unsplash.jpg", logo: "https://i.postimg.cc/wTNVJc7H/harvard-university-seeklogo.png" },
            { name: "Introduction to Artificial Intelligence", provider: "Stanford University", duration: "16 weeks, ~6 hours/week (On-Demand, Free)", short_duration: "16 weeks", description: "A comprehensive course covering modern AI fundamentals and applications, including machine learning, robotics, computer vision, and natural language processing.", topics: ["Machine Learning", "Robotics", "Computer Vision", "Natural Language Processing (NLP)"], link: "https://www.classcentral.com/course/udacity-introduction-to-artificial-intelligence-301", imageUrl: "https://i.postimg.cc/bNGzRdht/markus-winkler-t-GBXi-Hc-PKr-M-unsplash.jpg", logo: "https://i.postimg.cc/dtVJ4w1Z/stanford-university-seeklogo.png" },
            { name: "Elements of AI", provider: "University of Helsinki", duration: "6 weeks (5â€“10 hours/week), On-Demand, Free", short_duration: "6 weeks", description: "This course introduces AI concepts, possibilities, and its impact without requiring math or coding knowledge.", topics: ["Core AI Concepts", "Societal Impact of AI", "No Math/Coding Required", "AI Possibilities"], link: "https://www.classcentral.com/course/independent-elements-of-ai-12469", imageUrl: "https://images.unsplash.com/photo-1485827404703-89b55fcc595e?q=80&w=600&auto=format&fit=crop", logo: "https://i.postimg.cc/t40V33Wv/university-of-helsinki-seeklogo.png" },
            { name: "Introduction to Artificial Intelligence (AI)", provider: "IBM", duration: "12 hours 58 minutes", short_duration: "13 hours", description: "Learn the fundamentals, applications, and ethics of artificial intelligence. Covers machine learning, neural networks, generative AI, and more.", topics: ["AI Fundamentals & Applications", "AI Ethics", "Machine Learning", "Neural Networks", "Generative AI"], link: "https://www.classcentral.com/course/introduction-to-ai-13848", imageUrl: "https://images.unsplash.com/photo-1555949963-ff9fe0c870eb?q=80&w=600&auto=format&fit=crop", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/51/IBM_logo.svg/200px-IBM_logo.svg.png" },
            { name: "Artificial Intelligence for Robotics", provider: "Stanford", duration: "8 weeks (On-Demand, Free)", short_duration: "8 weeks", description: "Learn to program all major systems of a robotic car, including probabilistic inference, planning, localization, tracking, and control.", topics: ["Probabilistic Inference", "Planning & Search", "Localization", "Tracking & Control", "Robotic Car Systems"], link: "https://www.classcentral.com/course/udacity-artificial-intelligence-for-robotics-319", imageUrl: "https://i.postimg.cc/gkwYKrW4/maximalfocus-e-ZWGK5s-Ii-BM-unsplash.jpg", logo: "https://i.postimg.cc/dtVJ4w1Z/stanford-university-seeklogo.png" },
            // Original courses to keep
            { name: "Machine Learning with Python", provider: "MIT", duration: "15 weeks", short_duration: "15 weeks", description: "Comprehensive ML course from linear models to deep learning and reinforcement learning, with Python projects.", topics: ["Linear Regression", "Classification, SVM", "Neural Networks", "Probability", "Unsupervised Learning", "Reinforcement Learning"], link: "https://www.edx.org/learn/machine-learning/massachusetts-institute-of-technology-machine-learning-with-python-from-linear-models-to-deep-learning", imageUrl: "https://images.unsplash.com/photo-1555066931-4365d14bab8c?q=80&w=600&auto=format&fit=crop", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/200px-MIT_logo.svg.png" },
            { name: "Intro to Deep Learning", provider: "MIT", duration: "Self-Paced", short_duration: "Self-Paced", description: "A rapid intro to deep learning for computer vision, NLP, and biology. Covers neural networks in TensorFlow and modern architectures.", topics: ["Neural Networks", "Computer Vision", "NLP", "Generative Networks", "TensorFlow"], link: "https://introtodeeplearning.com/", imageUrl: "https://i.postimg.cc/KzTxPHLb/e2cbe35-c15f-f4ba-3da7-bdf4f6fd248a-Dongang-Machine-Learning-Theme-Image-min-1.webp", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/200px-MIT_logo.svg.png" },
            { name: "The Analytics Edge", provider: "MIT", duration: "13 weeks", short_duration: "13 weeks", description: "Learn from real-world analytics success stories (Netflix, Google). Hands-on data modeling with R programming.", topics: ["Data Analytics", "Regression", "Decision Trees", "Text Analytics", "Clustering", "Optimization"], link: "https://ocw.mit.edu/courses/15-071-the-analytics-edge-spring-2017/", imageUrl: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?q=80&w=600&auto=format&fit=crop", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/200px-MIT_logo.svg.png" },
            { name: "Probability - The Science of Data", provider: "MIT", duration: "16 weeks", short_duration: "16 weeks", description: "A foundation in probability for data science, including classical, frequentist, and Bayesian inference, plus Markov chains.", topics: ["Probability models", "Random Processes", "Statistical Inference", "Bayes' Rule", "Markov Chains"], link: "https://www.edx.org/learn/probability/massachusetts-institute-of-technology-probability-the-science-of-uncertainty-and-data", imageUrl: "https://i.postimg.cc/DmkhpdQk/sl-031420-28950-10.jpg", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/200px-MIT_logo.svg.png" },
            { name: "Computational Thinking & Data Science", provider: "MIT", duration: "9 weeks", short_duration: "9 weeks", description: "Advanced Python course focusing on simulations, Monte Carlo methods, statistical thinking, and an intro to ML.", topics: ["Python", "Stochastic Programming", "Data Structures", "Graphs", "Random Walks", "Optimization", "Machine Learning"], link: "https://ocw.mit.edu/courses/6-0002-introduction-to-computational-thinking-and-data-science-fall-2016/", imageUrl: "https://images.unsplash.com/photo-1534665482403-a909d0d97c67?q=80&w=600&auto=format&fit=crop", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/200px-MIT_logo.svg.png" },
            { name: "Fundamentals of Statistics", provider: "MIT", duration: "17 weeks", short_duration: "17 weeks", description: "A rigorous introduction to statisticsâ€”estimation, hypothesis testing, prediction, regression, and Bayesian methods.", topics: ["Estimation", "Hypothesis Testing", "Regression", "PCA", "Bayesian Statistics"], link: "https://www.edx.org/learn/statistics/massachusetts-institute-of-technology-fundamentals-of-statistics", imageUrl: "https://images.unsplash.com/photo-1488190211105-8b0e65b80b4e?q=80&w=600&auto=format&fit=crop", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/200px-MIT_logo.svg.png" },
            { name: "Machine Learning for Healthcare", provider: "MIT", duration: "Self-Paced", short_duration: "Self-Paced", description: "Explore ML applications in healthcare: clinical risk prediction, data analysis, time series, and interpretability.", topics: ["Clinical Data", "Risk Models", "Time Series", "Deep Learning for Medicine"], link: "https://ocw.mit.edu/courses/6-s897-machine-learning-for-healthcare-spring-2019/", imageUrl: "https://images.unsplash.com/photo-1576091160550-2173dba999ef?q=80&w=600&auto=format&fit=crop", logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/200px-MIT_logo.svg.png" }
        ];

        // --- NEW & UPDATED ACADEMY-X DATA ---
        const platformCardData = [
            { name: "Google", link: "https://www.classcentral.com/institution/google", description: "Data, Cloud, Digital Marketing, Android, Cloud Computing, certifications (free + paid).", gradientClass: "gradient-google", bgImage: "https://i.postimg.cc/PrzM2bkx/google-m.webp", iconHtml: `<img src="https://i.postimg.cc/1zgCCgH2/google.png" alt="Google Logo" class="h-20 w-20">` },
            { name: "Coding & AI Prep", link: "https://www.classcentral.com/provider/codesignal", description: "1500+ AI, coding, data science, interview prep courses, badges & certificates.", gradientClass: "gradient-ai", bgImage: "https://images.unsplash.com/photo-1515879218367-8466d910aaa4?q=80&w=2069&auto=format=fit=crop", iconHtml: `<svg class="h-20 w-20 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/></svg>` },
            { name: "Amazon", link: "https://www.classcentral.com/institution/amazon", description: "AWS, Cloud, Alexa skills, technical & business learningâ€”free & paid.", gradientClass: "gradient-amazon", bgImage: "https://images.unsplash.com/photo-1560415755-bd80d06eda60?q=80&w=1974&auto=format=fit=crop", iconHtml: `<img src="https://upload.wikimedia.org/wikipedia/commons/9/93/Amazon_Web_Services_Logo.svg" alt="Amazon AWS Logo" class="h-16">` },
            { name: "Stanford", link: "https://www.classcentral.com/institution/stanford", description: "Computer Science, Medicine, Business, Engineeringâ€”world-class faculty lectures & updates.", gradientClass: "gradient-stanford", bgImage: "https://i.postimg.cc/vBg1kygz/stanford.webp", iconHtml: `<img src="https://i.postimg.cc/BvZ7xYLK/icons8-computer-science-100.png" alt="Stanford Logo" class="h-20 w-20">` },
            { name: "Skills for Growth", link: "https://www.classcentral.com/subject/personal-development", description: "Time management, leadership, productivity, emotional intelligence, mindset.", gradientClass: "gradient-growth", bgImage: "https://images.unsplash.com/photo-1454496522488-7a8e488e8606?q=80&w=2070&auto=format=fit=crop", iconHtml: `<svg class="h-20 w-20 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>` },
            { name: "Business", link: "https://www.classcentral.com/subject/business", description: "Entrepreneurship, management, digital marketing, FinTech courses.", gradientClass: "gradient-business", bgImage: "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?q=80&w=2070&auto=format=fit=crop", iconHtml: `<svg class="h-20 w-20 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>` },
            { name: "Design & Tech", link: "https://www.classcentral.com/provider/noble-desktop", description: "Full-stack, UX/UI design, data science, digital marketing, career-focused tech courses.", gradientClass: "gradient-design", bgImage: "https://images.unsplash.com/photo-1558655146-d09347e92766?q=80&w=1964&auto=format=fit=crop", iconHtml: `<svg class="h-20 w-20 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242z" /></svg>` },
            { name: "Computer Science", link: "https://www.classcentral.com/subject/cs", description: "Python, Algorithms, AI, Software Engineering, Cloudâ€”top global courses.", gradientClass: "gradient-cs", bgImage: "https://images.unsplash.com/photo-1542831371-29b0f74f9713?q=80&w=2070&auto=format=fit=crop", iconHtml: `<svg class="h-20 w-20 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>` },
            { name: "Corporate Finance Institute", link: "https://www.classcentral.com/provider/corporate-finance-institute", description: "Excel, Financial Modeling, Accounting, Banking certifications.", gradientClass: "gradient-cfi", bgImage: "https://i.postimg.cc/tJbXkGht/cfi-png.webp", iconHtml: `<span class="text-5xl font-extrabold text-white tracking-wider">CFI</span>` },
            { name: "Digital Marketing", link: "https://www.classcentral.com/provider/semrush-academy", description: "80+ free SEO, marketing, content, social media courses with badges.", gradientClass: "gradient-dm", bgImage: "https://images.unsplash.com/photo-1460925895917-afdab827c52f?q=80&w=2015&auto=format=fit=crop", iconHtml: `<svg class="h-20 w-20 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-2.236 9.168-5.514C18.358 1.84 19.668 1 21 1c.34 0 .67.04.985.118l-3.97 4.043A3.007 3.007 0 0116 7a3 3 0 11-6 0 3.007 3.007 0 01-1.029-.253l-4.043 3.97A.996.996 0 015 11v2c0 .538.214 1.03.564 1.392L11 19.24" /></svg>` },
            { name: "Product & Marketing", link: "https://pragmaticinstitute.sjv.io/c/259799/3247815/22425?subId1=cc_homepage_pill", description: "Product Management & Marketing certifications, globally recognized.", gradientClass: "gradient-pm", bgImage: "https://images.unsplash.com/photo-1557862921-37829c790f19?q=80&w=2071&auto=format=fit=crop", iconHtml: `<svg class="h-20 w-20 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" /></svg>` },
        ];
        const academyXData = { 
            universities: [
                { name: 'Harvard University', link: "https://www.classcentral.com/university/harvard", courses: 432, imageUrl: 'https://i.postimg.cc/rFWm5gxp/harvard.webp' },
                { name: 'Stanford University', link: "https://www.classcentral.com/university/stanford", courses: 2074, imageUrl: 'https://i.postimg.cc/858Mmss5/stanford-2.jpg' },
                { name: 'MIT', link: "https://www.classcentral.com/university/mit", courses: 713, imageUrl: 'https://i.postimg.cc/q7s9p6fT/mit.jpg' },
                { name: 'University of Oxford', link: "https://www.classcentral.com/university/oxford", courses: 111, imageUrl: 'https://i.postimg.cc/g0VfGL9Y/oxford.jpg' },
                { name: 'University of Cambridge', link: "https://www.classcentral.com/university/university-of-cambridge", courses: 48, imageUrl: 'https://i.postimg.cc/Cxf366mn/cambridge.jpg' },
                { name: 'Caltech', link: "https://www.classcentral.com/university/caltech", courses: 26, imageUrl: 'https://i.postimg.cc/Dzk9VdMZ/caltech.jpg' },
                { name: 'UC Berkeley', link: "https://www.classcentral.com/university/berkeley", courses: 86, imageUrl: 'https://i.postimg.cc/YCm5yyb0/berkley.jpg' },
                { name: 'Princeton University', link: "https://www.classcentral.com/university/princeton", courses: 37, imageUrl: 'https://i.postimg.cc/bJq4rY8j/princeton.jpg' },
                { name: 'Yale University', link: "https://www.classcentral.com/university/yale", courses: 1130, imageUrl: 'https://i.postimg.cc/C1w95MY5/yale.jpg' },
                { name: 'University of Chicago', link: "https://www.classcentral.com/university/chicago", courses: 178, imageUrl: 'https://i.postimg.cc/W4LBR6H1/chicago.jpg' },
                { name: 'Columbia University', link: "https://www.classcentral.com/university/columbia", courses: 127, imageUrl: 'https://i.postimg.cc/jSJpkkZJ/columbia.jpg' },
                { name: 'Imperial College London', link: "https://www.classcentral.com/university/imperial", courses: 110, imageUrl: 'https://i.postimg.cc/TPVZTLzN/imperial.jpg' },
                { name: 'University of Toronto', link: "https://www.classcentral.com/university/utoronto", courses: 81, imageUrl: 'https://i.postimg.cc/W3sxzpjv/toronto.jpg' },
                { name: 'UCL', link: "https://www.classcentral.com/university/ucl", courses: 52, imageUrl: 'https://i.postimg.cc/TwTB12Gw/ucl.jpg' },
                { name: 'ETH Zurich', link: "https://www.classcentral.com/university/eth", courses: 563, imageUrl: 'https://i.postimg.cc/TwTB12Gp/zurich.jpg' },
                { name: 'NUS', link: "https://www.classcentral.com/university/national-university-of-singapore", courses: 46, imageUrl: 'https://i.postimg.cc/k5Qk7Rr9/nus.jpg' },
                { name: 'University of Melbourne', link: "https://www.classcentral.com/university/unimelb", courses: 198, imageUrl: 'https://i.postimg.cc/mrY0T1xW/melbourne.jpg' },
                { name: 'Peking University', link: "https://www.classcentral.com/university/peking-university", courses: 167, imageUrl: 'https://i.postimg.cc/cJRVdtqx/peeking.jpg' },
                { name: 'University of Tokyo', link: "https://www.classcentral.com/university/todai", courses: 35, imageUrl: 'https://i.postimg.cc/B6JRbZsS/tokyo.jpg' },
                { name: 'IIT Bombay', link: "https://www.classcentral.com/university/indian-institute-of-technology-bombay", courses: 202, imageUrl: 'https://i.postimg.cc/yNmw7gMw/iit-bombay.jpg' },
                { name: 'IISc Bangalore', link: "https://www.classcentral.com/university/iisc", courses: 129, imageUrl: 'https://i.postimg.cc/DZ7R0fFk/iisc-bangaore.jpg' },
                { name: 'IIT Delhi', link: "https://www.classcentral.com/university/iitd", courses: 127, imageUrl: 'https://i.postimg.cc/GpwW0J5x/iit-delhi.jpg' },
                { name: 'IIT Madras', link: "https://www.classcentral.com/university/iitm", courses: 418, imageUrl: 'https://i.postimg.cc/vmrpGgJq/iit-madras-jpg.webp' },
                { name: 'IIT Kanpur', link: "https://www.classcentral.com/university/iitk", courses: 381, imageUrl: 'https://i.postimg.cc/zfZsmSck/iit-kanpur-jpg.png' },
                { name: 'IIT Kharagpur', link: "https://www.classcentral.com/university/iit-kharagpur", courses: 584, imageUrl: 'https://i.postimg.cc/xdDwry4p/iit-kharragpur-jpg.webp' }
            ] 
        };
        const subjectsData = [
            { name: "Computer Science", description: "Programming, Software Dev, Algorithms, etc.", details: "Covers programming (Python, Java, C++), software development, algorithms, data structures, cybersecurity, cloud computing, and the foundations of computation. Students learn to write code, build applications, understand complex systems, and solve technical problems. Includes courses from Harvard, MIT, and industry leaders focusing on both theoretical and practical skills for careers in tech and research.", link: "https://www.classcentral.com/subject/cs", imageUrl: "https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=870&q=80", buttonColor: "bg-blue-600", buttonHoverColor: "hover:bg-blue-700" },
            { name: "Psychology & Personal Development", description: "Cognitive, social, and clinical psychology.", details: "In-depth courses on cognitive, social, developmental, and clinical psychology, emotional intelligence, communication skills, decision-making, and mindfulness. Develops understanding of human behavior, self-motivation, mental health practices, and interpersonal effectiveness â€” valuable both personally and professionally.", link: "https://www.classcentral.com/subject/psychology", imageUrl: "https://i.postimg.cc/4NdzbDwp/brain-2062057-1280-2.jpg", buttonColor: "bg-blue-700", buttonHoverColor: "hover:bg-blue-800" },
            { name: "Artificial Intelligence & Machine Learning", description: "Deep learning, neural networks, NLP.", details: "Learn the core concepts of AI including deep learning, neural networks, natural language processing (NLP), robotics, image processing, and AI ethics. Courses are project-based and cover building smart systems, developing intelligent algorithms, and practical ML usage in real-world apps. Suited for tech professionals, researchers, and anyone fascinated by the future of tech.", link: "https://www.classcentral.com/subject/artificial-intelligence", imageUrl: "https://i.postimg.cc/sfKYWjPc/ai-generated-8668923-1280-2.jpg", buttonColor: "bg-purple-600", buttonHoverColor: "hover:bg-purple-700" },
            { name: "Business & Management", description: "Strategy, marketing, finance, entrepreneurship.", details: "Offers training in business operations, strategy, marketing, finance, entrepreneurship, supply chain, project management, and leadership. Learn to create and run startups, manage teams, build business models, and analyze markets. Courses from world-class business schools and renowned experts help you build managerial and entrepreneurial skills for any industry.", link: "https://www.classcentral.com/subject/business", imageUrl: "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=815&q=80", buttonColor: "bg-yellow-500", buttonHoverColor: "hover:bg-yellow-600" },
            { name: "Digital Marketing", description: "SEO, social media, content strategy.", details: "Teaches SEO, pay-per-click (PPC), social media marketing, content strategy, email campaigns, Google Analytics, and digital branding. Emphasis on using data-driven marketing and the latest platforms (Facebook, Instagram, LinkedIn, YouTube, etc.) to build audience and grow businesses. Prepares you for modern marketing and brand management jobs.", link: "https://www.classcentral.com/subject/digital-marketing", imageUrl: "https://images.unsplash.com/photo-1523961131990-5ea7c61b2107?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=774&q=80", buttonColor: "bg-red-600", buttonHoverColor: "hover:bg-red-700" },
            { name: "Web Development & UX/UI Design", description: "HTML, CSS, JavaScript, React, design principles.", details: "Covers HTML, CSS, JavaScript, frameworks (React, Angular, Node.js), mobile and web app design, responsive layouts, and UX/UI principles. Students learn to design, code, and deploy efficient, attractive, and user-friendly websites and apps. Includes courses on usability, wireframing, prototyping, and accessibility for a holistic web development and design skillset.", link: "https://www.classcentral.com/subject/web-development", imageUrl: "https://images.unsplash.com/photo-1555949963-ff9fe0c870eb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=870&q=80", buttonColor: "bg-teal-500", buttonHoverColor: "hover:bg-teal-600" },
            { name: "Health & Wellness", description: "Psychology, nutrition, public health.", details: "Explorations in psychology, mental health, nutrition, exercise, public health, mindfulness, disease prevention, and health technology. Prepares learners for roles in healthcare, wellness coaching, fitness training, and public health initiatives. Courses range from professional clinical subjects to everyday wellness and personal health management.", link: "https://www.classcentral.com/subject/health", imageUrl: "https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=920&q=80", buttonColor: "bg-green-700", buttonHoverColor: "hover:bg-green-800" },
            { name: "Finance & Accounting", description: "Financial analysis, investment, accounting.", details: "Fundamental and advanced topics in accounting, financial analysis, investment, corporate finance, entrepreneurship, risk management, and personal finance. Students learn to read financial statements, manage investments, understand markets, and make informed economic decisions. Critical for aspiring professionals in business, banking, and finance.", link: "https://www.classcentral.com/subject/accounting", imageUrl: "https://images.unsplash.com/photo-1665686306574-1ace09918530?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=870&q=80", buttonColor: "bg-red-700", buttonHoverColor: "hover:bg-red-800" },
            { name: "Arts & Design", description: "Graphic design, visual arts, music.", details: "Includes graphic design, user experience, visual arts, music, photography, animation, video production, and creative writing. Emphasizes creative thinking, technical skills, and artistic expression. Whether hobby or professional, courses span from beginner to advanced covering tools like Adobe Suite, Figma, and more.", link: "https://www.classcentral.com/subject/arts", imageUrl: "https://images.unsplash.com/photo-1513364776144-60967b0f800f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=871&q=80", buttonColor: "bg-purple-700", buttonHoverColor: "hover:bg-purple-800" },
            { name: "Data Science & Analytics", description: "Data analysis, statistics, machine learning.", details: "Focuses on data analysis, statistics, machine learning, data visualization, and applied AI. Courses teach how to collect, clean, analyze, and interpret large data sets for decision making. Topics include Python/R programming, SQL, big data tools, and business intelligence. Ideal for those aiming for careers as data analysts, data scientists, or in analytics roles across every sector.", link: "https://www.classcentral.com/subject/data-science", imageUrl: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=870&q=80", buttonColor: "bg-green-600", buttonHoverColor: "hover:bg-green-700" }
        ];

        let freeBooksAvailable = [
            { id: 'fb1', title: 'Electricity and Magnetism', author: 'B.S. Agarwal', claimed: true, isSwap: false },
            { id: 'fb2', title: 'Organic Chemistry', author: 'Paula Y. Bruice', claimed: false, isSwap: true },
            { id: 'fb3', title: 'Mechanics - D.S. Mathur', author: 'D.S. Mathur', claimed: false, isSwap: false },
            { id: 'fb4', title: 'Inorganic Chemistry', author: 'Puri, Sharma, Kalia', claimed: false, isSwap: false }
        ];


        // --- STATE MANAGEMENT ---
        let courseModalState = { major: null, group: null, subject: null, courseType: null, year: null, semester: null, step: 'majors', filters: { condition: 'All' } };
        let sellFlowState = {}; 
        let studyMaterialFlowState = {};

        // --- UNIVERSAL SCROLL LOCK for Study Modals ---
        let studySavedScrollY = 0;

        function lockScroll() {
            studySavedScrollY = window.scrollY;
            document.body.style.position = 'fixed';
            document.body.style.top = `-${studySavedScrollY}px`;
            document.body.style.width = '100%';
            document.body.style.overflow = 'hidden';
        }

        function unlockScroll() {
            // Remove fixed positioning
            document.body.style.position = '';
            document.body.style.top = '';
            document.body.style.width = '';
            document.body.style.overflow = '';

            // Restore EXACT scroll position instantly 
            window.scrollTo({
                top: studySavedScrollY,
                left: 0,
                behavior: 'instant'
            });
        }

        // --- UNIFIED MODAL MANAGER (SINGLETON) ---
        const ModalManager = {
            modals: {},
            currentOpenModal: null,
            init() {
                document.querySelectorAll('.modal-overlay').forEach(modal => {
                    const modalId = modal.id;
                    if (!modalId) return;
                    this.modals[modalId] = modal;

                    // Close on backdrop click
                    modal.querySelector('.modal-backdrop')?.addEventListener('click', () => this.close(modalId));
                    
                    // Close on button click (delegated)
                    modal.addEventListener('click', (e) => {
                        if (e.target.closest('[id^="close"]')) {
                            // Special case for founder message modal
                            if (modalId === 'founderMessageModal') {
                                this.close(modalId);
                                this.open('joinUsModal');
                                return;
                            }
                            this.close(modalId);
                        }
                    });
                });

                // Close with Escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        const visibleModal = document.querySelector('.modal-overlay.is-visible');
                        if (visibleModal) {
                            // Special case for founder message modal
                            if (visibleModal.id === 'founderMessageModal') {
                                this.close(visibleModal.id);
                                this.open('joinUsModal');
                                return;
                            }
                            this.close(visibleModal.id);
                        }
                    }
                });
            },
            open(modalId) {
                const modal = this.modals[modalId];
                if (!modal || modal.classList.contains('is-visible')) return;

                // NEW: Collapse Thinkly AI if it's expanded before opening another modal
                const thinklyExpandedView = document.getElementById('expandedView');
                const thinklyMainContainer = document.getElementById('mainContainer');
                if (thinklyExpandedView && thinklyExpandedView.classList.contains('visible')) {
                    thinklyExpandedView.classList.remove('visible');
                    
                    // ðŸ”¥ PERFECT SCROLL RESTORE: Get saved scroll position
                    const scrollY = document.body.style.top;
                    
                    // Restore body scroll perfectly
                    document.body.style.position = "";
                    document.body.style.top = "";
                    document.body.style.left = "";
                    document.body.style.right = "";
                    document.body.style.width = "";
                    
                    // Restore scroll back to exact same position
                    window.scrollTo(0, parseInt(scrollY || "0") * -1);
                    
                    document.body.classList.remove('thinkly-expanded');
                    if (thinklyMainContainer) {
                        thinklyMainContainer.style.opacity = '1';
                        thinklyMainContainer.style.pointerEvents = 'auto';
                    }
                    document.getElementById('mobile-nav')?.classList.remove('hidden'); // Ensure mobile nav is visible if it was hidden by thinkly
                }
                // NEW: Don't close the current modal if the new one is a confirmation dialog.
                // This allows stacking the confirmation on top of the backpack.
                const isConfirmation = modalId === 'confirmActionModal' || modalId === 'logoutConfirmModal';
                if (this.currentOpenModal && !isConfirmation) {
                    this.close(this.currentOpenModal, true); // Pass true to skip body class removal
                }

                // Lock scroll for study modals (PYQ, Notes, Assignments, Practicals)
                const studyModals = ['pyqModal', 'notesModal', 'assignmentsModal', 'practicalsModal'];
                if (studyModals.includes(modalId)) {
                    lockScroll();
                }

                if (!document.body.classList.contains('modal-open')) {
                    document.body.classList.add('modal-open');
                }
                modal.classList.add('is-visible');
                modal.setAttribute('aria-hidden', 'false');
                this.currentOpenModal = modalId;
            },
            close(modalId) {
                const modal = this.modals[modalId];
                if (!modal || !modal.classList.contains('is-visible')) return;

                // If we are closing a confirmation, we don't want to set currentOpenModal to null
                // because the underlying modal (e.g., myBackpackModal) is still open.
                const isConfirmation = modalId === 'confirmActionModal' || modalId === 'logoutConfirmModal';
                if (!isConfirmation) {
                    this.currentOpenModal = null;
                }

                modal.classList.remove('is-visible');
                modal.setAttribute('aria-hidden', 'true');
                
                // Unlock scroll for study modals (PYQ, Notes, Assignments, Practicals)
                const studyModals = ['pyqModal', 'notesModal', 'assignmentsModal', 'practicalsModal'];
                if (studyModals.includes(modalId)) {
                    unlockScroll();
                }
                
                setTimeout(() => {
                    if (!document.querySelector('.modal-overlay.is-visible')) {
                        document.body.classList.remove('modal-open');
                    }
                }, 400); // Match CSS transition duration
            }
        };
        window.ModalManager = ModalManager; // Make it globally accessible

        // --- DOM ELEMENTS ---
        const courseSelectionContainer = document.getElementById('course-selection-container');
        const modalContainer = document.getElementById('modalContainer');
        const aiModal = document.getElementById('aiModal');
        const checkoutModal = document.getElementById('checkoutModal');
        const checkoutModalContent = document.getElementById('checkoutModalContent');
        const requestModal = document.getElementById('requestModal');
        const syllabusModal = document.getElementById('syllabusModal');
        const syllabusContent = document.getElementById('syllabusContent');
        const pyqContent = document.getElementById('pyqContent');
        const practicalsContent = document.getElementById('practicalsContent');
        const assignmentsContent = document.getElementById('assignmentsContent');
        const notesContent = document.getElementById('notesContent');
        const timeTableModal = document.getElementById('timeTableModal');
        const itemSelectionModal = document.getElementById('itemSelectionModal');
        const itemSelectionContent = document.getElementById('itemSelectionContent');
        const sellBookModal = document.getElementById('sellBookModal');
        const sellBookModalContent = document.getElementById('sellBookModalContent');
        const freeBookModal = document.getElementById('freeBookModal');
        const freeBookModalContent = document.getElementById('freeBookModalContent');
        const courseModal = document.getElementById('courseModal');
        const courseModalContent = document.getElementById('courseModalContent');
        const toast = document.getElementById('toast');
        const leaderboardContainer = document.getElementById('leaderboard-container');
        const pickupBuddyModal = document.getElementById('pickupBuddyModal');
        const myBackpackModal = document.getElementById('myBackpackModal');
        const myOrdersModal = document.getElementById('myOrdersModal');
        const myBackpackContent = document.getElementById('myBackpackContent');
        const myOrdersContent = document.getElementById('myOrdersContent');
        
        // --- NEW: Auth View Logic (Moved from module script) ---
        const authViewContainer = document.getElementById('auth-view-container');

        function renderAuthView(view = 'login') {
            if (view === 'login') {
                authViewContainer.innerHTML = `
                    <form id="authForm" class="space-y-4">
                        <input type="email" name="email" required placeholder="Email Address" class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/>
                        <input type="password" name="password" required placeholder="Password" class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/>
                        <button type="submit" class="w-full h-12 text-lg bg-blue-600 text-white rounded-lg font-semibold button-animation">Login</button>
                        <p class="text-center text-sm text-gray-600">Don't have an account? <button type="button" id="showRegister" class="font-semibold text-blue-600 hover:underline">Register here</button></p>
                        <div class="relative flex py-2 items-center"><div class="flex-grow border-t border-gray-300"></div><span class="flex-shrink mx-4 text-gray-500 text-sm">OR</span><div class="flex-grow border-t border-gray-300"></div></div>
                        <button type="button" id="googleSignInBtn" class="w-full h-12 text-lg bg-white border border-gray-300 text-gray-700 rounded-lg font-semibold flex items-center justify-center button-animation hover:bg-gray-50">
                            <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" class="h-6 mr-3" alt="Google logo"> Sign in with Google
                        </button>
                    </form>
                `;
                document.getElementById('showRegister').onclick = () => renderAuthView('register');
            } else {
                authViewContainer.innerHTML = `
                    <form id="authForm" class="space-y-4">
                        <input type="email" name="email" required placeholder="Email Address" class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/>
                        <input type="password" name="password" required placeholder="Password (min. 6 characters)" class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/>
                        <button type="submit" class="w-full h-12 text-lg bg-green-500 text-white rounded-lg font-semibold button-animation">Register</button>
                        <div class="relative flex py-2 items-center"><div class="flex-grow border-t border-gray-300"></div><span class="flex-shrink mx-4 text-gray-500 text-sm">OR</span><div class="flex-grow border-t border-gray-300"></div></div>
                        <button type="button" id="googleSignInBtn" class="w-full h-12 text-lg bg-white border border-gray-300 text-gray-700 rounded-lg font-semibold flex items-center justify-center button-animation hover:bg-gray-50">
                            <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" class="h-6 mr-3" alt="Google logo"> Sign up with Google
                        </button>
                        <p class="text-center text-sm text-gray-600">Already have an account? <button type="button" id="showLogin" class="font-semibold text-blue-600 hover:underline">Login here</button></p>
                    </form>
                `;
                document.getElementById('showLogin').onclick = () => renderAuthView('login');
            }
            // The actual form submission logic and Google sign-in will be handled by the module script
            // which has access to the Firebase auth object.
            document.getElementById('googleSignInBtn')?.addEventListener('click', () => window.handleGoogleSignIn());
        }


        // --- NEW: Profile Dashboard Logic ---
        const profileDashboardContent = document.getElementById('profileDashboardContent');

        function renderProfileDashboard() {
            if (window.currentUser) {
                // Logged-in view
                const user = window.currentUser;
                const userInitial = user.displayName ? user.displayName[0].toUpperCase() : (user.email ? user.email[0].toUpperCase() : 'U');
                const userName = user.displayName || user.email;

                profileDashboardContent.innerHTML = `
                    <div class="space-y-6">
                        <!-- User Info Section -->
                        <div class="flex items-center gap-4">
                            <div class="w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center font-bold text-2xl text-gray-600">${userInitial}</div>
                            <div>
                                <p class="font-bold text-xl text-gray-800">${userName}</p>
                                <p class="text-sm text-gray-500">S.S. Jain Subodh P.G. College</p> 
                            </div>
                        </div>

                        <!-- Main Actions -->
                        <div class="grid grid-cols-1 gap-2 pt-6 border-t">
                            <button id="dashboardMyOrdersBtn" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" /></svg>
                                <span>My Orders</span>
                            </button>
                            <button id="dashboardMyBackpackBtn" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M4 9h16v11a2 2 0 01-2 2H6a2 2 0 01-2-2V9z" /><path stroke-linecap="round" stroke-linejoin="round" d="M9 9V4a3 3 0 013-3h0a3 3 0 013 3v5" /></svg>
                                <span>My Backpack</span>
                            </button>
                            <button id="dashboardEditProfileBtn" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z" /></svg>
                                <span>Edit Profile</span>
                            </button>
                            <button id="dashboardSettingsBtn" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><circle cx="12" cy="12" r="3" /></svg>
                                <span>Settings</span>
                            </button>
                            <button id="dashboardThinklyBtn" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.25 21.75l-.648-1.188a2.25 2.25 0 01-1.47-1.47l-1.188-.648 1.188-.648a2.25 2.25 0 011.47-1.47l.648-1.188.648 1.188a2.25 2.25 0 011.47 1.47l1.188.648-1.188.648a2.25 2.25 0 01-1.47 1.47z" /></svg>
                                <span>Ask Thinkly AI</span>
                            </button>
                            <button class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                <span class="material-symbols-outlined w-6 h-6 text-gray-500 text-2xl">support_agent</span>
                                <span>Help & Support</span>
                            </button>
                            <button id="dashboardFeedbackBtn" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg>
                                <span>Feedback</span>
                            </button>
                            <button id="dashboardJoinTeamBtn" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                <span class="material-symbols-outlined w-6 h-6 text-gray-500 text-2xl">handshake</span>
                                <span>Join Our Team</span>
                            </button>
                        </div>

                        <!-- Quick Navigation -->
                        <div class="pt-6 border-t">
                            <h4 class="px-4 pb-2 text-sm font-semibold text-gray-500 uppercase tracking-wider">Quick Navigation</h4>
                            <div class="grid grid-cols-1 gap-2">
                                <button data-scroll-target="#academy-x" class="dashboard-scroll-btn w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                    <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.905 59.905 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0l-3.172 3.172a1 1 0 001.414 1.414l3.172-3.172m15.482 0l3.172 3.172a1 1 0 01-1.414 1.414l-3.172-3.172M12 6.072a9 9 0 01-9 9m9-9a9 9 0 009 9" /></svg>
                                    <span>AcademyX Courses</span>
                                </button>
                                <button data-scroll-target="#free-books" class="dashboard-scroll-btn w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                    <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>
                                    <span>Free Books</span>
                                </button>
                                <button data-scroll-target="#gamification" class="dashboard-scroll-btn w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                    <span class="material-symbols-outlined w-6 h-6 text-gray-500 text-2xl">social_leaderboard</span>
                                    <span>Leaderboard</span>
                                </button>
                                <button data-scroll-target="#about-us" class="dashboard-scroll-btn w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                    <svg class="w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15 9h3.75M15 12h3.75M15 15h3.75M4.5 19.5h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5z" /></svg>
                                    <span>About Us</span>
                                </button>
                                <button data-scroll-target="#college-essentials" class="dashboard-scroll-btn w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                    <span class="material-symbols-outlined w-6 h-6 text-gray-500 text-2xl">checkroom</span>
                                    <span>Winter Blazer / Lab Coat</span>
                                </button>
                                <button data-scroll-target="#study-material" class="dashboard-scroll-btn w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                    <span class="material-symbols-outlined w-6 h-6 text-gray-500 text-2xl">globe_book</span>
                                    <span>Study Material</span>
                                </button>
                                <a href="https://qxds.netlify.app/" target="_blank" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                    <span class="font-bold text-xl">NeX</span>
                                    <span>Explore NeX</span>
                                </a>
                                <div class="pt-2 border-t">
                                    <a href="https://t.me/your_telegram_group" target="_blank" rel="noopener noreferrer" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                        <svg class="w-6 h-6 text-blue-500" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/>
                                        </svg>
                                        <span>Join Telegram Group</span>
                                    </a>
                                    <a href="https://chat.whatsapp.com/your_whatsapp_group" target="_blank" rel="noopener noreferrer" class="w-full text-left text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 flex items-center gap-4 button-animation">
                                        <svg class="w-6 h-6 text-green-500" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                                        </svg>
                                        <span>Join WhatsApp Group</span>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Logout Button -->
                        <div class="pt-6 border-t">
                            <button id="dashboardLogoutBtn" class="w-full text-lg font-semibold text-red-600 bg-red-50 rounded-lg px-4 py-3 hover:bg-red-100 text-left flex items-center gap-4 button-animation">
                                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
                                <span>Logout</span>
                            </button>
                        </div>
                    </div>
                `;
                document.getElementById('dashboardMyOrdersBtn').onclick = () => { ModalManager.close('profileDashboardModal'); renderOrdersModal(window.currentUser); ModalManager.open('myOrdersModal'); };

                // NEW: Founder Message Card Handler
                document.getElementById('founderMessageCard').onclick = () => {
                    // Close the current modal and open the new one
                    ModalManager.close('joinUsModal');
                    ModalManager.open('founderMessageModal');
                };

                // NEW: Founder Message "Apply Now" link handler
                const applyNowLink = document.getElementById('applyNowLink');
                if (applyNowLink) {
                    applyNowLink.onclick = (e) => {
                        e.preventDefault();
                        ModalManager.close('founderMessageModal');
                        ModalManager.open('joinUsModal');
                        
                        setTimeout(() => {
                            const joinUsContent = document.getElementById('joinUsContent');
                            const formWrapper = document.getElementById('joinUsFormWrapper');
                            joinUsContent.scrollTo({ top: formWrapper.offsetTop - 20, behavior: 'smooth' });
                        }, 400); // Wait for modal animation
                    };
                }
            } else {
                // Logged-out view
                profileDashboardContent.innerHTML = `
                    <div class="text-center space-y-4">
                        <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                        <h3 class="text-xl font-bold">Join the Community</h3>
                        <p class="text-gray-600">Login or create an account to manage your orders, backpack, and listings.</p>
                        <button id="dashboardLoginBtn" class="w-full h-12 text-lg bg-blue-600 text-white rounded-lg font-semibold button-animation">Login / Register</button>
                    </div>
                `;
                document.getElementById('dashboardLoginBtn').onclick = () => { ModalManager.close('profileDashboardModal'); renderAuthView('login'); ModalManager.open('authModal'); };
            }

            // Use event delegation for all buttons inside the dashboard
            profileDashboardContent.onclick = (e) => {
                const button = e.target.closest('button');
                if (!button) return;

                ModalManager.close('profileDashboardModal');

                switch (button.id) {
                    case 'dashboardMyOrdersBtn':
                        renderOrdersModal(window.currentUser);
                        ModalManager.open('myOrdersModal');
                        break;
                    case 'dashboardMyBackpackBtn':
                        renderBackpackModal(window.currentUser);
                        ModalManager.open('myBackpackModal');
                        break;
                    case 'dashboardEditProfileBtn':
                        renderEditProfileModal(window.currentUser);
                        break;
                    case 'dashboardSettingsBtn':
                        renderSettingsModal();
                        ModalManager.open('settingsModal');
                        break;
                    case 'dashboardThinklyBtn':
                        const thinklyHero = document.getElementById('thinkly-ai-hero');
                        if (thinklyHero) {
                            thinklyHero.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            setTimeout(() => thinklyHero.querySelector('#mainContainer')?.classList.add('UAbVe'), 500);
                        }
                        break;
                    case 'dashboardFeedbackBtn': renderFeedbackModal(); break;
                    case 'dashboardJoinTeamBtn': ModalManager.open('joinUsModal'); break;
                    case 'dashboardLogoutBtn': ModalManager.open('logoutConfirmModal'); break;
                }

                if (button.classList.contains('dashboard-scroll-btn')) {
                    document.querySelector(button.dataset.scrollTarget)?.scrollIntoView({ behavior: 'smooth' });
                }
            };
        }

        // --- NEW: Moved setButtonLoading to global scope ---
        function setButtonLoading(button, isLoading, originalText) {
            if (isLoading) {
                if (!button.dataset.originalText) {
                    button.dataset.originalText = originalText;
                }
                button.disabled = true;
                button.classList.add('btn-loading');
                // A more generic loading text
                button.textContent = 'Processing...';
            } else {
                button.disabled = false;
                button.classList.remove('btn-loading');
                button.textContent = button.dataset.originalText || originalText;
                delete button.dataset.originalText; // Clean up
            }
        }

        // --- NEW: Edit Profile, Settings, Legal Modals ---
        function renderEditProfileModal(user) {
            const modal = document.getElementById('editProfileModal');
            const content = modal.querySelector('.modal-content');

            // In a real app, you'd fetch this from Firestore
            const userProfile = {
                phone: '9876543210', // Placeholder
                college: 'S.S. Jain Subodh P.G. College' // Placeholder
            };

            content.innerHTML = `
                <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Edit Profile</h2>
                    <button id="closeEditProfileModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="p-8">
                    <form id="editProfileForm" class="space-y-4">
                        <div><label class="font-semibold text-gray-700">Full Name</label><input name="displayName" required value="${user.displayName || ''}" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                        <div><label class="font-semibold text-gray-700">College Name</label><input name="collegeName" required value="${userProfile.college}" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                        <div><label class="font-semibold text-gray-700">Phone Number</label><input name="phoneNumber" required value="${userProfile.phone}" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                        <div class="pt-4">
                            <button type="submit" class="w-full h-12 text-lg bg-blue-600 text-white rounded-lg font-semibold button-animation">Save Changes</button>
                        </div>
                    </form>
                </div>
            `;
            ModalManager.open('editProfileModal');

            document.getElementById('editProfileForm').onsubmit = async (e) => {
                e.preventDefault();
                const form = e.target;
                const button = form.querySelector('button[type="submit"]');
                const originalText = button.textContent;
                setButtonLoading(button, true, originalText);

                const newName = form.elements.displayName.value;
                // In a real app, you would also save collegeName and phoneNumber to Firestore
                try {
                    await user.updateProfile({ displayName: newName });
                    showToast('Profile updated successfully!');
                    ModalManager.close('editProfileModal');
                    renderProfileDashboard(); // Refresh dashboard to show new name
                } catch (error) {
                    showToast('Failed to update profile. Please try again.', true);
                    console.error("Profile update error:", error);
                } finally {
                    setButtonLoading(button, false, originalText);
                }
            };
        }

        function renderSettingsModal() {
            const modal = document.getElementById('settingsModal');
            const content = modal.querySelector('.modal-content');
            content.innerHTML = `
                <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold logo-font">Settings</h2>
                    <button id="closeSettingsModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="p-8 space-y-4">
                    <div class="flex justify-between items-center p-4 border rounded-lg">
                        <label for="notifToggle" class="font-semibold text-gray-700">Push Notifications</label>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" value="" id="notifToggle" class="sr-only peer" checked>
                            <div class="w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                        </label>
                    </div>
                    <button id="legalAboutBtn" class="w-full text-left p-4 border rounded-lg hover:bg-gray-50 button-animation font-semibold text-gray-700">Legal & About</button>
                </div>
            `;
            ModalManager.open('settingsModal');

            document.getElementById('legalAboutBtn').onclick = () => {
                ModalManager.close('settingsModal');
                renderLegalAboutModal();
            };
        }

        function renderLegalAboutModal() {
            const modal = document.getElementById('legalAboutModal');
            const content = modal.querySelector('.modal-content');
            content.innerHTML = `
                <div class="p-8 text-center">
                    <h2 class="text-3xl font-bold logo-font mb-4">Nexbook</h2>
                    <p class="text-gray-500 mb-8">Copyright Â© 2025, thenexbook.com</p>
                    <div class="border-t pt-6">
                        <button id="legalInfoLink" class="font-semibold text-blue-600 hover:underline">Legal Information</button>
                    </div>
                </div>
            `;
            ModalManager.open('legalAboutModal');

            document.getElementById('legalInfoLink').onclick = () => {
                ModalManager.close('legalAboutModal');
                ModalManager.open('legalInfoModal');
            };
        }

        // --- NEW: Feedback Modal ---
        function renderFeedbackModal(isSuccess = false) {
            const modal = document.getElementById('feedbackModal');
            const content = modal.querySelector('.modal-content'); // This is the container for the whole modal content

            if (isSuccess) {
                content.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-full p-8 text-center">
                        <div>
                            <div class="text-6xl mb-4">ðŸŽ‰</div>
                            <h2 class="text-2xl font-bold text-gray-800 mb-2">Thank you!</h2>
                            <p class="text-gray-600 mb-6 max-w-md">We really appreciate your time and will use your suggestions to make our website even better. ðŸ’›</p>
                            <button id="closeFeedbackSuccessBtn" class="w-full max-w-xs h-12 bg-blue-600 text-white rounded-lg font-semibold button-animation">Done</button>
                        </div>
                    </div>
                `;
                document.getElementById('closeFeedbackSuccessBtn').onclick = () => ModalManager.close('feedbackModal');
            } else {
                content.innerHTML = `
                    <div class="flex-shrink-0 flex items-center justify-between p-6 border-b">
                        <h2 class="text-2xl font-bold logo-font">Share Your Feedback</h2>
                        <button id="closeFeedbackModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                    </div>
                    <div class="p-8 overflow-y-auto flex-grow">
                        <p class="text-center text-gray-600 mb-6">Help us improve your shopping experience!</p>
                        <form id="feedbackForm" class="space-y-6">
                            <!-- 1. Experience Rating -->
                            <div>
                                <label class="font-semibold text-gray-700 block mb-2 text-xl">â­ 1. Experience Rating</label>
                                <div class="flex justify-center gap-2 text-4xl text-gray-300" id="star-rating">
                                    <span class="star cursor-pointer transition-transform duration-200 hover:scale-125" data-value="1">â­</span>
                                    <span class="star cursor-pointer transition-transform duration-200 hover:scale-125" data-value="2">â­</span>
                                    <span class="star cursor-pointer transition-transform duration-200 hover:scale-125" data-value="3">â­</span>
                                    <span class="star cursor-pointer transition-transform duration-200 hover:scale-125" data-value="4">â­</span>
                                    <span class="star cursor-pointer transition-transform duration-200 hover:scale-125" data-value="5">â­</span>
                                </div>
                                <input type="hidden" name="rating" id="rating-value" required>
                            </div>

                            <!-- 2. Category -->
                            <div>
                                <label class="font-semibold text-gray-700 block mb-2 text-xl">âš™ï¸ 2. Category / Type of Feedback</label>
                                <div class="flex flex-wrap gap-2">
                                    ${['ðŸ–¥ï¸ Website Design & Layout', 'âš¡ Page Speed / Loading Time', 'ðŸ›’ Ease of Use', 'ðŸ’³ Payment Experience', 'ðŸ”” Notifications / Popups', 'Other'].map(cat => `
                                        <label class="cursor-pointer"><input type="radio" name="category" value="${cat}" class="sr-only peer"><div class="px-3 py-2 text-sm border rounded-lg peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600">${cat}</div></label>
                                    `).join('')}
                                </div>
                            </div>

                            <!-- 3. Text Box -->
                            <div>
                                <label for="feedback-text" class="font-semibold text-gray-700 block mb-2 text-xl">ðŸ’¬ 3. Your Suggestions or Problems</label>
                                <textarea id="feedback-text" name="feedback_text" rows="4" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="ðŸ“ Type your feedback hereâ€¦"></textarea>
                            </div>

                            <!-- 4. Optional Contact -->
                            <div>
                                <label for="feedback-contact" class="font-semibold text-gray-700 block mb-2 text-xl">ðŸ“§ 4. Optional Contact</label>
                                <input id="feedback-contact" name="contact_info" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Enter your email or phone number">
                            </div>

                            <!-- Buttons -->
                            <div class="flex justify-end gap-4 pt-6 border-t">
                                <button type="button" id="cancelFeedbackBtn" class="h-12 px-6 bg-gray-200 text-gray-800 rounded-lg font-semibold button-animation">Cancel</button>
                                <button type="submit" class="h-12 px-6 bg-blue-600 text-white rounded-lg font-semibold button-animation">Submit Feedback</button>
                            </div>
                        </form>
                    </div>
                `;

                // Star Rating Logic
                const stars = content.querySelectorAll('.star');
                const ratingInput = content.querySelector('#rating-value');
                stars.forEach(star => {
                    star.addEventListener('click', () => {
                        const value = star.dataset.value;
                        ratingInput.value = value;
                        stars.forEach(s => s.style.filter = s.dataset.value <= value ? '' : 'grayscale(100%)');
                    });
                });

                // Add listeners for the new buttons
                document.getElementById('cancelFeedbackBtn').onclick = () => ModalManager.close('feedbackModal');
            }
            ModalManager.open('feedbackModal');
        }

        // --- BACKPACK LOGIC (LOCALSTORAGE) ---
        function getBackpack() {
            return JSON.parse(localStorage.getItem('nexBookBackpack')) || [];
        }

        function saveBackpack(backpack) {
            localStorage.setItem('nexBookBackpack', JSON.stringify(backpack));
        }

        function addToBackpack(item) {
            const backpack = getBackpack();
            // A more robust ID check, using title and price as a fallback unique key
            const uniqueId = item.id || `${item.title}-${item.price}`;
            if (!backpack.find(b => (b.id || `${b.title}-${b.price}`) === uniqueId)) {
                backpack.push({...item, uniqueId: uniqueId }); // Add a consistent uniqueId
                saveBackpack(backpack);
                showToast('Item added to Backpack!');
            } else {
                showToast('Item is already in your Backpack.');
            }
        }
        
        function removeFromBackpack(uniqueId) {
            let backpack = getBackpack();
            backpack = backpack.filter(item => item.uniqueId !== uniqueId);
            saveBackpack(backpack);
            renderBackpackModal(); // Re-render the modal content
        }

        // --- DOWNLOAD HELPER FUNCTIONS ---
        function getDriveDownloadUrl(viewUrl) {
            const match = viewUrl.match(/d\/(.*?)(?:\/view|$)/);
            if (match && match[1]) {
                const fileId = match[1];
                return `https://drive.google.com/uc?export=download&id=${fileId}`;
            }
            return viewUrl; // Fallback
        }

        function triggerDownload(url, filename) {
            const a = document.createElement('a');
            a.href = url;
            a.setAttribute('download', filename || true);
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // --- ROBUST VIEW MORE/LESS SYSTEM ---
        function initializeExpandableSections() {
            const buttonPositions = {};
            const initialMaxHeights = {};

            // Pre-calculate initial heights from CSS when the page loads
            document.querySelectorAll('[data-toggle="expand"]').forEach(button => {
                const controlsId = button.getAttribute('data-controls');
                if (controlsId) {
                    const contentWrapper = document.getElementById(controlsId);
                    if (contentWrapper && initialMaxHeights[controlsId] === undefined) {
                        initialMaxHeights[controlsId] = window.getComputedStyle(contentWrapper).maxHeight;
                    }
                }
            });

            document.body.addEventListener('click', function(event) {
                const button = event.target.closest('[data-toggle="expand"]');
                if (!button || button.getAttribute('data-animating') === 'true') return;

                event.preventDefault();
                
                const controlsId = button.getAttribute('data-controls');
                const contentWrapper = document.getElementById(controlsId);
                if (!contentWrapper) return;

                button.setAttribute('data-animating', 'true');

                const isExpanding = contentWrapper.getAttribute('data-expanded') !== 'true';
                const initialHeight = initialMaxHeights[controlsId]; 

                if (isExpanding) {
                    buttonPositions[controlsId] = button.getBoundingClientRect().top;
                }
                
                if (!isExpanding) {
                    contentWrapper.style.maxHeight = contentWrapper.scrollHeight + 'px';
                }

                const onTransitionEnd = () => {
                    contentWrapper.removeEventListener('transitionend', onTransitionEnd);
                    
                    if (isExpanding) {
                        contentWrapper.style.maxHeight = 'none';
                    } else {
                        contentWrapper.style.maxHeight = ''; 
                        
                        const storedTop = buttonPositions[controlsId];
                        if (storedTop !== undefined) {
                            const newTop = button.getBoundingClientRect().top;
                            const scrollByY = newTop - storedTop;
                            if (Math.abs(scrollByY) > 1) {
                                window.scrollBy({ top: scrollByY, behavior: 'smooth' });
                            }
                        }
                    }
                    button.removeAttribute('data-animating');
                };

                // NEW: Scroll to target on collapse
                if (!isExpanding) {
                    const scrollTargetId = button.dataset.scrollTarget;
                    if (scrollTargetId) {
                        const scrollTarget = document.getElementById(scrollTargetId);
                        scrollTarget?.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }

                contentWrapper.addEventListener('transitionend', onTransitionEnd);

                // NEW: Update all buttons that control this wrapper to keep them in sync
                const allControlButtons = document.querySelectorAll(`[data-toggle="expand"][data-controls="${controlsId}"]`);
                allControlButtons.forEach(btn => {
                    const viewLessText = btn.dataset.viewLessText || 'View Less';
                    const viewMoreText = btn.dataset.viewMoreText || 'View More';
                    btn.textContent = isExpanding ? viewLessText : viewMoreText;
                    btn.setAttribute('aria-expanded', String(isExpanding));
                });
                contentWrapper.setAttribute('data-expanded', String(isExpanding));
                requestAnimationFrame(() => {
                    if (isExpanding) {
                        contentWrapper.style.maxHeight = contentWrapper.scrollHeight + 'px';
                    } else {
                        contentWrapper.style.maxHeight = initialHeight || '0px'; 
                    }
                });
            });
        }

        function showToast(message, isError = false) {
            toast.textContent = message;
            toast.className = `toast show ${isError ? 'error' : ''}`;
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // NEW: Generic Confirmation Modal Helper
        function showConfirmation({ title, message, confirmText, onConfirm, icon = 'warning' }) {
            const modal = document.getElementById('confirmActionModal');
            const modalTitle = modal.querySelector('#confirmActionTitle');
            const modalMessage = modal.querySelector('#confirmActionMessage');
            const confirmBtn = modal.querySelector('#confirmActionConfirmBtn');
            const cancelBtn = modal.querySelector('#confirmActionCancelBtn');
            const iconDiv = modal.querySelector('#confirmActionIcon');

            modalTitle.textContent = title;
            modalMessage.textContent = message;
            confirmBtn.textContent = confirmText;

            if (icon === 'warning') {
                iconDiv.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>`;
                confirmBtn.className = 'w-full h-12 bg-red-600 text-white hover:bg-red-700 rounded-lg font-semibold button-animation';
            }

            const confirmHandler = () => {
                onConfirm();
                ModalManager.close('confirmActionModal');
            };

            confirmBtn.onclick = confirmHandler;
            cancelBtn.onclick = () => ModalManager.close('confirmActionModal');
            ModalManager.open('confirmActionModal');
        }

        const preventDoubleClick = (handler) => {
            let isClickDisabled = false;
            return function(...args) {
                if (isClickDisabled) return;
                const button = this;
                isClickDisabled = true;
                handler.apply(this, args);
                setTimeout(() => { isClickDisabled = false; }, 400); // Cooldown period
            };
        };

        // --- RENDERING LOGIC ---
        function createBackButton(text, onClick) {
            const button = document.createElement('button');
            button.className = 'mb-8 bg-gray-200 text-gray-800 rounded-lg font-semibold py-2 px-4 flex items-center justify-center transition-all duration-300 hover:bg-blue-600 hover:text-white transform hover:-translate-x-1 button-animation';
            button.innerHTML = `â† ${text}`;
            button.onclick = onClick;
            return button;
        }

        function createCenteredFlexContainer() {
            const flex = document.createElement('div');
            flex.className = 'flex flex-wrap justify-center gap-4';
            return flex;
        }
        
        function createTitle(text, isMobile = false) {
             const title = document.createElement('h3');
             const textSize = isMobile ? 'text-2xl' : 'text-3xl';
             title.className = `${textSize} font-bold mb-6 md:mb-8 text-center`;
             title.textContent = text;
             return title;
        }

        function renderMajors() {
            const courseSelectionContainer = document.getElementById('course-selection-container');
            // Clear skeleton loaders before adding real content
            courseSelectionContainer.innerHTML = '';
            let content = '';
            const majors = Object.entries(courseData);
            // Using a more robust class for targeting
            majors.forEach(([name, data]) => {
                content += `
                    <div class="cursor-pointer group course-major-item" data-major="${name}">
                        <div class="bg-white rounded-2xl shadow-lg overflow-hidden h-64 relative hover:shadow-2xl transition-shadow duration-400 transform hover:-translate-y-1">
                            <img src="${data.image}" class="w-full h-full object-cover transition-transform duration-400 group-hover:scale-105" alt="${name}" />
                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
                            <div class="absolute inset-0 bg-black/40 flex items-center justify-center p-4">
                                <h3 class="text-3xl font-bold text-white text-center">${name}</h3>
                            </div>
                        </div>
                    </div>`;
            });
            courseSelectionContainer.innerHTML = content;
            const viewMoreContainer = document.getElementById('view-more-container-courses');
            const wrapper = document.getElementById('course-selection-container-wrapper');
            
            // Only show the "View More" button if there are more than 4 items
            // and the initial state of the wrapper is not expanded.
            if (majors.length > 4) {
                viewMoreContainer.classList.remove('hidden');
            }
            
            document.querySelectorAll('.course-major-item').forEach(card => {
                card.addEventListener('click', preventDoubleClick(function() { 
                    courseModalState.major = card.dataset.major;
                    courseModalState.step = 'groups';
                    renderCourseModal(); 
                    ModalManager.open('courseModal');
                }));
            });
        }

        // --- NEW COURSE MODAL FLOW ---
        function resetCourseModalState() {
            courseModalState = { major: null, group: null, subject: null, courseType: null, year: null, semester: null, step: 'majors', filters: { condition: 'All' } };
        }
        
        function renderCourseModal() {
            const isMobile = window.innerWidth < 768;
            const content = courseModalContent;
            const modalContentDiv = courseModal.querySelector('.modal-content');

            if (courseModalState.step === 'books') {
                // Hide the default close button for this specific view
                const defaultCloseBtn = document.getElementById('closeCourseModalBtn');
                if (defaultCloseBtn) {
                    defaultCloseBtn.style.display = 'none';
                }

                // For the 'books' step, make the modal fullscreen.
                modalContentDiv.classList.remove('max-w-md', 'max-w-2xl', 'max-h-[90vh]');
                modalContentDiv.classList.add('modal-content--fullscreen');
            } else {
                // For all other steps (course/subject selection), use a smaller, standard size.
                modalContentDiv.classList.remove('modal-content--fullscreen');
                // NEW: Force mobile-like width (max-w-md) on all devices for a consistent look.
                // Show the default close button again
                const defaultCloseBtn = document.getElementById('closeCourseModalBtn');
                if (defaultCloseBtn) {
                    defaultCloseBtn.style.display = 'block';
                }

                modalContentDiv.classList.remove('max-w-2xl');
                modalContentDiv.classList.add('max-w-md');
                modalContentDiv.classList.add('max-h-[90vh]');
            }

            content.innerHTML = '';
            content.scrollTop = 0;

            const wrapper = document.createElement('div');
            
            switch (courseModalState.step) {
                case 'groups':
                    wrapper.appendChild(createTitle(courseModalState.major, isMobile));
                    const flexGroups = createCenteredFlexContainer();
                    Object.keys(courseData[courseModalState.major].groups).forEach(group => {
                        const button = document.createElement('button');
                        button.className = `bg-white h-auto min-h-[3rem] ${isMobile ? 'py-3 px-4 text-base' : 'py-2 px-6 text-md'} text-gray-800 border-2 border-gray-200 rounded-lg hover:bg-blue-600 hover:text-white hover:border-blue-600 button-animation`;
                        button.textContent = group;
                        button.onclick = preventDoubleClick(function() {
                            courseModalState.group = group;
                            courseModalState.step = 'subjects';
                            renderCourseModal();
                        });
                        flexGroups.appendChild(button);
                    });
                    wrapper.appendChild(flexGroups);
                    break;
                case 'subjects': // This case is for selecting a subject within a group
                    wrapper.appendChild(createBackButton(`Back to ${courseModalState.major}`, preventDoubleClick(() => {
                        courseModalState.step = 'groups'; renderCourseModal();
                    })));
                    wrapper.appendChild(createTitle(courseModalState.group, isMobile));
                    const flexSubjects = createCenteredFlexContainer();
                    courseData[courseModalState.major].groups[courseModalState.group].forEach(sub => {
                        const button = document.createElement('button');
                        button.className = `bg-white h-auto min-h-[3rem] ${isMobile ? 'py-3 px-4 text-base' : 'py-2 px-6 text-md'} text-gray-800 border-2 border-gray-200 rounded-lg hover:bg-blue-600 hover:text-white hover:border-blue-600 button-animation`;
                        button.textContent = sub;
                        button.onclick = preventDoubleClick(function() {
                            courseModalState.subject = sub.split(' ')[0];
                            courseModalState.step = 'years';
                            renderCourseModal();
                        });
                        flexSubjects.appendChild(button);
                    });
                    wrapper.appendChild(flexSubjects);
                    break;
                case 'years':
                     wrapper.appendChild(createBackButton('Back to Subjects', preventDoubleClick(() => {
                         courseModalState.step = 'subjects'; renderCourseModal();
                     })));
                     wrapper.appendChild(createTitle('Select Year', isMobile));
                     const flexYears = createCenteredFlexContainer();
                     const yearsForMajor = courseModalState.major.startsWith("Master") || courseModalState.major.startsWith("M.C.A") ? [1, 2] : [1, 2, 3];
                     yearsForMajor.forEach(year => {
                          const button = document.createElement('button');
                          button.className = `bg-white ${isMobile ? 'h-14 w-28 text-lg' : 'h-12 w-24 text-lg'} border-2 border-gray-200 rounded-lg hover:bg-blue-600 hover:text-white hover:border-blue-600 button-animation`;
                          button.textContent = `Year ${year}`;
                          button.onclick = preventDoubleClick(() => {
                             courseModalState.year = year;
                             courseModalState.step = 'books'; // Go directly to books
                             renderCourseModal();
                          });
                          flexYears.appendChild(button);
                     });
                     wrapper.appendChild(flexYears);
                     break;
                case 'books': // The main part of your request is implemented here
                    const headerWrapper = document.createElement('div');
                    // NEW: Unified header with title and close button
                    headerWrapper.className = 'flex items-center justify-between pb-6 border-b';
                    headerWrapper.innerHTML = `
                        <h2 class="text-4xl font-bold font-playfair">Select Books</h2>
                        <button id="closeBooksViewBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation" aria-label="Close book selection">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                    `;

                    const scrollableContent = document.createElement('div');
                    scrollableContent.className = 'p-6 md:p-8 overflow-y-auto flex-grow'; // This part will scroll

                    scrollableContent.appendChild(headerWrapper);
                    
                    // NEW: Combined header with course info and sort dropdown
                    const combinedHeader = document.createElement('div');
                    combinedHeader.className = 'mt-4 mb-6 flex flex-wrap gap-4 justify-between items-center';
                    combinedHeader.innerHTML = `
                        <div class="flex items-center gap-4">
                            <div class="relative" role="navigation" aria-label="Sort books">
                                <select id="conditionSort" class="appearance-none bg-gray-100 border border-gray-200 text-gray-700 py-2 pl-3 pr-8 rounded-lg leading-tight focus:outline-none focus:bg-white focus:border-blue-500 text-sm font-semibold">
                                    <option value="All">Sort by: All</option>
                                    <option value="New">Sort by: New</option>
                                    <option value="Old">Sort by: Old</option>
                                </select>
                                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700" aria-hidden="true">
                                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                                </div>
                            </div>
                            <span class="inline-block bg-gray-100 border border-gray-200 text-gray-700 text-sm font-semibold py-2 pl-3 pr-3 rounded-lg leading-tight">${courseModalState.subject} - Year ${courseModalState.year}</span>
                        </div>
                    `;
                    scrollableContent.appendChild(combinedHeader);
                    // Set the dropdown to the current filter state
                    combinedHeader.querySelector('#conditionSort').value = courseModalState.filters.condition;

                    const yearData = booksDatabase[courseModalState.subject]?.[courseModalState.year] || {};
                    const allBooksForYear = Object.values(yearData).flatMap(sem => sem.books || []);
                    const totalBundlePrice = Object.values(yearData).reduce((acc, sem) => acc + (sem.bundlePrice || 0), 0);
                    if (allBooksForYear.length > 1 && totalBundlePrice > 0) {
                        const bundleCard = document.createElement('div');
                        bundleCard.className = 'bg-gradient-to-br from-indigo-500 to-blue-600 p-6 md:p-8 rounded-2xl shadow-lg flex flex-col sm:flex-row sm:items-center justify-between gap-6 text-white mb-8';
                        bundleCard.innerHTML = `
                            <div class="flex items-center gap-5">
                                <div class="bg-white/20 p-3 rounded-lg">
                                     <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 10h16M4 14h16M4 18h16" /></svg>
                                </div>
                                <div>
                                    <h2 class="text-3xl font-bold font-playfair">Complete Year Bundle</h2>
                                    <p class="mt-1 opacity-90">Get all prescribed books for Year ${courseModalState.year}!</p>
                                </div>
                            </div>
                            <div class="text-center mt-4 sm:mt-0">
                                <p class="text-3xl md:text-4xl font-black font-roboto">â‚¹${totalBundlePrice}</p>
                                <button class="bundle-buy-btn mt-3 w-full sm:w-auto bg-yellow-400 text-slate-900 font-bold py-3 px-8 rounded-xl shadow-md hover:bg-yellow-300 transform hover:scale-105 transition-all duration-200">Buy Bundle</button>
                            </div>
                        `;
                        scrollableContent.appendChild(bundleCard);
                        bundleCard.querySelector('.bundle-buy-btn').onclick = preventDoubleClick(() => handleBuy({ title: `Bundle for ${courseModalState.subject} Year ${courseModalState.year}`, price: totalBundlePrice, condition: 'Bundle', verified: true, author: 'Various', id: `bundle-${courseModalState.subject}-${courseModalState.year}` }));
                    }

                    const bookListContainer = document.createElement('div');
                    const selectedCondition = courseModalState.filters.condition;
                    const filteredBooks = allBooksForYear.filter(book => {
                        if (selectedCondition === 'All') {
                            return true;
                        }
                        if (selectedCondition === 'New') {
                            return book.condition === 'New';
                        }
                        if (selectedCondition === 'Old') {
                            return ['Old', 'Okay', 'Good'].includes(book.condition);
                        }
                    });
                    
                    if (filteredBooks.length === 0) {
                        bookListContainer.innerHTML = `<div class="text-center py-12"><p class="text-gray-500 text-lg">No books found for the selected criteria.</p></div>`
                    } else {
                        bookListContainer.className = 'grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8';
                        filteredBooks.forEach(book => { // The 'book' variable is defined here
                            const bookCard = document.createElement('div');
                            bookCard.className = 'bg-white rounded-2xl shadow-lg overflow-hidden border border-slate-200 flex flex-col transition-all duration-300 hover:shadow-2xl hover:-translate-y-1.5';
                            
                            let starsHtml = '';
                            const fullStars = Math.floor(book.rating);
                            const halfStar = book.rating % 1 >= 0.5; // Not used in this design, but kept for future
                            for (let i = 0; i < 5; i++) {
                                const starSVG = `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>`;
                                starsHtml += `<div class="${i < fullStars ? 'text-yellow-400' : 'text-slate-300'}">${starSVG}</div>`;
                            }
                            const ratingHtml = `<div class="flex items-center gap-2"><div class="flex items-center text-yellow-400">${starsHtml}</div><span class="font-bold text-slate-700 text-sm">${book.rating.toFixed(1)}</span></div>`;
                            
                            const conditionHtml = `<div class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-semibold text-xs">${book.condition}</div>`;
                            const verifiedHtml = book.verified ? `<div class="inline-flex items-center gap-1.5 text-blue-600 text-sm font-semibold"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg><span>Nexbook Verified</span></div>` : '<div class="h-5"></div>';
                            
                            bookCard.innerHTML = `
                                <div class="bg-slate-100 h-56 flex items-center justify-center p-4">
                                    <h2 class="font-playfair text-3xl md:text-4xl font-bold text-slate-500 text-center">${book.title.split(' - ')[0]}</h2>
                                </div>
                                <div class="p-5 flex flex-col flex-grow">
                                    <h3 class="font-playfair text-2xl font-bold text-slate-900">${book.title}</h3>
                                    <p class="text-sm text-slate-500 mt-1">by ${book.author}</p>
                                    <div class="flex justify-between items-center mt-4">${ratingHtml}${conditionHtml}</div>
                                    <div class="mt-3">${verifiedHtml}</div>
                                    <p class="font-roboto text-4xl font-black text-slate-900 mt-4">â‚¹${book.price}</p>
                                    <div class="mt-auto pt-5 grid grid-cols-2 gap-3">
                                        <button class="buy-now-btn w-full bg-red-500 text-white font-bold py-3 px-5 rounded-lg shadow-md hover:bg-red-600 transition-colors duration-200">Buy Now</button>
                                        <button class="add-to-backpack-btn w-full bg-orange-500 text-white font-bold py-3 px-5 rounded-lg shadow-md hover:bg-orange-600 transition-colors duration-200">Add to Backpack</button>
                                    </div>
                                </div>`;

                            bookCard.querySelector('.buy-now-btn').onclick = preventDoubleClick(() => handleBuy(book));
                            bookCard.querySelector('.add-to-backpack-btn').onclick = preventDoubleClick(() => addToBackpack(book));
                            bookListContainer.appendChild(bookCard);
                        });
                    }
                    scrollableContent.appendChild(bookListContainer);

                    // Assemble the final structure
                    wrapper.appendChild(scrollableContent);
                    break;
            }
            
            content.appendChild(wrapper);

            // Add event listener for the new close button in the books view
            const closeBooksBtn = document.getElementById('closeBooksViewBtn');
            if (closeBooksBtn) {
                closeBooksBtn.addEventListener('click', () => ModalManager.close('courseModal'));
            }

            if (courseModalState.step === 'books') {
                // NEW: Event listener for the new sort dropdown
                const sortDropdown = document.getElementById('conditionSort');
                sortDropdown.addEventListener('change', (e) => {
                    courseModalState.filters.condition = e.target.value;
                    renderCourseModal(); // Re-render the view with the new filter
                });
            }
        }
        
        function handleBuy(book) {
            // CRITICAL FIX: Save scroll position before modal changes
            const scrollY = window.scrollY;
            
            ModalManager.close('courseModal');
            renderCheckoutModal(book);
            
            // Prevent any scrolling during modal transition
            document.body.style.position = 'fixed';
            document.body.style.top = `-${scrollY}px`;
            document.body.style.left = '0';
            document.body.style.right = '0';
            document.body.style.width = '100%';
            
            ModalManager.open('checkoutModal');
        }

        function renderCheckoutModal(book) {
            const getNextDeliveryDates = () => {
                const dates = []; let today = new Date();
                for (let i = 0; i < 14 && dates.length < 2; i++) {
                    let nextDate = new Date(today); nextDate.setDate(today.getDate() + i);
                    const day = nextDate.getDay(); if (day === 1 || day === 4) { dates.push(nextDate.toDateString()); }
                } return dates;
            };
            const deliveryDates = getNextDeliveryDates();
            checkoutModalContent.innerHTML = `
                <div class="flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold">Secure Your Item</h2>
                    <button id="closeCheckoutBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                </div> 
                <div class="flex-grow p-8 overflow-y-auto">
                    <p class="text-center text-gray-600 mb-8">Fill in your details to complete the order</p>
                     <form id="checkoutForm" class="grid md:grid-cols-2 gap-x-12 gap-y-8">
                        <div class="space-y-6 md:border-r md:pr-12"><h3 class="text-xl font-bold">Order Summary</h3>
                            <div class="bg-gray-50 border rounded-xl p-4 space-y-2"><h4 class="font-bold text-lg">${book.title}</h4><p class="text-sm text-gray-500">by ${book.author || 'N/A'}</p></div> 
                            <div class="space-y-2 border-t pt-4"><div class="flex justify-between"><span>Item Price</span><span>â‚¹${book.price}</span></div><div class="flex justify-between items-center"><span>Delivery Charges</span><div><span class="line-through text-gray-500 mr-2">â‚¹70</span><span class="text-green-600 font-bold">FREE</span></div></div><div class="flex justify-between font-bold text-lg border-t pt-2 mt-2"><span>Total Amount</span><span>â‚¹${book.price}</span></div></div>
                        </div>
                        <div class="space-y-4">
                            <div><label class="font-semibold text-gray-700">Full Name</label><input name="fullName" required placeholder="Enter your full name" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" autocomplete="name"/></div>
                            <div><label class="font-semibold text-gray-700">Phone Number / WhatsApp</label><input name="phone" required placeholder="For delivery updates" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                            <div><label class="font-semibold text-gray-700">Email Address</label><input name="email" type="email" required placeholder="For order confirmation" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div>
                            <div><label class="font-semibold text-gray-700">Quantity</label><input name="quantity" type="number" required placeholder="e.g. 1" value="1" min="1" class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"/></div> 
                            <div><label class="font-semibold text-gray-700">Delivery Location (College)</label><select name="deliveryLocation" class="w-full p-2 border border-gray-300 rounded-md"><option>Library Entrance</option><option>Cafeteria</option><option>Main Gate</option></select></div>
                            <div><label class="font-semibold text-gray-700">Delivery Date</label><div class="grid grid-cols-2 gap-4">${deliveryDates.map(date => `<label class="flex-1"><input type="radio" name="deliveryDate" value="${date}" required class="sr-only peer"/><div class="p-3 text-center border rounded-lg peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 cursor-pointer">${date}</div></label>`).join('')}</div></div>
                            <div><label class="font-semibold text-gray-700">Payment Method</label><div class="grid grid-cols-2 gap-4"><label class="flex-1"><input type="radio" name="paymentMethod" value="POD" checked class="sr-only peer"/><div class="p-3 text-center border rounded-lg peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 cursor-pointer">Pay on Delivery</div></label><label class="flex-1"><input type="radio" name="paymentMethod" value="Online" class="sr-only peer"/><div class="p-3 text-center border rounded-lg peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 cursor-pointer">Pay Online</div></label></div></div>
                            <div class="pt-4 space-y-2"><label class="flex items-center gap-2 text-sm text-gray-600"><input type="checkbox" required />I confirm the details are correct.</label><label class="flex items-center gap-2 text-sm text-gray-600"><input type="checkbox" required />I agree to Nexbookâ€™s safety & privacy guidelines.</label></div>
                            <button type="submit" class="w-full h-12 text-lg bg-blue-600 text-white rounded-lg font-semibold button-animation">Place Order Now</button>
                            <button type="button" id="addToBackpackBtnCheckout" class="w-full h-12 mt-3 text-lg bg-gray-200 text-gray-800 hover:bg-gray-300 rounded-lg font-semibold flex items-center justify-center button-animation">Add to Backpack</button>
                        </div>
                    </form>
                </div>`;

            document.getElementById('addToBackpackBtnCheckout').onclick = preventDoubleClick(function() {
                addToBackpack(book);
            });

            // Removed old form handler - Firebase handler will take over
            // document.getElementById('checkoutForm').onsubmit = preventDoubleClick((e) => { ... });
        }
        
        function renderSyllabusModal() {
            let content = '';
            for (const category in syllabusData) {
                content += `<div class="mb-8"><h3 class="text-2xl font-bold mb-4 border-b pb-2">${category}</h3><div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">`;
                for (const subject in syllabusData[category]) {
                    content += `<a href="${syllabusData[category][subject]}" target="_blank" class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg><span class="font-semibold">${subject}</span></a>`;
                }
                content += `</div></div>`;
            }
            syllabusContent.innerHTML = content;
        }

        function renderPyqModal() {
            let content = '<div class="p-6"><button onclick="openUnifiedModal(\'pyq\')" class="w-full py-4 px-6 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all text-lg flex items-center justify-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg><span>Browse Previous Year Questions</span></button></div>';
            pyqContent.innerHTML = content;
        }
        
        // Helper functions to hide/show mobile navbar
        function hideMobileNav() {
            const mobileNav = document.getElementById('mobile-nav');
            if (mobileNav) {
                mobileNav.style.display = 'none';
            }
        }
        
        function showMobileNav() {
            const mobileNav = document.getElementById('mobile-nav');
            if (mobileNav) {
                mobileNav.style.display = '';
            }
        }
        
        // Open Degree Modal for PYQ
        // Unified Multi-Step Modal with Tabs and Filtering
        let unifiedModalState = {
            activeTab: 'pyq', // 'pyq', 'notes', 'assignments', 'practicals'
            selectedDegree: null,
            selectedSubject: null,
            filterText: ''
        };

        window.openUnifiedModal = function(tab = 'pyq') {
            unifiedModalState.activeTab = tab;
            unifiedModalState.selectedDegree = null;
            unifiedModalState.selectedSubject = null;
            unifiedModalState.filterText = '';
            
            let modal = document.getElementById('unifiedStudyModal');
            if (!modal) {
                // Save current scroll position WITHOUT scrolling
                window.modalScrollY = window.scrollY;
                
                modal = document.createElement('div');
                modal.id = 'unifiedStudyModal';
                modal.className = 'fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-[60] p-0 md:p-4 overflow-hidden';
                modal.style.cssText = 'background-color: rgba(0,0,0,0.4); touch-action: none;';
                modal.onclick = function(e) { 
                    if (e.target === modal) { 
                        closeUnifiedModal();
                    } 
                };
                document.body.appendChild(modal);
            }
            
            // Prevent body scroll when modal is open WITHOUT changing scroll position
            const scrollY = window.scrollY;
            document.body.style.position = 'fixed';
            document.body.style.top = `-${scrollY}px`;
            document.body.style.width = '100%';
            document.body.style.overflow = 'hidden';
            
            renderUnifiedModal();
        };

        function getDataForTab(tab) {
            switch(tab) {
                case 'pyq': return pyqData;
                case 'notes': return notesData;
                case 'assignments': return assignmentsData;
                case 'practicals': return practicalsData;
                default: return {};
            }
        }

        function getColorScheme(tab) {
            switch(tab) {
                case 'pyq': return { from: 'blue-500', to: 'blue-600', light: 'blue-50', hover: 'blue-100', border: 'blue-300', text: 'blue-600' };
                case 'notes': return { from: 'green-500', to: 'green-600', light: 'green-50', hover: 'green-100', border: 'green-300', text: 'green-600' };
                case 'assignments': return { from: 'purple-500', to: 'purple-600', light: 'purple-50', hover: 'purple-100', border: 'purple-300', text: 'purple-600' };
                case 'practicals': return { from: 'orange-500', to: 'orange-600', light: 'orange-50', hover: 'orange-100', border: 'orange-300', text: 'orange-600' };
                default: return { from: 'gray-500', to: 'gray-600', light: 'gray-50', hover: 'gray-100', border: 'gray-300', text: 'gray-600' };
            }
        }

        function getTabTitle(tab) {
            switch(tab) {
                case 'pyq': return 'Previous Year Questions';
                case 'notes': return 'Notes';
                case 'assignments': return 'Assignments';
                case 'practicals': return 'Practicals';
                default: return 'Study Materials';
            }
        }

        function renderUnifiedModal() {
            const modal = document.getElementById('unifiedStudyModal');
            if (!modal) return;

            const { activeTab, selectedDegree, selectedSubject, filterText } = unifiedModalState;
            const data = getDataForTab(activeTab);
            const colors = getColorScheme(activeTab);
            const title = getTabTitle(activeTab);

            let contentHtml = '';
            let breadcrumb = title;

            // Step 1: Degree Selection (with dropdown filter)
            if (!selectedDegree) {
                const degrees = Object.keys(data);
                const filteredDegrees = degrees.filter(d => d.toLowerCase().includes(filterText.toLowerCase()));
                
                contentHtml = `
                    <div class="flex flex-col h-full">
                        <div class="flex-shrink-0 px-6 pt-6 pb-4">
                            <div class="relative">
                                <div class="relative flex items-center gap-3 px-4 py-3 bg-white rounded-[16px] border border-black/[0.06] shadow-[0_2px_8px_rgba(0,0,0,0.04)] hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] transition-all duration-250 cursor-text" onclick="document.getElementById('degreeFilter').focus()">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 flex-shrink-0 pointer-events-none"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                                    <input type="text" id="degreeFilter" placeholder="Search programs..." 
                                        value="${filterText}"
                                        dir="ltr"
                                        class="flex-1 bg-transparent border-0 outline-none text-[15px] font-normal text-black placeholder-gray-400 pointer-events-auto">
                                </div>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto px-6 pb-6">
                            <div class="space-y-3">
                            ${filteredDegrees.map(degree => {
                                let iconColor = '';
                                let borderColor = '';
                                if (activeTab === 'pyq') {
                                    iconColor = '#3b82f6';
                                    borderColor = 'border-l-[3px] border-l-[#3b82f6]';
                                } else if (activeTab === 'notes') {
                                    iconColor = '#FF9500';
                                    borderColor = 'border-l-[3px] border-l-[#FF9500]';
                                } else if (activeTab === 'assignments') {
                                    iconColor = '#34C759';
                                    borderColor = 'border-l-[3px] border-l-[#34C759]';
                                } else if (activeTab === 'practicals') {
                                    iconColor = '#AF52DE';
                                    borderColor = 'border-l-[3px] border-l-[#AF52DE]';
                                }
                                return `
                                <button onclick="selectDegree('${degree.replace(/'/g, "\\'")}')" 
                                    class="group w-full bg-white rounded-[22px] border border-black/[0.06] shadow-[0_10px_28px_rgba(0,0,0,0.08)] hover:shadow-[0_14px_30px_rgba(0,0,0,0.12)] hover:-translate-y-[3px] transition-all duration-[250ms] ease-[cubic-bezier(0.25,0.1,0.25,1)] ${borderColor}">
                                    <div class="flex items-center justify-between p-5">
                                        <div class="flex items-center gap-4">
                                            <div class="w-12 h-12 rounded-full bg-[#F2F2F7] flex items-center justify-center group-hover:scale-105 transition-transform duration-[250ms]">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="${iconColor}" stroke-width="1.5"><path d="M22 10v6M2 10l10-5 10 5-10 5z"></path><path d="M6 12v5c3 3 9 3 12 0v-5"></path></svg>
                                            </div>
                                            <div class="text-left">
                                                <h3 class="text-[17px] font-semibold text-black">${degree}</h3>
                                                <p class="text-[13px] text-gray-500 mt-0.5">Explore materials</p>
                                            </div>
                                        </div>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400"><polyline points="9 18 15 12 9 6"></polyline></svg>
                                    </div>
                                </button>
                            `}).join('')}
                            </div>
                            ${filteredDegrees.length === 0 ? '<p class="text-center text-gray-400 mt-8 text-[15px]">No programs found</p>' : ''}
                        </div>
                    </div>`;
            }
            // Step 2: Subject Selection (with filter)
            else if (!selectedSubject) {
                const subjects = Object.keys(data[selectedDegree] || {});
                const filteredSubjects = subjects.filter(s => s.toLowerCase().includes(filterText.toLowerCase()));
                breadcrumb = `${selectedDegree} > ${title}`;
                
                contentHtml = `
                    <div class="flex flex-col h-full">
                        <div class="flex-shrink-0 px-6 pt-6 pb-4">
                            <div class="relative">
                                <div class="relative flex items-center gap-3 px-4 py-3 bg-white rounded-[16px] border border-black/[0.06] shadow-[0_2px_8px_rgba(0,0,0,0.04)] hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] transition-all duration-250 cursor-text" onclick="document.getElementById('subjectFilter').focus()">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 flex-shrink-0 pointer-events-none"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                                    <input type="text" id="subjectFilter" placeholder="Search subjects..." 
                                        value="${filterText}"
                                        dir="ltr"
                                        class="flex-1 bg-transparent border-0 outline-none text-[15px] font-normal text-black placeholder-gray-400 pointer-events-auto">
                                </div>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto px-6 pb-6">
                            <div class="space-y-3">
                            ${filteredSubjects.map(subject => {
                                const subjectData = data[selectedDegree][subject];
                                let iconColor = '';
                                let borderColor = '';
                                if (activeTab === 'pyq') {
                                    iconColor = '#3b82f6';
                                    borderColor = 'border-l-[3px] border-l-[#3b82f6]';
                                } else if (activeTab === 'notes') {
                                    iconColor = '#FF9500';
                                    borderColor = 'border-l-[3px] border-l-[#FF9500]';
                                } else if (activeTab === 'assignments') {
                                    iconColor = '#34C759';
                                    borderColor = 'border-l-[3px] border-l-[#34C759]';
                                } else if (activeTab === 'practicals') {
                                    iconColor = '#AF52DE';
                                    borderColor = 'border-l-[3px] border-l-[#AF52DE]';
                                }
                                
                                // Check if subject has data and nested structure
                                const hasNestedData = subjectData && typeof subjectData === 'object' && !subjectData.url && Object.keys(subjectData).length > 0;
                                
                                if (hasNestedData) {
                                    return `
                                        <button onclick="selectSubject('${subject.replace(/'/g, "\\'")}')" 
                                            class="group w-full bg-white rounded-[22px] border border-black/[0.06] shadow-[0_10px_28px_rgba(0,0,0,0.08)] hover:shadow-[0_14px_30px_rgba(0,0,0,0.12)] hover:-translate-y-[3px] transition-all duration-[250ms] ease-[cubic-bezier(0.25,0.1,0.25,1)] ${borderColor}">
                                            <div class="flex items-center justify-between p-5">
                                                <div class="flex items-center gap-4">
                                                    <div class="w-12 h-12 rounded-full bg-[#F2F2F7] flex items-center justify-center group-hover:scale-105 transition-transform duration-[250ms]">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="${iconColor}" stroke-width="1.5"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                                                    </div>
                                                    <div class="text-left">
                                                        <h4 class="text-[17px] font-semibold text-black">${subject}</h4>
                                                        <p class="text-[13px] text-gray-500 mt-0.5">View files</p>
                                                    </div>
                                                </div>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400"><polyline points="9 18 15 12 9 6"></polyline></svg>
                                            </div>
                                        </button>`;
                                } else {
                                    return `
                                        <a href="${subjectData}" target="_blank" 
                                            class="group flex items-center gap-3 p-5 bg-white rounded-[22px] border border-black/[0.06] shadow-[0_10px_28px_rgba(0,0,0,0.08)] hover:shadow-[0_14px_30px_rgba(0,0,0,0.12)] hover:-translate-y-[3px] transition-all duration-[250ms] ease-[cubic-bezier(0.25,0.1,0.25,1)]">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="${iconColor}" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                                            <span class="font-semibold text-[15px] text-black">${subject}</span>
                                        </a>`;
                                }
                            }).join('')}
                            </div>
                            ${filteredSubjects.length === 0 ? '<p class="text-center text-gray-400 mt-8 text-[15px]">No subjects found</p>' : ''}
                        </div>
                    </div>`;
            }
            // Step 3: Semester/Files Display (with semester filter dropdown)
            else {
                const subjectData = data[selectedDegree][selectedSubject];
                const semesters = Object.keys(subjectData || {});
                breadcrumb = `${selectedDegree} > ${selectedSubject} > ${title}`;
                
                contentHtml = `
                    <div class="flex flex-col h-full">
                        <div class="flex-shrink-0 px-6 pt-6 pb-4">
                            <div class="relative">
                                <div class="relative flex items-center gap-3 px-4 py-3 bg-white rounded-[16px] border border-black/[0.06] shadow-[0_2px_8px_rgba(0,0,0,0.04)] hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] transition-all duration-250 cursor-pointer" onclick="document.getElementById('semesterFilter').focus(); document.getElementById('semesterFilter').click();">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 flex-shrink-0 pointer-events-none"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                                    <select id="semesterFilter" 
                                        class="flex-1 bg-transparent border-0 outline-none text-[15px] font-normal text-black cursor-pointer appearance-none pointer-events-auto">
                                        <option value="">All Semesters</option>
                                        ${semesters.map(sem => `<option value="${sem}" ${filterText === sem ? 'selected' : ''}>${sem}</option>`).join('')}
                                    </select>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 pointer-events-none"><polyline points="6 9 12 15 18 9"></polyline></svg>
                                </div>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto px-6 pb-6">
                            <div class="space-y-4">`;
                
                const filteredSemesters = filterText ? [filterText] : semesters;
                filteredSemesters.forEach(semester => {
                    const files = subjectData[semester];
                    let iconColor = '';
                    if (activeTab === 'pyq') iconColor = '#3b82f6';
                    else if (activeTab === 'notes') iconColor = '#FF9500';
                    else if (activeTab === 'assignments') iconColor = '#34C759';
                    else if (activeTab === 'practicals') iconColor = '#AF52DE';
                    
                    if (Array.isArray(files) && files.length > 0 && (!filterText || filterText === semester)) {
                        contentHtml += `
                            <div class="mb-6">
                                <h5 class="text-[22px] font-semibold text-black mb-3 px-1">
                                    ${semester}
                                </h5>
                                <div class="space-y-3">`;
                        
                        files.forEach(file => {
                            contentHtml += `
                                <a href="${file.url}" target="_blank" 
                                    class="group flex items-center gap-4 p-5 bg-white rounded-[22px] border border-black/[0.06] shadow-[0_10px_28px_rgba(0,0,0,0.08)] hover:shadow-[0_14px_30px_rgba(0,0,0,0.12)] hover:-translate-y-[3px] transition-all duration-[250ms] ease-[cubic-bezier(0.25,0.1,0.25,1)]">
                                    <div class="w-12 h-12 rounded-full bg-[#F2F2F7] flex items-center justify-center flex-shrink-0 group-hover:scale-105 transition-transform duration-[250ms]">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${iconColor}" stroke-width="1.5"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                                    </div>
                                    <span class="font-normal text-[15px] flex-1 text-black">${file.name}</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 flex-shrink-0"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                                </a>`;
                        });
                        
                        contentHtml += `</div></div>`;
                    }
                });
                
                contentHtml += `</div></div></div>`;
            }

            const hasBack = selectedDegree !== null;

            // Premium Apple-Style Gradient with extended range for smooth RTL sliding
            let headerGradient = '';
            let buttonBgClass = 'bg-white/90';
            if (activeTab === 'pyq') {
                headerGradient = 'background: linear-gradient(to right, #1e40af 0%, #3b82f6 25%, #6366f1 50%, #3b82f6 75%, #1e40af 100%);';
            } else if (activeTab === 'notes') {
                headerGradient = 'background: linear-gradient(to right, #c2410c 0%, #f97316 25%, #ef4444 50%, #f97316 75%, #c2410c 100%);';
            } else if (activeTab === 'assignments') {
                headerGradient = 'background: linear-gradient(to right, #15803d 0%, #34C759 25%, #10b981 50%, #34C759 75%, #15803d 100%);';
            } else if (activeTab === 'practicals') {
                headerGradient = 'background: linear-gradient(to right, #7e22ce 0%, #AF52DE 25%, #ec4899 50%, #AF52DE 75%, #7e22ce 100%);';
            }

            modal.innerHTML = `
                <div class="bg-[#F5F5F7] md:rounded-[28px] md:max-w-5xl w-full h-full md:h-auto md:max-h-[90vh] flex flex-col overflow-hidden shadow-[0_20px_60px_rgba(0,0,0,0.3)]" onclick="event.stopPropagation()">
                    
                    <!-- Fixed Top Bar with Navigation and Gradient -->
                    <div class="flex-shrink-0 border-b border-white/20 modal-header-gradient" style="${headerGradient}">
                        <div class="flex items-center justify-between px-3 py-3 md:px-5 md:py-4">
                            <div class="flex items-center gap-2 flex-1 min-w-0">
                                ${hasBack ? `
                                    <button onclick="goBack()" class="flex-shrink-0 w-8 h-8 md:w-9 md:h-9 flex items-center justify-center rounded-full ${buttonBgClass} backdrop-blur-sm hover:bg-white transition-all active:scale-95 shadow-sm">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="text-gray-700"><polyline points="15 18 9 12 15 6"></polyline></svg>
                                    </button>
                                ` : ''}
                                <h2 class="text-[17px] md:text-[22px] font-bold text-white truncate leading-tight">${breadcrumb}</h2>
                            </div>
                            <button onclick="closeUnifiedModal()" class="flex-shrink-0 w-8 h-8 md:w-9 md:h-9 flex items-center justify-center rounded-full ${buttonBgClass} backdrop-blur-sm hover:bg-white transition-all active:scale-95 shadow-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="text-gray-700"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                            </button>
                        </div>
                        
                        <!-- Premium Pill-Shaped Tabs - Conditionally Show Only Tabs With Data -->
                        <div class="flex gap-1.5 md:gap-2 overflow-x-auto px-3 pb-3 md:px-5 md:pb-4 no-scrollbar">
                            ${(() => {
                                const tabs = [];
                                // Check if each tab has data before displaying
                                if (pyqData && (!selectedDegree || (pyqData[selectedDegree] && (!selectedSubject || pyqData[selectedDegree][selectedSubject])))) {
                                    tabs.push(`<button onclick="switchTab('pyq')" class="flex-shrink-0 px-3 py-1.5 md:px-4 md:py-2 rounded-full font-semibold text-[12px] md:text-[13px] whitespace-nowrap transition-all duration-300 ease-out transform ${activeTab === 'pyq' ? 'bg-white/95 text-blue-600 shadow-lg scale-105' : 'bg-white/40 text-white hover:bg-white/60 hover:scale-102'}">
                                        ðŸ“ PYQ
                                    </button>`);
                                }
                                if (notesData && (!selectedDegree || (notesData[selectedDegree] && (!selectedSubject || notesData[selectedDegree][selectedSubject])))) {
                                    tabs.push(`<button onclick="switchTab('notes')" class="flex-shrink-0 px-3 py-1.5 md:px-4 md:py-2 rounded-full font-semibold text-[12px] md:text-[13px] whitespace-nowrap transition-all duration-300 ease-out transform ${activeTab === 'notes' ? 'bg-white/95 text-orange-600 shadow-lg scale-105' : 'bg-white/40 text-white hover:bg-white/60 hover:scale-102'}">
                                        ðŸ“š Notes
                                    </button>`);
                                }
                                if (assignmentsData && (!selectedDegree || (assignmentsData[selectedDegree] && (!selectedSubject || assignmentsData[selectedDegree][selectedSubject])))) {
                                    tabs.push(`<button onclick="switchTab('assignments')" class="flex-shrink-0 px-3 py-1.5 md:px-4 md:py-2 rounded-full font-semibold text-[12px] md:text-[13px] whitespace-nowrap transition-all duration-300 ease-out transform ${activeTab === 'assignments' ? 'bg-white/95 text-green-600 shadow-lg scale-105' : 'bg-white/40 text-white hover:bg-white/60 hover:scale-102'}">
                                        âœï¸ Assignments
                                    </button>`);
                                }
                                if (practicalsData && (!selectedDegree || (practicalsData[selectedDegree] && (!selectedSubject || practicalsData[selectedDegree][selectedSubject])))) {
                                    tabs.push(`<button onclick="switchTab('practicals')" class="flex-shrink-0 px-3 py-1.5 md:px-4 md:py-2 rounded-full font-semibold text-[12px] md:text-[13px] whitespace-nowrap transition-all duration-300 ease-out transform ${activeTab === 'practicals' ? 'bg-white/95 text-purple-600 shadow-lg scale-105' : 'bg-white/40 text-white hover:bg-white/60 hover:scale-102'}">
                                        ðŸ”¬ Practicals
                                    </button>`);
                                }
                                return tabs.join('');
                            })()}
                        </div>
                    </div>
                    
                    <!-- Scrollable Content Area -->
                    <div class="flex-1 overflow-hidden">
                        ${contentHtml}
                    </div>
                </div>`;

            // Attach filter event listeners
            setTimeout(() => {
                const degreeFilter = modal.querySelector('#degreeFilter');
                if (degreeFilter) {
                    degreeFilter.addEventListener('input', (e) => {
                        unifiedModalState.filterText = e.target.value;
                        renderUnifiedModal();
                        setTimeout(() => document.getElementById('degreeFilter')?.focus(), 50);
                    });
                }

                const subjectFilter = modal.querySelector('#subjectFilter');
                if (subjectFilter) {
                    subjectFilter.addEventListener('input', (e) => {
                        unifiedModalState.filterText = e.target.value;
                        renderUnifiedModal();
                        setTimeout(() => document.getElementById('subjectFilter')?.focus(), 50);
                    });
                }

                const semesterFilter = modal.querySelector('#semesterFilter');
                if (semesterFilter) {
                    semesterFilter.addEventListener('change', (e) => {
                        unifiedModalState.filterText = e.target.value;
                        renderUnifiedModal();
                    });
                }

                // Fade in content
                const content = modal.querySelector('.unified-modal-content');
                if (content) {
                    requestAnimationFrame(() => {
                        content.classList.remove('opacity-0');
                    });
                }
            }, 10);
        }

        window.switchTab = function(tab) {
            unifiedModalState.activeTab = tab;
            unifiedModalState.selectedDegree = null;
            unifiedModalState.selectedSubject = null;
            unifiedModalState.filterText = '';
            renderUnifiedModal();
        };

        window.selectDegree = function(degree) {
            unifiedModalState.selectedDegree = degree;
            unifiedModalState.filterText = '';
            renderUnifiedModal();
        };

        window.selectSubject = function(subject) {
            unifiedModalState.selectedSubject = subject;
            unifiedModalState.filterText = '';
            renderUnifiedModal();
        };

        window.goBack = function() {
            if (unifiedModalState.selectedSubject) {
                unifiedModalState.selectedSubject = null;
            } else if (unifiedModalState.selectedDegree) {
                unifiedModalState.selectedDegree = null;
            }
            unifiedModalState.filterText = '';
            renderUnifiedModal();
        };

        window.closeUnifiedModal = function() {
            const modal = document.getElementById('unifiedStudyModal');
            if (modal) modal.remove();
            
            // Restore body scroll when modal closes WITHOUT moving scroll position
            const scrollY = document.body.style.top;
            const savedPosition = parseInt(scrollY || '0') * -1;
            
            document.body.style.position = '';
            document.body.style.top = '';
            document.body.style.width = '';
            document.body.style.overflow = '';
            
            // Stay at exact same position - NO scrolling, use requestAnimationFrame for instant restore
            requestAnimationFrame(() => {
                window.scrollTo({
                    top: savedPosition,
                    left: 0,
                    behavior: 'instant'
                });
            });
            
            console.log('âœ… Modal closed - scroll position maintained at:', savedPosition);
        };

        // PYQ Modal Functions with Navigation Stack
        let pyqModalStack = [];
        
        window.openPyqDegreeModal = function(degree) {
            const degreeData = pyqData[degree];
            let content = `
                <div class="p-6 overflow-y-auto max-h-[calc(80vh-88px)] space-y-3">`;
            
            for (const subject in degreeData) {
                const subjectData = degreeData[subject];
                if (typeof subjectData === 'object' && !subjectData.url) {
                    content += `
                        <button onclick="openPyqSubjectModal('${degree}', '${subject.replace(/'/g, "\\'")}')" class="w-full flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-purple-100 hover:from-purple-100 hover:to-purple-200 rounded-lg transition-all shadow-sm hover:shadow-md text-left border border-purple-200">
                            <h4 class="text-md font-bold text-gray-800">${subject}</h4>
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>`;
                } else {
                    content += `
                        <a href="${subjectData}" target="_blank" class="flex items-center gap-2 p-4 bg-gray-50 rounded-lg hover:bg-blue-100 transition-colors border border-gray-200">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                            <span class="font-semibold text-sm">${subject}</span>
                        </a>`;
                }
            }
            content += `</div>`;
            
            // Create or update modal
            let modal = document.getElementById('pyqNavigationModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'pyqNavigationModal';
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4';
                modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
                document.body.appendChild(modal);
            }
            
            pyqModalStack = [{ degree, content, title: `${degree} - PYQ` }];
            updatePyqModal();
        };
        
        window.openPyqSubjectModal = function(degree, subject) {
            const subjectData = pyqData[degree][subject];
            let content = `<div class="p-6 overflow-y-auto max-h-[calc(80vh-88px)] space-y-4">`;
            
            for (const semester in subjectData) {
                const files = subjectData[semester];
                if (Array.isArray(files) && files.length > 0) {
                    content += `
                        <div class="border rounded-lg p-4 bg-gradient-to-r from-gray-50 to-gray-100">
                            <h5 class="text-lg font-bold text-gray-800 mb-3 uppercase flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                                ${semester}
                            </h5>
                            <div class="grid grid-cols-1 gap-2">`;
                    
                    files.forEach(file => {
                        content += `
                            <a href="${file.url}" target="_blank" class="flex items-center gap-3 p-3 bg-white rounded-lg hover:bg-blue-50 transition-colors border border-gray-200 hover:border-blue-300 group">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-blue-600 flex-shrink-0 group-hover:scale-110 transition-transform"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                                <span class="font-semibold text-sm flex-1">${file.name}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 group-hover:text-blue-600"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                            </a>`;
                    });
                    
                    content += `</div></div>`;
                }
            }
            content += `</div>`;
            
            pyqModalStack.push({ degree, subject, content, title: `${subject} - PYQ` });
            updatePyqModal();
        };
        
        function updatePyqModal() {
            const modal = document.getElementById('pyqNavigationModal');
            if (!modal) return;

            const current = pyqModalStack[pyqModalStack.length - 1];
            const hasBack = pyqModalStack.length > 1;

            // keep modal size constant; place dynamic content inside .pyq-modal-content
            modal.innerHTML = `
                <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[80vh] overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
                    <div class="flex items-center justify-between p-6 border-b bg-gradient-to-r from-blue-500 to-blue-600">
                        <div class="flex items-center gap-3">
                            ${hasBack ? `
                                <button id="pyq-back-btn" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                                </button>
                            ` : ''}
                            <h2 class="text-2xl font-bold text-white">${current.title}</h2>
                        </div>
                        <button id="pyq-close-btn" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                    </div>
                    <div class="pyq-modal-content-wrapper p-4">
                        <div class="pyq-modal-content opacity-0 transition-opacity duration-200">${current.content}</div>
                    </div>
                </div>`;

            // Attach handlers after content is in DOM
            const backBtn = modal.querySelector('#pyq-back-btn');
            if (backBtn) backBtn.addEventListener('click', function (e) { e.stopPropagation(); goBackPyq(); });

            const closeBtn = modal.querySelector('#pyq-close-btn');
            if (closeBtn) closeBtn.addEventListener('click', function (e) { e.stopPropagation(); modal.remove(); });

            // fade in the inner content for smooth transition
            const inner = modal.querySelector('.pyq-modal-content');
            if (inner) {
                // force a reflow then remove opacity-0 to trigger transition
                requestAnimationFrame(() => {
                    inner.classList.remove('opacity-0');
                });
            }
        }

        window.goBackPyq = function() {
            if (pyqModalStack.length > 1) {
                pyqModalStack.pop();
                updatePyqModal();
            }
        };

        function renderPracticalsModal() {
            let content = '<div class="p-6"><button onclick="openUnifiedModal(\'practicals\')" class="w-full py-4 px-6 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all text-lg flex items-center justify-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg><span>Browse Practicals</span></button></div>';
            practicalsContent.innerHTML = content;
        }

        function renderAssignmentsModal() {
            let content = '<div class="p-6"><button onclick="openUnifiedModal(\'assignments\')" class="w-full py-4 px-6 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all text-lg flex items-center justify-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg><span>Browse Assignments</span></button></div>';
            assignmentsContent.innerHTML = content;
        }

        function renderNotesModal() {
            let content = '<div class="p-6"><button onclick="openUnifiedModal(\'notes\')" class="w-full py-4 px-6 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all text-lg flex items-center justify-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg><span>Browse Notes</span></button></div>';
            notesContent.innerHTML = content;
        }

        // Notes Modal Functions with Navigation Stack
        let notesModalStack = [];
        
        window.openNotesDegreeModal = function(degree) {
            const degreeData = notesData[degree];
            let content = `
                <div class="p-6 overflow-y-auto max-h-[calc(80vh-88px)] space-y-3">`;
            
            for (const subject in degreeData) {
                const subjectData = degreeData[subject];
                if (typeof subjectData === 'object' && !subjectData.url) {
                    content += `
                        <button onclick="openNotesSubjectModal('${degree}', '${subject.replace(/'/g, "\\'")}')" class="w-full flex items-center justify-between p-4 bg-gradient-to-r from-teal-50 to-teal-100 hover:from-teal-100 hover:to-teal-200 rounded-lg transition-all shadow-sm hover:shadow-md text-left border border-teal-200">
                            <h4 class="text-md font-bold text-gray-800">${subject}</h4>
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>`;
                } else {
                    content += `
                        <a href="${subjectData}" target="_blank" class="flex items-center gap-2 p-4 bg-gray-50 rounded-lg hover:bg-green-100 transition-colors border border-gray-200">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                            <span class="font-semibold text-sm">${subject}</span>
                        </a>`;
                }
            }
            content += `</div>`;
            
            // Create or update modal
            let modal = document.getElementById('notesNavigationModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'notesNavigationModal';
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4';
                modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
                document.body.appendChild(modal);
            }
            
            notesModalStack = [{ degree, content, title: `${degree} - Notes` }];
            updateNotesModal();
        };
        
        window.openNotesSubjectModal = function(degree, subject) {
            const subjectData = notesData[degree][subject];
            let content = `<div class="p-6 overflow-y-auto max-h-[calc(80vh-88px)] space-y-4">`;
            
            for (const semester in subjectData) {
                const files = subjectData[semester];
                if (Array.isArray(files) && files.length > 0) {
                    content += `
                        <div class="border rounded-lg p-4 bg-gradient-to-r from-gray-50 to-gray-100">
                            <h5 class="text-lg font-bold text-gray-800 mb-3 uppercase flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                                ${semester}
                            </h5>
                            <div class="grid grid-cols-1 gap-2">`;
                    
                    files.forEach(file => {
                        content += `
                            <a href="${file.url}" target="_blank" class="flex items-center gap-3 p-3 bg-white rounded-lg hover:bg-green-50 transition-colors border border-gray-200 hover:border-green-300 group">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-green-600 flex-shrink-0 group-hover:scale-110 transition-transform"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                                <span class="font-semibold text-sm flex-1">${file.name}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 group-hover:text-green-600"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                            </a>`;
                    });
                    
                    content += `</div></div>`;
                }
            }
            content += `</div>`;
            
            notesModalStack.push({ degree, subject, content, title: `${subject} - Notes` });
            updateNotesModal();
        };
        
        function updateNotesModal() {
            const modal = document.getElementById('notesNavigationModal');
            if (!modal) return;
            
            const current = notesModalStack[notesModalStack.length - 1];
            const hasBack = notesModalStack.length > 1;
            
            modal.innerHTML = `
                <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[80vh] overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
                    <div class="flex items-center justify-between p-6 border-b bg-gradient-to-r from-green-500 to-green-600">
                        <div class="flex items-center gap-3">
                            ${hasBack ? `
                                <button onclick="goBackNotes()" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                                </button>
                            ` : ''}
                            <h2 class="text-2xl font-bold text-white">${current.title}</h2>
                        </div>
                        <button onclick="document.getElementById('notesNavigationModal').remove()" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                    </div>
                    ${current.content}
                </div>`;
        }
        
        window.goBackNotes = function() {
            if (notesModalStack.length > 1) {
                notesModalStack.pop();
                updateNotesModal();
            }
        };

        // Assignments Modal Functions with Navigation Stack
        let assignmentsModalStack = [];
        
        window.openAssignmentsDegreeModal = function(degree) {
            const degreeData = assignmentsData[degree];
            let content = `
                <div class="p-6 overflow-y-auto max-h-[calc(80vh-88px)] space-y-3">`;
            
            for (const subject in degreeData) {
                const subjectData = degreeData[subject];
                if (typeof subjectData === 'object' && !subjectData.url) {
                    content += `
                        <button onclick="openAssignmentsSubjectModal('${degree}', '${subject.replace(/'/g, "\\'")}')" class="w-full flex items-center justify-between p-4 bg-gradient-to-r from-pink-50 to-pink-100 hover:from-pink-100 hover:to-pink-200 rounded-lg transition-all shadow-sm hover:shadow-md text-left border border-pink-200">
                            <h4 class="text-md font-bold text-gray-800">${subject}</h4>
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>`;
                } else {
                    content += `
                        <a href="${subjectData}" target="_blank" class="flex items-center gap-2 p-4 bg-gray-50 rounded-lg hover:bg-purple-100 transition-colors border border-gray-200">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                            <span class="font-semibold text-sm">${subject}</span>
                        </a>`;
                }
            }
            content += `</div>`;
            
            // Create or update modal
            let modal = document.getElementById('assignmentsNavigationModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'assignmentsNavigationModal';
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4';
                modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
                document.body.appendChild(modal);
            }
            
            assignmentsModalStack = [{ degree, content, title: `${degree} - Assignments` }];
            updateAssignmentsModal();
        };
        
        window.openAssignmentsSubjectModal = function(degree, subject) {
            const subjectData = assignmentsData[degree][subject];
            let content = `<div class="p-6 overflow-y-auto max-h-[calc(80vh-88px)] space-y-4">`;
            
            for (const semester in subjectData) {
                const files = subjectData[semester];
                if (Array.isArray(files) && files.length > 0) {
                    content += `
                        <div class="border rounded-lg p-4 bg-gradient-to-r from-gray-50 to-gray-100">
                            <h5 class="text-lg font-bold text-gray-800 mb-3 uppercase flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                                ${semester}
                            </h5>
                            <div class="grid grid-cols-1 gap-2">`;
                    
                    files.forEach(file => {
                        content += `
                            <a href="${file.url}" target="_blank" class="flex items-center gap-3 p-3 bg-white rounded-lg hover:bg-purple-50 transition-colors border border-gray-200 hover:border-purple-300 group">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-purple-600 flex-shrink-0 group-hover:scale-110 transition-transform"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                                <span class="font-semibold text-sm flex-1">${file.name}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 group-hover:text-purple-600"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                            </a>`;
                    });
                    
                    content += `</div></div>`;
                }
            }
            content += `</div>`;
            
            assignmentsModalStack.push({ degree, subject, content, title: `${subject} - Assignments` });
            updateAssignmentsModal();
        };
        
        function updateAssignmentsModal() {
            const modal = document.getElementById('assignmentsNavigationModal');
            if (!modal) return;
            
            const current = assignmentsModalStack[assignmentsModalStack.length - 1];
            const hasBack = assignmentsModalStack.length > 1;
            
            modal.innerHTML = `
                <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[80vh] overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
                    <div class="flex items-center justify-between p-6 border-b bg-gradient-to-r from-purple-500 to-purple-600">
                        <div class="flex items-center gap-3">
                            ${hasBack ? `
                                <button onclick="goBackAssignments()" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                                </button>
                            ` : ''}
                            <h2 class="text-2xl font-bold text-white">${current.title}</h2>
                        </div>
                        <button onclick="document.getElementById('assignmentsNavigationModal').remove()" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                    </div>
                    ${current.content}
                </div>`;
        }
        
        window.goBackAssignments = function() {
            if (assignmentsModalStack.length > 1) {
                assignmentsModalStack.pop();
                updateAssignmentsModal();
            }
        };

        // Practicals Modal Functions with Navigation Stack
        let practicalsModalStack = [];
        
        window.openPracticalsDegreeModal = function(degree) {
            const degreeData = practicalsData[degree];
            let content = `
                <div class="p-6 overflow-y-auto max-h-[calc(80vh-88px)] space-y-3">`;
            
            for (const subject in degreeData) {
                const subjectData = degreeData[subject];
                if (typeof subjectData === 'object' && !subjectData.url) {
                    content += `
                        <button onclick="openPracticalsSubjectModal('${degree}', '${subject.replace(/'/g, "\\'")}')" class="w-full flex items-center justify-between p-4 bg-gradient-to-r from-amber-50 to-amber-100 hover:from-amber-100 hover:to-amber-200 rounded-lg transition-all shadow-sm hover:shadow-md text-left border border-amber-200">
                            <h4 class="text-md font-bold text-gray-800">${subject}</h4>
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
                        </button>`;
                } else {
                    content += `
                        <a href="${subjectData}" target="_blank" class="flex items-center gap-2 p-4 bg-gray-50 rounded-lg hover:bg-orange-100 transition-colors border border-gray-200">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                            <span class="font-semibold text-sm">${subject}</span>
                        </a>`;
                }
            }
            content += `</div>`;
            
            // Create or update modal
            let modal = document.getElementById('practicalsNavigationModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'practicalsNavigationModal';
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4';
                modal.onclick = function(e) { if (e.target === modal) modal.remove(); };
                document.body.appendChild(modal);
            }
            
            practicalsModalStack = [{ degree, content, title: `${degree} - Practicals` }];
            updatePracticalsModal();
        };
        
        window.openPracticalsSubjectModal = function(degree, subject) {
            const subjectData = practicalsData[degree][subject];
            let content = `<div class="p-6 overflow-y-auto max-h-[calc(80vh-88px)] space-y-4">`;
            
            for (const semester in subjectData) {
                const files = subjectData[semester];
                if (Array.isArray(files) && files.length > 0) {
                    content += `
                        <div class="border rounded-lg p-4 bg-gradient-to-r from-gray-50 to-gray-100">
                            <h5 class="text-lg font-bold text-gray-800 mb-3 uppercase flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                                ${semester}
                            </h5>
                            <div class="grid grid-cols-1 gap-2">`;
                    
                    files.forEach(file => {
                        content += `
                            <a href="${file.url}" target="_blank" class="flex items-center gap-3 p-3 bg-white rounded-lg hover:bg-orange-50 transition-colors border border-gray-200 hover:border-orange-300 group">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-orange-600 flex-shrink-0 group-hover:scale-110 transition-transform"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                                <span class="font-semibold text-sm flex-1">${file.name}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400 group-hover:text-orange-600"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                            </a>`;
                    });
                    
                    content += `</div></div>`;
                }
            }
            content += `</div>`;
            
            practicalsModalStack.push({ degree, subject, content, title: `${subject} - Practicals` });
            updatePracticalsModal();
        };
        
        function updatePracticalsModal() {
            const modal = document.getElementById('practicalsNavigationModal');
            if (!modal) return;
            
            const current = practicalsModalStack[practicalsModalStack.length - 1];
            const hasBack = practicalsModalStack.length > 1;
            
            modal.innerHTML = `
                <div class="bg-white rounded-2xl max-w-4xl w-full max-h-[80vh] overflow-hidden shadow-2xl" onclick="event.stopPropagation()">
                    <div class="flex items-center justify-between p-6 border-b bg-gradient-to-r from-orange-500 to-orange-600">
                        <div class="flex items-center gap-3">
                            ${hasBack ? `
                                <button onclick="goBackPracticals()" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"></polyline></svg>
                                </button>
                            ` : ''}
                            <h2 class="text-2xl font-bold text-white">${current.title}</h2>
                        </div>
                        <button onclick="document.getElementById('practicalsNavigationModal').remove()" class="text-white hover:bg-white/20 rounded-full p-2 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                    </div>
                    ${current.content}
                </div>`;
        }
        
        window.goBackPracticals = function() {
            if (practicalsModalStack.length > 1) {
                practicalsModalStack.pop();
                updatePracticalsModal();
            }
        };

        // Toggle function for collapsible degrees (kept for backward compatibility)
        function toggleDegree(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById(id + '-icon');
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
            } else {
                content.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
            }
        }
        
        window.toggleDegree = toggleDegree;

        function renderSellForm(item = 'Book', args = {}) {
            const isBookFlow = item === 'Book';
            const contentTarget = sellBookModalContent;

            if (isBookFlow && (!args.stage || args.stage === 'primary')) {
                sellFlowState = { stage: 'primary', primary: null, secondary: null };
            }
            
            if (!isBookFlow) { // This is for essentials like Blazer, Lab Coat - redirect to sell page
                ModalManager.close('sellBookModal');
                setTimeout(() => {
                    window.location.href = 'my-library.html?action=sell';
                }, 300);
                return;
            }

            const getSubtitle = () => {
                if (sellFlowState.stage === 'primary') return 'First, select your main stream';
                if (sellFlowState.stage === 'secondary') return `Next, select your subject in ${sellFlowState.primary}`;
            };

            const headerHTML = `
                <div class="flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <div class="flex items-center gap-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-orange-500"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                        <div><h2 class="text-2xl font-bold">Sell Your Book</h2><p class="text-gray-600">${getSubtitle()}</p></div>
                    </div>
                    <button id="closeSellModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                </div>`;
            
            let bodyHTML = '';

            if (sellFlowState.stage === 'primary') {
                const streams = Object.keys(sellStreamsData);
                bodyHTML = `<div class="space-y-3">${streams.map(stream => `<button class="stream-btn w-full p-4 text-left border rounded-lg hover:bg-gray-100 transition-colors button-animation" data-stream="${stream}">${stream}</button>`).join('')}</div>`;
            }
            
            if (sellFlowState.stage === 'secondary') {
                const subStreams = sellStreamsData[sellFlowState.primary];
                bodyHTML = `
                    <button class="back-btn font-semibold text-blue-600 mb-4 hover:underline button-animation" data-target="primary">â† Back to main streams</button>
                    <div class="space-y-3">${subStreams.map(stream => `<button class="stream-btn w-full p-4 text-left border rounded-lg hover:bg-gray-100 transition-colors button-animation" data-stream="${stream}">${stream}</button>`).join('')}</div>`;
            }

            contentTarget.innerHTML = headerHTML + `<div class="flex-grow p-8 overflow-y-auto">${bodyHTML}</div>`;

            const setupStreamButtons = () => {
                contentTarget.querySelectorAll('.stream-btn').forEach(btn => {
                    btn.onclick = preventDoubleClick(() => {
                        const stream = btn.dataset.stream;
                        if (sellFlowState.stage === 'primary') {
                            sellFlowState.primary = stream;
                            if (sellStreamsData[stream] && sellStreamsData[stream].length > 0) {
                                sellFlowState.stage = 'secondary';
                            } else {
                                // Redirect to my-library sell page instead of showing form
                                ModalManager.close('sellBookModal');
                                setTimeout(() => {
                                    window.location.href = 'my-library.html?action=sell';
                                }, 300);
                                return;
                            }
                        } else {
                            sellFlowState.secondary = stream;
                            // Redirect to my-library sell page instead of showing form
                            ModalManager.close('sellBookModal');
                            setTimeout(() => {
                                window.location.href = 'my-library.html?action=sell';
                            }, 300);
                            return;
                        }
                        renderSellForm('Book', sellFlowState);
                    });
                });
            };

            if (sellFlowState.stage === 'primary' || sellFlowState.stage === 'secondary') {
                setupStreamButtons();
            }
            
            contentTarget.querySelectorAll('.back-btn').forEach(btn => {
                btn.onclick = preventDoubleClick(() => {
                    const targetStage = btn.dataset.target;
                    sellFlowState.stage = targetStage;
                    if (targetStage === 'primary') { sellFlowState.primary = null; sellFlowState.secondary = null; }
                    if (targetStage === 'secondary') { sellFlowState.secondary = null; }
                    renderSellForm('Book', sellFlowState);
                });
            });


        }
        
        // --- STUDY MATERIAL FLOW ---
        function renderStudyMaterialFlow(type) {
            // Reset state
            if (!studyMaterialFlowState.stage || studyMaterialFlowState.stage === 'start') {
                 studyMaterialFlowState = { stage: 'stream', type: type, stream: null, subStream: null, year: null, semester: null, subject: null };
            }
            
            const content = itemSelectionContent;
            let bodyHTML = '';

            const renderHeader = (subtitle) => {
                 return `<div class="sticky top-0 bg-white/80 backdrop-blur-sm z-10 p-8 pb-4 mb-4"><h2 class="text-4xl font-bold text-center">Find ${studyMaterialFlowState.type}</h2><p class="text-center text-gray-600">${subtitle}</p></div>`;
            };
            
            const mainContent = document.createElement('div');
            mainContent.className = 'px-8 pb-8';

            switch(studyMaterialFlowState.stage) {
                case 'stream':
                    const streams = Object.keys(sellStreamsData);
                    bodyHTML += renderHeader('Select your main stream');
                    mainContent.innerHTML = `<div class="space-y-3">${streams.map(stream => `<button class="flow-btn w-full p-4 text-left border rounded-lg hover:bg-gray-100 transition-colors button-animation" data-value="${stream}">${stream}</button>`).join('')}</div>`;
                    break;
                
                case 'subStream':
                    const subStreams = sellStreamsData[studyMaterialFlowState.stream];
                    bodyHTML += renderHeader(`Select subject in ${studyMaterialFlowState.stream}`);
                    mainContent.innerHTML = `<button class="flow-back-btn font-semibold text-blue-600 mb-4 hover:underline button-animation" data-target="stream">â† Back to streams</button>`;
                    mainContent.innerHTML += `<div class="space-y-3">${subStreams.map(sub => `<button class="flow-btn w-full p-4 text-left border rounded-lg hover:bg-gray-100 transition-colors button-animation" data-value="${sub}">${sub}</button>`).join('')}</div>`;
                    break;
                
                case 'year':
                    bodyHTML += renderHeader(`Select Year`);
                    const backTarget = sellStreamsData[studyMaterialFlowState.stream]?.length > 0 ? 'subStream' : 'stream';
                    let yearContent = `<button class="flow-back-btn font-semibold text-blue-600 mb-4 hover:underline button-animation" data-target="${backTarget}">â† Back</button>`;
                    const years = Array.from({length: 11}, (_, i) => 2025 - i); // 2025 to 2015
                    if (type === 'PYQ') {
                         yearContent += `<button class="flow-btn w-full p-4 text-left border rounded-lg hover:bg-gray-100 transition-colors bg-blue-50 border-blue-200 font-bold button-animation" data-value="PYQ Pack">PYQ Pack</button><hr class="my-4">`;
                    }
                    yearContent += `<div class="grid grid-cols-3 sm:grid-cols-4 gap-4">${years.map(y => `<button class="flow-btn w-full p-4 text-center border rounded-lg hover:bg-gray-100 transition-colors button-animation" data-value="${y}">${y}</button>`).join('')}</div>`;
                    mainContent.innerHTML = yearContent;
                    break;
                
                 case 'result':
                    bodyHTML += renderHeader(`Results for ${studyMaterialFlowState.year}`);
                    mainContent.innerHTML = `<button class="flow-back-btn font-semibold text-blue-600 mb-4 hover:underline button-animation" data-target="year">â† Back to Year</button>`;
                    mainContent.innerHTML += `<div class="text-center p-8 bg-gray-100 rounded-lg">
                        <p class="font-semibold">${studyMaterialFlowState.stream} / ${studyMaterialFlowState.subStream || ''} / ${studyMaterialFlowState.year}</p>
                        <h3 class="text-2xl font-bold my-4">Here are your ${studyMaterialFlowState.type}s!</h3>
                        <p class="text-gray-600">(This is a placeholder. In a real app, PDFs would be listed here.)</p>
                        <a href="#" class="mt-6 inline-block bg-blue-600 text-white font-bold py-3 px-6 rounded-lg button-animation">Download Pack</a>
                    </div>`;
                    break;
            }

            content.innerHTML = bodyHTML;
            content.appendChild(mainContent);
            
            content.querySelectorAll('.flow-btn').forEach(btn => {
                btn.onclick = preventDoubleClick(function() {
                    const value = btn.dataset.value;
                    let shouldContinueFlow = true;

                    switch(studyMaterialFlowState.stage) {
                        case 'stream':
                            studyMaterialFlowState.stream = value;
                            studyMaterialFlowState.stage = (sellStreamsData[value]?.length > 0) ? 'subStream' : 'year';
                            break;
                        case 'subStream':
                            studyMaterialFlowState.subStream = value;
                            studyMaterialFlowState.stage = 'year';
                            break;
                        case 'year':
                            studyMaterialFlowState.year = value;
                            
                            if (studyMaterialFlowState.type === 'PYQ') {
                                const pyqLinks = {
                                    '2025': 'https://drive.google.com/file/d/1hIdnFZJT1649n02wTNNlIDoLGOob07cv/view?usp=sharing',
                                    '2024': 'https://drive.google.com/file/d/1oKI09ucdoO6sMO2hQy6SPDjDumFCuDeR/view?usp=sharing',
                                    '2023': 'https://drive.google.com/file/d/1zLgeB5epCJj5EJMFWEKfWyCQpJU4MZdL/view?usp=sharing'
                                };
                                if (pyqLinks[value]) {
                                    window.open(pyqLinks[value], '_blank');
                                    shouldContinueFlow = false;
                                } else {
                                     studyMaterialFlowState.stage = 'result'; // Go to placeholder if no link
                                }
                            }
                            
                            else if (studyMaterialFlowState.type === 'Assignments') {
                                let link = studyMaterialFlowState.subStream === 'Physics'
                                    ? 'https://drive.google.com/file/d/1OIagJmezoDjftt67HYVnNi6AY46LK3zb/view?usp=sharing'
                                    : 'https://drive.google.com/file/d/1tZ-gX-Uc2PSImuyY4M_cJj9Meb32v3tN/view?usp=sharing';
                                window.open(link, '_blank');
                                shouldContinueFlow = false;
                            }
                            
                            else if (studyMaterialFlowState.type === 'Practicals') {
                                const practicalLinks = [
                                    'https://drive.google.com/file/d/11nIrNczcpaRMAy40VKv0QYMmJwomzF-e/view?usp=sharing', 'https://drive.google.com/file/d/1C3wrmx_EWjb6qodm4192FC7ki-XxMu1C/view?usp=sharing',
                                    'https://drive.google.com/file/d/1NPFiC4yw0NRw46guR1Ycxmxcz2xreRWn/view?usp=sharing', 'https://drive.google.com/file/d/1PSN3n9SPp86I34qZJIBI4QTi8_Nv9uHF/view?usp=sharing',
                                    'https://drive.google.com/file/d/1QUC_pOMbqENClvKYFyQ_hKa8RvWko4w_/view?usp=sharing', 'https://drive.google.com/file/d/1XI-bMQ7wNo2_t4ipOVdCgAVKT4DfYWCX/view?usp=sharing',
                                    'https://drive.google.com/file/d/1j7UWWO1hW9fzDCPzgdN_IbEzppr2MSEA/view?usp=sharing', 'https://drive.google.com/file/d/1qL_0g6xFcL1tAygFOn3a6Y_vbwtSMyjS/view?usp=sharing',
                                    'https://drive.google.com/file/d/1uGbG8jNLO2o9ziSAbjR-pyBogevMDRjB/view?usp=sharing', 'https://drive.google.com/file/d/1zFs2Zq8DmeMfJDqJf39RQvwJaRceXHrP/view?usp=sharing'
                                ];
                                showToast(`Starting download of ${practicalLinks.length} practical files...`);
                                practicalLinks.forEach((link, index) => {
                                    setTimeout(() => { triggerDownload(getDriveDownloadUrl(link)); }, index * 500);
                                });
                                shouldContinueFlow = false;
                            }
                            
                            else {
                                studyMaterialFlowState.stage = 'result';
                            }
                            break;
                    }

                    if (shouldContinueFlow) {
                        renderStudyMaterialFlow(studyMaterialFlowState.type);
                    }
                });
            });
            
            content.querySelectorAll('.flow-back-btn').forEach(btn => {
                btn.onclick = preventDoubleClick(function() {
                    studyMaterialFlowState.stage = btn.dataset.target;
                    renderStudyMaterialFlow(type);
                });
            });
        }
        
        // --- ABOUT US SCROLL ANIMATION ---
        function setupScrollAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, {
                rootMargin: '0px 0px -50px 0px'
            });

            document.querySelectorAll('.scroll-reveal').forEach(el => {
                observer.observe(el);
            });
        }
        
        
        // --- AcademyX Search and Render ---
        const academyXContainer = document.getElementById('academy-x-content');
        const academySearchInput = document.getElementById('academySearchInput');
        const academySearchResults = document.getElementById('academySearchResults');

        function toggleAiCourseAccordion(card) {
            const wrapper = card.closest('#ai-courses-grid');
            if (!wrapper) return;

            const allCards = wrapper.querySelectorAll('.ai-course-card-apple');
            const targetPanel = card.querySelector('.details-panel');
            const isOpening = !card.classList.contains('expanded');

            allCards.forEach(c => {
                if (c !== card) {
                    c.classList.remove('expanded');
                    c.querySelector('.details-panel').style.maxHeight = null;
                }
            });

            if (isOpening) { 
                card.classList.add('expanded');
                targetPanel.style.maxHeight = '500px'; // Fixed height to ensure full visibility
                targetPanel.style.overflow = 'visible'; // Ensure content is not cut off
            } else {
                card.classList.remove('expanded');
                targetPanel.style.maxHeight = '0';
                targetPanel.style.overflow = 'hidden';
            }
        }

        function renderAcademyXSection(config) {
            const { id, title, data, itemRenderer, extraButton, wrapperClass = '' } = config;
            
            const sectionWrapper = document.createElement('div');
            sectionWrapper.id = `${id}-section`;
            if (wrapperClass) sectionWrapper.className = wrapperClass;
            
            // Use the new grid-based expandable wrapper
            let contentHTML = `
                <h3 id="${id}-heading" class="text-3xl font-bold mb-8 text-center">${title}</h3>
                <div id="${id}-wrapper" class="expandable-grid-wrapper" data-expanded="false">
                    <div id="${id}-grid" class="${config.gridClass || 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8'}">
                        ${data.map(itemRenderer).join('')}
                    </div>
                </div>
                <div id="view-more-${id}" class="text-center mt-12 space-y-2">
                    <button class="view-toggle-btn mb-1 block mx-auto" data-toggle="expand" data-controls="${id}-wrapper" data-view-more-text="View More" data-view-less-text="View Less">View More</button>
                    ${extraButton ? `<a href="${extraButton.link}" target="_blank" class="view-toggle-btn bg-blue-600 text-white hover:bg-blue-700 inline-block">${extraButton.text}</a>` : ''}
                </div>
            `;
            sectionWrapper.innerHTML = contentHTML;
            academyXContainer.appendChild(sectionWrapper);
        }

        function renderAcademyX() {
            academyXContainer.innerHTML = ''; 

            renderAcademyXSection({
                id: 'ai-courses',
                title: 'Featured AI & Machine Learning Courses',
                data: aiCoursesData,
                gridClass: 'grid grid-cols-1 md:grid-cols-2 gap-6',
                itemRenderer: (course, index) => {
                    const topicsHTML = course.topics ? `
                        <h4 class="font-semibold mt-4 mb-2 text-gray-700">Topics Covered:</h4>
                        <ul class="list-disc list-inside space-y-1 text-gray-600 text-sm">
                            ${course.topics.map(topic => `<li>${topic}</li>`).join('')}
                        </ul>
                    ` : '';

                    return `
                    <div class="course-card bg-white rounded-xl shadow-sm overflow-hidden cursor-pointer transition-all duration-300 hover:shadow-lg hover:scale-[1.02]" data-index="${index}">
                        <img src="${course.imageUrl}" alt="${course.name}" class="w-full h-40 object-cover" onerror="this.src='https://placehold.co/600x240/F0F0F0/333?text=Image+Unavailable'">
                        <div class="p-5">
                            <div class="flex justify-between items-start gap-4">
                                <div>
                                    <p class="text-sm font-semibold text-indigo-600">${course.provider}</p>
                                    <h3 class="text-lg font-bold mt-1 text-gray-900">${course.name}</h3>
                                    <p class="text-sm text-gray-500 mt-2">Duration: ${course.short_duration}</p>
                                </div>
                                <div class="flex-shrink-0">
                                     <img src="${course.logo}" alt="${course.provider} Logo" class="h-12 w-auto object-contain" onerror="this.src='https://placehold.co/100x50/F0F0F0/333?text=Logo'">
                                </div>
                            </div>
                        </div>
                        <div class="course-details px-5">
                            <p class="text-gray-600 text-sm">${course.description}</p>
                            ${topicsHTML}
                            <a href="${course.link}" target="_blank" class="block w-full text-center bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors button-animation text-base mt-4">Start Learning</a>
                        </div>
                        <div class="bg-gray-50/70 px-5 py-3 text-center text-xs font-semibold text-gray-500 border-t border-gray-200 flex items-center justify-center gap-2">
                            <div class="plus-icon text-indigo-500 font-bold text-lg leading-none">+</div>
                            <span>Details Dekhein</span>
                        </div>
                    </div>
                `
                },
                extraButton: { link: 'https://www.classcentral.com/search?q=ai', text: 'Explore Free Courses' }
            });

            renderAcademyXSection({
                id: 'platforms',
                title: 'Explore by Platform', // This title is now inside the section
                data: platformCardData,
                gridClass: 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8',
                itemRenderer: platform => `
                    <a href="${platform.link}" target="_blank" class="card-apple-platform">
                        <div class="card-visual ${platform.gradientClass}" style="background-image: url('${platform.bgImage}');">
                            ${platform.iconHtml}
                        </div>
                        <div class="card-content-platform">
                            <h2 class="text-2xl font-bold text-gray-900 mb-2">${platform.name}</h2>
                            <p class="text-gray-600 flex-grow mb-6">${platform.description}</p>
                            <span class="card-link-platform mt-auto">Start learning free &rarr;</span>
                        </div>
                    </a>`,
                extraButton: { link: 'https://www.classcentral.com/report/free-certificates/', text: 'View All Courses' }
            });

            renderAcademyXSection({
                id: 'universities',
                title: 'Top Universities',
                wrapperClass: 'bg-white p-6 md:p-8 rounded-2xl shadow-lg',
                gridClass: 'grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6',
                data: academyXData.universities,
                itemRenderer: uni => `
                    <a href="${uni.link}" target="_blank" 
                       class="relative block rounded-xl shadow-lg overflow-hidden h-52 bg-gray-700 bg-center bg-cover
                              transform transition-all duration-300 hover:scale-105 hover:shadow-2xl" 
                       style="background-image: url('${uni.imageUrl}')">
                        
                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
                        
                        <div class="absolute inset-0 p-4 flex flex-col justify-end">
                            <h3 class="font-playfair text-white text-lg font-bold">${uni.name}</h3>
                            <p class="bg-blue-600 text-white text-xs font-semibold mt-2 px-3 py-1 rounded-full w-fit">${uni.courses.toLocaleString()} courses</p>
                        </div>
                    </a>`,
                extraButton: { link: 'https://www.classcentral.com/universities', text: 'View All Universities' }
            });
            
             renderAcademyXSection({
                id: 'subjects',
                title: 'Subjects',
                gridClass: 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8',
                wrapperClass: 'bg-white p-6 md:p-8 rounded-2xl shadow-lg',
                data: subjectsData,
                itemRenderer: (subject, index) => `
                    <div class="subject-item bg-white rounded-lg shadow-lg overflow-hidden transform transition-transform duration-300 hover:scale-105 hover:shadow-2xl cursor-pointer" data-subject-index="${index}">
                        <img src="${subject.imageUrl}" alt="${subject.name}" class="w-full h-48 object-cover">
                        <div class="p-6">
                            <h2 class="text-2xl font-bold text-gray-900 mb-2 font-playfair">${subject.name}</h2>
                            <p class="text-gray-700 mb-4 text-base">${subject.description}</p>
                            <button class="view-details-subject-btn inline-block ${subject.buttonColor} text-white font-semibold py-2 px-4 rounded-md ${subject.buttonHoverColor} transition-colors duration-300" data-subject-index="${index}">View Details</button>
                        </div>
                    </div>
                `,
                extraButton: { link: 'https://www.classcentral.com/subjects', text: 'View All Subjects' }
            });
            
             document.querySelectorAll('.subject-item, .view-details-subject-btn').forEach(el => {
                el.addEventListener('click', preventDoubleClick(function(e) {
                    e.stopPropagation();
                    const index = e.currentTarget.dataset.subjectIndex;
                    const subject = subjectsData[index];
                    if (subject) {
                        const sentences = subject.details.split('. ').map(s => s.trim()).filter(Boolean);
                        const overview = sentences.slice(0, 2).join('. ') + '.';
                        const features = sentences.slice(2).map(sentence => `<li>${sentence.replace(/,$/, '')}</li>`).join('');

                         itemSelectionContent.innerHTML = `
                            <div class="p-6 md:p-8">
                                <h3 class="text-3xl font-bold text-center mb-2 logo-font">${subject.name}</h3>
                                <p class="text-center text-gray-500 mb-6">${subject.description}</p>
                                <div class="bg-gray-50 p-6 rounded-2xl border text-left space-y-4">
                                    <div>
                                        <h4 class="font-bold text-gray-800 mb-2">Overview</h4>
                                        <p class="text-gray-700">${overview}</p>
                                    </div>
                                    ${features ? `
                                    <div>
                                        <h4 class="font-bold text-gray-800 mb-2">Key Topics & Skills</h4>
                                        <ul class="list-disc list-inside text-gray-700 space-y-1">${features}</ul>
                                    </div>` : ''}
                                </div>
                                <a href="${subject.link}" target="_blank" class="block w-full text-center bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors button-animation mt-6">
                                    Explore Courses
                                </a>
                            </div>`;
                        ModalManager.open('itemSelectionModal');
                    }
                }));
            });
            
            academyXContainer.querySelectorAll('.course-card').forEach(card => {
                card.addEventListener('click', (e) => { if (e.target.tagName.toLowerCase() !== 'a') { card.classList.toggle('expanded'); } });
            });
        }


        academySearchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase().trim();
            if (!searchTerm) {
                academySearchResults.innerHTML = '';
                return;
            }

            const allItems = [...platformCardData, ...academyXData.universities, ...aiCoursesData, ...subjectsData];
            const results = allItems.filter(item => 
                item.name.toLowerCase().includes(searchTerm) || 
                (item.description && item.description.toLowerCase().includes(searchTerm))
            );
            
            if(results.length > 0) {
                 academySearchResults.innerHTML = `
                    <div class="bg-white rounded-2xl shadow-lg border max-h-60 overflow-y-auto">
                        ${results.slice(0, 10).map(item => `
                            <a href="${item.link}" target="_blank" class="block p-4 border-b hover:bg-gray-50 last:border-b-0 button-animation">
                                <p class="font-semibold text-gray-800">${item.name}</p>
                                ${item.description ? `<p class="text-sm text-gray-500">${item.description.substring(0, 60)}...</p>` : ''}
                            </a>
                        `).join('')}
                    </div>`;
            } else {
                 academySearchResults.innerHTML = `<div class="text-center p-4 bg-white rounded-2xl shadow-lg border"><p class="text-gray-500">No results found.</p></div>`;
            }
        });

        const mobileStudyToggle = document.getElementById('mobileStudyMaterialToggle');
        const mobileStudySubmenu = document.getElementById('mobileStudySubmenu');
        const mobileStudyChevron = document.getElementById('mobileStudyChevron');
        const mobileGroupsToggle = document.getElementById('mobileGroupsToggle');
        const mobileGroupsSubmenu = document.getElementById('mobileGroupsSubmenu');
        const mobileGroupsChevron = document.getElementById('mobileGroupsChevron');

        // Accordion toggle for Study Material with smooth animation
        if (mobileStudyToggle && mobileStudySubmenu && mobileStudyChevron) {
            mobileStudyToggle.addEventListener('click', function() {
                const isHidden = mobileStudySubmenu.classList.contains('max-h-0');
                if (isHidden) {
                    mobileStudySubmenu.classList.remove('max-h-0');
                    mobileStudySubmenu.classList.add('max-h-60');
                    mobileStudyChevron.classList.add('rotate-180');
                } else {
                    mobileStudySubmenu.classList.add('max-h-0');
                    mobileStudySubmenu.classList.remove('max-h-60');
                    mobileStudyChevron.classList.remove('rotate-180');
                }
            });
        }
        
        // Accordion toggle for Join Groups with smooth animation
        if (mobileGroupsToggle && mobileGroupsSubmenu && mobileGroupsChevron) {
            mobileGroupsToggle.addEventListener('click', function() {
                const isHidden = mobileGroupsSubmenu.classList.contains('max-h-0');
                if (isHidden) {
                    mobileGroupsSubmenu.classList.remove('max-h-0');
                    mobileGroupsSubmenu.classList.add('max-h-48');
                    mobileGroupsChevron.classList.add('rotate-180');
                } else {
                    mobileGroupsSubmenu.classList.add('max-h-0');
                    mobileGroupsSubmenu.classList.remove('max-h-48');
                    mobileGroupsChevron.classList.remove('rotate-180');
                }
            });
        }

        // --- Free Books Logic ---
        const freeBookRules = {
            grab: {
                title: "Fair & Safe Rules for Grabbing",
                content: `<ul class="list-disc list-inside space-y-2"><li><b>First Come, First Served:</b> You get a 24-hour reservation to pick up the book.</li><li><b>Notifications:</b> Our team will notify you and the giver via WhatsApp to coordinate.</li><li><b>No-show Policy:</b> If you don't show up within the time slot, your reservation is released.</li><li><b>General Rules:</b> Pickups at Library Gate, Canteen, or Ground Entrance only. College ID verification is mandatory.</li></ul>`
            },
            give: {
                title: "Fair & Safe Rules for Giving",
                content: `<ul class="list-disc list-inside space-y-2"><li><b>Coordination:</b> Our team will contact you to arrange a collection time.</li><li><b>Handover:</b> Please hand over the book to our campus rep at one of the designated spots.</li><li><b>Verification:</b> Your College ID is required during handover for safety.</li><li><b>Community Spirit:</b> Thank you for contributing and helping a fellow student!</li></ul>`
            },
            swap: {
                title: "Fair & Safe Rules for Swapping",
                content: `<div class="rules-panel">
                    <div class="relative">
                        <button class="absolute top-2 right-2 close-rules text-gray-500 hover:text-gray-700 p-1">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        </button>
                        <ul class="list-disc list-inside space-y-2">
                            <li><b>Eligibility:</b> You must give a book first to become eligible to claim another.</li>
                            <li><b>Reservation:</b> You get a 24-hour reservation window to complete the swap.</li>
                            <li><b>Pickup/Delivery:</b> Arrange pickup at fixed spots or our team can assist with delivery.</li>
                            <li><b>General Rules:</b> College ID verification is mandatory for all parties.</li>
                        </ul>
                    </div>
                </div>`
            }
        };

        function renderFreeBookModal(type, bookDetails = null) { // Renamed from ascd.html
            let title = '';
            let bodyHTML = '';

            const headerHTML = (title) => `
                <div class="flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold">${title}</h2>
                    <button id="closeFreeBookModalBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                </div>`;
            
            const commonFields = `
                <div><label class="font-semibold text-gray-700">Full Name</label><input name="fullName" required placeholder="Enter your full name" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                <div><label class="font-semibold text-gray-700">Roll No.</label><input name="rollNo" required placeholder="Enter your college roll number" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                <div><label class="font-semibold text-gray-700">Phone Number / WhatsApp</label><input name="phone" required placeholder="For coordination" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                <div><label class="font-semibold text-gray-700">Email Address</label><input name="email" type="email" required placeholder="For confirmation" class="w-full p-2 border border-gray-300 rounded-md"/></div>
            `;

            const pickupBuddyFeature = `
                <div class="flex items-center gap-2 text-sm text-gray-700">
                    <input name="pickupBuddy" type="checkbox"/>
                    <button type="button" class="pickup-buddy-btn text-left hover:underline">
                        <span>I am female, I prefer </span> 
                        <span class="font-semibold text-blue-600">Pickup Buddy Support.</span>
                        <span class="font-bold text-blue-500">â“˜</span>
                    </button>
                </div>`;

             const confirmation = `
                <div class="pt-4 space-y-2 border-t"><label class="flex items-center gap-2 text-sm text-gray-600"><input type="checkbox" required />I confirm the details are correct.</label><label class="flex items-center gap-2 text-sm text-gray-600"><input type="checkbox" required />I agree to Nexbookâ€™s safety & privacy guidelines.</label></div>
             `;
             const rulesSection = (type) => `
                <div class="bg-gray-50 rounded-lg border mt-6">
                    <button type="button" class="w-full p-4 text-left font-semibold flex justify-between items-center rules-collapsible-button" data-toggle="expand" data-controls="rules-free-content" aria-expanded="false">
                        ${freeBookRules[type].title}
                        <svg class="w-5 h-5 transition-transform" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                    </button>
                    <div id="rules-free-content" class="expandable-content-wrapper" style="max-height: 0;">
                        <div class="p-4 border-t text-gray-700 text-sm">${freeBookRules[type].content}</div>
                    </div>
                </div>`;

            if (type === 'grab') {
                if (!bookDetails) {
                    title = 'Available Free Books';
                    bodyHTML = `<div class="p-8"><div class="space-y-4" id="free-book-list">${freeBooksAvailable.map(book => {
                        const claimButtonHTML = book.claimed 
                            ? `<button class="bg-gray-200 text-gray-500 font-semibold py-2 px-4 rounded-lg cursor-not-allowed" disabled>Booked</button>`
                            : `<button class="claim-free-book-btn bg-green-100 text-green-800 hover:bg-green-200 font-semibold py-2 px-4 rounded-lg button-animation">Claim</button>`;
                        const swapLabelHTML = book.isSwap
                            ? `<span class="text-xs font-semibold text-purple-600 bg-purple-100 px-2 py-0.5 rounded-full inline-block mt-1">Swap</span>`
                            : '';

                        return `
                        <div class="bg-white rounded-xl shadow-sm overflow-hidden border flex justify-between items-center p-4" data-book-id="${book.id}">
                            <div>
                                <h4 class="font-bold text-md">${book.title}</h4>
                                <p class="text-gray-600 text-sm">by ${book.author}</p>
                                ${swapLabelHTML}
                            </div>
                            <div class="flex items-center gap-2">
                                ${claimButtonHTML}
                            </div>
                        </div>`;
                        }).join('')}
                    </div></div>`;
                } else {
                    title = 'Grab a Free Book';
                    bodyHTML = `<form id="freeBookForm" class="grid md:grid-cols-2 gap-x-12 gap-y-8 p-8">
                        <div class="space-y-6 md:border-r md:pr-12">
                            <h3 class="text-xl font-bold">Order Summary</h3>
                            <div class="bg-gray-50 border rounded-xl p-4 space-y-2">
                                <h4 class="font-bold text-lg">${bookDetails.title}</h4>
                                <p class="text-sm text-gray-500">by ${bookDetails.author}</p>
                            </div>
                            <div class="space-y-2 border-t pt-4">
                                <div class="flex justify-between"><span>Item Price</span><span class="text-green-600 font-bold">FREE</span></div>
                                <div class="flex justify-between items-center"><span>Pickup Charges</span><span class="text-green-600 font-bold">FREE</span></div>
                                <div class="flex justify-between font-bold text-lg border-t pt-2 mt-2"><span>Total Amount</span><span>FREE</span></div>
                            </div>
                        </div>
                        <div class="space-y-4">${commonFields}
                            <div><label class="font-semibold text-gray-700">Quantity</label><p class="w-full p-2 border-gray-200 rounded-md font-bold text-lg">1</p></div>
                            <div><label class="font-semibold text-gray-700">Pickup Location (College)</label><select name="pickupLocation" class="w-full p-2 border border-gray-300 rounded-md"><option>Library Entrance</option><option>Cafeteria</option><option>Main Gate</option></select></div>
                            ${pickupBuddyFeature}${confirmation}
                            <button type="submit" class="w-full h-12 text-lg bg-blue-600 text-white rounded-lg font-semibold button-animation">Place Order Now</button>
                            <button type="button" id="addToBackpackBtnFree" class="w-full h-12 mt-3 text-lg bg-gray-200 text-gray-800 hover:bg-gray-300 rounded-lg font-semibold flex items-center justify-center button-animation">Add to Backpack</button>
                            ${rulesSection('grab')}
                        </div>
                    </form>`;
                }
            } else if (type === 'give' || type === 'swap') {
                title = type === 'give' ? 'Give a Free Book' : 'Swap a Book';
                const buttonText = type === 'give' ? 'List for Donation' : 'List for Swap';
                const timeOptions = ['9 AM', '9:30 AM', '10 AM', '10:30 AM', '11 AM', '11:30 AM', '12 PM', '12:30 PM', '1 PM', '1:30 PM', '2 PM'];
                const timeSelectorHTML = `
                    <div class="segmented-control" id="time-selector-freebook">
                        ${timeOptions.map((time, index) => `<button type="button" class="segment ${index === 0 ? 'active' : ''}" data-value="${time}">${time}</button>`).join('')}
                    </div>
                    <input type="hidden" name="pickupTime" id="pickupTimeInput" value="${timeOptions[0]}">`;

                bodyHTML = `<form id="freeBookForm" class="p-8 space-y-4">
                     <div><label class="font-semibold text-gray-700">Book Title</label><input name="bookTitle" id="freeBookTitle" required placeholder="e.g. University Physics" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                     <div><label class="font-semibold text-gray-700">Author</label><input name="author" id="freeBookAuthor" required placeholder="e.g. Young & Freedman" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                     ${commonFields} 
                     <div><label class="font-semibold text-gray-700">Quantity</label><input name="quantity" type="number" required placeholder="e.g. 1" value="1" min="1" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                     ${type === 'give' ? `
                        <div><label class="font-semibold text-gray-700">Hand Over Location</label><select name="pickupLocation" class="w-full p-2 border border-gray-300 rounded-md"><option>Library Entrance</option><option>Cafeteria</option><option>Main Gate</option></select></div>
                        <div class="grid grid-cols-1 gap-4">
                            <div><label class="font-semibold text-gray-700">Pickup Date</label><input name="pickupDate" type="date" required class="w-full p-2 border border-gray-300 rounded-md"/></div>
                            <div><label class="font-semibold text-gray-700">Pickup Time</label>${timeSelectorHTML}</div>
                        </div>
                        <small class="text-gray-500 block text-center">Your selected date and time will be confirmed by our team.</small>
                     ` : `
                        <div><label class="font-semibold text-gray-700">Pickup Location (College)</label><select name="pickupLocation" class="w-full p-2 border border-gray-300 rounded-md"><option>Library Entrance</option><option>Cafeteria</option><option>Main Gate</option></select></div>
                     `}
                     <div><label class="font-semibold text-gray-700">Book Condition</label><select name="condition" class="w-full p-2 border border-gray-300 rounded-md"><option>New</option><option>Like New</option><option>Used</option></select></div>
                     <div><label class="font-semibold text-gray-700">Upload Photos (Proof)</label><div class="space-y-2 mt-1"><small class="text-gray-500">1. Front Cover, 2. Edition Page, 3. Page with Your Name, Roll No & Date</small><input type="file" required class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/><input type="file" required class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/><input type="file" required class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/></div></div>
                     ${pickupBuddyFeature}${confirmation}
                     <button type="submit" class="w-full h-12 text-lg bg-orange-500 text-white rounded-lg font-semibold button-animation">${buttonText}</button>
                     <button type="button" id="addToBackpackBtnGive" class="w-full h-12 mt-3 text-lg bg-gray-200 text-gray-800 hover:bg-gray-300 rounded-lg font-semibold flex items-center justify-center button-animation">Add to Backpack</button>
                     ${rulesSection(type)}
                 </form>`;
            }

            freeBookModalContent.innerHTML = headerHTML(title) + `<div class="flex-grow overflow-y-auto">${bodyHTML}</div>`; 
            ModalManager.open('freeBookModal');
            
            const backpackFreeBtn = document.getElementById('addToBackpackBtnFree');
            if (backpackFreeBtn) {
                 backpackFreeBtn.onclick = preventDoubleClick(function() {
                    // Only mark as FREE if it's genuinely a free book flow.
                    // The bookDetails object for a paid book won't have a price of 0.
                    const isTrulyFree = bookDetails.price === 0 || bookDetails.price === 'FREE';
                    const item = isTrulyFree ? {...bookDetails, price: 'FREE'} : bookDetails;
                    addToBackpack(item);
                });
            } 
            freeBookModalContent.querySelectorAll('.pickup-buddy-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                   ModalManager.open('pickupBuddyModal');
                });
            });
            
            freeBookModalContent.querySelectorAll('.rules-collapsible-button').forEach(btn => {
                btn.addEventListener('click', preventDoubleClick(function(e) {
                    const isExpanding = e.currentTarget.getAttribute('aria-expanded') === 'false';
                    e.currentTarget.setAttribute('aria-expanded', isExpanding);
                    const panel = e.currentTarget.nextElementSibling;
                    panel.classList.toggle('expanded');
                    const content = document.getElementById('rules-free-content');
                    if(isExpanding) {
                         content.style.maxHeight = content.scrollHeight + 'px';
                     } else {
                         content.style.maxHeight = '0px';
                     }
                }));
            });

            const form = freeBookModalContent.querySelector('#freeBookForm');
            if (form) {
                // Removed old form handler - Firebase handler will take over
                // form.onsubmit = preventDoubleClick(e => { ... });
            }
            
            if (type === 'grab' && !bookDetails) { // In the list view
                 freeBookModalContent.querySelectorAll('.claim-free-book-btn').forEach(btn => {
                    btn.addEventListener('click', preventDoubleClick(function(e) {
                        const bookId = e.target.closest('[data-book-id]').dataset.bookId;
                        const book = freeBooksAvailable.find(b => b.id === bookId);
                        renderFreeBookModal('grab', book);
                    }));
                 });
            }
            
            const timeSelector = document.getElementById('time-selector-freebook');
            if (timeSelector) {
                const timeInput = document.getElementById('pickupTimeInput');
                timeSelector.addEventListener('click', (e) => {
                    if (e.target.classList.contains('segment')) {
                        timeSelector.querySelector('.active').classList.remove('active');
                        e.target.classList.add('active');
                        timeInput.value = e.target.dataset.value;
                    }
                });
            }
        }
        
        // --- NEW MODAL RENDERERS ---
        async function renderBackpackModal(user) {
            if (!user) {
                myBackpackContent.innerHTML = `<div class="text-center text-gray-500 py-16">Please log in to see your backpack.</div>`;
                return;
            }

            myBackpackContent.innerHTML = `<div class="flex items-center justify-center h-48"><div class="w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"></div></div>`;

            try {
                const backpackSnapshot = await db.collection('backpacks').where('ownerUid', '==', user.uid).orderBy('timestamp', 'desc').get();
                
                if (backpackSnapshot.empty) {
                    myBackpackContent.innerHTML = `<div class="text-center text-gray-500 py-16">
                        <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 9h16v11a2 2 0 01-2 2H6a2 2 0 01-2-2V9z" /><path stroke-linecap="round" stroke-linejoin="round" d="M9 9V4a3 3 0 013-3h0a3 3 0 013 3v5" /></svg>
                        <h3 class="mt-2 text-lg font-medium text-gray-900">Your backpack is empty</h3>
                        <p class="mt-1 text-sm text-gray-500">Add some books to get started.</p>
                    </div>`;
                    return;
                }

                let backpackHTML = '<div class="space-y-4">';
                let backpackItems = [];
                backpackSnapshot.forEach(doc => {
                    const item = doc.data();
                    backpackItems.push({ id: doc.id, ...item });
                    backpackHTML += `
                        <div class="bg-white rounded-xl shadow-sm border flex justify-between items-center p-4">
                            <div>
                                <h4 class="font-bold text-md">${item.title}</h4>
                                <p class="text-gray-600 text-sm">by ${item.author || 'N/A'}</p>
                                <p class="font-bold text-blue-600 mt-1 font-roboto">${(item.price === 'FREE' || item.price === 0) ? 'FREE' : 'â‚¹' + item.price}</p>
                            </div>
                            <button class="remove-from-backpack-btn bg-red-100 text-red-700 hover:bg-red-200 font-semibold py-2 px-3 rounded-lg button-animation" data-id="${doc.id}">
                                Remove
                            </button>
                        </div>
                    `;
                });
                backpackHTML += '</div><div class="mt-8 pt-4 border-t"><button id="backpackCheckoutBtn" class="w-full h-12 text-lg bg-green-500 text-white rounded-lg font-semibold button-animation">Checkout All Items</button></div>';
                myBackpackContent.innerHTML = backpackHTML;

                // Add event listener for remove buttons
                myBackpackContent.querySelectorAll('.remove-from-backpack-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const docId = this.dataset.id;
                        showConfirmation({
                            title: 'Remove Item?',
                            message: 'Are you sure you want to remove this item from your backpack?',
                            confirmText: 'Yes, Remove',
                            onConfirm: async () => {
                                await db.collection('backpacks').doc(docId).delete();
                                showToast('Item removed from backpack.');
                                renderBackpackModal(user); // Re-render the modal
                            }
                        });
                    });
                });

                // Add event listener for checkout button
                document.getElementById('backpackCheckoutBtn').addEventListener('click', () => {
                    renderBackpackCheckoutModal(backpackItems);
                    ModalManager.open('backpackCheckoutModal');
                });

            } catch (error) {
                console.error("Error fetching backpack:", error);
                myBackpackContent.innerHTML = `<div class="text-center text-red-500 py-16">Could not load your backpack. Please try again.</div>`;
            }
        }

        function renderBackpackCheckoutModal(backpackItems) {
            const content = document.getElementById('backpackCheckoutModalContent');
            const totalAmount = backpackItems.reduce((acc, item) => acc + (Number(item.price) || 0), 0);
            const getNextDeliveryDates = () => {
                const dates = []; let today = new Date();
                for (let i = 0; i < 14 && dates.length < 2; i++) {
                    let nextDate = new Date(today); nextDate.setDate(today.getDate() + i);
                    const day = nextDate.getDay(); if (day === 1 || day === 4) { dates.push(nextDate.toDateString()); }
                } return dates;
            };
            const deliveryDates = getNextDeliveryDates();

            content.innerHTML = `
                <div class="flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                    <h2 class="text-2xl font-bold">Backpack Checkout</h2>
                    <button id="closeBackpackCheckoutBtn" class="bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 button-animation"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>
                </div>
                <div class="flex-grow p-8 overflow-y-auto">
                    <form id="backpackCheckoutForm" class="grid md:grid-cols-2 gap-x-12 gap-y-8">
                        <div class="space-y-6 md:border-r md:pr-12">
                            <h3 class="text-xl font-bold">Order Summary (${backpackItems.length} items)</h3>
                            <div class="bg-gray-50 border rounded-xl p-4 space-y-2 max-h-48 overflow-y-auto">
                                ${backpackItems.map(item => `<div class="flex justify-between text-sm"><p>${item.title}</p><p class="font-roboto">${item.price === 'FREE' ? 'FREE' : 'â‚¹' + item.price}</p></div>`).join('')}
                            </div>
                            <div class="space-y-2 border-t pt-4">
                                <div class="flex justify-between"><span>Subtotal</span><span class="font-roboto">â‚¹${totalAmount}</span></div>
                                <div class="flex justify-between items-center"><span>Delivery Charges</span><span class="text-green-600 font-bold">FREE</span></div>
                                <div class="flex justify-between font-bold text-lg border-t pt-2 mt-2"><span>Total Amount</span><span class="font-roboto">â‚¹${totalAmount}</span></div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div><label class="font-semibold text-gray-700">Full Name</label><input name="fullName" required placeholder="Enter your full name" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                            <div><label class="font-semibold text-gray-700">Phone Number / WhatsApp</label><input name="phone" required placeholder="For delivery updates" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                            <div><label class="font-semibold text-gray-700">Email Address</label><input name="email" type="email" required placeholder="For order confirmation" class="w-full p-2 border border-gray-300 rounded-md"/></div>
                            <div><label class="font-semibold text-gray-700">Delivery Location (College)</label><select name="deliveryLocation" class="w-full p-2 border border-gray-300 rounded-md"><option>Library Entrance</option><option>Cafeteria</option><option>Main Gate</option></select></div>
                            <div><label class="font-semibold text-gray-700">Delivery Date</label><div class="grid grid-cols-2 gap-4">${deliveryDates.map(date => `<label class="flex-1"><input type="radio" name="deliveryDate" value="${date}" required class="sr-only peer"/><div class="p-3 text-center border rounded-lg peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 cursor-pointer">${date}</div></label>`).join('')}</div></div>
                            <div><label class="font-semibold text-gray-700">Payment Method</label><div class="grid grid-cols-2 gap-4"><label class="flex-1"><input type="radio" name="paymentMethod" value="POD" checked class="sr-only peer"/><div class="p-3 text-center border rounded-lg peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 cursor-pointer">Pay on Delivery</div></label><label class="flex-1"><input type="radio" name="paymentMethod" value="Online" class="sr-only peer"/><div class="p-3 text-center border rounded-lg peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 cursor-pointer">Pay Online</div></label></div></div>
                            <div class="pt-4 space-y-2"><label class="flex items-center gap-2 text-sm text-gray-600"><input type="checkbox" required />I confirm the details are correct.</label></div>
                            <button type="submit" class="w-full h-12 text-lg bg-blue-600 text-white rounded-lg font-semibold button-animation">Place Order</button>
                        </div>
                    </form>
                </div>
            `;
        }

        // --- MAIN INITIALIZATION FUNCTION ---
        function initialize() {
            renderMajors();
            renderSyllabusModal();
            renderPyqModal();
            renderPracticalsModal();
            renderAssignmentsModal();
            renderNotesModal();
            renderAcademyX(); // This will now use the new grid-based expander
            initializeExpandableSections();
            ModalManager.init();
            setupScrollAnimations();
            
            document.querySelectorAll('.expandable-content-wrapper').forEach(wrapper => {
                wrapper.setAttribute('data-expanded', 'false');
            });
            
            if (document.querySelectorAll('#study-material-grid > *').length > 4) {
                 document.getElementById('view-more-container-study').classList.remove('hidden');
            }
            
            document.querySelectorAll('.essential-buy-btn').forEach(btn => {
                btn.addEventListener('click', preventDoubleClick(function(e) {
                    const item = e.currentTarget.dataset.item;
                    const price = e.currentTarget.dataset.price;
                    handleEssentialAction('buy', item, price);
                }));
            });

            document.querySelectorAll('.essential-sell-btn').forEach(btn => { 
                btn.addEventListener('click', preventDoubleClick(function(e) {
                    const item = e.currentTarget.dataset.item;
                    handleEssentialAction('sell', item);
                }));
            });

             document.querySelectorAll('.freebook-action-btn').forEach(btn => {
                btn.addEventListener('click', preventDoubleClick(function() {
                    renderFreeBookModal(btn.dataset.action);
                }));
            });
            document.getElementById('claim-now-btn').addEventListener('click', preventDoubleClick(function() {
                renderFreeBookModal('grab');
            }));
            document.getElementById('claim-now-img-link').addEventListener('click', preventDoubleClick(function(e) {
                e.preventDefault();
                renderFreeBookModal('grab');
            }));

            // Trading Simplified Card Logic (Overlay removed as per request)
            // The "View Steps" button inside the card now handles the expand/collapse functionality.
            // No additional JavaScript is needed for the card itself.
            
        }
        
        // --- ONE-TIME INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('logoLink').addEventListener('click', (e) => {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            document.getElementById('requestBookBtnNav').addEventListener('click', preventDoubleClick(() => ModalManager.open('requestModal'))); 
            
            document.getElementById('postRequestBtn').addEventListener('click', preventDoubleClick(function() {
                 ModalManager.close('requestModal');
                 showToast('Your book request has been posted!');
            }));
            
            document.getElementById('sellBookBtnHero').addEventListener('click', preventDoubleClick(() => { renderSellForm('Book'); ModalManager.open('sellBookModal'); })); 
            document.querySelector('.sell-book-footer').addEventListener('click', preventDoubleClick(function(e) {
                e.preventDefault();
                renderSellForm('Book'); 
                renderSellForm('Book');
                ModalManager.open('sellBookModal');
            }));

            document.getElementById('syllabusBtn').addEventListener('click', preventDoubleClick(() => ModalManager.open('syllabusModal'))); 
            document.getElementById('pyqBtn').addEventListener('click', preventDoubleClick(() => openUnifiedModal('pyq'))); 
            document.getElementById('practicalsBtn').addEventListener('click', preventDoubleClick(() => openUnifiedModal('practicals'))); 
            document.getElementById('assignmentsBtn').addEventListener('click', preventDoubleClick(() => openUnifiedModal('assignments'))); 
            document.getElementById('notesBtn').addEventListener('click', preventDoubleClick(() => openUnifiedModal('notes'))); 
            document.getElementById('timeTableBtn').addEventListener('click', preventDoubleClick(() => ModalManager.open('timeTableModal'))); 

            // New Modal Listeners - with null checks to prevent errors
            const myOrdersBtnMobile = document.getElementById('myOrdersBtnMobile');
            if (myOrdersBtnMobile) {
                myOrdersBtnMobile.onclick = preventDoubleClick(() => { renderOrdersModal(currentUser); ModalManager.open('myOrdersModal'); });
            }
            const myBackpackBtnMobile = document.getElementById('myBackpackBtnMobile');
            if (myBackpackBtnMobile) {
                myBackpackBtnMobile.onclick = preventDoubleClick(() => { renderBackpackModal(currentUser); ModalManager.open('myBackpackModal'); });
            }

            // --- NEW: Profile Dashboard Logic ---
            /* MOVED TO TOP OF SCRIPT */

            function renderProfileDashboard() {
                if (currentUser) {
                    // Logged-in view
                    profileDashboardContent.innerHTML = `
                        <div class="text-center space-y-6">
                            <div class="flex flex-col items-center gap-3">
                                <div class="w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center font-bold text-3xl text-gray-600">${window.currentUser.displayName ? window.currentUser.displayName[0].toUpperCase() : (window.currentUser.email ? window.currentUser.email[0].toUpperCase() : 'U')}</div>
                                <div>
                                    <p class="font-bold text-xl text-gray-800">${currentUser.displayName || currentUser.email}</p>
                                </div>
                            </div>
                            <div class="space-y-3 pt-4 border-t">
                                <button id="dashboardMyOrdersBtn" class="w-full text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 border text-left">My Orders</button>
                                <button id="dashboardMyBackpackBtn" class="w-full text-lg font-semibold text-gray-700 rounded-lg px-4 py-3 hover:bg-gray-100 border text-left">My Backpack</button>
                            </div>
                            <button id="dashboardLogoutBtn" class="w-full text-lg font-semibold text-red-600 bg-red-50 rounded-lg px-4 py-3 hover:bg-red-100 border border-red-100">Logout</button>
                        </div>
                    `;
                    // This logic is now inside the main renderProfileDashboard function
                    // to avoid duplication and ensure it's always wired up correctly.
                    
                } else {
                    // Logged-out view
                    profileDashboardContent.innerHTML = `
                        <div class="text-center space-y-4">
                            <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                            <h3 class="text-xl font-bold">Join the Community</h3>
                            <p class="text-gray-600">Login or create an account to manage your orders, backpack, and listings.</p>
                            <button id="dashboardLoginBtn" class="w-full h-12 text-lg bg-blue-600 text-white rounded-lg font-semibold button-animation">Login / Register</button>
                        </div>
                    `;
                    document.getElementById('dashboardLoginBtn').onclick = () => {
                        ModalManager.close('profileDashboardModal');
                        renderAuthView('login');
                        ModalManager.open('authModal');
                    };
                }
            }

            function handleEssentialAction(action, item, price) {
                // CRITICAL FIX: Save scroll position before opening modal
                const scrollY = window.scrollY;
                
                const sizes = ['XS', 'S', 'M', 'L', 'XL', 'XXL'];
                itemSelectionContent.innerHTML = `
                     <div class="p-8">
                        <h3 class="text-2xl font-bold text-center mb-1">Select Size</h3>
                        <p class="text-center text-gray-600 mb-6">For ${item}</p>
                        <div class="flex flex-wrap justify-center gap-4">
                            ${sizes.map(size => `<button class="size-btn bg-gray-100 text-gray-800 font-semibold py-4 px-6 rounded-lg hover:bg-blue-600 hover:text-white transition-colors button-animation" data-size="${size}">${size}</button>`).join('')}
                        </div>
                    </div>
                `; 
                
                // Prevent scroll jump when opening modal
                document.body.style.position = 'fixed';
                document.body.style.top = `-${scrollY}px`;
                document.body.style.left = '0';
                document.body.style.right = '0';
                document.body.style.width = '100%';
                
                ModalManager.open('itemSelectionModal');

                itemSelectionContent.querySelectorAll('.size-btn').forEach(btn => {
                    btn.onclick = preventDoubleClick(function() {
                        const selectedSize = btn.dataset.size;
                        
                        // CRITICAL FIX: Save scroll before modal transition
                        const currentScrollY = parseInt(document.body.style.top || '0') * -1;
                        
                        ModalManager.close('itemSelectionModal');
                        
                        if (action === 'buy') {
                            // Maintain fixed position during modal transition
                            document.body.style.position = 'fixed';
                            document.body.style.top = `-${currentScrollY}px`;
                            document.body.style.left = '0';
                            document.body.style.right = '0';
                            document.body.style.width = '100%';
                            
                            handleBuy({
                                title: `${item} - Size ${selectedSize}`,
                                price: price,
                                condition: 'Used',
                                author: 'College Store',
                                verified: true,
                                id: `${item.replace(/\s+/g, '-')}-${selectedSize}`
                            });
                        } else {
                            // Maintain fixed position during modal transition
                            document.body.style.position = 'fixed';
                            document.body.style.top = `-${currentScrollY}px`;
                            document.body.style.left = '0';
                            document.body.style.right = '0';
                            document.body.style.width = '100%';
                            
                            renderSellForm(item, { size: selectedSize });
                            ModalManager.open('sellBookModal');
                        }
                    });
                });
            }

            // Wire up Essentials buttons to Size Selection flow
            document.querySelectorAll('.essential-buy-btn').forEach(btn => {
                btn.addEventListener('click', preventDoubleClick(function() {
                    const item = btn.dataset.item;
                    const price = parseInt(btn.dataset.price, 10) || 0;
                    handleEssentialAction('buy', item, price);
                }));
            });

            document.querySelectorAll('.essential-sell-btn').forEach(btn => {
                btn.addEventListener('click', preventDoubleClick(function() {
                    const item = btn.dataset.item;
                    handleEssentialAction('sell', item);
                }));
            });

            // Counter Animation Function
            function animateCounter(element, target, duration = 2000) {
                const start = 0;
                const increment = target / (duration / 16); // 60fps
                let current = start;
                
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    
                    // Format number with commas for Indian numbering system
                    if (target >= 100000) {
                        // For 2,50,000
                        element.textContent = Math.floor(current).toLocaleString('en-IN');
                    } else {
                        // For 20,000
                        element.textContent = Math.floor(current).toLocaleString('en-IN');
                    }
                }, 16);
            }

            // Initialize counter animations when elements come into view
            function initCounterAnimations() {
                const counterElements = document.querySelectorAll('.counter-number');
                const observerOptions = {
                    threshold: 0.5,
                    rootMargin: '0px 0px -100px 0px'
                };

                const counterObserver = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting && !entry.target.classList.contains('animated')) {
                            const target = parseInt(entry.target.dataset.target);
                            entry.target.classList.add('animated');
                            animateCounter(entry.target, target);
                        }
                    });
                }, observerOptions);

                counterElements.forEach(element => {
                    counterObserver.observe(element);
                });
            }

            // Initialize counter animations
            initCounterAnimations();

            // --- Thinkly AI Chat Inline Logic ---
            const thinklyAiHero = document.getElementById('thinkly-ai-hero');
            const aiTab = document.getElementById('aiTab');

            if (!thinklyAiHero) {
                console.error('âŒ Thinkly AI Hero element not found!');
            } else {
                console.log('âœ… Thinkly AI Hero element found');
            }

            function initializeThinklyAiChat() {
                if (!thinklyAiHero) {
                    console.error('âŒ Cannot initialize Thinkly AI - element missing');
                    return;
                }
                
                const mainContainer = thinklyAiHero.querySelector('#mainContainer');
                const searchBarWrapper = thinklyAiHero.querySelector('#searchBarWrapper');
                const searchInput = thinklyAiHero.querySelector('#searchInput');
                const sendButton = thinklyAiHero.querySelector('#sendButton');
                const chatOutput = thinklyAiHero.querySelector('#chatOutput');
                const clearChatButton = thinklyAiHero.querySelector('#clearChatButton');
                const expandButton = thinklyAiHero.querySelector('#expandButton');
                const closeButton = thinklyAiHero.querySelector('#closeButton');
                const expandedView = thinklyAiHero.querySelector('#expandedView');
                const expandedChatOutput = thinklyAiHero.querySelector('#expandedChatOutput');
                const expandedSearchInput = thinklyAiHero.querySelector('#expandedSearchInput');
                const expandedSendButton = thinklyAiHero.querySelector('#expandedSendButton');

                // Debug: Check if close button exists
                if (!closeButton) {
                    console.error('âŒ Close button not found!');
                } else {
                    console.log('âœ… Close button found:', closeButton);
                }

                let chatHistory = [];

                // --- NEW: Predefined AI responses for the "About Nexbook" flow ---
                const aboutNexbookResponses = {
                    'what-is-nexbook': "Nexbook is an exclusive marketplace for students of S.S. Jain Subodh P.G. College! ðŸŽ“ It's a platform built by students, for students, to make academic life easier. You can buy and sell used textbooks, get free books, find study materials like PYQs, and even access thousands of free certified courses from top universities worldwide. Think of it as your all-in-one campus hub!",
                    'how-to-buy': "Buying a book is super simple! Here's how:\n\n1. **Browse:** Go to the 'Buy Books' section and select your course.\n2. **Select:** Find the book you need and click 'Buy Now'.\n3. **Details:** Fill in your name and contact info.\n4. **Meet Up:** Our team coordinates a safe meetup on campus. You only pay after you've checked the book and are happy with it. No online payment needed beforehand!",
                    'how-to-sell': "Selling your old books is a great way to earn some cash! ðŸ’°\n\n1. **Click 'Sell':** Tap the 'Sell Your Book' button.\n2. **Details:** Fill in the book's title, author, condition, and your price.\n3. **List It:** Submit the form. Your book is now listed!\n\nWhen someone buys it, our team will contact you to arrange a pickup. It's completely hassle-free.",
                    'is-it-safe': "Safety is our #1 priority! âœ¨\n\n- **Verified Users:** We encourage everyone to log in, creating a trusted community.\n- **On-Campus Only:** All transactions happen within the college campus at designated safe spots (like the library or cafeteria).\n- **Pay on Delivery:** You never have to pay online. You inspect the book first, then pay the seller directly.\n- **Pickup Buddy:** For extra safety, female students can request a 'Pickup Buddy' from our team to assist them during the exchange, completely free of charge."
                };

                const addAiMessage = (htmlContent) => {
                    if (!mainContainer.classList.contains('is-chatting')) {
                        mainContainer.classList.add('is-chatting');
                        mainContainer.classList.remove('UAbVe');
                    }
                    chatHistory.push({ type: 'ai', text: htmlContent });
                    renderChat();
                };

                const expandSearchBar = () => {
                    // ðŸ”¥ RESTORED OLD BEHAVIOR: Expand inline first (not fullscreen)
                    console.log('ðŸš€ searchBarWrapper clicked - expanding inline!');
                    
                    if (!mainContainer.classList.contains('UAbVe') && chatHistory.length === 0) {
                        mainContainer.classList.add('UAbVe');
                        mainContainer.classList.add('is-chatting');
                        searchInput.focus();
                        
                        // Show quick pills when expanded and no chat history
                        const quickPills = document.getElementById('quickPills');
                        if (quickPills && chatHistory.length === 0) {
                            quickPills.style.display = 'flex';
                        }
                    }
                };

                const collapseSearchBar = () => {
                    if (searchInput.value === '' && chatHistory.length === 0) {
                        mainContainer.classList.remove('UAbVe');
                    }
                };

                const renderChat = () => {
                    chatOutput.innerHTML = '';
                    expandedChatOutput.innerHTML = '';
                    chatHistory.forEach(msg => {
                        const messageEl = document.createElement('div');
                        messageEl.classList.add('chat-message', msg.type === 'user' ? 'user-message' : 'ai-message');
                        
                        if (msg.thinking) {
                            messageEl.innerHTML = `<span class="thinking-shine">${msg.text}</span>`;
                        } else {
                            messageEl.innerHTML = msg.text; // Use innerHTML to render pills
                        }

                        chatOutput.appendChild(messageEl);
                        expandedChatOutput.appendChild(messageEl.cloneNode(true));
                    });
                    setTimeout(() => {
                        chatOutput.scrollTop = chatOutput.scrollHeight;
                        expandedChatOutput.scrollTop = expandedChatOutput.scrollHeight;
                    }, 0);
                };

                const handleSend = (inputElement, buttonElement, isPillClick = false, pillText = '') => {
                    const text = inputElement.value.trim();
                    if (text === '') return;

                    if (!mainContainer.classList.contains('is-chatting')) {
                        mainContainer.classList.add('is-chatting');
                        mainContainer.classList.remove('UAbVe');
                    }
                    
                    // Hide pills when sending a message
                    const quickPills = document.getElementById('quickPills');
                    if (quickPills) {
                        quickPills.style.display = 'none';
                    }

                    chatHistory.push({ type: 'user', text: isPillClick ? pillText : text });
                    chatHistory.push({ type: 'ai', text: 'Thinking...', thinking: true });
                    renderChat();

                    inputElement.value = '';
                    autoResizeTextarea(inputElement);
                    toggleSendButtons();
                    
                    const iconContainer = buttonElement.querySelector('.wilSz');
                    if (iconContainer) {
                        iconContainer.classList.add('animate-takeoff');
                        setTimeout(() => iconContainer.classList.remove('animate-takeoff'), 500);
                    }
                    
                    // Simulate AI response
                    setTimeout(() => {
                        chatHistory.pop(); // Remove "Thinking..."
                        let responseText;
                        if (isPillClick) {
                            // Get response from our predefined object
                            const responseKey = inputElement.dataset.key;
                            responseText = aboutNexbookResponses[responseKey] || "Sorry, I don't have information on that right now.";
                        } else {
                            // Generic response for typed messages
                            const aiResponses = ["Namaste!", "Main aapki kaise sahayata kar sakta hun?", "Soch raha hun...", "Yah ek dilachasp savaal hai.", "Main aapki sahayata ke liye yahan hun."];
                            responseText = aiResponses[Math.floor(Math.random() * aiResponses.length)];
                        }
                        chatHistory.push({ type: 'ai', text: responseText });
                        renderChat();
                    }, 2000); 
                };
                
                const autoResizeTextarea = (element) => {
                    element.style.height = 'auto';
                    element.style.height = element.scrollHeight + 'px';
                };

                const toggleSendButtons = () => {
                    const isMainInputFilled = searchInput.value.trim() !== '';
                    const isExpandedInputFilled = expandedSearchInput.value.trim() !== '';
                    
                    sendButton.classList.toggle('disabled', !isMainInputFilled);
                    expandedSendButton.classList.toggle('disabled', !isExpandedInputFilled);
                };
                
                const handleInput = (e) => {
                    const wrapper = e.target.parentElement;
                    if (e.target.value.trim() !== '') {
                        wrapper.classList.add('has-content');
                    } else {
                        wrapper.classList.remove('has-content');
                    }
                    toggleSendButtons();
                    autoResizeTextarea(e.target);
                }

                // Event Listeners for main view
                searchBarWrapper.addEventListener('click', expandSearchBar);
                searchInput.addEventListener('input', handleInput);
                sendButton.addEventListener('click', () => handleSend(searchInput, sendButton));

                // Event Listeners for expanded view
                expandedSearchInput.addEventListener('input', () => {
                    toggleSendButtons();
                    autoResizeTextarea(expandedSearchInput);
                });
                expandedSendButton.addEventListener('click', () => handleSend(expandedSearchInput, expandedSendButton));
                
                // Sync inputs
                searchInput.addEventListener('input', () => {
                     expandedSearchInput.value = searchInput.value;
                     autoResizeTextarea(expandedSearchInput);
                });
                expandedSearchInput.addEventListener('input', () => {
                    searchInput.value = expandedSearchInput.value;
                    autoResizeTextarea(searchInput);
                });
                
                // EMO Expression Changes
                const sendLeftEye = document.getElementById('sendLeftEye');
                const sendRightEye = document.getElementById('sendRightEye');
                const expandedSendLeftEye = document.getElementById('expandedSendLeftEye');
                const expandedSendRightEye = document.getElementById('expandedSendRightEye');
                
                const emoExpressions = {
                    normal: { left: 'M20 25 C27 15, 40 15, 47 25', right: 'M53 25 C60 15, 73 15, 80 25' },
                    happy: { left: 'M20 22 C30 32, 37 32, 47 22', right: 'M53 22 C63 32, 70 32, 80 22' },
                    thinking: { left: 'M20 25 C27 18, 40 25, 47 18', right: 'M53 18 C60 25, 73 18, 80 25' },
                    excited: { left: 'M20 20 C30 35, 37 35, 47 20', right: 'M53 20 C63 35, 70 35, 80 20' }
                };
                
                function changeEmoExpression(expression, leftEye, rightEye) {
                    const paths = emoExpressions[expression];
                    if (leftEye && rightEye && paths) {
                        const leftPath = leftEye.querySelector('path');
                        const rightPath = rightEye.querySelector('path');
                        if (leftPath) {
                            leftPath.setAttribute('d', paths.left);
                        }
                        if (rightPath) {
                            rightPath.setAttribute('d', paths.right);
                        }
                    }
                }
                
                let typingTimeout;
                function handleEmoTyping(value) {
                    clearTimeout(typingTimeout);
                    if (value.length > 0) {
                        changeEmoExpression('thinking', sendLeftEye, sendRightEye);
                        changeEmoExpression('thinking', expandedSendLeftEye, expandedSendRightEye);
                        
                        typingTimeout = setTimeout(() => {
                            changeEmoExpression('happy', sendLeftEye, sendRightEye);
                            changeEmoExpression('happy', expandedSendLeftEye, expandedSendRightEye);
                        }, 800);
                    } else {
                        changeEmoExpression('normal', sendLeftEye, sendRightEye);
                        changeEmoExpression('normal', expandedSendLeftEye, expandedSendRightEye);
                    }
                }
                
                searchInput.addEventListener('input', (e) => {
                    handleEmoTyping(e.target.value);
                });
                
                expandedSearchInput.addEventListener('input', (e) => {
                    handleEmoTyping(e.target.value);
                });
                
                // Change to excited when clicking send
                const originalSendClick = sendButton.onclick;
                sendButton.addEventListener('click', () => {
                    changeEmoExpression('excited', sendLeftEye, sendRightEye);
                    setTimeout(() => {
                        changeEmoExpression('normal', sendLeftEye, sendRightEye);
                    }, 1200);
                });
                
                const originalExpandedSendClick = expandedSendButton.onclick;
                expandedSendButton.addEventListener('click', () => {
                    changeEmoExpression('excited', expandedSendLeftEye, expandedSendRightEye);
                    setTimeout(() => {
                        changeEmoExpression('normal', expandedSendLeftEye, expandedSendRightEye);
                    }, 1200);
                });

                // Expand/Collapse/Clear logic
                // Quick Pills Click Handler
                document.querySelectorAll('.ai-pill').forEach(pill => {
                    pill.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const pillText = pill.getAttribute('data-pill');
                        const questionMap = {
                            'What is Nexbook?': 'what-is-nexbook',
                            'How to buy books?': 'how-to-buy',
                            'How to sell books?': 'how-to-sell',
                            'Is it safe?': 'is-it-safe'
                        };
                        
                        // Set the response key for later retrieval
                        searchInput.dataset.key = questionMap[pillText];
                        searchInput.value = pillText;
                        
                        // Hide pills after selection
                        document.getElementById('quickPills').style.display = 'none';
                        
                        // Trigger send
                        handleSend(searchInput, sendButton, true, pillText);
                    });
                });
                
                expandButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('Expand button clicked!'); // Debug log
                    
                    // ðŸ”¥ PERFECT NO-JUMP FIX: Save current scroll position
                    const scrollY = window.scrollY;
                    
                    // Freeze body without forcing scroll to top
                    document.body.style.position = "fixed";
                    document.body.style.top = `-${scrollY}px`;
                    document.body.style.left = "0";
                    document.body.style.right = "0";
                    document.body.style.width = "100%";
                    
                    expandedView.classList.add('visible');
                    document.getElementById('mobile-nav')?.classList.add('hidden'); // Hide mobile nav
                    mainContainer.style.opacity = '0';
                    mainContainer.style.pointerEvents = 'none';
                });
                
                // Close button with multiple event types for better compatibility
                if (closeButton) {
                    const closeHandler = (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        
                        console.log('ðŸ”´ Close button clicked!'); // Debug log
                        
                        // Close fullscreen
                        expandedView.classList.remove('visible');
                        
                        // ðŸ”¥ PERFECT SCROLL RESTORE: Get saved scroll position
                        const scrollY = document.body.style.top;
                        const savedPosition = parseInt(scrollY || "0") * -1;
                        
                        // Restore body scroll perfectly
                        document.body.style.position = "";
                        document.body.style.top = "";
                        document.body.style.left = "";
                        document.body.style.right = "";
                        document.body.style.width = "";
                        
                        // Use requestAnimationFrame for smooth restoration
                        requestAnimationFrame(() => {
                            window.scrollTo({
                                top: savedPosition,
                                left: 0,
                                behavior: 'instant'
                            });
                        });
                        
                        document.body.classList.remove('thinkly-expanded'); // Clean up class
                        document.getElementById('mobile-nav')?.classList.remove('hidden'); // Show mobile nav
                        mainContainer.style.opacity = '1';
                        mainContainer.style.pointerEvents = 'auto';
                    };
                    
                    // Add both click and touchend for better mobile support
                    closeButton.addEventListener('click', closeHandler);
                    closeButton.addEventListener('touchend', closeHandler);
                    
                    // Make sure it's always clickable
                    closeButton.style.pointerEvents = 'auto';
                    closeButton.style.cursor = 'pointer';
                    closeButton.style.touchAction = 'manipulation';
                    
                    console.log('âœ… Close button handlers attached');
                }
                
                clearChatButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    chatHistory = [];
                    mainContainer.classList.add('is-clearing'); // Add class for fast transition
                    renderChat();
                    mainContainer.classList.remove('is-chatting');
                    collapseSearchBar();
                    
                    // Reset pills visibility
                    const quickPills = document.getElementById('quickPills');
                    if (quickPills) {
                        quickPills.style.display = 'none';
                    }
                    
                    setTimeout(() => mainContainer.classList.remove('is-clearing'), 150); // Remove class after transition
                });
                
                document.addEventListener('click', (event) => {
                    const isClickInside = searchBarWrapper.contains(event.target);
                    const isExpanded = mainContainer.classList.contains('UAbVe');

                    if (!isClickInside && isExpanded) {
                        collapseSearchBar();
                    }
                });

                // Initial check
                toggleSendButtons();
            }

            // --- NEW: Thinkly AI Sidebar "About" button logic ---
            function initializeThinklySidebar() {
                const menuButton = document.getElementById('thinklyMenuButton');
                const sidebar = document.getElementById('thinklySidebar');
                const overlay = document.getElementById('thinklySidebarOverlay');
                const closeButton = document.getElementById('closeThinklySidebarBtn');
                const aboutButton = document.getElementById('thinklyAboutBtn');

                console.log('ðŸ”§ Initializing Thinkly Sidebar...');
                console.log('Menu Button:', menuButton);
                console.log('Sidebar:', sidebar);
                console.log('Overlay:', overlay);
                console.log('Close Button:', closeButton);
                console.log('About Button:', aboutButton);

                const toggleSidebar = (forceClose = false) => {
                    console.log('ðŸ”„ Toggle Sidebar called, forceClose:', forceClose);
                    if (forceClose) {
                        sidebar.classList.add('-translate-x-full');
                        overlay.classList.remove('visible');
                    } else {
                        sidebar.classList.toggle('-translate-x-full');
                        overlay.classList.toggle('visible');
                    }
                };

                if (menuButton && sidebar && overlay && closeButton && aboutButton) {
                    menuButton.addEventListener('click', () => {
                        console.log('ðŸ” Menu button clicked!');
                        toggleSidebar();
                    });
                    closeButton.addEventListener('click', () => {
                        console.log('âŒ Sidebar close button clicked!');
                        toggleSidebar();
                    });
                    overlay.addEventListener('click', () => {
                        console.log('ðŸŒ«ï¸ Overlay clicked!');
                        toggleSidebar();
                    });

                    aboutButton.addEventListener('click', () => {
                        console.log('â„¹ï¸ About button clicked!');
                        toggleSidebar(true); // Force close the sidebar
                        // Trigger the AI chat flow
                        const initialMessage = `Hello! I'm Thinkly, your AI assistant for Nexbook. How can I help you today? <div class="ai-response-pills"><button class="ai-pill" data-key="what-is-nexbook">What is Nexbook?</button><button class="ai-pill" data-key="how-to-buy">How to buy a book?</button><button class="ai-pill" data-key="how-to-sell">How to sell a book?</button><button class="ai-pill" data-key="is-it-safe">Is it safe?</button></div>`;
                        addAiMessage(initialMessage);
                    });
                    
                    console.log('âœ… Thinkly Sidebar handlers attached successfully!');
                } else {
                    console.error('âŒ Thinkly Sidebar initialization failed - missing elements');
                }
            }
            
            // --- NEW: Event delegation for AI pills ---
            function setupPillListeners() {
                const chatContainers = [document.getElementById('chatOutput'), document.getElementById('expandedChatOutput')];
                chatContainers.forEach(container => {
                    if(container) {
                        container.addEventListener('click', (e) => {
                            if (e.target.classList.contains('ai-pill')) {
                                handleSend(e.target, null, true, e.target.textContent);
                            }
                        });
                    }
                });
            }

            // --- NEW: Loader on "Buy" button click ---
            // This provides instant feedback on mobile when navigating to the buy page.
            const buyBooksLink = document.querySelector('a.mobile-nav-item[data-item="buy"]');
            const pageLoader = document.getElementById('page-loader');

            if (buyBooksLink && pageLoader) {
                buyBooksLink.addEventListener('click', function(e) {
                    // Prevent the default link navigation
                    e.preventDefault();
                    // Show the loader immediately
                    pageLoader.classList.remove('hidden');
                    // Navigate to the new page after a very short delay
                    setTimeout(() => { window.location.href = this.href; }, 50);
                });
            }

            initializeThinklySidebar();

            // Initialize Thinkly AI chat on page load
            if (thinklyAiHero) {
                console.log('ðŸš€ Starting Thinkly AI Chat initialization...');
                initializeThinklyAiChat();
                console.log('âœ… Thinkly AI Chat initialization complete');
            } else {
                console.error('âŒ thinklyAiHero element not found - cannot initialize');
            }

            setupPillListeners();
            // Make AI tab scroll to the chat section
            if (aiTab) {
                aiTab.addEventListener('click', (e) => {
                    e.preventDefault();
                    thinklyAiHero.scrollIntoView({ behavior: 'smooth', block: 'center' });
                });
            }
        });
    </script>

    <!-- Enhanced Firebase Configuration and Form Handlers -->
    <script type="module">
        // --- 1. FIREBASE SERVICES (MODULE SCOPE) ---
        // The `db` object is already initialized in the global scope.
        // We just need references to other services like auth and storage here.
        const auth = firebase.auth();
        window.currentUser = null; // Make currentUser globally accessible
        let currentUser = null;
        let storage;
        try {
            // eslint-disable-next-line no-undef
            storage = firebase.storage();
            console.log("Firebase Storage service accessed in module scope.");
        } catch (error) {
            console.error("Firebase Storage service error:", error);
        }


        // --- 2. UTILITY FUNCTIONS ---
        function getFormData(form) {
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            return data;
        }

        function triggerConfetti() {
            // Multi-colored confetti animation
            const duration = 3 * 1000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 10001 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);
                
                // Launch confetti from multiple points
                confetti(Object.assign({}, defaults, {
                    particleCount,
                    origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 }
                }));
                confetti(Object.assign({}, defaults, {
                    particleCount,
                    origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 }
                }));
            }, 250);
        }

        function showSuccessModal(title, productName, message) {
            // Use the dedicated success modal
            const modal = document.getElementById('successModal');
            const titleEl = document.getElementById('successTitle');
            const productEl = document.getElementById('successProductName');
            const messageEl = document.getElementById('successMessage');
            const continueBtn = document.getElementById('successContinueBtn');
            
            // Update modal content
            titleEl.textContent = title;
            productEl.textContent = `Product: ${productName}`;
            messageEl.textContent = message;
            
            // Show modal with animation
            modal.classList.add('show');
            
            // Ensure body doesn't scroll
            document.body.style.overflow = 'hidden';
            
            // Trigger confetti after a short delay
            setTimeout(triggerConfetti, 300);
            
            // Close modal handler
            const closeModal = () => {
                modal.classList.remove('show');
                document.body.style.overflow = ''; // Restore body scroll
                
                // Reset any forms
                resetAllForms();
                
                // Ensure all other modals are properly closed
                closeAllModals();
            };
            
            continueBtn.onclick = closeModal;
            
            // Close on backdrop click
            modal.onclick = (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            };
            
            // Auto close after 15 seconds
            setTimeout(() => {
                if (modal.classList.contains('show')) {
                    closeModal();
                }
            }, 15000);
        }
        
        function closeAllModals() {
            // Close all possible modals to prevent screen freeze
            const modalSelectors = [
                '#authModal', '#backpackCheckoutModal',
                    '#cancelOrderModal', // NEW
                    '#confirmActionModal', // NEW
                '#checkoutModal', '#sellBookModal', '#freeBookModal', 
                '#requestModal', '#aiModal', '#studyMaterialModal',
                '#pickupBuddyModal'
            ];
            
            modalSelectors.forEach(selector => {
                const modal = document.querySelector(selector);
                if (modal) {
                    modal.classList.add('hidden', 'opacity-0', 'pointer-events-none');
                    modal.classList.remove('show', 'visible', 'opacity-100', 'pointer-events-auto');
                }
            });
            
            // Remove modal-open class from body
            document.body.classList.remove('modal-open');
        }
        
        function resetAllForms() {
            // Reset all forms to empty state
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                if (form.id) {
                    form.reset();
                }
            });
        }

        async function saveToFirestore(collection, data) {
            if (!db) {
                console.warn("Firebase not configured - simulating save:", { collection, data });
                // Simulate delay for demo
                await new Promise(resolve => setTimeout(resolve, 1000));
                return { id: 'demo_' + Date.now() };
            }
            
            try {
                const timestampField = collection === 'backpacks' ? 'timestamp' : 'createdAt';
                const docData = {
                    ...data,
                    ownerUid: currentUser ? currentUser.uid : null, // Automatically set the owner's UID
                    userName: currentUser ? (currentUser.displayName || currentUser.email) : 'Anonymous',
                    userEmail: currentUser ? currentUser.email : null,
                };
                docData[timestampField] = firebase.firestore.FieldValue.serverTimestamp();

                const docRef = await db.collection(collection).add(docData);
                console.log(`Document saved to ${collection} with ID:`, docRef.id);
                return docRef;
            } catch (error) {
                console.error(`Error saving to ${collection}:`, error);
                throw error;
            }
        }

        // --- 4. VALIDATION FUNCTIONS ---
        function validateFullName(name) {
            return name.trim().split(/\s+/).length > 1;
        }

        function validatePhoneNumber(phone) {
            return /^\d{10}$/.test(phone.trim());
        }

        function validateBookTitle(title) {
            return title.trim().split(/\s+/).length >= 3;
        }

        function validateAuthor(author) {
            return author.trim().split(/\s+/).length >= 3;
        }

        function validatePrice(price) {
            const numericPrice = Number(price);
            return !isNaN(numericPrice) && numericPrice > 9;
        }

        // --- Join Us Form Handler ---
        async function handleJoinUsSubmit(event) { // Renamed from ascd.html
            event.preventDefault();
            if (!currentUser) {
                showToast('Please log in to submit an application.', true);
                return;
            }

            const form = event.target;
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            setButtonLoading(submitBtn, true, originalText);

            try {
                const formDataObject = getFormData(form);
                const resumeFile = formDataObject.resume;

                // If a resume file is selected, upload it first.
                if (resumeFile && resumeFile.size > 0) {
                    if (!storage) {
                        throw new Error("Firebase Storage is not initialized.");
                    }
                    // Create a storage reference
                    const storageRef = storage.ref();
                    const filePath = `resumes/${currentUser.uid}/${Date.now()}_${resumeFile.name}`;
                    const fileRef = storageRef.child(filePath);

                    // Upload the file
                    const uploadTask = await fileRef.put(resumeFile);

                    // Get the download URL
                    const downloadURL = await uploadTask.ref.getDownloadURL();

                    // Add the URL to our form data object
                    formDataObject.resumeUrl = downloadURL;
                }

                // Remove the file object before saving to Firestore
                delete formDataObject.resume;

                // Now, save the data (with the URL instead of the file) to Firestore
                await saveToFirestore('applications', formDataObject);

                ModalManager.close('joinUsModal'); // Close the specific modal
                showSuccessModal(
                    'Application Submitted!',
                    'Thank you for your interest',
                    'We have received your application and will get back to you soon.'
                );
                form.reset();
            } catch (error) {
                console.error('Join Us submission error:', error);
                showToast(`Application failed: ${error.message}`, true);
            } finally {
                setButtonLoading(submitBtn, false, originalText);
            }
        }
        
        // --- 4. ENHANCED FORM SUBMISSION HANDLERS ---
        document.addEventListener('DOMContentLoaded', function() {
            
            // Handle form submissions with event delegation
            document.body.addEventListener('submit', async function(event) {
                console.log('Form submission detected:', event.target.id);

                if (event.target.id === 'joinUsForm') {
                    await handleJoinUsSubmit(event);
                    return;
                }

                // Auth Form Handler
                if (event.target.id === 'authForm') {
                    event.preventDefault();
                    console.log('Processing auth form');
                    
                    const form = event.target;
                    const email = form.email.value;
                    const password = form.password.value;
                    const isRegister = form.querySelector('button[type="submit"]').textContent.includes('Register');
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    
                    // Disable button and show loading
                    setButtonLoading(submitBtn, true, originalText);
                    
                    try {
                        if (isRegister) {
                            const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                            showToast('ðŸŽ‰ Registration successful! Welcome to Nexbook!');
                            console.log('User registered:', userCredential.user.email);
                            // Modal will auto-close via onAuthStateChanged
                        } else {
                            const userCredential = await auth.signInWithEmailAndPassword(email, password);
                            showToast('âœ… Login successful! Welcome back!');
                            console.log('User logged in:', userCredential.user.email);
                            // Modal will auto-close via onAuthStateChanged
                        }
                    } catch (error) {
                        console.error('Auth error:', error);
                        let errorMessage = error.message;
                        
                        // Provide user-friendly error messages
                        if (error.code === 'auth/email-already-in-use') {
                            errorMessage = 'This email is already registered. Please login instead.';
                        } else if (error.code === 'auth/weak-password') {
                            errorMessage = 'Password should be at least 6 characters long.';
                        } else if (error.code === 'auth/invalid-email') {
                            errorMessage = 'Please enter a valid email address.';
                        } else if (error.code === 'auth/user-not-found') {
                            errorMessage = 'No account found with this email. Please register first.';
                        } else if (error.code === 'auth/wrong-password') {
                            errorMessage = 'Incorrect password. Please try again.';
                        }
                        
                        showToast(errorMessage, true);
                        setButtonLoading(submitBtn, false, originalText);
                    }
                    return;
                }
                
                if (!currentUser && event.target.id !== 'authForm') {
                    event.preventDefault();
                    showToast('Please log in to perform this action.', true);
                    return;
                }
                
                // Checkout Form Handler
                if (event.target.id === 'checkoutForm') {
                    event.preventDefault();
                    console.log('Processing checkout form');
                    
                    const form = event.target;
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    
                    try {
                        setButtonLoading(submitBtn, true, originalText);
                        const formData = getFormData(form);

                        // --- Form Validation ---
                        if (!validateFullName(formData.fullName)) {
                            showToast('Validation Error: Full Name must contain more than 1 word.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        if (!validatePhoneNumber(formData.phone)) {
                            showToast('Validation Error: Phone Number must be exactly 10 digits.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        // --- End Validation ---
                        
                        // Get item details
                        const summary = form.querySelector('.bg-gray-50');
                        const itemName = summary?.querySelector('h4')?.textContent || 'Unknown Item';
                        const priceElement = form.querySelector('.flex.justify-between.font-bold.text-lg span:last-child');
                        const itemPrice = priceElement ? parseInt(priceElement.textContent.replace('â‚¹', '')) : 0;

                        // B. Specific Logging Rules
                        let transactionType = 'paid buy book'; // Default for course books
                        if (itemName.toLowerCase().includes('blazer')) {
                            transactionType = 'buy blazer';
                        } else if (itemName.toLowerCase().includes('lab coat')) {
                            transactionType = 'buy lab coat';
                        }

                        // C. Pickup Buddy Support
                        const pickupBuddyCheckbox = form.querySelector('input[name="pickupBuddy"]');
                        const pickupBuddySupport = pickupBuddyCheckbox ? pickupBuddyCheckbox.checked : false;

                        const orderData = {
                            transactionType: transactionType, // A. Add transactionType Field
                            item: itemName,
                            price: itemPrice,
                            buyerName: formData.fullName,
                            buyerPhone: formData.phone,
                            buyerEmail: formData.email,
                            quantity: formData.quantity || 1,
                            deliveryLocation: formData.deliveryLocation,
                            deliveryDate: formData.deliveryDate,
                            paymentMethod: formData.paymentMethod,
                            type: 'Purchase',
                            status: 'Pending',
                            pickupBuddySupport: pickupBuddySupport
                        };

                        await saveToFirestore('orders', orderData);
                        
                        // Close existing modal first
                        closeAllModals();
                        
                        // Show success modal
                        showSuccessModal(
                            'Order Confirmed!',
                            itemName,
                            'Your order has been placed successfully and will be processed shortly.'
                        );
                        
                        // --- FIX: Refresh the orders list ---
                        // After a successful order, re-render the My Orders modal content.
                        renderOrdersModal(currentUser);
                        
                    } catch (error) {
                        console.error('Checkout error:', error);
                        closeAllModals(); // Ensure modals are closed on error
                        showToast('Order submission failed. Please try again.', true);
                    } finally {
                        setButtonLoading(submitBtn, false, originalText);
                    }
                }
                
                // Sell Item Form Handler
                else if (event.target.id === 'sellItemForm') {
                    event.preventDefault();
                    console.log('Processing sell item form');
                    
                    const form = event.target;
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    
                    try {
                        setButtonLoading(submitBtn, true, originalText);
                        const formData = getFormData(form);

                        // --- Form Validation ---
                        if (!validateFullName(formData.sellerName)) {
                            showToast('Validation Error: Full Name must contain more than 1 word.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        if (!validatePhoneNumber(formData.sellerPhone)) {
                            showToast('Validation Error: Phone Number must be exactly 10 digits.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        if (formData.bookTitle && !validateBookTitle(formData.bookTitle)) {
                            showToast('Validation Error: Book Title must contain at least 3 words.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        if (formData.author && !validateAuthor(formData.author)) {
                            showToast('Validation Error: Author must contain at least 3 words.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        if (formData.price && !validatePrice(formData.price)) {
                            showToast('Validation Error: Selling Price must be a number greater than 9.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        // --- End Validation ---
                        
                        // Get item type
                        const itemSummary = form.querySelector('.bg-gray-50 h4, .bg-blue-50 h4');
                        const itemType = itemSummary?.textContent || formData.bookTitle || 'Item';
                        
                        // B. Specific Logging Rules
                        let transactionType = 'paid sell book'; // Default
                        if (itemType.toLowerCase().includes('blazer')) {
                            transactionType = 'sell blazer';
                        } else if (itemType.toLowerCase().includes('lab coat')) {
                            transactionType = 'sell lab coat';
                        }

                        // C. Pickup Buddy Support
                        const pickupBuddyCheckbox = form.querySelector('input[name="pickupBuddy"]');
                        const pickupBuddySupport = pickupBuddyCheckbox ? pickupBuddyCheckbox.checked : false;

                        const listingData = {
                            transactionType: transactionType, // A. Add transactionType Field
                            itemType: itemType,
                            bookTitle: formData.bookTitle || null,
                            author: formData.author || null,
                            sellerName: formData.sellerName,
                            sellerPhone: formData.sellerPhone,
                            sellerEmail: formData.sellerEmail,
                            condition: formData.condition || 'Used',
                            price: parseFloat(formData.price) || 0,
                            quantity: parseInt(formData.quantity) || 1,
                            pickupLocation: formData.pickupLocation,
                            status: 'Available',
                            pickupBuddySupport: pickupBuddySupport
                        };

                        await saveToFirestore('listings', listingData);
                        
                        // Close existing modal first
                        closeAllModals();
                        
                        // Show success modal
                        showSuccessModal(
                            'Item Listed!',
                            itemType,
                            'Your item has been listed for sale successfully.'
                        );
                        
                    } catch (error) {
                        console.error('Sell item error:', error);
                        closeAllModals(); // Ensure modals are closed on error
                        showToast('Listing submission failed. Please try again.', true);
                    } finally {
                        setButtonLoading(submitBtn, false, originalText);
                    }
                }
                
                // Free Book Form Handler
                else if (event.target.id === 'freeBookForm') {
                    event.preventDefault();
                    console.log('Processing free book form');
                    
                    const form = event.target;
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    
                    try {
                        setButtonLoading(submitBtn, true, originalText);
                        const formData = getFormData(form);

                        // --- Form Validation ---
                        if (!validateFullName(formData.fullName)) {
                            showToast('Validation Error: Full Name must contain more than 1 word.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        if (!validatePhoneNumber(formData.phone)) {
                            showToast('Validation Error: Phone Number must be exactly 10 digits.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return; // Stop submission
                        }
                        // --- End Validation ---
                        
                        // Determine action type
                        const modalTitle = form.closest('.bg-white')?.querySelector('h2')?.textContent || '';
                        let actionType, transactionType, collection;

                        if (modalTitle.includes('Grab')) {
                            actionType = 'Claim';
                            transactionType = 'free buy book';
                            collection = 'orders';
                        } else if (modalTitle.includes('Give')) {
                            actionType = 'Give';
                            transactionType = 'free sell book';
                            collection = 'listings';
                        } else if (modalTitle.includes('Swap')) {
                            actionType = 'Swap';
                            transactionType = 'free swap book';
                            collection = 'listings';
                        }
                        
                        const bookTitle = formData.bookTitle || form.querySelector('.bg-gray-50 h4')?.textContent || 'Unknown Book';
                        
                        const pickupBuddySupport = formData.pickupBuddy === 'on';

                        const freeBookData = {
                            transactionType: transactionType, // A & B. Add transactionType Field
                            actionType: actionType, // For internal logic if needed
                            bookTitle: bookTitle,
                            author: formData.author || form.querySelector('.bg-gray-50 p')?.textContent?.replace('by ', '') || '',
                            userName: formData.fullName,
                            rollNo: formData.rollNo,
                            userPhone: formData.phone,
                            userEmail: formData.email,
                            pickupLocation: formData.pickupLocation,
                            pickupDate: formData.pickupDate || null,
                            pickupTime: formData.pickupTime || null,
                            bookCondition: formData.condition || null,
                            pickupBuddySupport: pickupBuddySupport, // C. Pickup Buddy Support
                            status: 'Pending'
                        };

                        await saveToFirestore(collection, freeBookData);
                        
                        // Close existing modal first
                        closeAllModals();
                        
                        // Show success modal
                        showSuccessModal(
                            `${actionType} Request Submitted!`,
                            bookTitle,
                            `Your ${actionType.toLowerCase()} request has been submitted successfully.`
                        );
                        
                    } catch (error) {
                        console.error('Free book error:', error);
                        closeAllModals(); // Ensure modals are closed on error
                        showToast('Request submission failed. Please try again.', true);
                    } finally {
                        setButtonLoading(submitBtn, false, originalText);
                    }
                }

                // Feedback Form Handler
                else if (event.target.id === 'feedbackForm') {
                    event.preventDefault();
                    const form = event.target;
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    setButtonLoading(submitBtn, true, originalText);

                    // Although we are allowing anonymous feedback, it's good practice
                    // to check for the user. If you ever change your rules to require
                    // auth for feedback, this will prevent errors.
                    if (!currentUser) {
                        console.log("Submitting feedback as an anonymous user.");
                    }

                    try {
                        const formData = getFormData(form);
                        await saveToFirestore('feedback', formData);
                        renderFeedbackModal(true); // Show success view
                    } catch (error) {
                        console.error('Feedback submission error:', error);
                        showToast('Could not submit feedback. Please try again.', true);
                    } finally {
                        setButtonLoading(submitBtn, false, originalText);
                    }
                }


                // Backpack Checkout Form Handler
                else if (event.target.id === 'backpackCheckoutForm') {
                    event.preventDefault();
                    console.log('Processing backpack checkout form');

                    const form = event.target;
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;

                    try {
                        setButtonLoading(submitBtn, true, originalText);
                        const formData = getFormData(form);

                        if (!validateFullName(formData.fullName)) {
                            showToast('Validation Error: Full Name must contain more than 1 word.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return;
                        }
                        if (!validatePhoneNumber(formData.phone)) {
                            showToast('Validation Error: Phone Number must be exactly 10 digits.', true);
                            setButtonLoading(submitBtn, false, originalText);
                            return;
                        }

                        const backpack = getBackpack();
                        const totalAmount = backpack.reduce((acc, item) => acc + (Number(item.price) || 0), 0);

                        // Clear backpack from Firestore
                        const deletePromises = [];
                        const backpackSnapshot = await db.collection('backpacks').where('ownerUid', '==', currentUser.uid).get();
                        backpackSnapshot.forEach(doc => {
                            deletePromises.push(doc.ref.delete());
                        });
                        const orderData = {
                            transactionType: 'backpack_checkout',
                            items: backpack,
                            totalPrice: totalAmount,
                            buyerName: formData.fullName,
                            buyerPhone: formData.phone,
                            buyerEmail: formData.email,
                            deliveryLocation: formData.deliveryLocation,
                            deliveryDate: formData.deliveryDate,
                            paymentMethod: formData.paymentMethod,
                            type: 'Backpack Purchase',
                            status: 'Placed'
                        };

                        await Promise.all(deletePromises);
                        await saveToFirestore('orders', orderData);
                        closeAllModals();
                        showSuccessModal('Order Confirmed!', `${backpack.length} items from your backpack`, 'Your order has been placed and will be processed shortly.');

                    } catch (error) {
                        console.error('Backpack checkout error:', error);
                        showToast('Backpack order submission failed. Please try again.', true);
                    } finally {
                        setButtonLoading(submitBtn, false, originalText);
                    }
                }
            });
            
            // Handle click events (for non-form submissions)
            document.body.addEventListener('click', async function(event) {
                
                // Book Request Handler
                if (event.target.id === 'postRequestBtn') {
                    event.preventDefault();
                    console.log('Processing book request');
                    
                    const button = event.target;
                    const originalText = button.textContent;
                    
                    try {
                        setButtonLoading(button, true, originalText);

                        if (!currentUser) {
                            showToast('Please log in to post a request.', true);
                            setButtonLoading(button, false, originalText);
                            return;
                        }
                        
                        const form = button.closest('.p-8');
                        const bookTitle = form.querySelector('input[placeholder="Book Title"]')?.value || '';
                        const author = form.querySelector('input[placeholder="Author"]')?.value || '';
                        const subject = form.querySelector('input[placeholder="Subject"]')?.value || '';
                        const semester = form.querySelector('input[placeholder="Semester"]')?.value || '';
                        const email = form.querySelector('input[placeholder="Your Email Address"]')?.value || '';
                        
                        if (!bookTitle || !email) {
                            showToast('Please enter at least the book title and your email.', true);
                            return;
                        }

                        const requestData = {
                            bookTitle,
                            author,
                            subject,
                            semester,
                            requesterEmail: email,
                            status: 'Open'
                        };

                        await saveToFirestore('requests', requestData); // C. Use requests collection
                        
                        // Close existing modal first
                        closeAllModals();
                        
                        // Show success modal
                        showSuccessModal(
                            'Book Request Posted!',
                            bookTitle,
                            'Your book request has been posted successfully.'
                        );
                        
                    } catch (error) {
                        console.error('Book request error:', error);
                        showToast('Request submission failed. Please try again.', true);
                    } finally {
                        setButtonLoading(button, false, originalText);
                    }
                }
                
                // Add to Backpack Handler
                else if (event.target.id?.includes('addToBackpack') || event.target.classList?.contains('add-to-backpack-btn')) {
                    event.preventDefault();
                    console.log('Processing add to backpack');
                    
                    const button = event.target;
                    const originalText = button.textContent;
                    
                    try {
                        setButtonLoading(button, true, originalText);

                        if (!currentUser) {
                            showToast('Please log in to add items to your backpack.', true);
                            setButtonLoading(button, false, originalText);
                            return;
                        }
                        
                        // Extract item details from context
                        let itemData = {};
                        
                        // Try to get data from form context
                        const form = button.closest('form');
                        if (form) {
                            const formData = getFormData(form);
                            const summary = form.querySelector('.bg-gray-50, .bg-blue-50');
                            
                            itemData = {
                                title: summary?.querySelector('h4')?.textContent || formData.bookTitle || 'Unknown Item', // Get title from summary or form
                                author: summary?.querySelector('p')?.textContent?.replace('by ', '') || formData.author || '', // Get author
                                price: formData.price || 0, // Get price from form, default to 0 if not present
                                type: 'Backpack Item', // Set item type
                                userId: currentUser.uid,
                                status: 'In Backpack'
                            };
                        } else {
                            // Fallback for items outside forms
                            const parentCard = button.closest('.p-4, .p-6, .border');
                            itemData = {
                                // This part is for course books, which are not in a form
                                title: parentCard?.querySelector('.font-playfair')?.textContent || 'Unknown Item',
                                author: parentCard?.querySelector('.text-sm.text-slate-500')?.textContent?.replace('by ', '') || 'N/A',
                                price: parseInt(parentCard?.querySelector('.font-roboto')?.textContent.replace('â‚¹', ''), 10) || 0,
                                type: 'Backpack Item', 
                                userId: currentUser.uid,
                                status: 'In Backpack'
                            };
                        }

                        await saveToFirestore('backpacks', itemData); // C. Add to Backpacks
                        showToast('Item added to Backpack!');
                        
                    } catch (error) {
                        console.error('Add to backpack error:', error);
                        showToast('Failed to add item to backpack. Please try again.', true);
                    } finally {
                        setButtonLoading(button, false, originalText);
                    }
                }
            });
            
            // --- PART 4: FIREBASE AUTHENTICATION ---
            const authModal = document.getElementById('authModal');
            const authBtn = document.getElementById('authBtn');
            const authBtnMobile = document.getElementById('authBtnMobile');
            const mobileProfileSection = document.getElementById('mobileProfileSection');

            async function handleGoogleSignIn() {
                const provider = new firebase.auth.GoogleAuthProvider();
                try {
                    const result = await auth.signInWithPopup(provider);
                    showToast('Signed in with Google successfully!');
                    // The onAuthStateChanged listener will handle closing the modal.
                } catch (error) {
                    // The onAuthStateChanged listener will not fire on error, so no modal will close.
                    console.error("Google Sign-In Error:", error.message);
                if (error.code === 'auth/unauthorized-domain' || error.code === 'auth/cancelled-popup-request' || error.code === 'auth/popup-closed-by-user') {
                    showToast('Please check your browser and Google account permissions, then refresh the page and try again.', true);
                } else {
                    showToast(`Google Sign-In Failed: ${error.code}`, true);
                }
                }
            }
            window.handleGoogleSignIn = handleGoogleSignIn; // Make it globally accessible

            // --- AUTH STATE INITIALIZATION ---
            // This promise resolves once the first onAuthStateChanged event fires.
            const onAuthReady = new Promise(resolve => {
                const unsubscribe = auth.onAuthStateChanged(user => {
                    resolve(user); // Resolve with the user object (or null)
                    unsubscribe(); // Stop listening after the first check
                });
            });

            // Wait for the initial auth state before starting the app and hiding the loader
            onAuthReady.then(() => {
                window.startApp(); // Initialize the main app logic
            });

            auth.onAuthStateChanged(user => {
                currentUser = user; // For use within this module
                window.currentUser = user; // For use in other scripts
                if (user) {
                    // --- USER IS LOGGED IN ---
                    console.log('User is logged in:', user.uid, user.displayName);
                    // Automatically close the auth modal upon successful login
                    // Small delay to let success toast show
                    setTimeout(() => {
                        ModalManager.close('authModal');
                    }, 500);

                    // Hide login buttons from both navbars (with null check)
                    [authBtn, authBtnMobile].forEach(btn => {
                        if (btn) btn.classList.add('hidden');
                    });

                    // Update mobile profile section in hamburger menu - SHOW USERNAME
                    if (mobileProfileSection) {
                        const userName = user.displayName || user.email || 'User';
                        const userInitial = userName[0].toUpperCase();
                        
                        mobileProfileSection.innerHTML = `
                            <div class="flex items-center space-x-4">
                                <div class="h-14 w-14 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center">
                                    <span class="text-2xl font-bold text-white">${userInitial}</span>
                                </div>
                                <div>
                                    <div class="text-base font-semibold text-black">${userName}</div>
                                    <div class="text-sm text-gray-500">${user.email || 'Nexbook User'}</div>
                                </div>
                            </div>
                            <button id="mobileLogoutBtn" class="inline-flex items-center text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-full px-4 py-1.5 mt-4 transition-colors duration-150 group">
                                <span>Logout</span>
                                <i data-lucide="log-out" class="h-4 w-4 ml-1.5"></i>
                            </button>
                        `;
                        
                        // Initialize Lucide icons for logout button
                        if (typeof lucide !== 'undefined') {
                            lucide.createIcons();
                        }
                        
                        // Logout handler
                        document.getElementById('mobileLogoutBtn').onclick = () => {
                            const mobileMenu = document.getElementById('mobileMenu');
                            const menuOverlay = document.getElementById('menu-overlay');
                            
                            // Close hamburger menu
                            if (mobileMenu) {
                                mobileMenu.classList.add('translate-x-full');
                                mobileMenu.classList.remove('translate-x-0');
                            }
                            if (menuOverlay) {
                                menuOverlay.classList.add('hidden');
                            }
                            document.body.classList.remove('overflow-hidden');
                            
                            // Open logout confirmation modal
                            handleAuthClick();
                        };
                    }

                    // Re-attach listeners for logged-in actions - MY ORDERS requires login
                    const myOrdersBtnMobileLogin = document.getElementById('myOrdersBtnMobile');
                    if (myOrdersBtnMobileLogin) {
                        myOrdersBtnMobileLogin.onclick = preventDoubleClick(() => { 
                            renderOrdersModal(user); 
                            ModalManager.open('myOrdersModal'); 
                        });
                    }
                    
                    const menuMyOrders = document.getElementById('menuMyOrders');
                    if (menuMyOrders) {
                        menuMyOrders.onclick = (e) => {
                            e.preventDefault();
                            if (typeof ModalManager !== 'undefined') {
                                ModalManager.open('profileDashboardModal');
                                setTimeout(() => {
                                    const myOrdersBtn = document.getElementById('dashboardMyOrdersBtn');
                                    if (myOrdersBtn) myOrdersBtn.click();
                                }, 300);
                            }
                        };
                    }
                    
                    // MY BACKPACK requires login
                    const myBackpackBtnMobileLogin = document.getElementById('myBackpackBtnMobile');
                    if (myBackpackBtnMobileLogin) {
                        myBackpackBtnMobileLogin.onclick = preventDoubleClick(() => { 
                            renderBackpackModal(user); 
                            ModalManager.open('myBackpackModal'); 
                        });
                    }
                    
                    const menuBackpack = document.getElementById('menuBackpack');
                    if (menuBackpack) {
                        menuBackpack.onclick = (e) => {
                            e.preventDefault();
                            if (typeof ModalManager !== 'undefined') {
                                ModalManager.open('profileDashboardModal');
                                setTimeout(() => {
                                    const myBackpackBtn = document.getElementById('dashboardMyBackpackBtn');
                                    if (myBackpackBtn) myBackpackBtn.click();
                                }, 300);
                            }
                        };
                    }
                } else { 
                    // --- USER IS LOGGED OUT ---
                    console.log('User is logged out.'); 
                    // Show login buttons on both navbars (with null check)
                    [authBtn, authBtnMobile].forEach(btn => {
                        if (btn) btn.classList.remove('hidden');
                    });

                    // Reset mobile profile section in hamburger menu - SHOW LOGIN BUTTON
                    if (mobileProfileSection) {
                        mobileProfileSection.innerHTML = `
                            <div class="flex items-center justify-center py-6">
                                <button id="mobileLoginBtn" class="inline-flex items-center text-base font-semibold text-white bg-blue-600 hover:bg-blue-700 rounded-full px-6 py-3 transition-all duration-150 group shadow-lg">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                                        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
                                        <polyline points="10 17 15 12 10 7"></polyline>
                                        <line x1="15" y1="12" x2="3" y2="12"></line>
                                    </svg>
                                    <span>Login</span>
                                </button>
                            </div>
                        `;
                        
                        // Login button handler
                        document.getElementById('mobileLoginBtn').onclick = () => {
                            const mobileMenu = document.getElementById('mobileMenu');
                            const menuOverlay = document.getElementById('menu-overlay');
                            
                            // Close hamburger menu
                            if (mobileMenu) {
                                mobileMenu.classList.add('translate-x-full');
                                mobileMenu.classList.remove('translate-x-0');
                            }
                            if (menuOverlay) {
                                menuOverlay.classList.add('hidden');
                            }
                            document.body.classList.remove('overflow-hidden');
                            
                            // Open login modal
                            renderAuthView('login'); 
                            ModalManager.open('authModal');
                        };
                    }

                    // Attach listeners for logged-out state - REQUIRE LOGIN FOR MY ORDERS
                    const myOrdersBtnMobileLogout = document.getElementById('myOrdersBtnMobile');
                    if (myOrdersBtnMobileLogout) {
                        myOrdersBtnMobileLogout.onclick = preventDoubleClick(() => { 
                            showToast('Please log in to view your orders.', true);
                            renderAuthView('login');
                            ModalManager.open('authModal');
                        });
                    }
                    
                    const menuMyOrders = document.getElementById('menuMyOrders');
                    if (menuMyOrders) {
                        menuMyOrders.onclick = (e) => {
                            e.preventDefault();
                            showToast('Please log in to view your orders.', true);
                            renderAuthView('login');
                            ModalManager.open('authModal');
                        };
                    }
                    
                    // REQUIRE LOGIN FOR MY BACKPACK
                    const myBackpackBtnMobileLogout = document.getElementById('myBackpackBtnMobile');
                    if (myBackpackBtnMobileLogout) {
                        myBackpackBtnMobileLogout.onclick = preventDoubleClick(() => { 
                            showToast('Please log in to view your backpack.', true);
                            renderAuthView('login');
                            ModalManager.open('authModal');
                        });
                    }
                    
                    const menuBackpack = document.getElementById('menuBackpack');
                    if (menuBackpack) {
                        menuBackpack.onclick = (e) => {
                            e.preventDefault();
                            showToast('Please log in to view your backpack.', true);
                            renderAuthView('login');
                            ModalManager.open('authModal');
                        };
                    }
                }
            });

            const handleAuthClick = (isProfileDashboardRequest = false) => {
                if (currentUser) {
                    if (isProfileDashboardRequest) {
                        renderProfileDashboard();
                        ModalManager.open('profileDashboardModal');
                    } else { // This is a logout request
                        ModalManager.open('logoutConfirmModal');
                    }
                } else {
                    renderAuthView('login'); 
                    ModalManager.open('authModal');
                }
            };

            // Add null checks for auth buttons
            if (authBtn) authBtn.onclick = handleAuthClick;
            if (authBtnMobile) authBtnMobile.onclick = () => handleAuthClick(false);

            // Logout Confirmation Logic
            document.getElementById('cancelLogoutBtn').addEventListener('click', () => {
                ModalManager.close('logoutConfirmModal');
            });
            document.getElementById('confirmLogoutBtn').addEventListener('click', () => {
                auth.signOut().catch(error => {
                    console.error("Sign out error", error);
                    showToast('Logout failed. Please try again.', true);
                });
                ModalManager.close('logoutConfirmModal');
                showToast('You have been logged out.');
            });
            
            // --- PART 5: MY ORDERS PAGE ---
            async function cancelOrder(orderId) {
                if (!currentUser || !orderId) {
                    // NEW: Close the confirmation modal if it's open
                    const confirmModal = document.getElementById('confirmActionModal');
                    if (confirmModal) ModalManager.close('confirmActionModal');

                    showToast('Could not cancel order. Please try again.', true);
                    return;
                }
                try {
                    const orderRef = db.collection('orders').doc(orderId);
                    await orderRef.update({ status: 'Cancelled' });
                    showToast('Order has been cancelled.');
                    // NEW: Close any open modals (like the confirmation modal)
                    ModalManager.close('confirmActionModal');
                    ModalManager.close('cancelOrderModal');
                    renderOrdersModal(currentUser); // Refresh the modal view
                } catch (error) {
                    console.error("Error cancelling order:", error);
                    showToast('Failed to cancel order. Please try again.', true);
                    ModalManager.close('confirmActionModal');
                }
            }
            // Make it globally accessible
            window.cancelOrder = cancelOrder;

            // NEW: Function to show the cancellation reason modal
            function showCancelReasonModal(orderId) {
                const modal = document.getElementById('cancelOrderModal');
                const orderCard = document.querySelector(`.order-card[data-order-id="${orderId}"]`);
                if (!orderCard) return;

                orderCard.innerHTML = `
                    <div class="p-8">
                        <form id="cancelReasonForm" class="space-y-3">
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="reason" value="Ordered by mistake" class="mr-3" checked> Ordered by mistake</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="reason" value="Found a better price" class="mr-3"> Found a better price elsewhere</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="reason" value="Delivery time too long" class="mr-3"> Delivery time too long</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="reason" value="Change address or item" class="mr-3"> Want to change address or item</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="reason" value="Other" class="mr-3"> Other</label>
                            <textarea name="other_reason" placeholder="Please specify..." class="w-full p-2 border border-gray-300 rounded-md hidden mt-2"></textarea>
                            <div class="flex gap-4 pt-4">
                                <button type="button" class="inline-cancel-btn w-full h-12 bg-gray-200 text-gray-800 rounded-lg font-semibold button-animation">Don't Cancel</button>
                                <button type="submit" class="w-full h-12 bg-red-600 text-white rounded-lg font-semibold button-animation">Proceed to Cancel</button>
                            </div>
                        </form>
                    </div>
                `;

                const form = orderCard.querySelector('#cancelReasonForm');
                const otherTextarea = form.querySelector('textarea[name="other_reason"]');

                form.addEventListener('change', (e) => {
                    if (e.target.name === 'reason') {
                        otherTextarea.classList.toggle('hidden', e.target.value !== 'Other');
                    }
                });

                orderCard.querySelector('.inline-cancel-btn').onclick = () => renderOrdersModal(currentUser);

                form.onsubmit = (e) => {
                    e.preventDefault();
                    const reason = new FormData(form).get('reason');
                    if (reason === 'Other' && !otherTextarea.value.trim()) {
                        showToast('Please specify a reason.', true);
                        return;
                    }
                    showConfirmationModal(orderId);
                };
            }

            // NEW: Function to show the final confirmation modal
            function showConfirmationModal(orderId) {
                const modal = document.getElementById('confirmActionModal');
                const title = modal.querySelector('#confirmActionTitle');
                const message = modal.querySelector('#confirmActionMessage');
                const confirmBtn = modal.querySelector('#confirmActionConfirmBtn');
                const cancelBtn = modal.querySelector('#confirmActionCancelBtn');
                const icon = modal.querySelector('#confirmActionIcon');

                title.textContent = 'Are you sure?';
                message.textContent = 'Are you sure you want to cancel this order?';
                confirmBtn.textContent = 'Yes, Cancel Order';
                cancelBtn.textContent = 'No, Keep Order';
                icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>`;

                confirmBtn.onclick = () => cancelOrder(orderId);
                cancelBtn.onclick = () => ModalManager.close('confirmActionModal');

                ModalManager.open('confirmActionModal');
            }

            // NEW: Show order options menu
            function showOrderOptions(button, orderId, status) {
                // Close any other open menus
                document.querySelectorAll('.order-options-menu').forEach(menu => menu.remove());

                // NEW: Get the full order object from a data attribute on the button
                const orderDataString = button.dataset.orderObject;
                const order = orderDataString ? JSON.parse(orderDataString) : null;

                const menuTemplate = document.getElementById('order-options-template').firstElementChild.cloneNode(true);
                menuTemplate.classList.add('order-options-menu');
                // NEW: Add a close button to the menu
                menuTemplate.innerHTML = `
                    <button class="absolute top-1 right-1 p-1 text-gray-400 hover:text-gray-700 hover:bg-gray-100 rounded-full close-order-options">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                    <div class="mt-4"></div>
                `;

                // NEW: Function to handle sharing
                const handleShare = (order, orderId) => {
                    const shareText = `Check out my Nexbook order details:\nOrder ID: ${orderId}\nItem: ${order.item || (order.items && order.items.map(i => i.title).join(', '))}\nStatus: ${order.status}`;
                    if (navigator.share) {
                        navigator.share({ title: 'Nexbook Order Details', text: shareText, url: window.location.href });
                    } else {
                        showToast('Sharing is not supported on your browser.');
                    }
                };

                let optionsHTML = '';

                if (status === 'Delivered' || status === 'Completed') {
                    optionsHTML = `<div class="max-h-60 overflow-y-auto">
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="view-details"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>View Details</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="download-invoice"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>Download Invoice</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="report-problem"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 2.1l4 4-4 4"/><path d="M3 12.6v-2.1c0-2 1-3.5 3-4.5"/><path d="M21 12.6v-2.1c0-2-1-3.5-3-4.5"/><path d="M7 21.9l-4-4 4-4"/><path d="M3 11.4v2.1c0 2 1 3.5 3 4.5"/><path d="M21 11.4v2.1c0 2-1 3.5-3 4.5"/></svg>Return / Replace Item</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="write-review"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/></svg>Write a Review</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="buy-again"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/><path d="M16 16.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"/><path d="M8.5 18a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"/><path d="M12 12v6"/><path d="M9 15h6"/></svg>Buy Again</button>
                        <div class="border-t my-1"></div>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-red-600 hover:bg-red-50" data-action="report-problem"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>Report a Problem</button>
                    </div>`;
                } else if (status === 'Cancelled') {
                    optionsHTML = `<div class="max-h-60 overflow-y-auto">
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="view-details"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>View Details</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="buy-again"><span class="material-symbols-outlined w-6 h-6 text-gray-500 text-xl">shopping_cart</span>Reorder / Buy Again</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="download-invoice"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>Download Invoice / Bill</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="track-refund"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/></svg>Track Refund</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="share-details"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg>Share Order Details</button>
                        <div class="border-t my-1"></div>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-red-600 hover:bg-red-50" data-action="report-problem"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>Report a Problem</button>
                    </div>`;
                } else { // For Pending, Shipped, etc.
                    optionsHTML = `<div class="max-h-60 overflow-y-auto">
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="view-details"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M10 9H8"/><path d="M16 13H8"/><path d="M16 17H8"/></svg>View Details</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="change-date"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Change Delivery Date</button>
                        <a href="mailto:nexbookofficial@gmail.com?subject=Support for Order ${orderId}" class="flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-100"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>Contact Support</a>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100" data-action="download-invoice"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>View Invoice</button>
                        <div class="border-t my-1"></div>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-red-600 hover:bg-red-50" data-action="cancel-order"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>Cancel Order</button>
                        <button class="order-action-btn flex items-center gap-3 w-full text-left px-4 py-2 text-red-600 hover:bg-red-50" data-action="report-problem"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>Report a Problem</button>
                    </div>`;
                }
                menuTemplate.querySelector('div').insertAdjacentHTML('afterend', optionsHTML);
                button.parentElement.appendChild(menuTemplate);


                // NEW: Add listener for the new close button
                menuTemplate.querySelector('.close-order-options').addEventListener('click', (e) => {
                    e.preventDefault();
                    menuTemplate.remove();
                });

                // Add listener for the cancel button inside the new menu
                menuTemplate.querySelectorAll('.order-action-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        const action = btn.dataset.action;
                        menuTemplate.remove(); // Close menu on action
                        switch(action) {
                            case 'cancel-order':
                                showCancelReasonModal(orderId);
                                break;
                            case 'view-details':
                                renderOrderDetailsModal(order, orderId);
                                break;
                            case 'change-date':
                                renderChangeDateModal(orderId, order.deliveryDate);
                                break;
                            case 'download-invoice':
                                renderInvoiceModal(order, orderId);
                                break;
                            case 'buy-again':
                                // This assumes a function `handleBuy` exists and can take an order object
                                if (order.items && Array.isArray(order.items)) {
                                    // This was a multi-item (backpack) order.
                                    renderBackpackCheckoutModal(order.items);
                                    ModalManager.open('backpackCheckoutModal');
                                } else {
                                    // This was a single-item order.
                                    handleBuy({ title: order.item, price: order.price, author: order.author || 'N/A' });
                                }
                                break;
                            case 'track-refund':
                                // NEW: Show refund info modal for POD orders
                                const confirmModal = document.getElementById('confirmActionModal');
                                const title = confirmModal.querySelector('#confirmActionTitle');
                                const message = confirmModal.querySelector('#confirmActionMessage');
                                const confirmBtn = confirmModal.querySelector('#confirmActionConfirmBtn');
                                const cancelBtn = confirmModal.querySelector('#confirmActionCancelBtn');
                                const icon = confirmModal.querySelector('#confirmActionIcon');

                                title.textContent = 'Refund Information';
                                message.textContent = 'This was a "Pay on Delivery" order. Since no payment was made online, no refund is applicable.';
                                confirmBtn.textContent = 'Okay, Got It';
                                cancelBtn.classList.add('hidden'); // Hide the cancel button
                                icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`;

                                confirmBtn.onclick = () => {
                                    ModalManager.close('confirmActionModal');
                                    cancelBtn.classList.remove('hidden'); // Show it again for next time
                                };
                                ModalManager.open('confirmActionModal');
                                break;
                            case 'share-details':
                                handleShare(order, orderId);
                                break;
                            case 'report-problem':
                                renderReportProblemModal(orderId);
                                break;
                        }
                    });
                });
                // Close menu when clicking outside
                setTimeout(() => {
                    document.addEventListener('click', function closeMenu(e) {
                        if (!menuTemplate.contains(e.target) && !button.contains(e.target)) {
                            menuTemplate.remove();
                            document.removeEventListener('click', closeMenu);
                        }
                    });
                }, 0);
            }

            // NEW: Render Order Details Modal
            function renderOrderDetailsModal(order, orderId) {
                const content = document.getElementById('orderDetailsContent');
                if (!order) {
                    content.innerHTML = `<p class="text-center text-gray-500 py-8">Order details not found.</p>`;
                    ModalManager.open('orderDetailsModal');
                    return;
                }

                const itemsSummary = Array.isArray(order.items)
                    ? order.items.map(item => `<div class="flex justify-between py-2 border-b"><span class="font-medium">${item.title}</span><span class="font-roboto">${item.price === 'FREE' ? 'FREE' : 'â‚¹' + item.price}</span></div>`).join('')
                    : `<div class="flex justify-between py-2 border-b"><span class="font-medium">${order.item}</span><span class="font-roboto">â‚¹${order.price}</span></div>`;

                const paymentStatus = (order.status === 'Delivered' || order.status === 'Completed') ? '<span class="font-semibold text-green-600">Paid</span>' : '<span class="font-semibold text-red-500">Unpaid</span>';


                content.innerHTML = `
                    <div class="space-y-6">
                        <div>
                            <p class="text-sm text-gray-500">Order ID</p>
                            <p class="font-mono text-gray-700">${orderId}</p>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h3 class="font-bold text-lg mb-2">Items</h3>
                            ${itemsSummary}
                            <div class="flex justify-between font-bold text-lg pt-2"><span>Total</span><span class="font-roboto">â‚¹${order.totalPrice || order.price}</span></div>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg mb-2">Delivery Details</h3>
                            <p><span class="font-semibold">Name:</span> ${order.buyerName}</p>
                            <p><span class="font-semibold">Phone:</span> ${order.buyerPhone}</p>
                            <p><span class="font-semibold">Location:</span> ${order.deliveryLocation}</p>
                            <p><span class="font-semibold">Date:</span> ${order.deliveryDate} <span class="text-sm text-gray-500"> (Ordered: ${new Date(order.createdAt.seconds * 1000).toLocaleString()})</span></p>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg mb-2">Payment</h3>
                            <p><span class="font-semibold">Method:</span> ${order.paymentMethod}</p>
                            <p><span class="font-semibold">Status:</span> ${paymentStatus}</p>
                        </div>
                    </div>
                `;
                ModalManager.open('orderDetailsModal');
            }

            // NEW: Render Change Delivery Date Modal
            function renderChangeDateModal(orderId, currentDate) {
                const orderCard = document.querySelector(`.order-card[data-order-id="${orderId}"]`);
                if (!orderCard) return;

                const getNextDeliveryDates = () => {
                    const dates = []; let today = new Date();
                    for (let i = 0; i < 14 && dates.length < 4; i++) {
                        let nextDate = new Date(today); nextDate.setDate(today.getDate() + i);
                        const day = nextDate.getDay(); if (day === 1 || day === 4) { dates.push(nextDate.toDateString()); }
                    } return dates;
                };
                const deliveryDates = getNextDeliveryDates();
                orderCard.innerHTML = `
                    <div class="p-8">
                        <form id="changeDateForm">
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                ${deliveryDates.map(date => `<label class="flex-1"><input type="radio" name="deliveryDate" value="${date}" required class="sr-only peer"/><div class="p-3 text-center border rounded-lg peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 cursor-pointer">${date}</div></label>`).join('')}
                            </div>
                            <div class="flex gap-4">
                                <button type="button" class="inline-cancel-btn w-full h-12 bg-gray-200 text-gray-800 rounded-lg font-semibold button-animation">Cancel</button>
                                <button type="submit" class="w-full h-12 bg-blue-600 text-white rounded-lg font-semibold button-animation">Update Date</button>
                            </div>
                        </form>
                    </div>
                `;
                orderCard.querySelector('.inline-cancel-btn').onclick = () => renderOrdersModal(currentUser);
                orderCard.querySelector('#changeDateForm').onsubmit = async (e) => {
                    e.preventDefault();
                    const newDate = new FormData(e.target).get('deliveryDate');
                    if (!newDate) {
                        showToast('Please select a new date.', true);
                        return;
                    }
                    try {
                        await db.collection('orders').doc(orderId).update({ deliveryDate: newDate });
                        showToast('Delivery date updated successfully!');
                        renderOrdersModal(currentUser); // Refresh view
                    } catch (error) {
                        showToast('Failed to update date. Please try again.', true);
                        console.error("Date change error:", error);
                    }
                };
            }

            // NEW: Render Report a Problem Modal
            function renderReportProblemModal(orderId) {
                const modal = document.getElementById('reportProblemModal');
                const content = modal.querySelector('.modal-content');
                content.innerHTML = `
                    <div class="p-8">
                        <h2 class="text-2xl font-bold mb-2">Report a Problem</h2>
                        <p class="text-gray-600 mb-6">Order ID: ${orderId}</p>
                        <form id="reportProblemForm" class="space-y-3">
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="issue" value="change_address" class="mr-3" checked> I want to change my delivery address</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="issue" value="change_variant" class="mr-3"> I want to change the product variant / size / color</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="issue" value="add_remove_item" class="mr-3"> I want to add / remove an item from my order</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="issue" value="cancel_order" class="mr-3"> I want to cancel my order</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="issue" value="wrong_contact" class="mr-3"> I entered wrong contact number or email</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="issue" value="order_query" class="mr-3"> I have a query about my order</label>
                            <label class="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer"><input type="radio" name="issue" value="other" class="mr-3"> Other</label>
                            <textarea name="other_issue" placeholder="Please describe your issue..." class="w-full p-2 border border-gray-300 rounded-md hidden mt-2"></textarea>
                            <div class="flex gap-4 pt-4">
                                <button type="button" id="closeReportProblemBtn" class="w-full h-12 bg-gray-200 text-gray-800 rounded-lg font-semibold button-animation">Cancel</button>
                                <button type="submit" class="w-full h-12 bg-blue-600 text-white rounded-lg font-semibold button-animation">Submit Report</button>
                            </div>
                        </form>
                    </div>
                `;
                ModalManager.open('reportProblemModal');

                const form = content.querySelector('#reportProblemForm');
                const otherTextarea = form.querySelector('textarea[name="other_issue"]');
                form.addEventListener('change', (e) => {
                    if (e.target.name === 'issue') {
                        otherTextarea.classList.toggle('hidden', e.target.value !== 'Other');
                    }
                });

                document.getElementById('closeReportProblemBtn').onclick = () => ModalManager.close('reportProblemModal');
                form.onsubmit = async (e) => {
                    e.preventDefault();
                    const formData = new FormData(form);
                    const issue = formData.get('issue');
                    const other_issue = formData.get('other_issue');
                    if (issue === 'Other' && !other_issue.trim()) {
                        showToast('Please describe your issue.', true);
                        return;
                    }
                    try {
                        await saveToFirestore('reports', { orderId, issue, details: other_issue, status: 'Open' });
                        ModalManager.close('reportProblemModal');
                        showToast('âœ… Your issue has been reported! Our support team will get back to you within 24 hours.');
                    } catch (error) {
                        showToast('Failed to submit report. Please try again.', true);
                        console.error("Report submission error:", error);
                    }
                };
            }

            // NEW: Render Invoice Modal (Print-based)
            function renderInvoiceModal(order, orderId) {
                const modal = document.getElementById('invoiceModal');
                const content = modal.querySelector('.modal-content');
                
                // Generate a unique invoice number from the order ID
                const invoiceNumber = `INV-${orderId.substring(0, 4).toUpperCase()}-${(order.createdAt.seconds % 10000).toString().padStart(4, '0')}`;

                const isMultiItem = Array.isArray(order.items) && order.items.length > 0;
                const itemsToRender = isMultiItem ? order.items : [{ title: order.item, price: order.price, quantity: order.quantity || 1, author: order.author || 'N/A' }];

                const itemsHTML = Array.isArray(order.items)
                    ? order.items.map(item => `
                        <tr class="border-b">
                            <td class="py-3 pr-3">
                                <p class="font-semibold">${item.title}</p>
                                <p class="text-sm text-gray-500">${item.author || 'Book'}</p>
                            </td>
                            <td class="py-3 px-3 text-center">${item.quantity || 1}</td>
                            <td class="py-3 px-3 text-right font-roboto">â‚¹${item.price}</td>
                            <td class="py-3 pl-3 text-right font-roboto">â‚¹${(item.quantity || 1) * item.price}</td>
                        </tr>`).join('')
                    : `
                        <tr class="border-b">
                            <td class="py-3 pr-3">
                                <p class="font-semibold">${order.item}</p>
                                <p class="text-sm text-gray-500">${order.author || 'Book'}</p>
                            </td>
                            <td class="py-3 px-3 text-center">${order.quantity || 1}</td>
                            <td class="py-3 px-3 text-right font-roboto">â‚¹${order.price}</td>
                            <td class="py-3 pl-3 text-right font-roboto">â‚¹${(order.quantity || 1) * order.price}</td>
                        </tr>`;

                const paymentStatusText = (order.status === 'Delivered' || order.status === 'Completed') ? '<span class="font-semibold text-green-600">Paid</span>' : '<span class="font-semibold text-orange-500">Pending</span>';
                const subtotal = isMultiItem ? order.totalPrice : order.price;

                content.innerHTML = ` 
                    <button id="closeInvoiceModalBtn" class="absolute top-4 right-4 bg-gray-100 rounded-full p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 transition-all button-animation z-20">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                    <div class="flex-shrink-0 flex items-center justify-between p-6 border-b sticky top-0 bg-white/80 backdrop-blur-md z-10">
                        <h2 class="text-2xl font-bold logo-font">Invoice / Receipt</h2>
                        <div>
                            <button id="printInvoiceBtn" class="bg-blue-100 text-blue-700 font-semibold py-2 px-4 rounded-lg button-animation mr-12 relative">Download PDF</button>
                        </div>
                    </div>
                    <div id="invoice-printable-area" class="p-8 overflow-y-auto">
                        <div class="flex justify-between items-start mb-8">
                            <div>
                                <h1 class="text-3xl font-bold logo-font text-blue-600">Nexbook</h1>
                                <p class="text-gray-600">S.S. Jain Subodh P.G. College</p>
                                <p class="text-gray-600">thenexbook.com</p>
                            </div>
                            <div class="text-right">
                                <h2 class="text-2xl font-bold">INVOICE</h2>
                                <p class="text-sm text-gray-500">Invoice #: ${invoiceNumber}</p>
                                <p class="text-sm text-gray-500">Order ID: ${orderId.substring(0, 10)}...</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-8 mb-8"> 
                            <div>
                                <h3 class="font-bold">Bill To:</h3>
                                <p>${order.buyerName || 'N/A'}</p>
                                <p class="text-sm text-gray-600">${order.buyerEmail || ''}</p>
                                <p class="text-sm text-gray-600">${order.buyerPhone || ''}</p>
                            </div>
                            <div class="text-right"><h3 class="font-bold">Ship To:</h3><p>${order.deliveryLocation}</p><h3 class="font-bold mt-2">Invoice Date:</h3><p>${new Date(order.createdAt.seconds * 1000).toLocaleString()}</p></div>
                        </div>
                        <table class="w-full text-left">
                            <thead><tr class="bg-gray-100"><th class="p-2 font-bold rounded-l-lg">Item / Description</th><th class="p-2 font-bold text-center">Qty</th><th class="p-2 font-bold text-right">Unit Price</th><th class="p-2 font-bold text-right rounded-r-lg">Total</th></tr></thead>
                            <tbody>${itemsHTML}</tbody>
                            <tfoot>
                                <tr class="border-t-2"><td colspan="3" class="pt-4 font-semibold text-right">Subtotal</td><td class="pt-4 font-semibold text-right font-roboto">â‚¹${subtotal}</td></tr>
                                <tr><td colspan="3" class="py-1 text-right">Shipping</td><td class="py-1 text-right font-roboto">FREE</td></tr>
                                <tr><td colspan="3" class="py-1 text-right">Discount</td><td class="py-1 text-right font-roboto">â‚¹0.00</td></tr>
                                <tr class="border-t-2 border-gray-800"><td colspan="3" class="pt-2 text-xl font-bold text-right">Grand Total</td><td class="pt-2 text-xl font-bold text-right font-roboto">â‚¹${subtotal}</td></tr>
                            </tfoot>
                        </table>
                        <div class="mt-10">
                            <h3 class="font-bold">Payment Info</h3>
                            <p>Method: ${order.paymentMethod || 'Pay on Delivery'}</p>
                            <p>Status: ${paymentStatusText}</p>
                        </div>
                        <div class="text-center text-gray-500 mt-12 border-t pt-6">
                            <p class="font-semibold">Thank you for shopping with Nexbook!</p>
                            <p class="text-sm">For support, contact: nexbookofficial@gmail.com</p>
                            <p class="text-xs mt-4"><strong>Terms & Conditions:</strong> Payment is due upon delivery.</p>
                        </div>
                    </div>
                `;
                ModalManager.open('invoiceModal');
                document.getElementById('closeInvoiceModalBtn').onclick = () => ModalManager.close('invoiceModal');
                document.getElementById('printInvoiceBtn').onclick = async () => {
                    const button = document.getElementById('printInvoiceBtn');
                    const originalText = button.textContent;
                    setButtonLoading(button, true, 'Downloading...');
                    
                    const { jsPDF } = window.jspdf;
                    const invoiceElement = document.getElementById('invoice-printable-area');

                    // Temporarily adjust styles to ensure html2canvas captures the full scrollable content
                    const originalHeight = invoiceElement.style.height;
                    const originalOverflow = invoiceElement.style.overflowY;
                    invoiceElement.style.height = 'auto';
                    invoiceElement.style.overflowY = 'visible';

                    try {
                        const canvas = await html2canvas(invoiceElement, { scale: 2, useCORS: true }); // Increased scale for high quality
                        const imgData = canvas.toDataURL('image/png'); // Use PNG for lossless, clear text
                        const pdf = new jsPDF('p', 'mm', 'a4');
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        const pdfHeight = (canvas.height * pdfWidth) / canvas.width;
                        pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                        pdf.save(`Nexbook-Invoice-${orderId.substring(0, 8)}.pdf`);
                    } catch (error) { console.error("PDF generation failed:", error); showToast('Could not generate PDF. Please try again.', true); } finally {
                        setButtonLoading(button, false, originalText);
                        // Restore original styles
                        invoiceElement.style.height = originalHeight;
                        invoiceElement.style.overflowY = originalOverflow;
                    }
                };
            }

            window.renderOrdersModal = async function(user) {
                if (!user) {
                    myOrdersContent.innerHTML = `<div class="text-center text-gray-500 py-16">Please log in to see your orders.</div>`;
                    return;
                }

                // Set loading state: make the container a flex-center box
                myOrdersContent.className = 'flex-grow flex items-center justify-center';
                myOrdersContent.innerHTML = `
                    <div class="w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"></div>
                `;

                try {
                    const ordersSnapshot = await db.collection('orders').where('ownerUid', '==', user.uid).orderBy('createdAt', 'desc').get();
                    // Restore original classes after loading
                    myOrdersContent.className = 'p-8 overflow-y-auto';

                    if (ordersSnapshot.empty) {
                        myOrdersContent.innerHTML = `<div class="text-center text-gray-500 py-16">You have no past orders.</div>`;
                        return;
                    }

                    let ordersHTML = '<div class="space-y-8">';
                    ordersSnapshot.forEach(doc => {
                        const order = doc.data();
                        const orderId = doc.id;
                        // Generate a 5-digit order number from the timestamp
                        const numericOrderId = (order.createdAt.seconds * 1000 + order.createdAt.nanoseconds / 1000000) % 100000;
                        const status = order.status || 'Placed'; // Default to 'Placed'
                        const statuses = ['Placed', 'Shipped', 'Delivered']; // Simplified statuses
                        const currentStatusIndex = statuses.indexOf(status); // Corrected to use statuses array

                        const itemsSummary = Array.isArray(order.items) 
                            ? order.items.map(item => `<h4 class="text-xl font-bold text-gray-800">${item.title} <span class="font-roboto">(${item.price === 'FREE' ? 'FREE' : 'â‚¹' + item.price})</span></h4>`).join('')
                            : `<h4 class="text-xl font-bold text-gray-800">${order.item} <span class="font-roboto">(â‚¹${order.price})</span></h4>`;

                        // NEW: Conditional rendering for status tracker
                        const statusTrackerHTML = status === 'Cancelled'
                            ? `
                            <div class="text-center py-4 bg-red-50 rounded-lg border border-red-200 mt-4">
                                <p class="text-lg font-bold text-red-600">Order Cancelled</p>
                            </div>
                            `
                            : `
                            <div class="order-status-tracker">
                                ${statuses.map((s, index) => {
                                    const isActive = index <= currentStatusIndex;
                                    const placedIcon = (s === 'Placed' && isActive) ? `<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-white absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>` : '';
                                    return `
                                    <div class="status-step ${isActive ? 'active' : ''}">
                                        <div class="status-dot relative">${placedIcon}</div>
                                        <p class="text-xs font-semibold mt-1">${s}</p>
                                    </div>`;
                                }).join('')}
                            </div>`;

                        const optionsBtnHtml = `
                            <div class="relative">
                                <button class="order-options-btn p-1 rounded-full hover:bg-gray-100" data-order-id="${orderId}" data-status="${status}" data-order-object='${JSON.stringify(order)}'>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg>
                                </button>
                            </div>`;

                        ordersHTML += `
                            <div class="order-card bg-white rounded-2xl shadow-md border p-6" data-order-id="${orderId}">
                                <div class="flex justify-between items-start mb-4">
                                    <div class="font-bold text-lg">
                                        <h3>Order <span class="font-roboto">${String(Math.floor(numericOrderId)).padStart(5, '0')}</span></h3>
                                        <p class="text-sm text-gray-500 font-sans font-normal">Date: ${new Date(order.createdAt.seconds * 1000).toLocaleDateString()}</p>
                                    </div>
                                    ${optionsBtnHtml}
                                </div>
                                <div class="mb-6">
                                    ${itemsSummary}
                                    <p class="text-xs text-gray-400 mt-1">Order ID: ${orderId}</p>
                                </div>
                                
                                ${statusTrackerHTML}
                            </div>
                        `;
                    });
                    ordersHTML += '</div>';
                    myOrdersContent.innerHTML = ordersHTML;

                    // Add event listeners for the new 3-dot menu buttons
                    myOrdersContent.querySelectorAll('.order-options-btn').forEach(btn => {
                        btn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            showOrderOptions(this, this.dataset.orderId, this.dataset.status);
                        });
                    });

                } catch (error) {
                    if (error.code === 'failed-precondition') {
                        console.error("Firestore Index Error:", error.message);
                        console.error("Please create the required composite index in your Firebase console.");
                    } else {
                        console.error("Error fetching orders:", error);
                    }
                    console.error("Error fetching orders:", error);
                    myOrdersContent.innerHTML = `<div class="text-center text-red-500 py-16">Failed to load orders. Please try again.</div>`;
                }
            }

            // --- NEW MOBILE NAV LOGIC ---
            const mobileNavContainer = document.querySelector('.mobile-nav-container');
            const mobileNavItems = document.querySelectorAll('.mobile-nav-item');

            function handleNavClick(e) {
                // Check if the link is external or meant to open in a new tab. If so, do nothing.
                const isExternalLink = e.currentTarget.getAttribute('target') === '_blank';
                if (isExternalLink) {
                    return; // Let the browser handle the click
                }
                
                // NEW: Check if the clicked item is the "Buy" button.
                // If it is, we should NOT prevent the default behavior, so it can navigate to buy-books.html.
                const itemTypeCheck = e.currentTarget.dataset.item;
                if (itemTypeCheck === 'buy') {
                    // Allow the link to navigate normally.
                    return;
                }

                // For all other items, prevent the default anchor behavior to handle it with JS.
                e.preventDefault();

                const item = e.currentTarget;
                const itemType = item.dataset.item;

                mobileNavItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                switch (itemType) {
                    case 'home':
                        document.getElementById('top')?.scrollIntoView({ behavior: 'smooth' });
                        break;
                    case 'buy':
                        document.getElementById('browse-courses')?.scrollIntoView({ behavior: 'smooth' });
                        break;
                    case 'think':
                        // Smooth scroll to Thinkly AI section - NO page jump!
                        const thinklySection = document.getElementById('thinkly-ai-hero');
                        if (thinklySection) {
                            thinklySection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                        break;
                    case 'profile':
                        // hamburgerBtn.click(); // Open the main mobile menu
                        renderProfileDashboard(); // Prepare the content
                        ModalManager.open('profileDashboardModal'); // Open the modal
                        break;
                }
            }

            mobileNavItems.forEach(item => {
                item.addEventListener('click', handleNavClick);
            });

            // --- Mobile Nav Hide on Scroll ---
            const mobileNavbar = document.querySelector('.mobile-nav-container');
            let lastScrollY = window.scrollY;
            const scrollDelta = 10;

            window.addEventListener('scroll', () => {
                // This gets the new (current) scroll position.
                const currentScrollY = window.scrollY;

                // Here we check if the scroll movement is too small.
                // If it is, the function stops here.
                if (Math.abs(lastScrollY - currentScrollY) <= scrollDelta) {
                    return;
                }

                // This is the HIDE condition:
                // 1. Is the user scrolling DOWN? (currentScrollY > lastScrollY)
                // 2. Has the user scrolled more than 100px from the top of the page?
                const shouldHide = currentScrollY > lastScrollY && currentScrollY > 100;
                mobileNavbar.classList.toggle('nav-hidden', shouldHide);

                // Finally, we update 'lastScrollY' so that for the next scroll, we have the correct previous position.
                lastScrollY = currentScrollY <= 0 ? 0 : currentScrollY;
            });

            // This function will be called by the Firebase auth script once the auth state is known.
            window.startApp = () => {
                console.log('Auth state confirmed. Starting app...');
                initialize();

                // --- Thinkly AI Button Handlers ---
                const handleThinklyClick = (e) => {
                    if (e) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                    console.log('Thinkly AI button clicked - opening directly'); // Debug log
                    
                    // DIRECT OPEN - No scrolling, just expand fullscreen
                    const expandedView = document.querySelector('#thinkly-ai-hero #expandedView');
                    
                    if(expandedView) {
                        // Save current scroll position
                        const scrollY = window.scrollY;
                        
                        // Freeze body without forcing scroll to top
                        document.body.style.position = "fixed";
                        document.body.style.top = `-${scrollY}px`;
                        document.body.style.left = "0";
                        document.body.style.right = "0";
                        document.body.style.width = "100%";
                        
                        // Open fullscreen chat directly
                        expandedView.classList.add('visible');
                        document.getElementById('mobile-nav')?.classList.add('hidden');
                        
                        console.log('Thinkly AI opened in fullscreen directly'); // Debug log
                    }
                };
                document.getElementById('aiHelperBtnNav')?.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    handleThinklyClick(e);
                });
                document.getElementById('aiHelperBtnMobile')?.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    handleThinklyClick(e);
                });
            };

            console.log('Enhanced Firebase form handlers initialized!');
            
            // --- Mobile Bottom Nav Thinkly AI Button ---
            const mobileThinklyBtn = document.getElementById('mobileThinklyBtn');
            if (mobileThinklyBtn) {
                mobileThinklyBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    handleThinklyClick(e);
                });
                console.log('âœ… Mobile Thinkly AI button connected');
            }
        });

    </script>

    <script>
        // --- OPTIMIZED: Instant Loader Hide on DOM Ready ---
        // Hide loader as soon as DOM is interactive - no waiting for images/scripts
        (function() {
            const loader = document.getElementById('page-loader');
            
            // Function to hide loader
            const hideLoader = () => {
                if (loader && !loader.classList.contains('hidden')) {
                    // Use requestAnimationFrame for smooth transition
                    requestAnimationFrame(() => {
                        loader.classList.add('hidden');
                        // Remove from DOM after transition completes (200ms)
                        setTimeout(() => {
                            if (loader.parentNode) {
                                loader.parentNode.removeChild(loader);
                            }
                        }, 200);
                    });
                }
            };

            // Hide immediately when DOM is ready (fastest)
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', hideLoader);
            } else {
                // DOM already loaded, hide immediately
                hideLoader();
            }
        })();

        // --- Connection Status Handler ---
        document.addEventListener('DOMContentLoaded', () => {
            const connectionAlert = document.getElementById('connection-alert');

            const updateConnectionStatus = () => {
                if (navigator.onLine) {
                    connectionAlert.classList.remove('show');
                } else {
                    connectionAlert.classList.add('show');
                }
            };

            window.addEventListener('online', updateConnectionStatus);
            window.addEventListener('offline', updateConnectionStatus);

            // Initial check on page load
            updateConnectionStatus();
        });
    </script>

    <script type="text/babel">
        const { useEffect, useMemo, useRef } = React;

        // Register the GSAP ScrollTrigger plugin
        gsap.registerPlugin(ScrollTrigger);

        /**
         * The ScrollFloat component with increased intensity.
         */
        const ScrollFloat = ({
            children,
        }) => {
            const containerRef = useRef(null);

            const splitText = useMemo(() => {
                const text = typeof children === 'string' ? children : '';
                return text.split('').map((char, index) => (
                    <span className="char" key={index}>
                        {char === ' ' ? '\u00A0' : char}
                    </span>
                ));
            }, [children]);

            useEffect(() => {
                const el = containerRef.current;
                if (!el) return;

                const charElements = el.querySelectorAll('.char');
                if (charElements.length === 0) return;

                // GSAP animation with MORE INTENSITY
                const anim = gsap.fromTo(
                    charElements,
                    { // From: more extreme initial state
                        willChange: 'opacity, transform',
                        opacity: 0,
                        yPercent: 150,      // Increased from 120
                        scaleY: 3,          // Increased from 2.3
                        scaleX: 0.5,        // Decreased from 0.7
                        transformOrigin: '50% 0%'
                    },
                    { // To: final state
                        duration: 1.5,
                        ease: 'power4.inOut', // More aggressive ease
                        opacity: 1,
                        yPercent: 0,
                        scaleY: 1,
                        scaleX: 1,
                        stagger: 0.05,       // Slightly increased stagger
                        scrollTrigger: {
                            trigger: el,
                            start: 'top bottom', // Start when the top of the element hits the bottom of the viewport
                            end: 'bottom center',
                            scrub: true 
                        }
                    }
                );
                
                return () => { anim.kill(); };
            }, [children]);

            return <div ref={containerRef} className="scroll-float"><span className="scroll-float-text font-playfair text-gray-900">{splitText}</span></div>;
        };

        // Render the React app into the #about-us-animated-title element
        const container = document.getElementById('about-us-animated-title');
        if (container) {
            const root = ReactDOM.createRoot(container);
            root.render(<ScrollFloat>About Us</ScrollFloat>);
        }

        // NEW: Render the React app for the DESKTOP title
        const desktopContainer = document.getElementById('about-us-animated-title-desktop');
        if (desktopContainer) {
            const desktopRoot = ReactDOM.createRoot(desktopContainer);
            desktopRoot.render(<ScrollFloat>About Us</ScrollFloat>);
        }
    </script>

    <script>
        // --- NEW: Explosive Title Scroll Animation ---
        document.addEventListener('DOMContentLoaded', () => {
            const explosiveTitle = document.querySelector('.explosive-title');

            if (explosiveTitle) {
                gsap.to(explosiveTitle, {
                    scrollTrigger: {
                        trigger: explosiveTitle,
                        start: "top 80%", // Trigger when the top of the element is 80% down the viewport
                        onEnter: () => {
                            explosiveTitle.classList.add('is-bursting');
                        },
                        onLeave: () => {
                            explosiveTitle.classList.remove('is-bursting');
                        },
                        onEnterBack: () => {
                            explosiveTitle.classList.add('is-bursting');
                        },
                        onLeaveBack: () => {
                            explosiveTitle.classList.remove('is-bursting');
                        },
                    }
                });
            }
        });
    </script>
    
    <!-- NEW Mobile Bottom Navigation -->
    <header id="mobile-nav" class="md:hidden">
        <div class="mobile-nav-container pb-safe">
            <div class="mobile-nav-bg"></div>
            <!-- The nav element itself must have pointer-events: auto to allow its children (buttons) to be clicked -->
            <nav class="relative flex items-center justify-around px-2 py-2" style="pointer-events: auto;">
                <!-- Home -->
                <a href="#top" class="mobile-nav-item active flex-1 flex flex-col items-center justify-center p-5 rounded-lg text-slate-500 min-h-[60px] touch-manipulation" data-item="home" style="-webkit-tap-highlight-color: transparent;">
                    <div class="relative icon-wrapper">
                         <div class="icon-glow"></div>
                        <svg class="w-7 h-7 z-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" /></svg>
                    </div>
                </a>
                <!-- Buy -->
                <a href="buy-books.html" class="mobile-nav-item flex-1 flex flex-col items-center justify-center p-5 rounded-lg text-slate-500 min-h-[60px] touch-manipulation" data-item="buy" style="-webkit-tap-highlight-color: transparent;">
                    <div class="relative icon-wrapper">
                        <div class="icon-glow"></div>
                        <svg class="w-7 h-7 z-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.658-.463 1.243-1.117 1.243H4.252c-.654 0-1.187-.585-1.117-1.243l1.263-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.117 1.007z" /></svg>
                    </div>
                </a>
                <!-- NeX Button -->
                <div class="flex-1 flex justify-center relative z-20">
                    <a href="https://qxds.netlify.app/" target="_blank" rel="noopener noreferrer" class="mobile-nav-item nex-button-raised w-14 h-14 bg-black rounded-full flex items-center justify-center text-white shadow-lg shadow-neutral-500/30 ring-1 ring-white/20 transition-transform duration-300 hover:scale-110 button-animation" style="display: flex; position:relative; z-index: 20;" aria-label="NeX" data-item="nex">
                        <div class="flex items-center justify-center font-bold text-xl icon-wrapper" style="font-family: 'Orbitron', sans-serif;">
                            <span>N</span>
                            <div class="flex flex-col space-y-1.5 mx-0.48 scale-50">
                                <div class="w-4 h-[3px] bg-white rounded-full"></div>
                                <div class="w-4 h-[3px] bg-white rounded-full"></div>
                                <div class="w-4 h-[3px] bg-white rounded-full"></div>
                        </div>
                            <span>X</span> 
                    </div>
                    </a>
                </div>
                <!-- Think AI -->
                <button id="mobileThinklyBtn" class="mobile-nav-item flex-1 flex flex-col items-center justify-center p-5 rounded-lg text-slate-500 min-h-[60px] touch-manipulation" data-item="think" style="cursor: pointer; -webkit-tap-highlight-color: transparent;">
                    <div class="relative icon-wrapper">
                        <div class="icon-glow"></div>
                       <svg class="w-7 h-7 z-10" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.25 21.75l-.648-1.188a2.25 2.25 0 01-1.47-1.47l-1.188-.648 1.188-.648a2.25 2.25 0 011.47-1.47l.648-1.188.648 1.188a2.25 2.25 0 011.47 1.47l1.188.648-1.188.648a2.25 2.25 0 01-1.47 1.47z" /></svg>
                    </div>
                </button>
                <!-- Profile -->
                <a href="#" id="mobileProfileBtn" class="mobile-nav-item flex-1 flex flex-col items-center justify-center p-5 rounded-lg text-slate-500 min-h-[60px] touch-manipulation" data-item="profile" style="-webkit-tap-highlight-color: transparent;">
                    <div class="relative icon-wrapper">
                        <div class="icon-glow"></div>
                       <svg class="w-6 h-6 z-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg>
                    </div>
                </a>
            </nav>
        </div>
    </header>

    <!-- BUY BOOKS MODAL CONTAINER -->
    <div id="buyBooksModal">
        <div id="buyBooksContainer">
            <!-- Loader (same as page loader) -->
            <div id="shoppingLoader">
                <svg class="shopping-spinner" viewBox="0 0 50 50">
                    <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="4"></circle>
                </svg>
            </div>
            <!-- Content from buy-books 2.html will be loaded here via iframe -->
        </div>
    </div>

    <script>
// Buy Books Modal Handler - Using iframe for complete isolation
        (function() {
            const buyBtn = document.querySelector('[data-item="buy"]');
            const buyModal = document.getElementById('buyBooksModal');
            const buyContainer = document.getElementById('buyBooksContainer');
            let iframeCreated = false;
            
            if (buyBtn && buyModal && buyContainer) {
                // Update buy button to open modal instead of navigating
                buyBtn.href = '#';
                buyBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (!iframeCreated) {
                        createBuyBooksIframe();
                        iframeCreated = true;
                    }
                    openBuyBooksModal();
                });
            }
            
            let savedScrollPosition = 0;
            
            function openBuyBooksModal() {
                // Save current scroll position
                savedScrollPosition = window.scrollY;
                buyModal.classList.add('active');
                document.body.classList.add('modal-open');
                document.body.style.overflow = 'hidden';
                document.body.style.position = 'fixed';
                document.body.style.top = `-${savedScrollPosition}px`;
                document.body.style.width = '100%';
                document.body.style.height = '100vh';
            }
            
            function closeBuyBooksModal() {
                // First remove modal visibility
                buyModal.classList.remove('active');
                document.body.classList.remove('modal-open');
                
                // Store the scroll position
                const scrollY = savedScrollPosition;
                
                // Remove all body styles
                document.body.style.position = '';
                document.body.style.top = '';
                document.body.style.overflow = '';
                document.body.style.width = '';
                document.body.style.height = '';
                
                // Force instant scroll (no smooth behavior)
                window.scrollTo({
                    top: scrollY,
                    left: 0,
                    behavior: 'instant'
                });
            }
            
            function createBuyBooksIframe() {
                const loader = document.getElementById('shoppingLoader');
                
                // Show loader
                if (loader) {
                    loader.classList.remove('hidden');
                }
                
                // Create iframe to load buy-books 2.html
                const iframe = document.createElement('iframe');
                iframe.id = 'buyBooksIframe';
                iframe.src = 'buy-books 2.html';
                iframe.style.cssText = 'width: 100%; height: 100%; border: none; display: block; opacity: 0; transition: opacity 0.3s;';
                iframe.setAttribute('sandbox', 'allow-same-origin allow-scripts allow-forms allow-popups allow-modals');
                
                // Handle iframe load - will hide loader when page is ready
                iframe.onload = function() {
                    console.log('Iframe loaded, waiting for page ready signal...');
                };
                
                // Add iframe to container
                buyContainer.appendChild(iframe);
                
                // Listen for messages from iframe
                window.addEventListener('message', function(event) {
                    const loader = document.getElementById('shoppingLoader');
                    const iframe = document.getElementById('buyBooksIframe');
                    
                    if (event.data === 'pageReady') {
                        // Page fully loaded - hide loader and show content
                        console.log('Page ready signal received, hiding loader');
                        if (loader) {
                            loader.classList.add('hidden');
                        }
                        if (iframe) {
                            iframe.style.opacity = '1';
                        }
                    } else if (event.data === 'closeBuyBooks') {
                        closeBuyBooksModal();
                    } else if (event.data && event.data.action === 'openSellModal') {
                        // Close buy books modal first
                        closeBuyBooksModal();
                        // Wait a bit for modal to close, then open sell modal
                        setTimeout(() => {
                            if (typeof renderSellForm === 'function' && typeof ModalManager !== 'undefined') {
                                renderSellForm('Book');
                                ModalManager.open('sellBookModal');
                            }
                        }, 300);
                    }
                });
                
                // Iframe load handler
                iframe.onload = function() {
                    try {
                        // Try to access iframe document and modify back button
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        const backButton = iframeDoc.querySelector('#back-button');
                        
                        if (backButton) {
                            // Override back button to close modal
                            backButton.addEventListener('click', function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                closeBuyBooksModal();
                            });
                        }
                        
                        console.log('Buy Books iframe loaded successfully');
                    } catch (err) {
                        console.log('Cross-origin iframe - using postMessage for communication');
                    }
                };
                
                iframe.onerror = function() {
                    buyContainer.innerHTML = `
                        <div class="flex flex-col items-center justify-center min-h-screen p-8">
                            <svg class="w-16 h-16 text-red-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <p class="text-red-600 text-lg font-semibold mb-2">Failed to load Buy Books page</p>
                            <p class="text-gray-600 mb-4">File not found: buy-books 2.html</p>
                            <button onclick="document.getElementById('buyBooksModal').classList.remove('active'); document.body.style.overflow = '';" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">Close</button>
                        </div>
                    `;
                };
            }
            
            // Expose close function globally
            window.closeBuyBooksModal = closeBuyBooksModal;
        })();
    </script>

    <!-- ðŸ”¥ UNIVERSAL FULLSCREEN MODAL (For ALL 32+ Hamburger Buttons + Hero Buttons) -->
    <div id="fullscreenModal" class="fixed inset-0 bg-white z-[9999999] opacity-0 pointer-events-none transition-all duration-300 flex flex-col">
        
        <!-- Modal Header -->
        <div class="p-4 border-b flex justify-between items-center bg-white/80 backdrop-blur-md sticky top-0 z-10">
            <h2 id="fmTitle" class="text-xl font-bold text-gray-900"></h2>
            <button id="fmClose" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg font-semibold transition-all button-animation">Close</button>
        </div>

        <!-- Modal Content (Scrollable) -->
        <div id="fmContent" class="flex-1 overflow-y-auto p-5 text-gray-700"></div>

    </div>

    <!-- EMO Pet Chatbot -->
    <div class="emo-pet-container">
        <div class="emo-bot" id="emoBot" role="img" aria-label="EMO pet assistant">
            <div class="emo-screen" aria-hidden="true">
                <svg viewBox="0 0 300 110" preserveAspectRatio="xMidYMid meet" style="width:100%;height:100%;">
                    <defs>
                        <filter id="emoSoftGlow" x="-50%" y="-50%" width="200%" height="200%">
                            <feGaussianBlur stdDeviation="5" result="blur" />
                            <feMerge>
                                <feMergeNode in="blur" />
                                <feMergeNode in="SourceGraphic" />
                            </feMerge>
                        </filter>
                    </defs>
                    <g id="emoLeftGroup" class="emo-eye-group emo-glow">
                        <path id="emoLeftArc" d="M60 70 C80 40, 120 40, 140 70" fill="transparent" stroke="#bffcff" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" opacity="0.98"/>
                    </g>
                    <g id="emoRightGroup" class="emo-eye-group emo-glow">
                        <path id="emoRightArc" d="M160 70 C180 40, 220 40, 240 70" fill="transparent" stroke="#bffcff" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" opacity="0.98"/>
                    </g>
                </svg>
            </div>
            <div class="emo-hint">Tap for Thinkly AI</div>
        </div>
    </div>

    <script>
        // EMO Pet Chatbot Script with Enhanced Emotions and Animations
        (function() {
            const bot = document.getElementById('emoBot');
            const left = document.getElementById('emoLeftGroup');
            const right = document.getElementById('emoRightGroup');
            const Lpath = document.getElementById('emoLeftArc');
            const Rpath = document.getElementById('emoRightArc');

            let baseX = 0, baseRot = 0;
            let currentEmotion = 'happy';
            const slowSeq = [ {x:-10, rot:-3, t:1400}, {x:10, rot:3, t:1400}, {x:0, rot:0, t:1800} ];
            
            // Advanced Features State
            let tapHistory = [];
            let sessionActions = {};
            let lastScrollY = window.scrollY;
            let scrollSpeed = 0;

            function applyLook(x, rot, smooth = true){
                if(smooth){
                    left.style.transition = 'transform 1200ms cubic-bezier(0.34, 1.56, 0.64, 1)';
                    right.style.transition = 'transform 1200ms cubic-bezier(0.34, 1.56, 0.64, 1)';
                } else {
                    left.style.transition = 'none'; 
                    right.style.transition = 'none';
                }
                left.style.transform = `translate(${x-6}px,${rot*0.12}px) rotate(${rot}deg)`;
                right.style.transform = `translate(${x+6}px,${rot*0.12}px) rotate(${rot}deg)`;
            }

            function cycleSlow(){
                let i = 0;
                function step(){
                    const p = slowSeq[i];
                    baseX = p.x; baseRot = p.rot;
                    applyLook(baseX, baseRot);
                    i = (i+1)%slowSeq.length;
                    setTimeout(step, p.t);
                }
                step();
            }

            function slowBlink(){
                Lpath.style.transition = 'transform 220ms ease, stroke-opacity 220ms ease';
                Rpath.style.transition = 'transform 220ms ease, stroke-opacity 220ms ease';
                Lpath.style.transform = 'scaleY(0.18)';
                Rpath.style.transform = 'scaleY(0.18)';
                Lpath.style.strokeOpacity = 0.06;
                Rpath.style.strokeOpacity = 0.06;
                setTimeout(()=>{
                    Lpath.style.transform = 'scaleY(1)';
                    Rpath.style.transform = 'scaleY(1)';
                    Lpath.style.strokeOpacity = 0.98;
                    Rpath.style.strokeOpacity = 0.98;
                },260);
                setTimeout(slowBlink, 2800 + Math.random()*2000);
            }

            // All Emotion Expressions
            const expressions = {
                happy(){
                    Lpath.setAttribute('d','M60 65 C90 92, 110 92, 140 65');
                    Rpath.setAttribute('d','M160 65 C190 92, 210 92, 240 65');
                },
                sad(){
                    Lpath.setAttribute('d','M60 75 C90 48, 110 48, 140 75');
                    Rpath.setAttribute('d','M160 75 C190 48, 210 48, 240 75');
                },
                angry(){
                    Lpath.setAttribute('d','M60 80 C70 60, 130 55, 140 80');
                    Rpath.setAttribute('d','M160 80 C170 55, 230 60, 240 80');
                },
                confused(){
                    Lpath.setAttribute('d','M60 70 C90 40, 110 80, 140 50');
                    Rpath.setAttribute('d','M160 50 C190 80, 210 40, 240 70');
                },
                sleepy(){
                    Lpath.setAttribute('d','M60 75 C100 75, 100 75, 140 75');
                    Rpath.setAttribute('d','M160 75 C200 75, 200 75, 240 75');
                },
                scared(){
                    Lpath.setAttribute('d','M60 55 C85 25, 115 25, 140 55');
                    Rpath.setAttribute('d','M160 55 C185 25, 215 25, 240 55');
                },
                excited(){
                    Lpath.setAttribute('d','M60 60 C85 85, 115 85, 140 60');
                    Rpath.setAttribute('d','M160 60 C185 85, 215 85, 240 60');
                },
                bored(){
                    Lpath.setAttribute('d','M60 70 C100 68, 100 68, 140 70');
                    Rpath.setAttribute('d','M160 70 C200 68, 200 68, 240 70');
                },
                shocked(){
                    Lpath.setAttribute('d','M70 70 C70 50, 130 50, 130 70 C130 50, 70 50, 70 70');
                    Rpath.setAttribute('d','M170 70 C170 50, 230 50, 230 70 C230 50, 170 50, 170 70');
                },
                wink(){
                    Lpath.setAttribute('d','M60 75 C100 75, 100 75, 140 75');
                    Rpath.setAttribute('d','M160 65 C190 92, 210 92, 240 65');
                },
                sideEye(){
                    Lpath.setAttribute('d','M80 70 C100 40, 140 40, 160 70');
                    Rpath.setAttribute('d','M180 70 C200 40, 240 40, 260 70');
                },
                mischievous(){
                    Lpath.setAttribute('d','M60 70 C85 50, 115 80, 140 65');
                    Rpath.setAttribute('d','M160 65 C185 80, 215 50, 240 70');
                }
            };

            function showExpression(name, smooth = true){
                const fn = expressions[name];
                if(fn) {
                    // Smooth transition for path changes
                    Lpath.style.transition = smooth ? 'd 800ms cubic-bezier(0.34, 1.56, 0.64, 1)' : 'none';
                    Rpath.style.transition = smooth ? 'd 800ms cubic-bezier(0.34, 1.56, 0.64, 1)' : 'none';
                    fn();
                    currentEmotion = name;
                }
            }

            // Tap Speed Detection
            function detectTapSpeed() {
                const now = Date.now();
                tapHistory.push(now);
                
                // Keep only last 3 taps
                if (tapHistory.length > 3) {
                    tapHistory.shift();
                }
                
                if (tapHistory.length >= 2) {
                    const timeDiff = tapHistory[tapHistory.length - 1] - tapHistory[tapHistory.length - 2];
                    
                    if (timeDiff < 300) {
                        // Fast tapping - excitement
                        return 'excited';
                    } else if (timeDiff > 2000) {
                        // Slow tapping - bored
                        return 'bored';
                    }
                }
                return 'normal';
            }
            
            // Session History Tracking
            function recordAction(action) {
                if (!sessionActions[action]) {
                    sessionActions[action] = 0;
                }
                sessionActions[action]++;
                
                // Store in localStorage
                try {
                    localStorage.setItem('emo_session', JSON.stringify(sessionActions));
                } catch(e) {}
            }
            
            function getSmarterReaction(action) {
                const count = sessionActions[action] || 0;
                
                if (count > 5) {
                    // User does this a lot - show excited/happy
                    return 'happy';
                } else if (count > 10) {
                    // User really loves this - show super excited
                    return 'excited';
                }
                return 'normal';
            }
            
            // Load session history
            try {
                const stored = localStorage.getItem('emo_session');
                if (stored) {
                    sessionActions = JSON.parse(stored);
                }
            } catch(e) {}

            function openThinklyAI(){
                // DIRECT FULLSCREEN OPEN - Thinkly AI style (NO scroll, NO jump)
                const expandedView = document.querySelector('#thinkly-ai-hero #expandedView');
                
                if(expandedView) {
                    // ðŸ”¥ PERFECT NO-JUMP FIX: Save current scroll position
                    const scrollY = window.scrollY;
                    
                    // Freeze body without forcing scroll to top
                    document.body.style.position = "fixed";
                    document.body.style.top = `-${scrollY}px`;
                    document.body.style.left = "0";
                    document.body.style.right = "0";
                    document.body.style.width = "100%";
                    
                    // Open fullscreen chat directly
                    expandedView.classList.add('visible');
                    
                    // Record action and show smarter reaction
                    recordAction('openThinkly');
                    const reaction = getSmarterReaction('openThinkly');
                    showExpression(reaction);
                    setTimeout(()=>{ showExpression('normal'); }, 1500);
                }
            }

            bot.addEventListener('click', (e)=>{
                e.preventDefault();
                e.stopPropagation();
                
                // Prevent page scroll
                if (e.cancelable) {
                    e.preventDefault();
                }
                
                // Detect tap speed
                const speed = detectTapSpeed();
                
                // Quick reaction animation based on speed
                bot.style.transition = 'transform 300ms cubic-bezier(0.34, 1.56, 0.64, 1)';
                bot.style.animation = 'none'; // Pause bounce during interaction
                
                if (speed === 'excited') {
                    bot.style.transform = 'scale(1.15) translateY(-8px) rotate(5deg)';
                    showExpression('excited');
                } else if (speed === 'bored') {
                    bot.style.transform = 'scale(1.05) translateY(-2px)';
                    showExpression('sleepy');
                } else {
                    bot.style.transform = 'scale(1.1) translateY(-5px)';
                }
                
                setTimeout(()=>{ 
                    bot.style.transform = 'scale(1) translateY(0) rotate(0)';
                    bot.style.animation = 'emo-minimal-bounce 3s ease-in-out infinite'; // Resume bounce
                }, 300);
                
                // Open Thinkly AI - FULLSCREEN DIRECTLY
                openThinklyAI();
            });

            let pressT = null;
            bot.addEventListener('touchstart', ()=>{ pressT = setTimeout(()=>{ showExpression('sleepy'); }, 700); });
            bot.addEventListener('touchend', ()=>{ clearTimeout(pressT); setTimeout(()=>{ showExpression('happy'); }, 700); });

            // Enhanced Emotion Cycle - Smoothly cycles through all emotions
            function emotionCycle(){
                const emotions = ['happy', 'sad', 'angry', 'confused', 'sleepy', 'scared', 'excited', 'bored', 'shocked', 'wink', 'sideEye', 'mischievous'];
                let currentIndex = 0;
                
                function nextEmotion() {
                    showExpression(emotions[currentIndex], true);
                    currentIndex = (currentIndex + 1) % emotions.length;
                    setTimeout(nextEmotion, 5000); // Change emotion every 5 seconds (smooth transitions)
                }
                
                nextEmotion();
            }

            // 360 Degree Rotation Animation (every 10 seconds)
            function rotate360(){
                bot.style.transition = 'transform 2s cubic-bezier(0.34, 1.56, 0.64, 1)';
                bot.style.transform = 'rotate(360deg)';
                
                setTimeout(() => {
                    bot.style.transition = 'none';
                    bot.style.transform = 'rotate(0deg)';
                    setTimeout(() => {
                        bot.style.transition = 'transform 520ms ease';
                    }, 50);
                }, 2000);
                
                setTimeout(rotate360, 10000); // Repeat every 10 seconds
            }

            function idleJitter(){
                const jx = (Math.random()*2 - 1) * 2;
                const jr = (Math.random()*2 - 1) * 0.6;
                applyLook(baseX + jx, baseRot + jr);
                setTimeout(idleJitter, 600 + Math.random()*900);
            }

            cycleSlow();
            setTimeout(slowBlink, 1200 + Math.random()*800);
            setTimeout(emotionCycle, 1800); // Start emotion cycling after 1.8s
            setTimeout(rotate360, 10000); // Start rotation after 10s
            setTimeout(idleJitter, 700);

            window.addEventListener('pointermove', (e)=>{
                if(e.pointerType !== 'mouse') return;
                const rect = bot.getBoundingClientRect();
                const cx = rect.left + rect.width/2;
                const dx = (e.clientX - cx)/rect.width;
                baseX = Math.max(-1, Math.min(1, dx)) * 10;
                baseRot = Math.max(-1, Math.min(1, dx)) * 3;
            });

            window.addEventListener('pointerleave', ()=>{ baseX = 0; baseRot = 0; });
            
            // Scroll-based Reactions
            let scrollTimeout;
            window.addEventListener('scroll', ()=>{
                const currentScrollY = window.scrollY;
                scrollSpeed = Math.abs(currentScrollY - lastScrollY);
                
                clearTimeout(scrollTimeout);
                
                // Fast scroll
                if (scrollSpeed > 50) {
                    showExpression('excited');
                    // Eyes follow scroll direction
                    const direction = currentScrollY > lastScrollY ? 1 : -1;
                    baseX = direction * 15;
                    baseRot = direction * 5;
                    applyLook(baseX, baseRot);
                }
                // Medium scroll
                else if (scrollSpeed > 20) {
                    showExpression('happy');
                    const direction = currentScrollY > lastScrollY ? 1 : -1;
                    baseX = direction * 8;
                    baseRot = direction * 3;
                    applyLook(baseX, baseRot);
                }
                // Slow scroll
                else if (scrollSpeed > 5) {
                    showExpression('confused');
                    baseX = 0;
                    baseRot = 0;
                    applyLook(baseX, baseRot);
                }
                
                lastScrollY = currentScrollY;
                
                // Return to normal after scroll stops
                scrollTimeout = setTimeout(()=>{
                    showExpression('normal');
                    baseX = 0;
                    baseRot = 0;
                    applyLook(baseX, baseRot);
                }, 800);
            });
        })();
    </script>

    <!-- Profile Modal for Leaderboard -->
    <div id="profile-modal-nexbook" class="modal-container-nexbook" onclick="hideProfileModalNexbook(event)">
        <div class="modal-backdrop-nexbook"></div>
        <div class="modal-content-nexbook" onclick="event.stopPropagation()">
            
            <!-- Modal Header -->
            <div class="flex items-center gap-4 p-6 md:p-8 border-b border-gray-200 relative">
                <div class="relative flex-shrink-0">
                    <img id="modal-avatar-nexbook" src="https://placehold.co/80x80/4f46e5/ffffff?text=YOU" alt="Donor Avatar" class="w-16 h-16 md:w-20 md:h-20 rounded-full object-cover">
                    <div id="modal-avatar-loader-nexbook" class="loader-nexbook loader-hidden-nexbook"></div>
                </div>
                <div>
                    <h2 id="modal-name-nexbook" class="text-2xl md:text-3xl font-bold text-black">Donor Name</h2>
                    <p id="modal-badge-nexbook" class="text-lg md:text-xl font-medium text-gray-900">Badge</p>
                    <!-- Avatar Upload (Sirf "YOU" ke liye) -->
                    <div id="avatar-upload-section-nexbook" class="hidden mt-2">
                        <label for="avatar-upload-input-nexbook" class="text-sm font-medium text-indigo-600 hover:text-indigo-800 cursor-pointer">
                            Change Photo
                        </label>
                        <input type="file" id="avatar-upload-input-nexbook" class="hidden" accept="image/png, image/jpeg" onchange="uploadImageNexbook(event)">
                        <p id="avatar-upload-status-nexbook" class="text-sm text-gray-500 h-4 mt-1"></p>
                    </div>
                </div>
                <!-- Close Button -->
                <button onclick="hideProfileModalNexbook()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 bg-gray-200/50 hover:bg-gray-300/60 transition-all rounded-full p-1.5">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                        <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>                  
                </button>
            </div>
            
            <!-- Modal Body -->
            <div class="p-6 md:p-8 space-y-6 max-h-[70vh] overflow-y-auto">

                <!-- Next Badge Goal Card -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-5">
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Next Goal</h3>
                    <div class="flex justify-between text-sm font-medium text-gray-600 mb-1">
                        <span id="modal-goal-text-nexbook">Next: Crown Prince (10 books)</span>
                        <span id="modal-goal-progress-text-nexbook">5 / 10</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3">
                        <div id="modal-progress-bar-nexbook" class="bg-blue-600 h-3 rounded-full transition-all duration-500" style="width: 50%"></div>
                    </div>
                    <p id="modal-goal-remaining-nexbook" class="text-sm text-gray-500 mt-2">Need more books!</p>
                </div>

                <!-- Donation History Card -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-5">
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Donation History</h3>
                    <div class="mb-4 h-40">
                        <canvas id="modal-donation-chart-nexbook"></canvas>
                    </div>
                    <h4 class="text-sm font-semibold text-gray-600 mb-2">This Month's Donations</h4>
                    <ul id="modal-history-list-nexbook" class="space-y-2 max-h-40 overflow-y-auto pr-2">
                        <!-- JS dynamically fills this -->
                    </ul>
                </div>

                <!-- Profile Bio Card -->
                <div id="modal-bio-section-nexbook" class="bg-white rounded-lg shadow-sm border border-gray-200 p-5">
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Profile Bio</h3>
                    <!-- Locked State -->
                    <div id="modal-bio-locked-nexbook" class="text-center py-4 hidden">
                        <div class="flex justify-center mb-2">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-8 h-8 text-gray-400">
                                <path fill-rule="evenodd" d="M10 1a4.5 4.5 0 0 0-4.5 4.5V9H5a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2h-.5V5.5A4.5 4.5 0 0 0 10 1Zm3 8V5.5a3 3 0 1 0-6 0V9h6Z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <p class="font-medium text-gray-700">Bio Locked</p>
                        <p class="text-sm text-gray-500">Reach the Top 5 to set your profile bio.</p>
                    </div>
                    <!-- Unlocked State -->
                    <div id="modal-bio-unlocked-nexbook" class="hidden">
                        <div id="modal-bio-text-nexbook" class="text-gray-800 p-4 bg-gray-100 rounded-lg min-h-[50px] text-base">
                            <!-- JS will fill this -->
                        </div>
                    </div>
                </div>
            </div> <!-- End Modal Body -->
        </div>
    </div>

    <!-- ðŸš¨ CRITICAL FIX: Block Thinkly AI internal auto-scroll to top -->
    <script>
        // Wait for Thinkly AI element to load
        window.addEventListener('DOMContentLoaded', function() {
            const thinklyElement = document.querySelector("#thinkly-ai-hero .AgWCw");
            
            if (thinklyElement) {
                thinklyElement.addEventListener("click", function(e) {
                    // INTERCEPT: Block Thinkly AI's internal scrollTo(0,0) hook
                    const originalScrollTo = window.scrollTo;
                    
                    // Temporarily disable scrollTo during expand animation
                    window.scrollTo = function() {
                        console.log('ðŸ›¡ï¸ Blocked Thinkly AI auto-scroll');
                    };
                    
                    // Restore scrollTo after animation completes (900ms)
                    setTimeout(function() {
                        window.scrollTo = originalScrollTo;
                        console.log('âœ… ScrollTo restored');
                    }, 900);
                });
                
                console.log('âœ… Thinkly AI auto-scroll interceptor loaded!');
            }
        });
    </script>

    <!-- ðŸ”¥ UNIVERSAL FULLSCREEN MODAL SYSTEM - For ALL 32+ Hamburger Buttons -->
    <script>
        (function() {
            const fm = document.getElementById("fullscreenModal");
            const fmTitle = document.getElementById("fmTitle");
            const fmContent = document.getElementById("fmContent");
            const fmClose = document.getElementById("fmClose");

            let savedScroll = 0;

            // ðŸ”¥ OPEN MODAL FUNCTION (Works for ALL buttons)
            window.openFM = function(title, content) {

                // Freeze scroll without jumping
                savedScroll = window.scrollY;
                document.body.style.position = "fixed";
                document.body.style.top = `-${savedScroll}px`;
                document.body.style.width = "100%";

                // Set content
                fmTitle.textContent = title;
                fmContent.innerHTML = content;

                fm.classList.remove("pointer-events-none");
                fm.classList.add("opacity-100");
            };

            // ðŸ”¥ CLOSE MODAL FUNCTION
            function closeFM() {
                fm.classList.add("pointer-events-none");
                fm.classList.remove("opacity-100");

                document.body.style.position = "";
                const y = document.body.style.top;
                document.body.style.top = "";
                window.scrollTo(0, parseInt(y || "0") * -1);
            }

            // Close button click
            fmClose.addEventListener("click", closeFM);

            // Close on ESC key
            document.addEventListener("keydown", function(e) {
                if (e.key === "Escape" && fm.classList.contains("opacity-100")) {
                    closeFM();
                }
            });

            console.log('âœ… Universal Fullscreen Modal System Ready!');
        })();
    </script>

    <!-- Hamburger system removed -->

    <!-- ðŸ”¥ HERO BUTTONS (Buy, Sell, Request) - KEEP EXISTING RICH CONTENT -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // ðŸŽ¯ 1. BUY BOOKS (Hero Button - Rich Content)
            const buyBooksHero = document.getElementById("buyBooksBtnHero");
            if (buyBooksHero) {
                buyBooksHero.addEventListener("click", (e) => {
                    e.preventDefault();
                    openFM("Buy Books", `
                            <div class="space-y-6">
                                <div class="text-center">
                                    <svg class="w-20 h-20 mx-auto text-blue-600 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
                                    </svg>
                                    <h3 class="text-2xl font-bold mb-2">Buy Used Books</h3>
                                    <p class="text-gray-600">Get verified textbooks from seniors at 50% off retail price.</p>
                                </div>
                                
                                <div class="grid gap-4">
                                    <div class="p-4 bg-blue-50 rounded-xl">
                                        <h4 class="font-bold text-lg mb-2">Browse by Course</h4>
                                        <p class="text-sm text-gray-600">Select your degree program to see available books</p>
                                        <button class="mt-3 w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-blue-700 transition">Browse Courses</button>
                                    </div>
                                    
                                    <div class="p-4 bg-green-50 rounded-xl">
                                        <h4 class="font-bold text-lg mb-2">Search by Title</h4>
                                        <p class="text-sm text-gray-600">Find specific books by name or author</p>
                                        <input type="text" placeholder="Search books..." class="mt-3 w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                </div>
                                
                                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
                                    <p class="text-sm"><strong>ðŸ’¡ Pro Tip:</strong> Pay only after receiving the book. Free hand-delivery within campus!</p>
                                </div>
                            </div>
                        `);
                });
            }

            // ðŸŽ¯ 2. SELL BOOKS (Hero Button - Rich Content)
            const sellBooksHero = document.getElementById("sellBookBtnHero");
            if (sellBooksHero) {
                sellBooksHero.addEventListener("click", (e) => {
                    e.preventDefault();
                    openFM("Sell Your Books", `
                            <div class="space-y-6">
                                <div class="text-center">
                                    <svg class="w-20 h-20 mx-auto text-green-600 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <h3 class="text-2xl font-bold mb-2">Sell Your Books</h3>
                                    <p class="text-gray-600">Turn your old textbooks into cash instantly!</p>
                                </div>
                                
                                <form class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-semibold mb-2">Book Title</label>
                                        <input type="text" placeholder="e.g., Engineering Mathematics" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-semibold mb-2">Author</label>
                                            <input type="text" placeholder="Author name" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-semibold mb-2">Edition</label>
                                            <input type="text" placeholder="e.g., 5th" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-semibold mb-2">Your Price (â‚¹)</label>
                                            <input type="number" placeholder="300" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-semibold mb-2">Condition</label>
                                            <select class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                                <option>Like New</option>
                                                <option>Good</option>
                                                <option>Fair</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-semibold mb-2">Upload Photos (Optional)</label>
                                        <input type="file" multiple accept="image/*" class="w-full p-3 border border-gray-300 rounded-lg">
                                    </div>
                                    
                                    <button type="submit" class="w-full bg-green-600 text-white py-3 px-6 rounded-lg font-bold text-lg hover:bg-green-700 transition">List Book for Sale</button>
                                </form>
                            </div>
                        `);
                });
            }

            // ðŸŽ¯ 3. REQUEST BOOK - Using standard modal (requestModal) via line 10516, no fullscreen needed

            // Note: Hamburger buttons (hbPYQ, hbStudyMaterial, etc.) are now handled by HAMBURGER_MAP above
            
            // ðŸŽ¯ 4. PYQ CARD (If you have a PYQ card on page)
            const pyqCard = document.getElementById("pyqCard");
            if (pyqCard) {
                pyqCard.addEventListener("click", (e) => {
                    e.preventDefault();
                    openFM("Previous Year Questions (PYQ)", `
                            <div class="space-y-6">
                                <div class="text-center">
                                    <h3 class="text-3xl font-bold mb-3">ðŸ“ PYQs</h3>
                                    <p class="text-lg text-gray-600">Practice with previous year question papers for better exam preparation.</p>
                                </div>
                                
                                <div class="grid md:grid-cols-2 gap-4">
                                    <div class="p-6 bg-blue-50 rounded-xl hover:shadow-lg transition cursor-pointer">
                                        <h4 class="text-xl font-bold mb-2">ðŸ“š Commerce</h4>
                                        <p class="text-gray-600 text-sm mb-3">B.Com & M.Com question papers</p>
                                        <button class="text-blue-600 font-semibold">Browse â†’</button>
                                    </div>
                                    
                                    <div class="p-6 bg-green-50 rounded-xl hover:shadow-lg transition cursor-pointer">
                                        <h4 class="text-xl font-bold mb-2">ðŸŽ¨ Arts</h4>
                                        <p class="text-gray-600 text-sm mb-3">B.A. & M.A. question papers</p>
                                        <button class="text-green-600 font-semibold">Browse â†’</button>
                                    </div>
                                    
                                    <div class="p-6 bg-purple-50 rounded-xl hover:shadow-lg transition cursor-pointer">
                                        <h4 class="text-xl font-bold mb-2">ðŸ”¬ Science</h4>
                                        <p class="text-gray-600 text-sm mb-3">B.Sc. & M.Sc. question papers</p>
                                        <button class="text-purple-600 font-semibold">Browse â†’</button>
                                    </div>
                                    
                                    <div class="p-6 bg-orange-50 rounded-xl hover:shadow-lg transition cursor-pointer">
                                        <h4 class="text-xl font-bold mb-2">ðŸ’» Computer Science</h4>
                                        <p class="text-gray-600 text-sm mb-3">BCA & MCA question papers</p>
                                        <button class="text-orange-600 font-semibold">Browse â†’</button>
                                    </div>
                                </div>
                            </div>
                        `);
                });
            }

            console.log('âœ… Hero Buttons & Special Cards Connected!');
            console.log('âœ… All buttons connected to Fullscreen Modal!');

            // ========================================
            // FREE RESOURCES CARD - Direct Modal Opening (No Scroll)
            // ========================================
            const freeResourceNotesBtn = document.getElementById('freeResourceNotesBtn');
            const freeResourcePYQBtn = document.getElementById('freeResourcePYQBtn');
            const freeResourceAssignmentBtn = document.getElementById('freeResourceAssignmentBtn');
            const freeResourcePracticalsBtn = document.getElementById('freeResourcePracticalsBtn');

            // Notes Button - Direct modal open without scrolling
            if (freeResourceNotesBtn) {
                freeResourceNotesBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Free Resources: Notes clicked - opening modal directly (no scroll)');
                    if (typeof openUnifiedModal === 'function') {
                        openUnifiedModal('notes');
                    }
                });
            }

            // PYQ Button - Direct modal open without scrolling
            if (freeResourcePYQBtn) {
                freeResourcePYQBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Free Resources: PYQ clicked - opening modal directly (no scroll)');
                    if (typeof openUnifiedModal === 'function') {
                        openUnifiedModal('pyq');
                    }
                });
            }

            // Assignment Button - Direct modal open without scrolling
            if (freeResourceAssignmentBtn) {
                freeResourceAssignmentBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Free Resources: Assignment clicked - opening modal directly (no scroll)');
                    if (typeof openUnifiedModal === 'function') {
                        openUnifiedModal('assignments');
                    }
                });
            }

            // Practicals Button - Direct modal open without scrolling
            if (freeResourcePracticalsBtn) {
                freeResourcePracticalsBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Free Resources: Practicals clicked - opening modal directly (no scroll)');
                    if (typeof openUnifiedModal === 'function') {
                        openUnifiedModal('practicals');
                    }
                });
            }

            console.log('âœ… Free Resources Card Connected! Direct modal opening (NO SCROLL) enabled.');
        });
    </script>

    <!-- ========================================
         HAMBURGER MENU JAVASCRIPT
         ======================================== -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const hamburgerBtn = document.getElementById('hamburgerBtn');
            const closeMenuBtn = document.getElementById('closeMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            const menuOverlay = document.getElementById('menu-overlay');
            const body = document.body;

            // Accordion elements
            const groupToggleBtn = document.getElementById('group-toggle-btn');
            const groupSubmenu = document.getElementById('groupDrop');
            const groupChevron = document.getElementById('group-chevron');
            const studyToggleBtn = document.getElementById('study-toggle-btn');
            const studySubmenu = document.getElementById('studyDrop');
            const studyChevron = document.getElementById('study-chevron');
            const studentToggleBtn = document.getElementById('student-toggle-btn');
            const studentSubmenu = document.getElementById('studentDrop');
            const studentChevron = document.getElementById('student-chevron');

            // Open Menu Function
            function openMenu() {
                mobileMenu.classList.remove('translate-x-full');
                mobileMenu.classList.add('translate-x-0');
                menuOverlay.classList.remove('hidden');
                body.classList.add('overflow-hidden');
                if (hamburgerBtn) hamburgerBtn.classList.add('active');
            }

            // Close Menu Function
            function closeMenu() {
                mobileMenu.classList.add('translate-x-full');
                mobileMenu.classList.remove('translate-x-0');
                menuOverlay.classList.add('hidden');
                body.classList.remove('overflow-hidden');
                if (hamburgerBtn) hamburgerBtn.classList.remove('active');
            }

            // Hamburger button toggle
            if (hamburgerBtn) {
                hamburgerBtn.addEventListener('click', () => {
                    const isMenuOpen = !mobileMenu.classList.contains('translate-x-full');
                    isMenuOpen ? closeMenu() : openMenu();
                });
            }

            // Close button inside menu
            if (closeMenuBtn) {
                closeMenuBtn.addEventListener('click', closeMenu);
            }

            // Close when clicking overlay
            if (menuOverlay) {
                menuOverlay.addEventListener('click', closeMenu);
            }

            // Accordion: Join Groups
            if (groupToggleBtn && groupSubmenu && groupChevron) {
                groupToggleBtn.addEventListener('click', () => {
                    const isHidden = groupSubmenu.classList.contains('max-h-0');
                    if (isHidden) {
                        groupSubmenu.classList.remove('max-h-0');
                        groupSubmenu.classList.add('max-h-48');
                        groupChevron.classList.add('rotate-180');
                    } else {
                        groupSubmenu.classList.add('max-h-0');
                        groupSubmenu.classList.remove('max-h-48');
                        groupChevron.classList.remove('rotate-180');
                    }
                });
            }

            // Accordion: Study Material
            if (studyToggleBtn && studySubmenu && studyChevron) {
                studyToggleBtn.addEventListener('click', () => {
                    const isHidden = studySubmenu.classList.contains('max-h-0');
                    if (isHidden) {
                        studySubmenu.classList.remove('max-h-0');
                        studySubmenu.classList.add('max-h-96');
                        studyChevron.classList.add('rotate-180');
                    } else {
                        studySubmenu.classList.add('max-h-0');
                        studySubmenu.classList.remove('max-h-96');
                        studyChevron.classList.remove('rotate-180');
                    }
                });
            }

            // Accordion: Student Corner
            if (studentToggleBtn && studentSubmenu && studentChevron) {
                studentToggleBtn.addEventListener('click', () => {
                    const isHidden = studentSubmenu.classList.contains('max-h-0');
                    if (isHidden) {
                        studentSubmenu.classList.remove('max-h-0');
                        studentSubmenu.classList.add('max-h-60');
                        studentChevron.classList.add('rotate-180');
                    } else {
                        studentSubmenu.classList.add('max-h-0');
                        studentSubmenu.classList.remove('max-h-60');
                        studentChevron.classList.remove('rotate-180');
                    }
                });
            }

            // Initialize Lucide Icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            // ========================================
            // MENU ITEM CLICK HANDLERS - Auto close menu and navigate
            // ========================================
            
            // Close menu on any menu item click (except accordions)
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', () => {
                    setTimeout(closeMenu, 100); // Small delay for smooth UX
                });
            });

            // My Orders - Open Profile Modal with My Orders tab
            const menuMyOrders = document.getElementById('menuMyOrders');
            if (menuMyOrders) {
                menuMyOrders.addEventListener('click', (e) => {
                    e.preventDefault();
                    // Open profile dashboard modal using ModalManager
                    if (typeof ModalManager !== 'undefined') {
                        ModalManager.open('profileDashboardModal');
                        // Wait for modal to open, then click My Orders tab
                        setTimeout(() => {
                            const myOrdersBtn = document.getElementById('dashboardMyOrdersBtn');
                            if (myOrdersBtn) myOrdersBtn.click();
                        }, 300);
                    }
                });
            }

            // My Backpack - Open Profile Modal with My Backpack tab
            const menuBackpack = document.getElementById('menuBackpack');
            if (menuBackpack) {
                menuBackpack.addEventListener('click', (e) => {
                    e.preventDefault();
                    // Open profile dashboard modal using ModalManager
                    if (typeof ModalManager !== 'undefined') {
                        ModalManager.open('profileDashboardModal');
                        // Wait for modal to open, then click My Backpack tab
                        setTimeout(() => {
                            const myBackpackBtn = document.getElementById('dashboardMyBackpackBtn');
                            if (myBackpackBtn) myBackpackBtn.click();
                        }, 300);
                    }
                });
            }

            // Request a Book - Open Request Book Modal
            const menuRequestBook = document.getElementById('menuRequestBook');
            if (menuRequestBook) {
                menuRequestBook.addEventListener('click', (e) => {
                    e.preventDefault();
                    const requestBookBtn = document.getElementById('requestBookBtnNav');
                    if (requestBookBtn) {
                        requestBookBtn.click();
                    } else {
                        const requestBookBtnHero = document.getElementById('requestBookBtnHero');
                        if (requestBookBtnHero) requestBookBtnHero.click();
                    }
                });
            }

            // Sell Books - Open Sell Book Modal
            // Sell Books button in hamburger menu - DISABLED (no action)
            const menuSellBook = document.getElementById('menuSellBook');
            if (menuSellBook) {
                menuSellBook.addEventListener('click', (e) => {
                    e.preventDefault();
                    // Do nothing - sell books modal disabled
                });
            }

            // College Essentials - Open Fullscreen Modal with College Essentials
            const menuCollegeEssentials = document.getElementById('menuCollegeEssentials');
            if (menuCollegeEssentials) {
                menuCollegeEssentials.addEventListener('click', (e) => {
                    e.preventDefault();
                    const collegeEssentialsBtn = document.querySelector('[data-modal-target="college-essentials"]');
                    if (collegeEssentialsBtn) collegeEssentialsBtn.click();
                });
            }

            // Study Material Items - Open unified modal with program list
            document.querySelectorAll('.study-material-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const section = item.getAttribute('data-section');
                    
                    // Open unified modal with the program list (like clicking the card button)
                    if (section === 'pyq') {
                        const pyqBtn = document.getElementById('pyqBtn');
                        if (pyqBtn) pyqBtn.click();
                    } else if (section === 'notes') {
                        const notesBtn = document.getElementById('notesBtn');
                        if (notesBtn) notesBtn.click();
                    } else if (section === 'assignment') {
                        const assignmentsBtn = document.getElementById('assignmentsBtn');
                        if (assignmentsBtn) assignmentsBtn.click();
                    } else if (section === 'practical') {
                        const practicalsBtn = document.getElementById('practicalsBtn');
                        if (practicalsBtn) practicalsBtn.click();
                    } else if (section === 'syllabus') {
                        const syllabusBtn = document.getElementById('syllabusBtn');
                        if (syllabusBtn) syllabusBtn.click();
                    }
                });
            });

            // Thinkly AI - Open Fullscreen Thinkly AI
            const menuThinklyAI = document.getElementById('menuThinklyAI');
            if (menuThinklyAI) {
                menuThinklyAI.addEventListener('click', (e) => {
                    e.preventDefault();
                    const thinklyAIBtn = document.getElementById('aiHelperBtnNav');
                    if (thinklyAIBtn) {
                        thinklyAIBtn.click();
                    } else {
                        // Try the fullscreen Thinkly AI button
                        const thinklyFullscreenBtn = document.querySelector('[data-modal-target="thinkly-ai"]');
                        if (thinklyFullscreenBtn) thinklyFullscreenBtn.click();
                    }
                });
            }

            console.log('âœ… Hamburger Menu Connected!');
            console.log('âœ… All Menu Items Linked & Auto-Close Enabled!');
        });
    </script>

    <!-- ðŸ”¥ FINAL STANDALONE FIX for Thinkly AI buttons -->
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            console.log('ðŸš€ STANDALONE THINKLY FIX LOADING...');
            
            // 1ï¸âƒ£ Fix 3-dot menu button
            const menuBtn = document.getElementById('thinklyMenuButton');
            const sidebar = document.getElementById('thinklySidebar');
            const overlay = document.getElementById('thinklySidebarOverlay');
            const sidebarClose = document.getElementById('closeThinklySidebarBtn');
            
            console.log('ðŸ” Menu Button:', menuBtn);
            console.log('ðŸ” Sidebar:', sidebar);
            console.log('ðŸ” Overlay:', overlay);
            
            if (menuBtn && sidebar && overlay) {
                menuBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('âœ…âœ…âœ… 3-DOT MENU CLICKED!');
                    sidebar.classList.toggle('-translate-x-full');
                    overlay.classList.toggle('visible');
                });
                
                overlay.addEventListener('click', () => {
                    console.log('âœ…âœ…âœ… OVERLAY CLICKED!');
                    sidebar.classList.add('-translate-x-full');
                    overlay.classList.remove('visible');
                });
                
                if (sidebarClose) {
                    sidebarClose.addEventListener('click', () => {
                        console.log('âœ…âœ…âœ… SIDEBAR CLOSE CLICKED!');
                        sidebar.classList.add('-translate-x-full');
                        overlay.classList.remove('visible');
                    });
                }
                
                console.log('âœ… STANDALONE: 3-dot menu fixed!');
            } else {
                console.error('âŒ STANDALONE: Menu elements not found!');
            }
            
            // 2ï¸âƒ£ Fix close button in expanded view
            const hero = document.getElementById('thinkly-ai-hero');
            if (hero) {
                const closeBtn = hero.querySelector('#closeButton');
                const expanded = hero.querySelector('#expandedView');
                
                console.log('ðŸ” Hero:', hero);
                console.log('ðŸ” Close Button:', closeBtn);
                console.log('ðŸ” Expanded View:', expanded);
                
                if (closeBtn && expanded) {
                    const closeIt = (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('âœ…âœ…âœ… CLOSE BUTTON CLICKED!');
                        
                        expanded.classList.remove('visible');
                        document.body.classList.remove('thinkly-expanded');
                        
                        // Restore scroll
                        const scrollY = document.body.style.top;
                        const savedPosition = parseInt(scrollY || "0") * -1;
                        document.body.style.position = "";
                        document.body.style.top = "";
                        window.scrollTo({ top: savedPosition, left: 0, behavior: 'instant' });
                        
                        const mobileNav = document.getElementById('mobile-nav');
                        if (mobileNav) mobileNav.classList.remove('hidden');
                    };
                    
                    closeBtn.addEventListener('click', closeIt);
                    closeBtn.addEventListener('touchstart', closeIt);
                    closeBtn.addEventListener('touchend', closeIt);
                    
                    console.log('âœ… STANDALONE: Close button fixed!');
                } else {
                    console.error('âŒ STANDALONE: Close button not found!');
                }
            } else {
                console.error('âŒ STANDALONE: Hero element not found!');
            }
            
            console.log('ðŸŽ‰ STANDALONE THINKLY FIX COMPLETE!');
        });
    </script>

    <!-- ðŸ”¥ SUPER SIMPLE DEBUG SCRIPT -->
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            console.log('ðŸ§ª DEBUG SCRIPT LOADED');
            
            const wrapper = document.getElementById('searchBarWrapper');
            const mainContainer = document.getElementById('mainContainer');
            const expandBtn = document.getElementById('expandButton');
            
            console.log('ðŸ” searchBarWrapper:', wrapper);
            console.log('ðŸ” mainContainer:', mainContainer);
            console.log('ðŸ” expandButton:', expandBtn);
            
            if (wrapper) {
                wrapper.addEventListener('click', () => {
                    console.log('ðŸŽ¯ðŸŽ¯ðŸŽ¯ WRAPPER CLICKED!');
                    if (mainContainer) {
                        mainContainer.classList.add('UAbVe');
                        mainContainer.classList.add('is-chatting');
                        console.log('âœ… Classes added: UAbVe, is-chatting');
                    }
                });
            }
            
            if (expandBtn) {
                expandBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    console.log('ðŸš€ðŸš€ðŸš€ EXPAND BUTTON CLICKED!');
                    
                    // ðŸ”¥ ACTUALLY OPEN FULLSCREEN!
                    const expandedView = document.getElementById('expandedView');
                    if (expandedView) {
                        // Save scroll position
                        const scrollY = window.scrollY;
                        document.body.style.position = "fixed";
                        document.body.style.top = `-${scrollY}px`;
                        document.body.style.left = "0";
                        document.body.style.right = "0";
                        document.body.style.width = "100%";
                        
                        expandedView.classList.add('visible');
                        document.body.classList.add('thinkly-expanded');
                        document.getElementById('mobile-nav')?.classList.add('hidden');
                        console.log('âœ… Fullscreen opened!');
                    }
                });
            }
        });
    </script>

    <!-- ðŸ”¥ UNIVERSAL CLOSE BUTTON FIX - Fix ALL (X) buttons globally -->
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            console.log('ðŸ”§ UNIVERSAL CLOSE BUTTON FIX STARTING...');
            
            // 1. Fix all modal close buttons (X icons with IDs starting with "close")
            document.querySelectorAll('[id^="close"]').forEach(closeBtn => {
                // Remove any existing listeners to avoid duplicates
                const newBtn = closeBtn.cloneNode(true);
                closeBtn.parentNode.replaceChild(newBtn, closeBtn);
                
                newBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Find the parent modal
                    const modal = this.closest('.modal-overlay');
                    if (modal && typeof ModalManager !== 'undefined') {
                        console.log('âœ… Closing modal:', modal.id);
                        ModalManager.close(modal.id);
                    }
                });
                
                console.log('âœ… Fixed close button:', newBtn.id);
            });
            
            // 2. Fix all [data-close-modal] backdrops
            document.querySelectorAll('[data-close-modal]').forEach(backdrop => {
                backdrop.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const modal = this.closest('.modal-overlay');
                    if (modal && typeof ModalManager !== 'undefined') {
                        console.log('âœ… Closing modal via backdrop:', modal.id);
                        ModalManager.close(modal.id);
                    }
                });
            });
            
            // 3. Fix hamburger menu close button
            const closeMenuBtn = document.getElementById('closeMenuBtn');
            if (closeMenuBtn) {
                closeMenuBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const mobileMenu = document.getElementById('mobileMenu');
                    const menuOverlay = document.getElementById('menu-overlay');
                    
                    if (mobileMenu) {
                        mobileMenu.classList.add('translate-x-full');
                        mobileMenu.classList.remove('translate-x-0');
                    }
                    if (menuOverlay) {
                        menuOverlay.classList.add('hidden');
                    }
                    document.body.classList.remove('overflow-hidden');
                    
                    console.log('âœ… Closed hamburger menu');
                });
            }
            
            // 4. Remove any pointer-events:none that might block clicks
            document.querySelectorAll('[style*="pointer-events: none"]').forEach(el => {
                if (!el.classList.contains('loading')) { // Don't fix elements that should be non-interactive when loading
                    el.style.pointerEvents = 'auto';
                    console.log('âœ… Removed pointer-events:none from:', el);
                }
            });
            
            // 5. Ensure z-index doesn't block close buttons
            document.querySelectorAll('[id^="close"]').forEach(btn => {
                btn.style.position = 'relative';
                btn.style.zIndex = '9999';
            });
            
            console.log('ðŸŽ‰ UNIVERSAL CLOSE BUTTON FIX COMPLETE!');
        });
    </script>

    <!-- ðŸ”¥ NEW: Hide Thinkly AI when scrolled away from its section -->
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const thinklySection = document.querySelector('#thinkly-ai-hero')?.closest('section');
            const thinklyAI = document.getElementById('thinkly-ai-hero');
            
            if (!thinklySection || !thinklyAI) return;
            
            // Function to check if Thinkly AI section is in viewport
            function checkThinklyVisibility() {
                const sectionRect = thinklySection.getBoundingClientRect();
                const windowHeight = window.innerHeight;
                
                // Check if section is in viewport (with some buffer)
                const isInView = sectionRect.top < windowHeight && sectionRect.bottom > 0;
                
                // Hide Thinkly AI if section is not in view
                if (!isInView) {
                    thinklyAI.style.opacity = '0';
                    thinklyAI.style.pointerEvents = 'none';
                    thinklyAI.style.visibility = 'hidden';
                } else {
                    thinklyAI.style.opacity = '1';
                    thinklyAI.style.pointerEvents = 'auto';
                    thinklyAI.style.visibility = 'visible';
                }
            }
            
            // Check on scroll with throttle
            let ticking = false;
            window.addEventListener('scroll', () => {
                if (!ticking) {
                    window.requestAnimationFrame(() => {
                        checkThinklyVisibility();
                        ticking = false;
                    });
                    ticking = true;
                }
            });
            
            // Initial check
            checkThinklyVisibility();
        });
    </script>

</body>
</html> 